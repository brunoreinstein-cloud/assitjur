import{r as _,j as e,ae as ks,af as Tr,ag as Sr,ah as Rr,ai as es,aj as ts,ak as Is,al as ss,am as as,an as rs,ao as Fs,ap as Ms,aq as Ls,ar as $s,as as Er,at as zs,au as Dr,av as qs,aw as Pr,ax as Vs,ay as Bs,az as Us,aA as Js,a4 as Hs,aB as Ws,aC as Ar,aD as Ks,aE as Qs,aF as Or,aG as kr,aH as Gs,aI as Ir,aJ as Fr,aK as Ys,aL as Mr,Y as Xs,aM as Zs,aN as ea,aO as ta,aP as sa,aQ as aa,aR as ra,aS as Lr,aT as $r,aU as zr,aV as na,aW as qr,aX as Vr,aY as Br,aZ as oa,a_ as Ur,C as xt,a$ as ia,k as la,b0 as ca,b1 as Jr,b2 as da,b3 as Hr,b4 as ua,b5 as ma,b6 as Wr,b7 as Kr,b8 as ha,b9 as dt,ba as Qr,z as Ft,p as Ye,bb as fa,bc as pa,v as Je,bd as xa,ab as Pt,be as ga,bf as Gr,bg as Yr,R as E,bh as Xr,bi as Zr,bj as en,bk as tn,bl as ns,bm as Ut,N as sn,x as an,bn as rn,Z as va,m as ja,a8 as hs,K as ba,bo as ut,bp as nn,h as Ve,a9 as Jt,D as _a,ac as lt,bq as on,a7 as Ht,U as Wt,br as Na,M as ln,bs as cn,bt as dn,f as wa,bu as fs,E as ps,n as un,bv as mn,i as xs,bw as hn,u as fn,ad as pn,bx as xn,e as gn}from"./vendor-B4dDctVk.js";import{g as q,x as ya,y as vn,z as jn,D as Be,b as ce,a as H,C as pe,m as we,S as ot,n as He,p as We,_ as bn,s as pt,j as De,k as Pe,l as _t,q as gs,E as Tt,r as ht,G as _n,H as vt,I as os,A as Nn,c as vs,d as js,e as bs}from"./page-About-BOeQq8Je.js";import{L as Ee,I as ct,w as Ca,u as Lt,a as wn,b as _s,T as yn,c as Cn,d as Ns,e as ws}from"./page-Login-foFjYdyQ.js";import{P as Tn,a as Sn,b as Rn,T as Ta,c as Sa,d as At,e as Te,f as Ra,g as Se}from"./page-DemoMapaTestemunhas-BKlu-LPl.js";const En=Tr,Dn=Sr,Pn=Rr,Ea=_.forwardRef(({className:t,sideOffset:a=4,...s},r)=>e.jsx(ks,{ref:r,sideOffset:a,className:q("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...s}));Ea.displayName=ks.displayName;const An=Fs,Gi=Ms,On=Ls,Da=_.forwardRef(({className:t,...a},s)=>e.jsx(es,{ref:s,className:q("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...a}));Da.displayName=es.displayName;const Pa=_.forwardRef(({className:t,children:a,...s},r)=>e.jsxs(On,{children:[e.jsx(Da,{}),e.jsxs(ts,{ref:r,className:q("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...s,children:[a,e.jsxs(Is,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(ss,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Pa.displayName=ts.displayName;const Aa=({className:t,...a})=>e.jsx("div",{className:q("flex flex-col space-y-1.5 text-center sm:text-left",t),...a});Aa.displayName="DialogHeader";const kn=({className:t,...a})=>e.jsx("div",{className:q("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a});kn.displayName="DialogFooter";const Oa=_.forwardRef(({className:t,...a},s)=>e.jsx(as,{ref:s,className:q("text-lg font-semibold leading-none tracking-tight",t),...a}));Oa.displayName=as.displayName;const ka=_.forwardRef(({className:t,...a},s)=>e.jsx(rs,{ref:s,className:q("text-sm text-muted-foreground",t),...a}));ka.displayName=rs.displayName;const Ia=_.forwardRef(({className:t,...a},s)=>e.jsx($s,{className:q("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...a,ref:s,children:e.jsx(Er,{className:q("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));Ia.displayName=$s.displayName;const is=Or,ls=kr,In=_.forwardRef(({className:t,inset:a,children:s,...r},o)=>e.jsxs(zs,{ref:o,className:q("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",a&&"pl-8",t),...r,children:[s,e.jsx(Dr,{className:"ml-auto h-4 w-4"})]}));In.displayName=zs.displayName;const Fn=_.forwardRef(({className:t,...a},s)=>e.jsx(qs,{ref:s,className:q("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...a}));Fn.displayName=qs.displayName;const Mt=_.forwardRef(({className:t,sideOffset:a=4,...s},r)=>e.jsx(Pr,{children:e.jsx(Vs,{ref:r,sideOffset:a,className:q("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...s})}));Mt.displayName=Vs.displayName;const Ot=_.forwardRef(({className:t,inset:a,...s},r)=>e.jsx(Bs,{ref:r,className:q("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a&&"pl-8",t),...s}));Ot.displayName=Bs.displayName;const Fa=_.forwardRef(({className:t,children:a,checked:s,...r},o)=>e.jsxs(Us,{ref:o,className:q("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:s,...r,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Js,{children:e.jsx(Hs,{className:"h-4 w-4"})})}),a]}));Fa.displayName=Us.displayName;const Mn=_.forwardRef(({className:t,children:a,...s},r)=>e.jsxs(Ws,{ref:r,className:q("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...s,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Js,{children:e.jsx(Ar,{className:"h-2 w-2 fill-current"})})}),a]}));Mn.displayName=Ws.displayName;const Ln=_.forwardRef(({className:t,inset:a,...s},r)=>e.jsx(Ks,{ref:r,className:q("px-2 py-1.5 text-sm font-semibold",a&&"pl-8",t),...s}));Ln.displayName=Ks.displayName;const Kt=_.forwardRef(({className:t,...a},s)=>e.jsx(Qs,{ref:s,className:q("-mx-1 my-1 h-px bg-muted",t),...a}));Kt.displayName=Qs.displayName;const Ma=_.forwardRef(({className:t,children:a,...s},r)=>e.jsxs(Gs,{ref:r,className:q("relative overflow-hidden",t),...s,children:[e.jsx(Ir,{className:"h-full w-full rounded-[inherit] min-h-0",children:a}),e.jsx(La,{}),e.jsx(Fr,{})]}));Ma.displayName=Gs.displayName;const La=_.forwardRef(({className:t,orientation:a="vertical",...s},r)=>e.jsx(Ys,{ref:r,orientation:a,className:q("flex touch-none select-none transition-colors",a==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",a==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...s,children:e.jsx(Mr,{className:"relative flex-1 rounded-full bg-border"})}));La.displayName=Ys.displayName;function $n(t,a){let s;try{s=t()}catch{return}return{getItem:o=>{var n;const i=l=>l===null?null:JSON.parse(l,void 0),m=(n=s.getItem(o))!=null?n:null;return m instanceof Promise?m.then(i):i(m)},setItem:(o,n)=>s.setItem(o,JSON.stringify(n,void 0)),removeItem:o=>s.removeItem(o)}}const Qt=t=>a=>{try{const s=t(a);return s instanceof Promise?s:{then(r){return Qt(r)(s)},catch(r){return this}}}catch(s){return{then(r){return this},catch(r){return Qt(r)(s)}}}},zn=(t,a)=>(s,r,o)=>{let n={storage:$n(()=>localStorage),partialize:f=>f,version:0,merge:(f,w)=>({...w,...f}),...a},i=!1;const m=new Set,l=new Set;let u=n.storage;if(!u)return t((...f)=>{console.warn(`[zustand persist middleware] Unable to update item '${n.name}', the given storage is currently unavailable.`),s(...f)},r,o);const h=()=>{const f=n.partialize({...r()});return u.setItem(n.name,{state:f,version:n.version})},p=o.setState;o.setState=(f,w)=>(p(f,w),h());const j=t((...f)=>(s(...f),h()),r,o);o.getInitialState=()=>j;let y;const M=()=>{var f,w;if(!u)return;i=!1,m.forEach(S=>{var $;return S(($=r())!=null?$:j)});const P=((w=n.onRehydrateStorage)==null?void 0:w.call(n,(f=r())!=null?f:j))||void 0;return Qt(u.getItem.bind(u))(n.name).then(S=>{if(S)if(typeof S.version=="number"&&S.version!==n.version){if(n.migrate){const $=n.migrate(S.state,S.version);return $ instanceof Promise?$.then(D=>[!0,D]):[!0,$]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,S.state];return[!1,void 0]}).then(S=>{var $;const[D,ee]=S;if(y=n.merge(ee,($=r())!=null?$:j),s(y,!0),D)return h()}).then(()=>{P?.(y,void 0),y=r(),i=!0,l.forEach(S=>S(y))}).catch(S=>{P?.(void 0,S)})};return o.persist={setOptions:f=>{n={...n,...f},f.storage&&(u=f.storage)},clearStorage:()=>{u?.removeItem(n.name)},getOptions:()=>n,rehydrate:()=>M(),hasHydrated:()=>i,onHydrate:f=>(m.add(f),()=>{m.delete(f)}),onFinishHydration:f=>(l.add(f),()=>{l.delete(f)})},n.skipHydration||M(),y||j},qn=zn,Vn=Xs()(qn((t,a)=>({notifications:[],unreadCount:0,addNotification:s=>{const r=`notification-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,o={...s,id:r,createdAt:new Date,read:!1,duration:s.duration??5e3};return t(n=>({notifications:[o,...n.notifications],unreadCount:n.unreadCount+1})),o.duration&&setTimeout(()=>{a().removeNotification(r)},o.duration),r},removeNotification:s=>{t(r=>{const o=r.notifications.find(i=>i.id===s),n=o&&!o.read;return{notifications:r.notifications.filter(i=>i.id!==s),unreadCount:n?r.unreadCount-1:r.unreadCount}})},markAsRead:s=>{t(r=>{const o=r.notifications.map(i=>i.id===s?{...i,read:!0}:i),n=o.filter(i=>!i.read).length;return{notifications:o,unreadCount:n}})},markAllAsRead:()=>{t(s=>({notifications:s.notifications.map(r=>({...r,read:!0})),unreadCount:0}))},clearAll:()=>{t({notifications:[],unreadCount:0})},clearRead:()=>{t(s=>({notifications:s.notifications.filter(r=>!r.read),unreadCount:s.unreadCount}))}}),{name:"assistjur-notifications",partialize:t=>({notifications:t.notifications.slice(0,50)})})),Bn=()=>{const{addNotification:t,...a}=Vn();return{...a,success:(s,r,o)=>t({type:"success",title:s,message:r,...o}),error:(s,r,o)=>t({type:"error",title:s,message:r,duration:null,...o}),warning:(s,r,o)=>t({type:"warning",title:s,message:r,...o}),info:(s,r,o)=>t({type:"info",title:s,message:r,...o}),addNotification:t}},Un=Lr,Yi=$r,Jn=zr,$a=_.forwardRef(({className:t,...a},s)=>e.jsx(Zs,{className:q("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...a,ref:s}));$a.displayName=Zs.displayName;const za=_.forwardRef(({className:t,...a},s)=>e.jsxs(Jn,{children:[e.jsx($a,{}),e.jsx(ea,{ref:s,className:q("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...a})]}));za.displayName=ea.displayName;const qa=({className:t,...a})=>e.jsx("div",{className:q("flex flex-col space-y-2 text-center sm:text-left",t),...a});qa.displayName="AlertDialogHeader";const Va=({className:t,...a})=>e.jsx("div",{className:q("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a});Va.displayName="AlertDialogFooter";const Ba=_.forwardRef(({className:t,...a},s)=>e.jsx(ta,{ref:s,className:q("text-lg font-semibold",t),...a}));Ba.displayName=ta.displayName;const Ua=_.forwardRef(({className:t,...a},s)=>e.jsx(sa,{ref:s,className:q("text-sm text-muted-foreground",t),...a}));Ua.displayName=sa.displayName;const Ja=_.forwardRef(({className:t,...a},s)=>e.jsx(aa,{ref:s,className:q(ya(),t),...a}));Ja.displayName=aa.displayName;const Ha=_.forwardRef(({className:t,...a},s)=>e.jsx(ra,{ref:s,className:q(ya({variant:"outline"}),"mt-2 sm:mt-0",t),...a}));Ha.displayName=ra.displayName;const kt=_.forwardRef(({className:t,value:a,...s},r)=>e.jsx(na,{ref:r,className:q("relative h-2 w-full overflow-hidden rounded-full bg-secondary",t),...s,children:e.jsx(qr,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(a||0)}%)`}})}));kt.displayName=na.displayName;var Wa={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/(function(t,a){((s,r)=>{t.exports=r()})(vn,function s(){var r=typeof self<"u"?self:typeof window<"u"?window:r!==void 0?r:{},o,n=!r.document&&!!r.postMessage,i=r.IS_PAPA_WORKER||!1,m={},l=0,u={};function h(c){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(d){var x=ee(d);x.chunkSize=parseInt(x.chunkSize),d.step||d.chunk||(x.chunkSize=null),this._handle=new f(x),(this._handle.streamer=this)._config=x}.call(this,c),this.parseChunk=function(d,x){var g=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<g){let A=this._config.newline;A||(b=this._config.quoteChar||'"',A=this._handle.guessLineEndings(d,b)),d=[...d.split(A).slice(g)].join(A)}this.isFirstChunk&&C(this._config.beforeFirstChunk)&&(b=this._config.beforeFirstChunk(d))!==void 0&&(d=b),this.isFirstChunk=!1,this._halted=!1;var g=this._partialLine+d,b=(this._partialLine="",this._handle.parse(g,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(d=b.meta.cursor,g=(this._finished||(this._partialLine=g.substring(d-this._baseIndex),this._baseIndex=d),b&&b.data&&(this._rowCount+=b.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),i)r.postMessage({results:b,workerId:u.WORKER_ID,finished:g});else if(C(this._config.chunk)&&!x){if(this._config.chunk(b,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=b=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(b.data),this._completeResults.errors=this._completeResults.errors.concat(b.errors),this._completeResults.meta=b.meta),this._completed||!g||!C(this._config.complete)||b&&b.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),g||b&&b.meta.paused||this._nextChunk(),b}this._halted=!0},this._sendError=function(d){C(this._config.error)?this._config.error(d):i&&this._config.error&&r.postMessage({workerId:u.WORKER_ID,error:d,finished:!1})}}function p(c){var d;(c=c||{}).chunkSize||(c.chunkSize=u.RemoteChunkSize),h.call(this,c),this._nextChunk=n?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(x){this._input=x,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(d=new XMLHttpRequest,this._config.withCredentials&&(d.withCredentials=this._config.withCredentials),n||(d.onload=ae(this._chunkLoaded,this),d.onerror=ae(this._chunkError,this)),d.open(this._config.downloadRequestBody?"POST":"GET",this._input,!n),this._config.downloadRequestHeaders){var x,g=this._config.downloadRequestHeaders;for(x in g)d.setRequestHeader(x,g[x])}var b;this._config.chunkSize&&(b=this._start+this._config.chunkSize-1,d.setRequestHeader("Range","bytes="+this._start+"-"+b));try{d.send(this._config.downloadRequestBody)}catch(A){this._chunkError(A.message)}n&&d.status===0&&this._chunkError()}},this._chunkLoaded=function(){d.readyState===4&&(d.status<200||400<=d.status?this._chunkError():(this._start+=this._config.chunkSize||d.responseText.length,this._finished=!this._config.chunkSize||this._start>=(x=>(x=x.getResponseHeader("Content-Range"))!==null?parseInt(x.substring(x.lastIndexOf("/")+1)):-1)(d),this.parseChunk(d.responseText)))},this._chunkError=function(x){x=d.statusText||x,this._sendError(new Error(x))}}function j(c){(c=c||{}).chunkSize||(c.chunkSize=u.LocalChunkSize),h.call(this,c);var d,x,g=typeof FileReader<"u";this.stream=function(b){this._input=b,x=b.slice||b.webkitSlice||b.mozSlice,g?((d=new FileReader).onload=ae(this._chunkLoaded,this),d.onerror=ae(this._chunkError,this)):d=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var b=this._input,A=(this._config.chunkSize&&(A=Math.min(this._start+this._config.chunkSize,this._input.size),b=x.call(b,this._start,A)),d.readAsText(b,this._config.encoding));g||this._chunkLoaded({target:{result:A}})},this._chunkLoaded=function(b){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(b.target.result)},this._chunkError=function(){this._sendError(d.error)}}function y(c){var d;h.call(this,c=c||{}),this.stream=function(x){return d=x,this._nextChunk()},this._nextChunk=function(){var x,g;if(!this._finished)return x=this._config.chunkSize,d=x?(g=d.substring(0,x),d.substring(x)):(g=d,""),this._finished=!d,this.parseChunk(g)}}function M(c){h.call(this,c=c||{});var d=[],x=!0,g=!1;this.pause=function(){h.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){h.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(b){this._input=b,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){g&&d.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),d.length?this.parseChunk(d.shift()):x=!0},this._streamData=ae(function(b){try{d.push(typeof b=="string"?b:b.toString(this._config.encoding)),x&&(x=!1,this._checkIsFinished(),this.parseChunk(d.shift()))}catch(A){this._streamError(A)}},this),this._streamError=ae(function(b){this._streamCleanUp(),this._sendError(b)},this),this._streamEnd=ae(function(){this._streamCleanUp(),g=!0,this._streamData("")},this),this._streamCleanUp=ae(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function f(c){var d,x,g,b,A=Math.pow(2,53),Q=-A,te=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,re=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,k=this,G=0,I=0,ue=!1,z=!1,N=[],v={data:[],errors:[],meta:{}};function T(L){return c.skipEmptyLines==="greedy"?L.join("").trim()==="":L.length===1&&L[0].length===0}function O(){if(v&&g&&(Y("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+u.DefaultDelimiter+"'"),g=!1),c.skipEmptyLines&&(v.data=v.data.filter(function(F){return!T(F)})),U()){let F=function(oe,R){C(c.transformHeader)&&(oe=c.transformHeader(oe,R)),N.push(oe)};if(v)if(Array.isArray(v.data[0])){for(var L=0;U()&&L<v.data.length;L++)v.data[L].forEach(F);v.data.splice(0,1)}else v.data.forEach(F)}function J(F,oe){for(var R=c.header?{}:[],Z=0;Z<F.length;Z++){var X=Z,W=F[Z],W=((ye,V)=>(se=>(c.dynamicTypingFunction&&c.dynamicTyping[se]===void 0&&(c.dynamicTyping[se]=c.dynamicTypingFunction(se)),(c.dynamicTyping[se]||c.dynamicTyping)===!0))(ye)?V==="true"||V==="TRUE"||V!=="false"&&V!=="FALSE"&&((se=>{if(te.test(se)&&(se=parseFloat(se),Q<se&&se<A))return 1})(V)?parseFloat(V):re.test(V)?new Date(V):V===""?null:V):V)(X=c.header?Z>=N.length?"__parsed_extra":N[Z]:X,W=c.transform?c.transform(W,X):W);X==="__parsed_extra"?(R[X]=R[X]||[],R[X].push(W)):R[X]=W}return c.header&&(Z>N.length?Y("FieldMismatch","TooManyFields","Too many fields: expected "+N.length+" fields but parsed "+Z,I+oe):Z<N.length&&Y("FieldMismatch","TooFewFields","Too few fields: expected "+N.length+" fields but parsed "+Z,I+oe)),R}var ne;v&&(c.header||c.dynamicTyping||c.transform)&&(ne=1,!v.data.length||Array.isArray(v.data[0])?(v.data=v.data.map(J),ne=v.data.length):v.data=J(v.data,0),c.header&&v.meta&&(v.meta.fields=N),I+=ne)}function U(){return c.header&&N.length===0}function Y(L,J,ne,F){L={type:L,code:J,message:ne},F!==void 0&&(L.row=F),v.errors.push(L)}C(c.step)&&(b=c.step,c.step=function(L){v=L,U()?O():(O(),v.data.length!==0&&(G+=L.data.length,c.preview&&G>c.preview?x.abort():(v.data=v.data[0],b(v,k))))}),this.parse=function(L,J,ne){var F=c.quoteChar||'"',F=(c.newline||(c.newline=this.guessLineEndings(L,F)),g=!1,c.delimiter?C(c.delimiter)&&(c.delimiter=c.delimiter(L),v.meta.delimiter=c.delimiter):((F=((oe,R,Z,X,W)=>{var ye,V,se,fe;W=W||[",","	","|",";",u.RECORD_SEP,u.UNIT_SEP];for(var Ae=0;Ae<W.length;Ae++){for(var xe,st=W[Ae],je=0,Fe=0,ge=0,be=(se=void 0,new P({comments:X,delimiter:st,newline:R,preview:10}).parse(oe)),ze=0;ze<be.data.length;ze++)Z&&T(be.data[ze])?ge++:(xe=be.data[ze].length,Fe+=xe,se===void 0?se=xe:0<xe&&(je+=Math.abs(xe-se),se=xe));0<be.data.length&&(Fe/=be.data.length-ge),(V===void 0||je<=V)&&(fe===void 0||fe<Fe)&&1.99<Fe&&(V=je,ye=st,fe=Fe)}return{successful:!!(c.delimiter=ye),bestDelimiter:ye}})(L,c.newline,c.skipEmptyLines,c.comments,c.delimitersToGuess)).successful?c.delimiter=F.bestDelimiter:(g=!0,c.delimiter=u.DefaultDelimiter),v.meta.delimiter=c.delimiter),ee(c));return c.preview&&c.header&&F.preview++,d=L,x=new P(F),v=x.parse(d,J,ne),O(),ue?{meta:{paused:!0}}:v||{meta:{paused:!1}}},this.paused=function(){return ue},this.pause=function(){ue=!0,x.abort(),d=C(c.chunk)?"":d.substring(x.getCharIndex())},this.resume=function(){k.streamer._halted?(ue=!1,k.streamer.parseChunk(d,!0)):setTimeout(k.resume,3)},this.aborted=function(){return z},this.abort=function(){z=!0,x.abort(),v.meta.aborted=!0,C(c.complete)&&c.complete(v),d=""},this.guessLineEndings=function(oe,F){oe=oe.substring(0,1048576);var F=new RegExp(w(F)+"([^]*?)"+w(F),"gm"),ne=(oe=oe.replace(F,"")).split("\r"),F=oe.split(`
`),oe=1<F.length&&F[0].length<ne[0].length;if(ne.length===1||oe)return`
`;for(var R=0,Z=0;Z<ne.length;Z++)ne[Z][0]===`
`&&R++;return R>=ne.length/2?`\r
`:"\r"}}function w(c){return c.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function P(c){var d=(c=c||{}).delimiter,x=c.newline,g=c.comments,b=c.step,A=c.preview,Q=c.fastMode,te=null,re=!1,k=c.quoteChar==null?'"':c.quoteChar,G=k;if(c.escapeChar!==void 0&&(G=c.escapeChar),(typeof d!="string"||-1<u.BAD_DELIMITERS.indexOf(d))&&(d=","),g===d)throw new Error("Comment character same as delimiter");g===!0?g="#":(typeof g!="string"||-1<u.BAD_DELIMITERS.indexOf(g))&&(g=!1),x!==`
`&&x!=="\r"&&x!==`\r
`&&(x=`
`);var I=0,ue=!1;this.parse=function(z,N,v){if(typeof z!="string")throw new Error("Input must be a string");var T=z.length,O=d.length,U=x.length,Y=g.length,L=C(b),J=[],ne=[],F=[],oe=I=0;if(!z)return je();if(Q||Q!==!1&&z.indexOf(k)===-1){for(var R=z.split(x),Z=0;Z<R.length;Z++){if(F=R[Z],I+=F.length,Z!==R.length-1)I+=x.length;else if(v)return je();if(!g||F.substring(0,Y)!==g){if(L){if(J=[],fe(F.split(d)),Fe(),ue)return je()}else fe(F.split(d));if(A&&A<=Z)return J=J.slice(0,A),je(!0)}}return je()}for(var X=z.indexOf(d,I),W=z.indexOf(x,I),ye=new RegExp(w(G)+w(k),"g"),V=z.indexOf(k,I);;)if(z[I]===k)for(V=I,I++;;){if((V=z.indexOf(k,V+1))===-1)return v||ne.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:J.length,index:I}),xe();if(V===T-1)return xe(z.substring(I,V).replace(ye,k));if(k===G&&z[V+1]===G)V++;else if(k===G||V===0||z[V-1]!==G){X!==-1&&X<V+1&&(X=z.indexOf(d,V+1));var se=Ae((W=W!==-1&&W<V+1?z.indexOf(x,V+1):W)===-1?X:Math.min(X,W));if(z.substr(V+1+se,O)===d){F.push(z.substring(I,V).replace(ye,k)),z[I=V+1+se+O]!==k&&(V=z.indexOf(k,I)),X=z.indexOf(d,I),W=z.indexOf(x,I);break}if(se=Ae(W),z.substring(V+1+se,V+1+se+U)===x){if(F.push(z.substring(I,V).replace(ye,k)),st(V+1+se+U),X=z.indexOf(d,I),V=z.indexOf(k,I),L&&(Fe(),ue))return je();if(A&&J.length>=A)return je(!0);break}ne.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:J.length,index:I}),V++}}else if(g&&F.length===0&&z.substring(I,I+Y)===g){if(W===-1)return je();I=W+U,W=z.indexOf(x,I),X=z.indexOf(d,I)}else if(X!==-1&&(X<W||W===-1))F.push(z.substring(I,X)),I=X+O,X=z.indexOf(d,I);else{if(W===-1)break;if(F.push(z.substring(I,W)),st(W+U),L&&(Fe(),ue))return je();if(A&&J.length>=A)return je(!0)}return xe();function fe(ge){J.push(ge),oe=I}function Ae(ge){var be=0;return be=ge!==-1&&(ge=z.substring(V+1,ge))&&ge.trim()===""?ge.length:be}function xe(ge){return v||(ge===void 0&&(ge=z.substring(I)),F.push(ge),I=T,fe(F),L&&Fe()),je()}function st(ge){I=ge,fe(F),F=[],W=z.indexOf(x,I)}function je(ge){if(c.header&&!N&&J.length&&!re){var be=J[0],ze=Object.create(null),mt=new Set(be);let wt=!1;for(let Me=0;Me<be.length;Me++){let Oe=be[Me];if(ze[Oe=C(c.transformHeader)?c.transformHeader(Oe,Me):Oe]){let at,yt=ze[Oe];for(;at=Oe+"_"+yt,yt++,mt.has(at););mt.add(at),be[Me]=at,ze[Oe]++,wt=!0,(te=te===null?{}:te)[at]=Oe}else ze[Oe]=1,be[Me]=Oe;mt.add(Oe)}wt&&console.warn("Duplicate headers found and renamed."),re=!0}return{data:J,errors:ne,meta:{delimiter:d,linebreak:x,aborted:ue,truncated:!!ge,cursor:oe+(N||0),renamedHeaders:te}}}function Fe(){b(je()),J=[],ne=[]}},this.abort=function(){ue=!0},this.getCharIndex=function(){return I}}function S(c){var d=c.data,x=m[d.workerId],g=!1;if(d.error)x.userError(d.error,d.file);else if(d.results&&d.results.data){var b={abort:function(){g=!0,$(d.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:D,resume:D};if(C(x.userStep)){for(var A=0;A<d.results.data.length&&(x.userStep({data:d.results.data[A],errors:d.results.errors,meta:d.results.meta},b),!g);A++);delete d.results}else C(x.userChunk)&&(x.userChunk(d.results,b,d.file),delete d.results)}d.finished&&!g&&$(d.workerId,d.results)}function $(c,d){var x=m[c];C(x.userComplete)&&x.userComplete(d),x.terminate(),delete m[c]}function D(){throw new Error("Not implemented.")}function ee(c){if(typeof c!="object"||c===null)return c;var d,x=Array.isArray(c)?[]:{};for(d in c)x[d]=ee(c[d]);return x}function ae(c,d){return function(){c.apply(d,arguments)}}function C(c){return typeof c=="function"}return u.parse=function(c,d){var x=(d=d||{}).dynamicTyping||!1;if(C(x)&&(d.dynamicTypingFunction=x,x={}),d.dynamicTyping=x,d.transform=!!C(d.transform)&&d.transform,!d.worker||!u.WORKERS_SUPPORTED)return x=null,u.NODE_STREAM_INPUT,typeof c=="string"?(c=(g=>g.charCodeAt(0)!==65279?g:g.slice(1))(c),x=new(d.download?p:y)(d)):c.readable===!0&&C(c.read)&&C(c.on)?x=new M(d):(r.File&&c instanceof File||c instanceof Object)&&(x=new j(d)),x.stream(c);(x=(()=>{var g;return!!u.WORKERS_SUPPORTED&&(g=(()=>{var b=r.URL||r.webkitURL||null,A=s.toString();return u.BLOB_URL||(u.BLOB_URL=b.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",A,")();"],{type:"text/javascript"})))})(),(g=new r.Worker(g)).onmessage=S,g.id=l++,m[g.id]=g)})()).userStep=d.step,x.userChunk=d.chunk,x.userComplete=d.complete,x.userError=d.error,d.step=C(d.step),d.chunk=C(d.chunk),d.complete=C(d.complete),d.error=C(d.error),delete d.worker,x.postMessage({input:c,config:d,workerId:x.id})},u.unparse=function(c,d){var x=!1,g=!0,b=",",A=`\r
`,Q='"',te=Q+Q,re=!1,k=null,G=!1,I=((()=>{if(typeof d=="object"){if(typeof d.delimiter!="string"||u.BAD_DELIMITERS.filter(function(N){return d.delimiter.indexOf(N)!==-1}).length||(b=d.delimiter),typeof d.quotes!="boolean"&&typeof d.quotes!="function"&&!Array.isArray(d.quotes)||(x=d.quotes),typeof d.skipEmptyLines!="boolean"&&typeof d.skipEmptyLines!="string"||(re=d.skipEmptyLines),typeof d.newline=="string"&&(A=d.newline),typeof d.quoteChar=="string"&&(Q=d.quoteChar),typeof d.header=="boolean"&&(g=d.header),Array.isArray(d.columns)){if(d.columns.length===0)throw new Error("Option columns is empty");k=d.columns}d.escapeChar!==void 0&&(te=d.escapeChar+Q),d.escapeFormulae instanceof RegExp?G=d.escapeFormulae:typeof d.escapeFormulae=="boolean"&&d.escapeFormulae&&(G=/^[=+\-@\t\r].*$/)}})(),new RegExp(w(Q),"g"));if(typeof c=="string"&&(c=JSON.parse(c)),Array.isArray(c)){if(!c.length||Array.isArray(c[0]))return ue(null,c,re);if(typeof c[0]=="object")return ue(k||Object.keys(c[0]),c,re)}else if(typeof c=="object")return typeof c.data=="string"&&(c.data=JSON.parse(c.data)),Array.isArray(c.data)&&(c.fields||(c.fields=c.meta&&c.meta.fields||k),c.fields||(c.fields=Array.isArray(c.data[0])?c.fields:typeof c.data[0]=="object"?Object.keys(c.data[0]):[]),Array.isArray(c.data[0])||typeof c.data[0]=="object"||(c.data=[c.data])),ue(c.fields||[],c.data||[],re);throw new Error("Unable to serialize unrecognized input");function ue(N,v,T){var O="",U=(typeof N=="string"&&(N=JSON.parse(N)),typeof v=="string"&&(v=JSON.parse(v)),Array.isArray(N)&&0<N.length),Y=!Array.isArray(v[0]);if(U&&g){for(var L=0;L<N.length;L++)0<L&&(O+=b),O+=z(N[L],L);0<v.length&&(O+=A)}for(var J=0;J<v.length;J++){var ne=(U?N:v[J]).length,F=!1,oe=U?Object.keys(v[J]).length===0:v[J].length===0;if(T&&!U&&(F=T==="greedy"?v[J].join("").trim()==="":v[J].length===1&&v[J][0].length===0),T==="greedy"&&U){for(var R=[],Z=0;Z<ne;Z++){var X=Y?N[Z]:Z;R.push(v[J][X])}F=R.join("").trim()===""}if(!F){for(var W=0;W<ne;W++){0<W&&!oe&&(O+=b);var ye=U&&Y?N[W]:W;O+=z(v[J][ye],W)}J<v.length-1&&(!T||0<ne&&!oe)&&(O+=A)}}return O}function z(N,v){var T,O;return N==null?"":N.constructor===Date?JSON.stringify(N).slice(1,25):(O=!1,G&&typeof N=="string"&&G.test(N)&&(N="'"+N,O=!0),T=N.toString().replace(I,te),(O=O||x===!0||typeof x=="function"&&x(N,v)||Array.isArray(x)&&x[v]||((U,Y)=>{for(var L=0;L<Y.length;L++)if(-1<U.indexOf(Y[L]))return!0;return!1})(T,u.BAD_DELIMITERS)||-1<T.indexOf(b)||T.charAt(0)===" "||T.charAt(T.length-1)===" ")?Q+T+Q:T)}},u.RECORD_SEP="",u.UNIT_SEP="",u.BYTE_ORDER_MARK="\uFEFF",u.BAD_DELIMITERS=["\r",`
`,'"',u.BYTE_ORDER_MARK],u.WORKERS_SUPPORTED=!n&&!!r.Worker,u.NODE_STREAM_INPUT=1,u.LocalChunkSize=10485760,u.RemoteChunkSize=5242880,u.DefaultDelimiter=",",u.Parser=P,u.ParserHandle=f,u.NetworkStreamer=p,u.FileStreamer=j,u.StringStreamer=y,u.ReadableStreamStreamer=M,r.jQuery&&((o=r.jQuery).fn.parse=function(c){var d=c.config||{},x=[];return this.each(function(A){if(!(o(this).prop("tagName").toUpperCase()==="INPUT"&&o(this).attr("type").toLowerCase()==="file"&&r.FileReader)||!this.files||this.files.length===0)return!0;for(var Q=0;Q<this.files.length;Q++)x.push({file:this.files[Q],inputElem:this,instanceConfig:o.extend({},d)})}),g(),this;function g(){if(x.length===0)C(c.complete)&&c.complete();else{var A,Q,te,re,k=x[0];if(C(c.before)){var G=c.before(k.file,k.inputElem);if(typeof G=="object"){if(G.action==="abort")return A="AbortError",Q=k.file,te=k.inputElem,re=G.reason,void(C(c.error)&&c.error({name:A},Q,te,re));if(G.action==="skip")return void b();typeof G.config=="object"&&(k.instanceConfig=o.extend(k.instanceConfig,G.config))}else if(G==="skip")return void b()}var I=k.instanceConfig.complete;k.instanceConfig.complete=function(ue){C(I)&&I(ue,k.file,k.inputElem),b()},u.parse(k.file,k.instanceConfig)}}function b(){x.splice(0,1),g()}}),i&&(r.onmessage=function(c){c=c.data,u.WORKER_ID===void 0&&c&&(u.WORKER_ID=c.workerId),typeof c.input=="string"?r.postMessage({workerId:u.WORKER_ID,results:u.parse(c.input,c.config),finished:!0}):(r.File&&c.input instanceof File||c.input instanceof Object)&&(c=u.parse(c.input,c.config))&&r.postMessage({workerId:u.WORKER_ID,results:c,finished:!0})}),(p.prototype=Object.create(h.prototype)).constructor=p,(j.prototype=Object.create(h.prototype)).constructor=j,(y.prototype=Object.create(y.prototype)).constructor=y,(M.prototype=Object.create(h.prototype)).constructor=M,u})})(Wa);var Hn=Wa.exports;const Ka=jn(Hn),et=Vr,tt=Br,Ke=_.forwardRef(({className:t,children:a,...s},r)=>e.jsxs(oa,{ref:r,className:q("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...s,children:[a,e.jsx(Ur,{asChild:!0,children:e.jsx(xt,{className:"h-4 w-4 opacity-50"})})]}));Ke.displayName=oa.displayName;const Qa=_.forwardRef(({className:t,...a},s)=>e.jsx(ia,{ref:s,className:q("flex cursor-default items-center justify-center py-1",t),...a,children:e.jsx(la,{className:"h-4 w-4"})}));Qa.displayName=ia.displayName;const Ga=_.forwardRef(({className:t,...a},s)=>e.jsx(ca,{ref:s,className:q("flex cursor-default items-center justify-center py-1",t),...a,children:e.jsx(xt,{className:"h-4 w-4"})}));Ga.displayName=ca.displayName;const Qe=_.forwardRef(({className:t,children:a,position:s="popper",...r},o)=>e.jsx(Jr,{children:e.jsxs(da,{ref:o,className:q("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:s,...r,children:[e.jsx(Qa,{}),e.jsx(Hr,{className:q("p-1",s==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),e.jsx(Ga,{})]})}));Qe.displayName=da.displayName;const Wn=_.forwardRef(({className:t,...a},s)=>e.jsx(ua,{ref:s,className:q("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...a}));Wn.displayName=ua.displayName;const ve=_.forwardRef(({className:t,children:a,...s},r)=>e.jsxs(ma,{ref:r,className:q("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...s,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Wr,{children:e.jsx(Hs,{className:"h-4 w-4"})})}),e.jsx(Kr,{children:a})]}));ve.displayName=ma.displayName;const Kn=_.forwardRef(({className:t,...a},s)=>e.jsx(ha,{ref:s,className:q("-mx-1 my-1 h-px bg-muted",t),...a}));Kn.displayName=ha.displayName;const Ya=_.forwardRef(({className:t,...a},s)=>e.jsx("textarea",{className:q("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:s,...a}));Ya.displayName="Textarea";function Qn(t){return t&&t.replace(/(\d{3})\.\d{3}\.\d{3}-(\d{2})/,"$1.***.***-$2")}function Gn(t){return t&&t.replace(/(\d{2})\.\d{3}\.\d{3}\/\d{4}-(\d{2})/,"$1.***.***/**-$2")}function Yn(t){if(!t)return t;const[a,s]=t.split("@");return a.length<=2?`${a}***@${s}`:`${a.slice(0,2)}***@${s}`}function Xn(t){return t&&t.replace(/(\d{2})\d{4,5}(\d{4})/,"$1****$2")}function Zn(t){return t&&t.replace(/(\d{2,3})\d+/,"$1***")}function eo(t){if(!t)return t;let a=t;return a=a.replace(/\d{3}\.\d{3}\.\d{3}-\d{2}/g,s=>Qn(s)),a=a.replace(/\d{2}\.\d{3}\.\d{3}\/\d{4}-\d{2}/g,s=>Gn(s)),a=a.replace(/[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}/g,s=>Yn(s)),a=a.replace(/\(\d{2}\)\s?\d{4,5}-?\d{4}/g,s=>Xn(s)),a=a.replace(/OAB[-\/]?\s?\d{3,6}/gi,s=>{const r=s.match(/\d{3,6}/)?.[0]||"";return s.replace(r,Zn(r))}),a}function Ge(t,a){if(!a||!t)return t;if(typeof t=="string")return eo(t);if(Array.isArray(t))return t.map(s=>Ge(s,a));if(typeof t=="object"){const s={};for(const[r,o]of Object.entries(t))s[r]=Ge(o,a);return s}return t}function it({items:t,maxVisible:a=2,isPiiMasked:s=!1}){const{toast:r}=Be();if(!t||t.length===0)return e.jsx("span",{className:"text-muted-foreground",children:"—"});const o=Ge(t,s),n=o.slice(0,a),i=t.length-a,m=async()=>{try{await navigator.clipboard.writeText(t.join(`
`)),r({title:"Copiado!",description:"Lista copiada para a área de transferência."})}catch{r({title:"Erro ao copiar",description:"Não foi possível copiar a lista.",variant:"destructive"})}};return t.length<=a?e.jsx("div",{className:"flex flex-wrap gap-1",children:n.map((l,u)=>e.jsx(ce,{variant:"secondary",className:"text-xs",children:l},u))}):e.jsxs("div",{className:"flex items-center gap-1",children:[n.map((l,u)=>e.jsx(ce,{variant:"secondary",className:"text-xs",children:l},u)),i>0&&e.jsxs(Tn,{children:[e.jsx(Sn,{asChild:!0,children:e.jsxs(H,{variant:"ghost",size:"sm",className:"h-6 px-2 text-xs",children:["+",i," ",e.jsx(xt,{className:"ml-1 h-3 w-3"})]})}),e.jsx(Rn,{className:"w-80",align:"start",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h4",{className:"font-medium",children:["Lista completa (",t.length," itens)"]}),e.jsx(H,{variant:"ghost",size:"sm",onClick:m,className:"h-8 px-2",children:e.jsx(dt,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"flex flex-wrap gap-1 max-h-48 overflow-y-auto",children:o.map((l,u)=>e.jsx(ce,{variant:"outline",className:"text-xs",children:l},u))})]})})]})]})}const to=["⏱ Mapeando conexões de testemunhas…","🔎 Checando histórico probatório…","⚖️ Analisando padrões de triangulação…","📋 Identificando riscos processuais…","👥 Cruzando dados do polo ativo…","🎯 Gerando insights estratégicos…","📊 Compilando relatório executivo…"],K=Xs((t,a)=>({processos:[],testemunhas:[],activeTab:"processos",selectedProcesso:null,selectedTestemunha:null,isDetailDrawerOpen:!1,isImportModalOpen:!1,isLoading:!1,isPiiMasked:!1,hasError:!1,errorMessage:"",lastUpdate:null,processoFilters:{},testemunhaFilters:{},columnVisibility:{processos:{cnj:!0,uf:!0,comarca:!0,fase:!0,status:!0,reclamante:!0,qtdDepos:!0,testemunhas:!0,classificacao:!0,acoes:!0},testemunhas:{nome:!0,qtdDepo:!0,ambosPolos:!0,jaReclamante:!0,cnjs:!0,classificacao:!0,acoes:!0}},savedViews:{},activeView:null,processosPage:1,testemunhasPage:1,pageSize:10,totalProcessos:0,totalTestemunhas:0,chatKind:"processo",chatInput:"",chatMessages:[],chatStatus:"idle",agentOnline:!0,chatResult:null,loadingHints:to,currentHintIndex:0,setActiveTab:s=>t({activeTab:s}),setProcessos:s=>t({processos:s}),setTestemunhas:s=>t({testemunhas:s}),setSelectedProcesso:s=>t({selectedProcesso:s}),setSelectedTestemunha:s=>t({selectedTestemunha:s}),setIsDetailDrawerOpen:s=>t({isDetailDrawerOpen:s}),setIsImportModalOpen:s=>t({isImportModalOpen:s}),setIsLoading:s=>t({isLoading:s}),setIsPiiMasked:s=>t({isPiiMasked:s}),setError:(s,r="")=>t({hasError:s,errorMessage:r}),setLastUpdate:s=>t({lastUpdate:s}),setProcessoFilters:s=>t(r=>{const o={...r.processoFilters,...s};return Object.keys(s).forEach(n=>{s[n]===void 0&&delete o[n]}),{processoFilters:o,processosPage:1}}),setTestemunhaFilters:s=>t(r=>{const o={...r.testemunhaFilters,...s};return Object.keys(s).forEach(n=>{s[n]===void 0&&delete o[n]}),{testemunhaFilters:o,testemunhasPage:1}}),setColumnVisibility:(s,r,o)=>t(n=>({columnVisibility:{...n.columnVisibility,[s]:{...n.columnVisibility[s],[r]:o}}})),saveView:(s,r)=>t(o=>{const n={...o.savedViews,[s]:{processoFilters:o.processoFilters,testemunhaFilters:o.testemunhaFilters,columnVisibility:o.columnVisibility}};return typeof window<"u"&&(localStorage.setItem(`mapaViews_${r}`,JSON.stringify(n)),localStorage.setItem(`mapaActiveView_${r}`,s)),{savedViews:n,activeView:s}}),loadViews:s=>{if(typeof window>"u")return;const r=localStorage.getItem(`mapaViews_${s}`),o=r?JSON.parse(r):{},n=localStorage.getItem(`mapaActiveView_${s}`);t({savedViews:o,activeView:n}),n&&o[n]&&t({processoFilters:o[n].processoFilters,testemunhaFilters:o[n].testemunhaFilters,columnVisibility:o[n].columnVisibility})},setActiveViewName:(s,r)=>t(o=>{const n=o.savedViews[s];return n?(typeof window<"u"&&localStorage.setItem(`mapaActiveView_${r}`,s),{activeView:s,processoFilters:n.processoFilters,testemunhaFilters:n.testemunhaFilters,columnVisibility:n.columnVisibility}):{}}),setProcessosPage:s=>t({processosPage:s}),setTestemunhasPage:s=>t({testemunhasPage:s}),setTotalProcessos:s=>t({totalProcessos:s}),setTotalTestemunhas:s=>t({totalTestemunhas:s}),removeProcesso:s=>{let r=null;return t(o=>{const n=o.processos.findIndex(m=>m.cnj===s);if(n===-1)return{};r=o.processos[n];const i=[...o.processos];return i.splice(n,1),{processos:i,totalProcessos:o.totalProcessos-1}}),r},restoreProcesso:s=>t(r=>({processos:[s,...r.processos],totalProcessos:r.totalProcessos+1})),removeTestemunha:s=>{let r=null;return t(o=>{const n=o.testemunhas.findIndex(m=>m.nome_testemunha===s);if(n===-1)return{};r=o.testemunhas[n];const i=[...o.testemunhas];return i.splice(n,1),{testemunhas:i,totalTestemunhas:o.totalTestemunhas-1}}),r},restoreTestemunha:s=>t(r=>({testemunhas:[s,...r.testemunhas],totalTestemunhas:r.totalTestemunhas+1})),resetFilters:()=>t({processoFilters:{},testemunhaFilters:{},processosPage:1,testemunhasPage:1}),setChatKind:s=>t({chatKind:s}),setChatInput:s=>t({chatInput:s}),addChatMessage:s=>{const r={...s,id:`msg-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,timestamp:new Date};return t(o=>({chatMessages:[...o.chatMessages,r]})),r.id},updateChatMessage:(s,r)=>t(o=>({chatMessages:o.chatMessages.map(n=>n.id===s?{...n,...r}:n)})),setChatStatus:s=>t({chatStatus:s}),setAgentOnline:s=>t({agentOnline:s}),setChatResult:s=>t({chatResult:s}),resetChat:()=>t({chatInput:"",chatMessages:[],chatStatus:"idle",chatResult:null,currentHintIndex:0}),nextHint:()=>t(s=>({currentHintIndex:(s.currentHintIndex+1)%s.loadingHints.length}))})),Xa=t=>t.activeTab,so=t=>t.processos,ao=t=>t.testemunhas,ro=t=>t.isLoading,Za=t=>t.isPiiMasked,no=t=>t.hasError,oo=t=>t.errorMessage,io=t=>t.lastUpdate,lo=t=>t.processoFilters,co=t=>t.testemunhaFilters,uo=t=>t.isImportModalOpen,cs=t=>t.columnVisibility,mo=t=>t.savedViews,ho=t=>t.activeView;function er({score:t,riscoNivel:a,className:s}){const n=a?(i=>{switch(i){case"alto":return{level:"Alto",color:"bg-destructive text-destructive-foreground"};case"medio":return{level:"Médio",color:"bg-amber-500/15 text-amber-600 border-amber-500/30"};case"baixo":return{level:"Baixo",color:"bg-emerald-500/15 text-emerald-600 border-emerald-500/30"}}})(a):t!==void 0?(i=>i>=70?{level:"VALIDAR",color:"bg-destructive text-destructive-foreground",riscoNivel:"alto"}:i>=50?{level:"AVALIAR",color:"bg-warning text-warning-foreground",riscoNivel:"medio"}:i>=30?{level:"CONHECER",color:"bg-success text-success-foreground",riscoNivel:"baixo"}:{level:"DESCARTAR",color:"bg-muted text-muted-foreground",riscoNivel:"baixo"})(t):{level:"N/A",color:"bg-muted text-muted-foreground"};return e.jsxs(ce,{className:q("font-semibold px-3 py-1 shadow-sm",n.color,s),children:[n.level,t!==void 0&&!a?` (${t})`:""]})}function tr(t){const{toast:a}=Be(),s=_.useRef(new Map);return{remove:({key:o,label:n,onDelete:i,onRestore:m})=>{const l=i();if(!l)return;s.current.set(o,l);const u=()=>{const h=s.current.get(o);h&&(m(h),s.current.delete(o))};a({title:`${t} removido`,description:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:n}),e.jsxs(H,{variant:"outline",size:"sm",onClick:u,className:"ml-2 h-6 px-2 text-xs",children:[e.jsx(Qr,{className:"h-3 w-3 mr-1"}),"Desfazer"]})]}),duration:5e3}),setTimeout(()=>{s.current.delete(o)},5e3)}}}function ds({open:t,title:a,description:s,confirmText:r="Confirmar",cancelText:o="Cancelar",loading:n=!1,onConfirm:i,onCancel:m}){return e.jsx(Un,{open:t,onOpenChange:l=>!l&&m(),children:e.jsxs(za,{children:[e.jsxs(qa,{children:[e.jsx(Ba,{children:a}),s&&e.jsx(Ua,{children:s})]}),e.jsxs(Va,{children:[e.jsx(Ha,{disabled:n,children:o}),e.jsxs(Ja,{onClick:i,disabled:n,children:[n&&e.jsx(Ft,{className:"mr-2 h-4 w-4 animate-spin"}),r]})]})]})})}function fo({data:t}){const{setSelectedProcesso:a,setIsDetailDrawerOpen:s,isPiiMasked:r,removeProcesso:o,restoreProcesso:n}=K(),i=K(cs).processos,{remove:m}=tr("Processo"),[l,u]=_.useState(null),[h,p]=_.useState(!1),j=w=>{a(w),s(!0)},y=w=>{u(w),p(!0)},M=()=>{l&&m({key:l.cnj,label:l.cnj,onDelete:()=>o(l.cnj),onRestore:n}),p(!1),u(null)},f=w=>{switch(w?.toLowerCase()){case"ativo":return"bg-success text-success-foreground";case"arquivado":return"bg-muted text-muted-foreground";case"suspenso":return"bg-warning text-warning-foreground";case"baixado":return"bg-secondary text-secondary-foreground";case"cancelado":return"bg-destructive text-destructive-foreground";default:return"bg-muted text-muted-foreground"}};return t.length?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"border border-border/50 rounded-2xl overflow-hidden",children:e.jsxs(Ta,{children:[e.jsx(Sa,{children:e.jsxs(At,{className:"bg-muted/30",children:[i.cnj&&e.jsx(Te,{className:"font-semibold",children:"CNJ"}),i.uf&&e.jsx(Te,{className:"font-semibold",children:"UF"}),i.comarca&&e.jsx(Te,{className:"font-semibold",children:"Comarca"}),i.fase&&e.jsx(Te,{className:"font-semibold",children:"Fase"}),i.status&&e.jsx(Te,{className:"font-semibold",children:"Status"}),i.reclamante&&e.jsx(Te,{className:"font-semibold",children:"Reclamante"}),i.qtdDepos&&e.jsx(Te,{className:"font-semibold",children:"Qtd Depo Únicos"}),i.testemunhas&&e.jsx(Te,{className:"font-semibold",children:"Testemunhas Ativo"}),i.classificacao&&e.jsx(Te,{className:"font-semibold",children:"Classificação"}),i.acoes&&e.jsx(Te,{className:"font-semibold text-center",children:"Ações"})]})}),e.jsx(Ra,{children:t.map(w=>e.jsxs(At,{className:"hover:bg-muted/20",children:[i.cnj&&e.jsx(Se,{className:"font-mono text-sm",children:Ge(w.cnj,r)}),i.uf&&e.jsx(Se,{children:e.jsx(ce,{variant:"outline",className:"text-xs",children:w.uf})}),i.comarca&&e.jsx(Se,{className:"max-w-[150px] truncate",title:w.comarca||"",children:Ge(w.comarca,r)||"—"}),i.fase&&e.jsx(Se,{children:e.jsx(ce,{variant:"secondary",className:"text-xs",children:w.fase||"—"})}),i.status&&e.jsx(Se,{children:e.jsx(ce,{className:`text-xs ${f(w.status)}`,children:w.status||"—"})}),i.reclamante&&e.jsx(Se,{className:"max-w-[180px] truncate",title:w.reclamante_limpo||"",children:Ge(w.reclamante_limpo,r)||"—"}),i.qtdDepos&&e.jsx(Se,{className:"text-center",children:w.qtd_total_depos_unicos?e.jsx(er,{score:w.qtd_total_depos_unicos}):"—"}),i.testemunhas&&e.jsx(Se,{children:e.jsx(it,{items:w.testemunhas_ativo_limpo,maxVisible:2,isPiiMasked:r})}),i.classificacao&&e.jsx(Se,{children:e.jsx(ce,{variant:w.classificacao_final==="ALTO RISCO"?"destructive":"secondary",className:"text-xs",children:w.classificacao_final||"—"})}),i.acoes&&e.jsx(Se,{children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(H,{variant:"ghost",size:"sm",onClick:()=>j(w),className:"h-8 w-8 p-0",children:e.jsx(Ye,{className:"h-4 w-4"})}),e.jsx(H,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:e.jsx(fa,{className:"h-4 w-4"})}),e.jsx(H,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-destructive hover:text-destructive",onClick:()=>y(w),children:e.jsx(pa,{className:"h-4 w-4"})})]})})]},w.cnj))})]})}),e.jsx(ds,{open:h,title:"Excluir processo?",description:l?`Deseja excluir o processo ${l.cnj}?`:void 0,confirmText:"Excluir",onConfirm:M,onCancel:()=>{p(!1),u(null)}})]}):e.jsx("div",{className:"border border-border/50 rounded-2xl p-12 text-center",children:e.jsxs("div",{className:"text-muted-foreground space-y-2",children:[e.jsx("p",{className:"text-lg",children:"Nenhum processo encontrado"}),e.jsx("p",{className:"text-sm",children:"Ajuste os filtros ou importe dados via Excel"})]})})}const Gt=_.memo(({value:t})=>t===null?e.jsx("span",{className:"text-muted-foreground",children:"—"}):t?e.jsx(Je,{className:"h-4 w-4 text-success"}):e.jsx(xa,{className:"h-4 w-4 text-muted-foreground"}));Gt.displayName="BooleanIcon";function Nt({status:t,onRetry:a,children:s}){return t==="loading"?e.jsx("div",{className:"p-8 text-center text-sm text-muted-foreground",children:"Carregando..."}):t==="error"?e.jsxs("div",{className:"p-8 text-center space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 text-destructive",children:[e.jsx(Pt,{className:"h-4 w-4"}),e.jsx("span",{children:"Erro ao carregar"})]}),a&&e.jsx(H,{variant:"outline",size:"sm",onClick:a,children:"Tentar novamente"})]}):t==="offline"?e.jsxs("div",{className:"p-8 text-center space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 text-destructive",children:[e.jsx(Pt,{className:"h-4 w-4"}),e.jsx("span",{children:"Sem conexão"})]}),a&&e.jsx(H,{variant:"outline",size:"sm",onClick:a,children:"Tentar novamente"})]}):t==="empty"?e.jsx("div",{className:"p-12 text-center text-muted-foreground",children:"Nenhum dado encontrado"}):e.jsx(e.Fragment,{children:s})}function po({data:t,status:a,onRetry:s}){const{setSelectedTestemunha:r,setIsDetailDrawerOpen:o,isPiiMasked:n,removeTestemunha:i,restoreTestemunha:m}=K(),l=K(cs).testemunhas,{remove:u}=tr("Testemunha"),[h,p]=_.useState(null),[j,y]=_.useState(!1),M=_.useCallback(S=>{r(S),o(!0)},[r,o]),f=S=>{switch(S?.toLowerCase()){case"alto risco":return"bg-destructive text-destructive-foreground";case"médio risco":return"bg-warning text-warning-foreground";case"baixo risco":return"bg-success text-success-foreground";default:return"bg-muted text-muted-foreground"}};if(a!=="success")return e.jsx(Nt,{status:a,onRetry:s});if(!t.length)return e.jsx(Nt,{status:"empty",onRetry:s});const w=_.useCallback(S=>{p(S),y(!0)},[]),P=_.useCallback(()=>{h&&u({key:h.nome_testemunha,label:h.nome_testemunha,onDelete:()=>i(h.nome_testemunha),onRestore:m}),y(!1),p(null)},[h,u,i,m]);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"border border-border/50 rounded-2xl overflow-hidden",children:e.jsxs(Ta,{children:[e.jsx(Sa,{children:e.jsxs(At,{className:"bg-muted/30",children:[l.nome&&e.jsx(Te,{className:"font-semibold",children:"Nome da Testemunha"}),l.qtdDepo&&e.jsx(Te,{className:"font-semibold text-center",children:"Qtd Depoimentos"}),l.ambosPolos&&e.jsx(Te,{className:"font-semibold text-center",children:"Ambos os Polos"}),l.jaReclamante&&e.jsx(Te,{className:"font-semibold text-center",children:"Já Foi Reclamante"}),l.cnjs&&e.jsx(Te,{className:"font-semibold",children:"CNJs como Testemunha"}),l.classificacao&&e.jsx(Te,{className:"font-semibold",children:"Classificação Estratégica"}),l.acoes&&e.jsx(Te,{className:"font-semibold text-center",children:"Ações"})]})}),e.jsx(Ra,{children:t.map(S=>e.jsxs(At,{className:"hover:bg-muted/20",children:[l.nome&&e.jsx(Se,{className:"font-medium max-w-[200px] truncate",title:S.nome_testemunha,children:Ge(S.nome_testemunha,n)}),l.qtdDepo&&e.jsx(Se,{className:"text-center",children:e.jsx(ce,{variant:"secondary",className:"text-xs",children:S.qtd_depoimentos||0})}),l.ambosPolos&&e.jsx(Se,{className:"text-center",children:e.jsx(Gt,{value:S.foi_testemunha_em_ambos_polos})}),l.jaReclamante&&e.jsx(Se,{className:"text-center",children:e.jsx(Gt,{value:S.ja_foi_reclamante})}),l.cnjs&&e.jsx(Se,{children:e.jsx(it,{items:S.cnjs_como_testemunha,maxVisible:2,isPiiMasked:n})}),l.classificacao&&e.jsx(Se,{children:e.jsx(ce,{className:`text-xs ${f(S.classificacao_estrategica)}`,children:S.classificacao_estrategica||"—"})}),l.acoes&&e.jsx(Se,{children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(H,{variant:"ghost",size:"sm",onClick:()=>M(S),className:"h-8 w-8 p-0",children:e.jsx(Ye,{className:"h-4 w-4"})}),e.jsx(H,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:e.jsx(fa,{className:"h-4 w-4"})}),e.jsx(H,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-destructive hover:text-destructive",onClick:()=>w(S),children:e.jsx(pa,{className:"h-4 w-4"})})]})})]},S.nome_testemunha))})]})}),e.jsx(ds,{open:j,title:"Excluir testemunha?",description:h?`Deseja excluir ${h.nome_testemunha}?`:void 0,confirmText:"Excluir",onConfirm:P,onCancel:()=>{y(!1),p(null)}})]})}const xo=["AC","AL","AP","AM","BA","CE","DF","ES","GO","MA","MT","MS","MG","PA","PB","PR","PE","PI","RJ","RN","RS","RO","RR","SC","SP","SE","TO"],go=["Ativo","Arquivado","Suspenso","Baixado","Cancelado"],vo=["Conhecimento","Execução","Recursal","Liquidação"];function jo(){const{processoFilters:t,setProcessoFilters:a,resetFilters:s}=K(),r=(i,m)=>{if(m===""||m===void 0||m==="TODAS"||m==="TODOS"){const l={...t};delete l[i],a(l)}else a({[i]:m})},o=()=>{s()},n=Object.keys(t).length>0;return e.jsx(pe,{className:"rounded-2xl border-border/50",children:e.jsxs(we,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(ga,{className:"h-5 w-5"}),"Filtros - Por Processo"]}),n&&e.jsxs(H,{variant:"ghost",size:"sm",onClick:o,children:[e.jsx(ss,{className:"h-4 w-4 mr-1"}),"Limpar"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ee,{htmlFor:"search",children:"Buscar"}),e.jsx(ct,{id:"search",placeholder:"CNJ, comarca, reclamante...",value:t.search||"",onChange:i=>r("search",i.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ee,{htmlFor:"testemunha",children:"Testemunha"}),e.jsx(ct,{id:"testemunha",placeholder:"Nome da testemunha...",value:t.testemunha||"",onChange:i=>r("testemunha",i.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ee,{htmlFor:"uf",children:"UF"}),e.jsxs(et,{value:t.uf||"TODAS",onValueChange:i=>r("uf",i),children:[e.jsx(Ke,{id:"uf",children:e.jsx(tt,{placeholder:"Selecione..."})}),e.jsxs(Qe,{children:[e.jsx(ve,{value:"TODAS",children:"Todas"}),xo.map(i=>e.jsx(ve,{value:i,children:i},i))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ee,{htmlFor:"status",children:"Status"}),e.jsxs(et,{value:t.status||"TODOS",onValueChange:i=>r("status",i),children:[e.jsx(Ke,{id:"status",children:e.jsx(tt,{placeholder:"Selecione..."})}),e.jsxs(Qe,{children:[e.jsx(ve,{value:"TODOS",children:"Todos"}),go.map(i=>e.jsx(ve,{value:i,children:i},i))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ee,{htmlFor:"fase",children:"Fase"}),e.jsxs(et,{value:t.fase||"TODAS",onValueChange:i=>r("fase",i),children:[e.jsx(Ke,{id:"fase",children:e.jsx(tt,{placeholder:"Selecione..."})}),e.jsxs(Qe,{children:[e.jsx(ve,{value:"TODAS",children:"Todas"}),vo.map(i=>e.jsx(ve,{value:i,children:i},i))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ee,{htmlFor:"qtdMin",children:"Qtd Depo Únicos (Mín)"}),e.jsx(ct,{id:"qtdMin",type:"number",placeholder:"0",value:t.qtdDeposMin||"",onChange:i=>r("qtdDeposMin",i.target.value?Number(i.target.value):void 0)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ee,{htmlFor:"qtdMax",children:"Qtd Depo Únicos (Máx)"}),e.jsx(ct,{id:"qtdMax",type:"number",placeholder:"∞",value:t.qtdDeposMax||"",onChange:i=>r("qtdDeposMax",i.target.value?Number(i.target.value):void 0)})]})]})]})})}function bo(){const{testemunhaFilters:t,setTestemunhaFilters:a,resetFilters:s}=K(),r=(i,m)=>{if(m===""||m===void 0||m==="TODOS"){const l={...t};delete l[i],a(l)}else a({[i]:m})},o=()=>{s()},n=Object.keys(t).length>0;return e.jsx(pe,{className:"rounded-2xl border-border/50",children:e.jsxs(we,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(ga,{className:"h-5 w-5"}),"Filtros - Por Testemunha"]}),n&&e.jsxs(H,{variant:"ghost",size:"sm",onClick:o,children:[e.jsx(ss,{className:"h-4 w-4 mr-1"}),"Limpar"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ee,{htmlFor:"search",children:"Buscar"}),e.jsx(ct,{id:"search",placeholder:"Nome da testemunha...",value:t.search||"",onChange:i=>r("search",i.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ee,{htmlFor:"ambosPolos",children:"Em Ambos os Polos"}),e.jsxs(et,{value:t.ambosPolos!==void 0?t.ambosPolos.toString():"TODOS",onValueChange:i=>r("ambosPolos",i==="TODOS"?void 0:i==="true"),children:[e.jsx(Ke,{id:"ambosPolos",children:e.jsx(tt,{placeholder:"Selecione..."})}),e.jsxs(Qe,{children:[e.jsx(ve,{value:"TODOS",children:"Todos"}),e.jsx(ve,{value:"true",children:"Sim"}),e.jsx(ve,{value:"false",children:"Não"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ee,{htmlFor:"jaFoiReclamante",children:"Já Foi Reclamante"}),e.jsxs(et,{value:t.jaFoiReclamante!==void 0?t.jaFoiReclamante.toString():"TODOS",onValueChange:i=>r("jaFoiReclamante",i==="TODOS"?void 0:i==="true"),children:[e.jsx(Ke,{id:"jaFoiReclamante",children:e.jsx(tt,{placeholder:"Selecione..."})}),e.jsxs(Qe,{children:[e.jsx(ve,{value:"TODOS",children:"Todos"}),e.jsx(ve,{value:"true",children:"Sim"}),e.jsx(ve,{value:"false",children:"Não"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ee,{htmlFor:"temTriangulacao",children:"Participou Triangulação"}),e.jsxs(et,{value:t.temTriangulacao!==void 0?t.temTriangulacao.toString():"TODOS",onValueChange:i=>r("temTriangulacao",i==="TODOS"?void 0:i==="true"),children:[e.jsx(Ke,{id:"temTriangulacao",children:e.jsx(tt,{placeholder:"Selecione..."})}),e.jsxs(Qe,{children:[e.jsx(ve,{value:"TODOS",children:"Todos"}),e.jsx(ve,{value:"true",children:"Sim"}),e.jsx(ve,{value:"false",children:"Não"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ee,{htmlFor:"temTroca",children:"Participou Troca"}),e.jsxs(et,{value:t.temTroca!==void 0?t.temTroca.toString():"TODOS",onValueChange:i=>r("temTroca",i==="TODOS"?void 0:i==="true"),children:[e.jsx(Ke,{id:"temTroca",children:e.jsx(tt,{placeholder:"Selecione..."})}),e.jsxs(Qe,{children:[e.jsx(ve,{value:"TODOS",children:"Todos"}),e.jsx(ve,{value:"true",children:"Sim"}),e.jsx(ve,{value:"false",children:"Não"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ee,{htmlFor:"qtdMin",children:"Qtd Depoimentos (Mín)"}),e.jsx(ct,{id:"qtdMin",type:"number",placeholder:"0",value:t.qtdDeposMin||"",onChange:i=>r("qtdDeposMin",i.target.value?Number(i.target.value):void 0)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ee,{htmlFor:"qtdMax",children:"Qtd Depoimentos (Máx)"}),e.jsx(ct,{id:"qtdMax",type:"number",placeholder:"∞",value:t.qtdDeposMax||"",onChange:i=>r("qtdDeposMax",i.target.value?Number(i.target.value):void 0)})]})]})]})})}function _o(){const t=K(Xa),a=K(cs),s=K(n=>n.setColumnVisibility),r=t==="processos"?[{key:"cnj",label:"CNJ"},{key:"uf",label:"UF"},{key:"comarca",label:"Comarca"},{key:"fase",label:"Fase"},{key:"status",label:"Status"},{key:"reclamante",label:"Reclamante"},{key:"qtdDepos",label:"Qtd Depo Únicos"},{key:"testemunhas",label:"Testemunhas Ativo"},{key:"classificacao",label:"Classificação"},{key:"acoes",label:"Ações"}]:[{key:"nome",label:"Nome da Testemunha"},{key:"qtdDepo",label:"Qtd Depoimentos"},{key:"ambosPolos",label:"Ambos os Polos"},{key:"jaReclamante",label:"Já Foi Reclamante"},{key:"cnjs",label:"CNJs como Testemunha"},{key:"classificacao",label:"Classificação Estratégica"},{key:"acoes",label:"Ações"}],o=a[t];return e.jsxs(is,{children:[e.jsx(ls,{asChild:!0,children:e.jsxs(H,{variant:"outline",size:"sm",className:"flex items-center gap-2",children:[e.jsx(Gr,{className:"h-4 w-4"})," Colunas"]})}),e.jsx(Mt,{align:"end",children:r.map(n=>e.jsx(Fa,{checked:o[n.key],onCheckedChange:i=>s(t,n.key,i),children:n.label},n.key))})]})}function No({userId:t}){const a=K(mo),s=K(ho),r=K(i=>i.saveView),o=K(i=>i.setActiveViewName),n=()=>{const i=window.prompt("Nome da visualização");i&&r(i,t)};return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(et,{value:s||"",onValueChange:i=>o(i,t),children:[e.jsx(Ke,{className:"w-[200px]",children:e.jsx(tt,{placeholder:"Visualizações"})}),e.jsx(Qe,{children:Object.keys(a).map(i=>e.jsx(ve,{value:i,children:i},i))})]}),e.jsxs(H,{variant:"outline",size:"sm",onClick:n,className:"flex items-center gap-2",children:[e.jsx(Yr,{className:"h-4 w-4"})," Salvar visão"]})]})}function wo(t){if(typeof document>"u")return;let a=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",a.appendChild(s),s.styleSheet?s.styleSheet.cssText=t:s.appendChild(document.createTextNode(t))}const sr=E.createContext({drawerRef:{current:null},overlayRef:{current:null},onPress:()=>{},onRelease:()=>{},onDrag:()=>{},onNestedDrag:()=>{},onNestedOpenChange:()=>{},onNestedRelease:()=>{},openProp:void 0,dismissible:!1,isOpen:!1,isDragging:!1,keyboardIsOpen:{current:!1},snapPointsOffset:null,snapPoints:null,handleOnly:!1,modal:!1,shouldFade:!1,activeSnapPoint:null,onOpenChange:()=>{},setActiveSnapPoint:()=>{},closeDrawer:()=>{},direction:"bottom",shouldScaleBackground:!1,setBackgroundColorOnScale:!0,noBodyStyles:!1,container:null,autoFocus:!1}),gt=()=>{const t=E.useContext(sr);if(!t)throw new Error("useDrawerContext must be used within a Drawer.Root");return t};wo(`[data-vaul-drawer]{touch-action:none;will-change:transform;transition:transform .5s cubic-bezier(.32, .72, 0, 1);animation-duration:.5s;animation-timing-function:cubic-bezier(0.32,0.72,0,1)}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=bottom][data-state=open]{animation-name:slideFromBottom}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=bottom][data-state=closed]{animation-name:slideToBottom}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=top][data-state=open]{animation-name:slideFromTop}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=top][data-state=closed]{animation-name:slideToTop}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=left][data-state=open]{animation-name:slideFromLeft}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=left][data-state=closed]{animation-name:slideToLeft}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=right][data-state=open]{animation-name:slideFromRight}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=right][data-state=closed]{animation-name:slideToRight}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=bottom]{transform:translate3d(0,100%,0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=top]{transform:translate3d(0,-100%,0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=left]{transform:translate3d(-100%,0,0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=right]{transform:translate3d(100%,0,0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=top]{transform:translate3d(0,var(--snap-point-height,0),0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=bottom]{transform:translate3d(0,var(--snap-point-height,0),0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=left]{transform:translate3d(var(--snap-point-height,0),0,0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=right]{transform:translate3d(var(--snap-point-height,0),0,0)}[data-vaul-overlay][data-vaul-snap-points=false]{animation-duration:.5s;animation-timing-function:cubic-bezier(0.32,0.72,0,1)}[data-vaul-overlay][data-vaul-snap-points=false][data-state=open]{animation-name:fadeIn}[data-vaul-overlay][data-state=closed]{animation-name:fadeOut}[data-vaul-overlay][data-vaul-snap-points=true]{opacity:0;transition:opacity .5s cubic-bezier(.32, .72, 0, 1)}[data-vaul-overlay][data-vaul-snap-points=true]{opacity:1}[data-vaul-drawer]:not([data-vaul-custom-container=true])::after{content:'';position:absolute;background:inherit;background-color:inherit}[data-vaul-drawer][data-vaul-drawer-direction=top]::after{top:initial;bottom:100%;left:0;right:0;height:200%}[data-vaul-drawer][data-vaul-drawer-direction=bottom]::after{top:100%;bottom:initial;left:0;right:0;height:200%}[data-vaul-drawer][data-vaul-drawer-direction=left]::after{left:initial;right:100%;top:0;bottom:0;width:200%}[data-vaul-drawer][data-vaul-drawer-direction=right]::after{left:100%;right:initial;top:0;bottom:0;width:200%}[data-vaul-overlay][data-vaul-snap-points=true]:not([data-vaul-snap-points-overlay=true]):not(
[data-state=closed]
){opacity:0}[data-vaul-overlay][data-vaul-snap-points-overlay=true]{opacity:1}[data-vaul-handle]{display:block;position:relative;opacity:.7;background:#e2e2e4;margin-left:auto;margin-right:auto;height:5px;width:32px;border-radius:1rem;touch-action:pan-y}[data-vaul-handle]:active,[data-vaul-handle]:hover{opacity:1}[data-vaul-handle-hitarea]{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);width:max(100%,2.75rem);height:max(100%,2.75rem);touch-action:inherit}@media (hover:hover) and (pointer:fine){[data-vaul-drawer]{user-select:none}}@media (pointer:fine){[data-vaul-handle-hitarea]:{width:100%;height:100%}}@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes fadeOut{to{opacity:0}}@keyframes slideFromBottom{from{transform:translate3d(0,100%,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToBottom{to{transform:translate3d(0,100%,0)}}@keyframes slideFromTop{from{transform:translate3d(0,-100%,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToTop{to{transform:translate3d(0,-100%,0)}}@keyframes slideFromLeft{from{transform:translate3d(-100%,0,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToLeft{to{transform:translate3d(-100%,0,0)}}@keyframes slideFromRight{from{transform:translate3d(100%,0,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToRight{to{transform:translate3d(100%,0,0)}}`);const yo=24,Co=typeof window<"u"?_.useLayoutEffect:_.useEffect;function ys(...t){return(...a)=>{for(let s of t)typeof s=="function"&&s(...a)}}function To(){return us(/^Mac/)}function So(){return us(/^iPhone/)}function Cs(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}function Ro(){return us(/^iPad/)||To()&&navigator.maxTouchPoints>1}function ar(){return So()||Ro()}function us(t){return typeof window<"u"&&window.navigator!=null?t.test(window.navigator.platform):void 0}const $t=typeof document<"u"&&window.visualViewport;function Ts(t){let a=window.getComputedStyle(t);return/(auto|scroll)/.test(a.overflow+a.overflowX+a.overflowY)}function rr(t){for(Ts(t)&&(t=t.parentElement);t&&!Ts(t);)t=t.parentElement;return t||document.scrollingElement||document.documentElement}const Eo=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);let St=0,zt;function Do(t={}){let{isDisabled:a}=t;Co(()=>{if(!a)return St++,St===1&&ar()&&(zt=Po()),()=>{St--,St===0&&zt?.()}},[a])}function Po(){let t,a=0,s=p=>{t=rr(p.target),!(t===document.documentElement&&t===document.body)&&(a=p.changedTouches[0].pageY)},r=p=>{if(!t||t===document.documentElement||t===document.body){p.preventDefault();return}let j=p.changedTouches[0].pageY,y=t.scrollTop,M=t.scrollHeight-t.clientHeight;M!==0&&((y<=0&&j>a||y>=M&&j<a)&&p.preventDefault(),a=j)},o=p=>{let j=p.target;Yt(j)&&j!==document.activeElement&&(p.preventDefault(),j.style.transform="translateY(-2000px)",j.focus(),requestAnimationFrame(()=>{j.style.transform=""}))},n=p=>{let j=p.target;Yt(j)&&(j.style.transform="translateY(-2000px)",requestAnimationFrame(()=>{j.style.transform="",$t&&($t.height<window.innerHeight?requestAnimationFrame(()=>{Ss(j)}):$t.addEventListener("resize",()=>Ss(j),{once:!0}))}))},i=()=>{window.scrollTo(0,0)},m=window.pageXOffset,l=window.pageYOffset,u=ys(Ao(document.documentElement,"paddingRight",`${window.innerWidth-document.documentElement.clientWidth}px`));window.scrollTo(0,0);let h=ys(jt(document,"touchstart",s,{passive:!1,capture:!0}),jt(document,"touchmove",r,{passive:!1,capture:!0}),jt(document,"touchend",o,{passive:!1,capture:!0}),jt(document,"focus",n,!0),jt(window,"scroll",i));return()=>{u(),h(),window.scrollTo(m,l)}}function Ao(t,a,s){let r=t.style[a];return t.style[a]=s,()=>{t.style[a]=r}}function jt(t,a,s,r){return t.addEventListener(a,s,r),()=>{t.removeEventListener(a,s,r)}}function Ss(t){let a=document.scrollingElement||document.documentElement;for(;t&&t!==a;){let s=rr(t);if(s!==document.documentElement&&s!==document.body&&s!==t){let r=s.getBoundingClientRect().top,o=t.getBoundingClientRect().top,n=t.getBoundingClientRect().bottom;const i=s.getBoundingClientRect().bottom+yo;n>i&&(s.scrollTop+=o-r)}t=s.parentElement}}function Yt(t){return t instanceof HTMLInputElement&&!Eo.has(t.type)||t instanceof HTMLTextAreaElement||t instanceof HTMLElement&&t.isContentEditable}function Oo(t,a){typeof t=="function"?t(a):t!=null&&(t.current=a)}function ko(...t){return a=>t.forEach(s=>Oo(s,a))}function nr(...t){return _.useCallback(ko(...t),t)}const or=new WeakMap;function _e(t,a,s=!1){if(!t||!(t instanceof HTMLElement))return;let r={};Object.entries(a).forEach(([o,n])=>{if(o.startsWith("--")){t.style.setProperty(o,n);return}r[o]=t.style[o],t.style[o]=n}),!s&&or.set(t,r)}function Io(t,a){if(!t||!(t instanceof HTMLElement))return;let s=or.get(t);s&&(t.style[a]=s[a])}const Ne=t=>{switch(t){case"top":case"bottom":return!0;case"left":case"right":return!1;default:return t}};function Rt(t,a){if(!t)return null;const s=window.getComputedStyle(t),r=s.transform||s.webkitTransform||s.mozTransform;let o=r.match(/^matrix3d\((.+)\)$/);return o?parseFloat(o[1].split(", ")[Ne(a)?13:12]):(o=r.match(/^matrix\((.+)\)$/),o?parseFloat(o[1].split(", ")[Ne(a)?5:4]):null)}function Fo(t){return 8*(Math.log(t+1)-2)}function qt(t,a){if(!t)return()=>{};const s=t.style.cssText;return Object.assign(t.style,a),()=>{t.style.cssText=s}}function Mo(...t){return(...a)=>{for(const s of t)typeof s=="function"&&s(...a)}}const he={DURATION:.5,EASE:[.32,.72,0,1]},ir=.4,Lo=.25,$o=100,lr=8,nt=16,Xt=26,Vt="vaul-dragging";function cr(t){const a=E.useRef(t);return E.useEffect(()=>{a.current=t}),E.useMemo(()=>(...s)=>a.current==null?void 0:a.current.call(a,...s),[])}function zo({defaultProp:t,onChange:a}){const s=E.useState(t),[r]=s,o=E.useRef(r),n=cr(a);return E.useEffect(()=>{o.current!==r&&(n(r),o.current=r)},[r,o,n]),s}function dr({prop:t,defaultProp:a,onChange:s=()=>{}}){const[r,o]=zo({defaultProp:a,onChange:s}),n=t!==void 0,i=n?t:r,m=cr(s),l=E.useCallback(u=>{if(n){const p=typeof u=="function"?u(t):u;p!==t&&m(p)}else o(u)},[n,t,o,m]);return[i,l]}function qo({activeSnapPointProp:t,setActiveSnapPointProp:a,snapPoints:s,drawerRef:r,overlayRef:o,fadeFromIndex:n,onSnapPointChange:i,direction:m="bottom",container:l,snapToSequentialPoint:u}){const[h,p]=dr({prop:t,defaultProp:s?.[0],onChange:a}),[j,y]=E.useState(typeof window<"u"?{innerWidth:window.innerWidth,innerHeight:window.innerHeight}:void 0);E.useEffect(()=>{function C(){y({innerWidth:window.innerWidth,innerHeight:window.innerHeight})}return window.addEventListener("resize",C),()=>window.removeEventListener("resize",C)},[]);const M=E.useMemo(()=>h===s?.[s.length-1]||null,[s,h]),f=E.useMemo(()=>s?.findIndex(C=>C===h),[s,h]),w=s&&s.length>0&&(n||n===0)&&!Number.isNaN(n)&&s[n]===h||!s,P=E.useMemo(()=>{const C=l?{width:l.getBoundingClientRect().width,height:l.getBoundingClientRect().height}:typeof window<"u"?{width:window.innerWidth,height:window.innerHeight}:{width:0,height:0};var c;return(c=s?.map(d=>{const x=typeof d=="string";let g=0;if(x&&(g=parseInt(d,10)),Ne(m)){const A=x?g:j?d*C.height:0;return j?m==="bottom"?C.height-A:-C.height+A:A}const b=x?g:j?d*C.width:0;return j?m==="right"?C.width-b:-C.width+b:b}))!=null?c:[]},[s,j,l]),S=E.useMemo(()=>f!==null?P?.[f]:null,[P,f]),$=E.useCallback(C=>{var c;const d=(c=P?.findIndex(x=>x===C))!=null?c:null;i(d),_e(r.current,{transition:`transform ${he.DURATION}s cubic-bezier(${he.EASE.join(",")})`,transform:Ne(m)?`translate3d(0, ${C}px, 0)`:`translate3d(${C}px, 0, 0)`}),P&&d!==P.length-1&&d!==n&&d<n?_e(o.current,{transition:`opacity ${he.DURATION}s cubic-bezier(${he.EASE.join(",")})`,opacity:"0"}):_e(o.current,{transition:`opacity ${he.DURATION}s cubic-bezier(${he.EASE.join(",")})`,opacity:"1"}),p(s?.[Math.max(d,0)])},[r.current,s,P,n,o,p]);E.useEffect(()=>{if(h||t){var C;const c=(C=s?.findIndex(d=>d===t||d===h))!=null?C:-1;P&&c!==-1&&typeof P[c]=="number"&&$(P[c])}},[h,t,s,P,$]);function D({draggedDistance:C,closeDrawer:c,velocity:d,dismissible:x}){if(n===void 0)return;const g=m==="bottom"||m==="right"?(S??0)-C:(S??0)+C,b=f===n-1,A=f===0,Q=C>0;if(b&&_e(o.current,{transition:`opacity ${he.DURATION}s cubic-bezier(${he.EASE.join(",")})`}),!u&&d>2&&!Q){x?c():$(P[0]);return}if(!u&&d>2&&Q&&P&&s){$(P[s.length-1]);return}const te=P?.reduce((k,G)=>typeof k!="number"||typeof G!="number"?k:Math.abs(G-g)<Math.abs(k-g)?G:k),re=Ne(m)?window.innerHeight:window.innerWidth;if(d>ir&&Math.abs(C)<re*.4){const k=Q?1:-1;if(k>0&&M){$(P[s.length-1]);return}if(A&&k<0&&x&&c(),f===null)return;$(P[f+k]);return}$(te)}function ee({draggedDistance:C}){if(S===null)return;const c=m==="bottom"||m==="right"?S-C:S+C;(m==="bottom"||m==="right")&&c<P[P.length-1]||(m==="top"||m==="left")&&c>P[P.length-1]||_e(r.current,{transform:Ne(m)?`translate3d(0, ${c}px, 0)`:`translate3d(${c}px, 0, 0)`})}function ae(C,c){if(!s||typeof f!="number"||!P||n===void 0)return null;const d=f===n-1;if(f>=n&&c)return 0;if(d&&!c)return 1;if(!w&&!d)return null;const g=d?f+1:f-1,b=d?P[g]-P[g-1]:P[g+1]-P[g],A=C/Math.abs(b);return d?1-A:A}return{isLastSnapPoint:M,activeSnapPoint:h,shouldFade:w,getPercentageDragged:ae,setActiveSnapPoint:p,activeSnapPointIndex:f,onRelease:D,onDrag:ee,snapPointsOffset:P}}const Vo=()=>()=>{};function Bo(){const{direction:t,isOpen:a,shouldScaleBackground:s,setBackgroundColorOnScale:r,noBodyStyles:o}=gt(),n=E.useRef(null),i=_.useMemo(()=>document.body.style.backgroundColor,[]);function m(){return(window.innerWidth-Xt)/window.innerWidth}E.useEffect(()=>{if(a&&s){n.current&&clearTimeout(n.current);const l=document.querySelector("[data-vaul-drawer-wrapper]")||document.querySelector("[vaul-drawer-wrapper]");if(!l)return;Mo(r&&!o?qt(document.body,{background:"black"}):Vo,qt(l,{transformOrigin:Ne(t)?"top":"left",transitionProperty:"transform, border-radius",transitionDuration:`${he.DURATION}s`,transitionTimingFunction:`cubic-bezier(${he.EASE.join(",")})`}));const u=qt(l,{borderRadius:`${lr}px`,overflow:"hidden",...Ne(t)?{transform:`scale(${m()}) translate3d(0, calc(env(safe-area-inset-top) + 14px), 0)`}:{transform:`scale(${m()}) translate3d(calc(env(safe-area-inset-top) + 14px), 0, 0)`}});return()=>{u(),n.current=window.setTimeout(()=>{i?document.body.style.background=i:document.body.style.removeProperty("background")},he.DURATION*1e3)}}},[a,s,i])}let bt=null;function Uo({isOpen:t,modal:a,nested:s,hasBeenOpened:r,preventScrollRestoration:o,noBodyStyles:n}){const[i,m]=E.useState(()=>typeof window<"u"?window.location.href:""),l=E.useRef(0),u=E.useCallback(()=>{if(Cs()&&bt===null&&t&&!n){bt={position:document.body.style.position,top:document.body.style.top,left:document.body.style.left,height:document.body.style.height,right:"unset"};const{scrollX:p,innerHeight:j}=window;document.body.style.setProperty("position","fixed","important"),Object.assign(document.body.style,{top:`${-l.current}px`,left:`${-p}px`,right:"0px",height:"auto"}),window.setTimeout(()=>window.requestAnimationFrame(()=>{const y=j-window.innerHeight;y&&l.current>=j&&(document.body.style.top=`${-(l.current+y)}px`)}),300)}},[t]),h=E.useCallback(()=>{if(Cs()&&bt!==null&&!n){const p=-parseInt(document.body.style.top,10),j=-parseInt(document.body.style.left,10);Object.assign(document.body.style,bt),window.requestAnimationFrame(()=>{if(o&&i!==window.location.href){m(window.location.href);return}window.scrollTo(j,p)}),bt=null}},[i]);return E.useEffect(()=>{function p(){l.current=window.scrollY}return p(),window.addEventListener("scroll",p),()=>{window.removeEventListener("scroll",p)}},[]),E.useEffect(()=>{s||!r||(t?(!window.matchMedia("(display-mode: standalone)").matches&&u(),a||window.setTimeout(()=>{h()},500)):h())},[t,r,i,a,s,u,h]),{restorePositionSetting:h}}function ur({open:t,onOpenChange:a,children:s,onDrag:r,onRelease:o,snapPoints:n,shouldScaleBackground:i=!1,setBackgroundColorOnScale:m=!0,closeThreshold:l=Lo,scrollLockTimeout:u=$o,dismissible:h=!0,handleOnly:p=!1,fadeFromIndex:j=n&&n.length-1,activeSnapPoint:y,setActiveSnapPoint:M,fixed:f,modal:w=!0,onClose:P,nested:S,noBodyStyles:$,direction:D="bottom",defaultOpen:ee=!1,disablePreventScroll:ae=!0,snapToSequentialPoint:C=!1,preventScrollRestoration:c=!1,repositionInputs:d=!0,onAnimationEnd:x,container:g,autoFocus:b=!1}){var A,Q;const[te=!1,re]=dr({defaultProp:ee,prop:t,onChange:B=>{a?.(B),!B&&!S&&ge(),setTimeout(()=>{x?.(B)},he.DURATION*1e3),B&&!w&&typeof window<"u"&&window.requestAnimationFrame(()=>{document.body.style.pointerEvents="auto"}),B||(document.body.style.pointerEvents="auto")}}),[k,G]=E.useState(!1),[I,ue]=E.useState(!1),[z,N]=E.useState(!1),v=E.useRef(null),T=E.useRef(null),O=E.useRef(null),U=E.useRef(null),Y=E.useRef(null),L=E.useRef(!1),J=E.useRef(null),ne=E.useRef(0),F=E.useRef(!1),oe=E.useRef(0),R=E.useRef(null),Z=E.useRef(((A=R.current)==null?void 0:A.getBoundingClientRect().height)||0),X=E.useRef(((Q=R.current)==null?void 0:Q.getBoundingClientRect().width)||0),W=E.useRef(0),ye=E.useCallback(B=>{n&&B===xe.length-1&&(T.current=new Date)},[]),{activeSnapPoint:V,activeSnapPointIndex:se,setActiveSnapPoint:fe,onRelease:Ae,snapPointsOffset:xe,onDrag:st,shouldFade:je,getPercentageDragged:Fe}=qo({snapPoints:n,activeSnapPointProp:y,setActiveSnapPointProp:M,drawerRef:R,fadeFromIndex:j,overlayRef:v,onSnapPointChange:ye,direction:D,container:g,snapToSequentialPoint:C});Do({isDisabled:!te||I||!w||z||!k||!d||!ae});const{restorePositionSetting:ge}=Uo({isOpen:te,modal:w,nested:S,hasBeenOpened:k,preventScrollRestoration:c,noBodyStyles:$});function be(){return(window.innerWidth-Xt)/window.innerWidth}function ze(B){var ie,de;!h&&!n||R.current&&!R.current.contains(B.target)||(Z.current=((ie=R.current)==null?void 0:ie.getBoundingClientRect().height)||0,X.current=((de=R.current)==null?void 0:de.getBoundingClientRect().width)||0,ue(!0),O.current=new Date,ar()&&window.addEventListener("touchend",()=>L.current=!1,{once:!0}),B.target.setPointerCapture(B.pointerId),ne.current=Ne(D)?B.pageY:B.pageX)}function mt(B,ie){var de,me;let le=B;const Le=(de=window.getSelection())==null?void 0:de.toString(),Re=R.current?Rt(R.current,D):null,ke=new Date;if(le.hasAttribute("data-vaul-no-drag")||le.closest("[data-vaul-no-drag]"))return!1;if(D==="right"||D==="left")return!0;if(T.current&&ke.getTime()-T.current.getTime()<500)return!1;if(Re!==null&&(D==="bottom"?Re>0:Re<0))return!0;if(Le&&Le.length>0)return!1;if(ke.getTime()-((me=Y.current)==null?void 0:me.getTime())<u&&Re===0||ie)return Y.current=ke,!1;for(;le;){if(le.scrollHeight>le.clientHeight){if(le.scrollTop!==0)return Y.current=new Date,!1;if(le.getAttribute("role")==="dialog")return!0}le=le.parentNode}return!0}function wt(B){if(R.current&&I){const ie=D==="bottom"||D==="right"?1:-1,de=(ne.current-(Ne(D)?B.pageY:B.pageX))*ie,me=de>0,le=n&&!h&&!me;if(le&&se===0)return;const Le=Math.abs(de),Re=document.querySelector("[data-vaul-drawer-wrapper]"),ke=D==="bottom"||D==="top"?Z.current:X.current;let qe=Le/ke;const rt=Fe(Le,me);if(rt!==null&&(qe=rt),le&&qe>=1||!L.current&&!mt(B.target,me))return;if(R.current.classList.add(Vt),L.current=!0,_e(R.current,{transition:"none"}),_e(v.current,{transition:"none"}),n&&st({draggedDistance:de}),me&&!n){const Ue=Fo(de),Ct=Math.min(Ue*-1,0)*ie;_e(R.current,{transform:Ne(D)?`translate3d(0, ${Ct}px, 0)`:`translate3d(${Ct}px, 0, 0)`});return}const Ze=1-qe;if((je||j&&se===j-1)&&(r?.(B,qe),_e(v.current,{opacity:`${Ze}`,transition:"none"},!0)),Re&&v.current&&i){const Ue=Math.min(be()+qe*(1-be()),1),Ct=8-qe*8,ms=Math.max(0,14-qe*14);_e(Re,{borderRadius:`${Ct}px`,transform:Ne(D)?`scale(${Ue}) translate3d(0, ${ms}px, 0)`:`scale(${Ue}) translate3d(${ms}px, 0, 0)`,transition:"none"},!0)}if(!n){const Ue=Le*ie;_e(R.current,{transform:Ne(D)?`translate3d(0, ${Ue}px, 0)`:`translate3d(${Ue}px, 0, 0)`})}}}E.useEffect(()=>{var B;function ie(){if(!R.current||!d)return;const de=document.activeElement;if(Yt(de)||F.current){var me;const le=((me=window.visualViewport)==null?void 0:me.height)||0,Le=window.innerHeight;let Re=Le-le;const ke=R.current.getBoundingClientRect().height||0,qe=ke>Le*.8;W.current||(W.current=ke);const rt=R.current.getBoundingClientRect().top;if(Math.abs(oe.current-Re)>60&&(F.current=!F.current),n&&n.length>0&&xe&&se){const Ze=xe[se]||0;Re+=Ze}if(oe.current=Re,ke>le||F.current){const Ze=R.current.getBoundingClientRect().height;let Ue=Ze;Ze>le&&(Ue=le-(qe?rt:Xt)),f?R.current.style.height=`${Ze-Math.max(Re,0)}px`:R.current.style.height=`${Math.max(Ue,le-rt)}px`}else R.current.style.height=`${W.current}px`;n&&n.length>0&&!F.current?R.current.style.bottom="0px":R.current.style.bottom=`${Math.max(Re,0)}px`}}return(B=window.visualViewport)==null||B.addEventListener("resize",ie),()=>{var de;return(de=window.visualViewport)==null?void 0:de.removeEventListener("resize",ie)}},[se,n,xe]);function Me(B){at(),P?.(),B||re(!1),setTimeout(()=>{n&&fe(n[0])},he.DURATION*1e3)}function Oe(){if(!R.current)return;const B=document.querySelector("[data-vaul-drawer-wrapper]"),ie=Rt(R.current,D);_e(R.current,{transform:"translate3d(0, 0, 0)",transition:`transform ${he.DURATION}s cubic-bezier(${he.EASE.join(",")})`}),_e(v.current,{transition:`opacity ${he.DURATION}s cubic-bezier(${he.EASE.join(",")})`,opacity:"1"}),i&&ie&&ie>0&&te&&_e(B,{borderRadius:`${lr}px`,overflow:"hidden",...Ne(D)?{transform:`scale(${be()}) translate3d(0, calc(env(safe-area-inset-top) + 14px), 0)`,transformOrigin:"top"}:{transform:`scale(${be()}) translate3d(calc(env(safe-area-inset-top) + 14px), 0, 0)`,transformOrigin:"left"},transitionProperty:"transform, border-radius",transitionDuration:`${he.DURATION}s`,transitionTimingFunction:`cubic-bezier(${he.EASE.join(",")})`},!0)}function at(){!I||!R.current||(R.current.classList.remove(Vt),L.current=!1,ue(!1),U.current=new Date)}function yt(B){if(!I||!R.current)return;R.current.classList.remove(Vt),L.current=!1,ue(!1),U.current=new Date;const ie=Rt(R.current,D);if(!mt(B.target,!1)||!ie||Number.isNaN(ie)||O.current===null)return;const de=U.current.getTime()-O.current.getTime(),me=ne.current-(Ne(D)?B.pageY:B.pageX),le=Math.abs(me)/de;if(le>.05&&(N(!0),setTimeout(()=>{N(!1)},200)),n){Ae({draggedDistance:me*(D==="bottom"||D==="right"?1:-1),closeDrawer:Me,velocity:le,dismissible:h}),o?.(B,!0);return}if(D==="bottom"||D==="right"?me>0:me<0){Oe(),o?.(B,!0);return}if(le>ir){Me(),o?.(B,!1);return}var Le;const Re=Math.min((Le=R.current.getBoundingClientRect().height)!=null?Le:0,window.innerHeight);var ke;const qe=Math.min((ke=R.current.getBoundingClientRect().width)!=null?ke:0,window.innerWidth),rt=D==="left"||D==="right";if(Math.abs(ie)>=(rt?qe:Re)*l){Me(),o?.(B,!1);return}o?.(B,!0),Oe()}E.useEffect(()=>(te&&(_e(document.documentElement,{scrollBehavior:"auto"}),T.current=new Date),()=>{Io(document.documentElement,"scrollBehavior")}),[te]);function wr(B){const ie=B?(window.innerWidth-nt)/window.innerWidth:1,de=B?-nt:0;J.current&&window.clearTimeout(J.current),_e(R.current,{transition:`transform ${he.DURATION}s cubic-bezier(${he.EASE.join(",")})`,transform:`scale(${ie}) translate3d(0, ${de}px, 0)`}),!B&&R.current&&(J.current=setTimeout(()=>{const me=Rt(R.current,D);_e(R.current,{transition:"none",transform:Ne(D)?`translate3d(0, ${me}px, 0)`:`translate3d(${me}px, 0, 0)`})},500))}function yr(B,ie){if(ie<0)return;const de=(window.innerWidth-nt)/window.innerWidth,me=de+ie*(1-de),le=-nt+ie*nt;_e(R.current,{transform:Ne(D)?`scale(${me}) translate3d(0, ${le}px, 0)`:`scale(${me}) translate3d(${le}px, 0, 0)`,transition:"none"})}function Cr(B,ie){const de=Ne(D)?window.innerHeight:window.innerWidth,me=ie?(de-nt)/de:1,le=ie?-nt:0;ie&&_e(R.current,{transition:`transform ${he.DURATION}s cubic-bezier(${he.EASE.join(",")})`,transform:Ne(D)?`scale(${me}) translate3d(0, ${le}px, 0)`:`scale(${me}) translate3d(${le}px, 0, 0)`})}return E.createElement(Fs,{defaultOpen:ee,onOpenChange:B=>{!h&&!B||(B?G(!0):Me(!0),re(B))},open:te},E.createElement(sr.Provider,{value:{activeSnapPoint:V,snapPoints:n,setActiveSnapPoint:fe,drawerRef:R,overlayRef:v,onOpenChange:a,onPress:ze,onRelease:yt,onDrag:wt,dismissible:h,handleOnly:p,isOpen:te,isDragging:I,shouldFade:je,closeDrawer:Me,onNestedDrag:yr,onNestedOpenChange:wr,onNestedRelease:Cr,keyboardIsOpen:F,modal:w,snapPointsOffset:xe,direction:D,shouldScaleBackground:i,setBackgroundColorOnScale:m,noBodyStyles:$,container:g,autoFocus:b}},s))}const mr=E.forwardRef(function({...t},a){const{overlayRef:s,snapPoints:r,onRelease:o,shouldFade:n,isOpen:i,modal:m}=gt(),l=nr(a,s),u=r&&r.length>0;return m?E.createElement(es,{onMouseUp:o,ref:l,"data-vaul-overlay":"","data-vaul-snap-points":i&&u?"true":"false","data-vaul-snap-points-overlay":i&&n?"true":"false",...t}):(typeof window<"u"&&window.requestAnimationFrame(()=>{document.body.style.pointerEvents="auto"}),null)});mr.displayName="Drawer.Overlay";const hr=E.forwardRef(function({onPointerDownOutside:t,style:a,onOpenAutoFocus:s,...r},o){const{drawerRef:n,onPress:i,onRelease:m,onDrag:l,keyboardIsOpen:u,snapPointsOffset:h,modal:p,isOpen:j,direction:y,snapPoints:M,container:f,handleOnly:w,autoFocus:P}=gt(),[S,$]=E.useState(!1),D=nr(o,n),ee=E.useRef(null),ae=E.useRef(null),C=E.useRef(!1),c=M&&M.length>0;Bo();const d=(g,b,A=0)=>{if(C.current)return!0;const Q=Math.abs(g.y),te=Math.abs(g.x),re=te>Q,k=["bottom","right"].includes(b)?1:-1;if(b==="left"||b==="right"){if(!(g.x*k<0)&&te>=0&&te<=A)return re}else if(!(g.y*k<0)&&Q>=0&&Q<=A)return!re;return C.current=!0,!0};E.useEffect(()=>{c&&window.requestAnimationFrame(()=>{$(!0)})},[]);function x(g){ee.current=null,C.current=!1,m(g)}return E.createElement(ts,{"data-vaul-drawer-direction":y,"data-vaul-drawer":"","data-vaul-delayed-snap-points":S?"true":"false","data-vaul-snap-points":j&&c?"true":"false","data-vaul-custom-container":f?"true":"false",...r,ref:D,style:h&&h.length>0?{"--snap-point-height":`${h[0]}px`,...a}:a,onPointerDown:g=>{w||(r.onPointerDown==null||r.onPointerDown.call(r,g),ee.current={x:g.pageX,y:g.pageY},i(g))},onOpenAutoFocus:g=>{s?.(g),P||g.preventDefault()},onPointerDownOutside:g=>{if(t?.(g),!p||g.defaultPrevented){g.preventDefault();return}u.current&&(u.current=!1)},onFocusOutside:g=>{if(!p){g.preventDefault();return}},onPointerMove:g=>{if(ae.current=g,w||(r.onPointerMove==null||r.onPointerMove.call(r,g),!ee.current))return;const b=g.pageY-ee.current.y,A=g.pageX-ee.current.x,Q=g.pointerType==="touch"?10:2;d({x:A,y:b},y,Q)?l(g):(Math.abs(A)>Q||Math.abs(b)>Q)&&(ee.current=null)},onPointerUp:g=>{r.onPointerUp==null||r.onPointerUp.call(r,g),ee.current=null,C.current=!1,m(g)},onPointerOut:g=>{r.onPointerOut==null||r.onPointerOut.call(r,g),x(ae.current)},onContextMenu:g=>{r.onContextMenu==null||r.onContextMenu.call(r,g),x(ae.current)}})});hr.displayName="Drawer.Content";const Jo=250,Ho=120,fr=E.forwardRef(function({preventCycle:t=!1,children:a,...s},r){const{closeDrawer:o,isDragging:n,snapPoints:i,activeSnapPoint:m,setActiveSnapPoint:l,dismissible:u,handleOnly:h,isOpen:p,onPress:j,onDrag:y}=gt(),M=E.useRef(null),f=E.useRef(!1);function w(){if(f.current){$();return}window.setTimeout(()=>{P()},Ho)}function P(){if(n||t||f.current){$();return}if($(),(!i||i.length===0)&&u){o();return}if(m===i[i.length-1]&&u){o();return}const ee=i.findIndex(C=>C===m);if(ee===-1)return;const ae=i[ee+1];l(ae)}function S(){M.current=window.setTimeout(()=>{f.current=!0},Jo)}function $(){window.clearTimeout(M.current),f.current=!1}return E.createElement("div",{onClick:w,onPointerCancel:$,onPointerDown:D=>{h&&j(D),S()},onPointerMove:D=>{h&&y(D)},ref:r,"data-vaul-drawer-visible":p?"true":"false","data-vaul-handle":"","aria-hidden":"true",...s},E.createElement("span",{"data-vaul-handle-hitarea":"","aria-hidden":"true"},a))});fr.displayName="Drawer.Handle";function Wo({onDrag:t,onOpenChange:a,...s}){const{onNestedDrag:r,onNestedOpenChange:o,onNestedRelease:n}=gt();if(!r)throw new Error("Drawer.NestedRoot must be placed in another drawer");return E.createElement(ur,{nested:!0,onClose:()=>{o(!1)},onDrag:(i,m)=>{r(i,m),t?.(i,m)},onOpenChange:i=>{i&&o(i)},onRelease:n,...s})}function Ko(t){const a=gt(),{container:s=a.container,...r}=t;return E.createElement(Ls,{container:s,...r})}const Xe={Root:ur,NestedRoot:Wo,Content:hr,Overlay:mr,Trigger:Ms,Portal:Ko,Handle:fr,Close:Is,Title:as,Description:rs},pr=({shouldScaleBackground:t=!0,...a})=>e.jsx(Xe.Root,{shouldScaleBackground:t,...a});pr.displayName="Drawer";const Qo=Xe.Portal,xr=_.forwardRef(({className:t,...a},s)=>e.jsx(Xe.Overlay,{ref:s,className:q("fixed inset-0 z-50 bg-black/80",t),...a}));xr.displayName=Xe.Overlay.displayName;const gr=_.forwardRef(({className:t,children:a,...s},r)=>e.jsxs(Qo,{children:[e.jsx(xr,{}),e.jsxs(Xe.Content,{ref:r,className:q("fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background",t),...s,children:[e.jsx("div",{className:"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted"}),a]})]}));gr.displayName="DrawerContent";const vr=({className:t,...a})=>e.jsx("div",{className:q("grid gap-1.5 p-4 text-center sm:text-left",t),...a});vr.displayName="DrawerHeader";const jr=_.forwardRef(({className:t,...a},s)=>e.jsx(Xe.Title,{ref:s,className:q("text-lg font-semibold leading-none tracking-tight",t),...a}));jr.displayName=Xe.Title.displayName;const Go=_.forwardRef(({className:t,...a},s)=>e.jsx(Xe.Description,{ref:s,className:q("text-sm text-muted-foreground",t),...a}));Go.displayName=Xe.Description.displayName;function Yo(){const{isDetailDrawerOpen:t,setIsDetailDrawerOpen:a,selectedProcesso:s,selectedTestemunha:r,isPiiMasked:o}=K(),{toast:n}=Be(),i=async(u,h)=>{const p=Ge(u,o);try{await navigator.clipboard.writeText(p),n({title:"Copiado!",description:`${h} copiado para a área de transferência.`})}catch{n({title:"Erro ao copiar",description:`Não foi possível copiar ${h}.`,variant:"destructive"})}},m=({value:u,label:h})=>e.jsxs("div",{className:"flex items-center gap-2",children:[u===null?e.jsx("span",{className:"text-muted-foreground",children:"—"}):u?e.jsxs(e.Fragment,{children:[e.jsx(Je,{className:"h-4 w-4 text-success"}),e.jsx("span",{children:"Sim"})]}):e.jsxs(e.Fragment,{children:[e.jsx(xa,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:"Não"})]}),h&&e.jsx(H,{variant:"ghost",size:"sm",onClick:()=>i(u?.toString()||"N/A",h),className:"h-6 w-6 p-0",children:e.jsx(dt,{className:"h-3 w-3"})})]}),l=({label:u,value:h,copyable:p=!1})=>e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:u}),p&&h&&e.jsx(H,{variant:"ghost",size:"sm",onClick:()=>i(h.toString(),u),className:"h-6 w-6 p-0",children:e.jsx(dt,{className:"h-3 w-3"})})]}),e.jsx("p",{className:"font-mono text-sm break-all",children:h?Ge(h.toString(),o):"—"})]});return!t||!s&&!r?null:e.jsx(pr,{open:t,onOpenChange:a,children:e.jsxs(gr,{className:"max-w-4xl mx-auto",children:[e.jsx(vr,{children:e.jsx(jr,{children:s?`Processo ${s.cnj}`:`Testemunha ${r?.nome_testemunha}`})}),e.jsxs(Ma,{className:"h-[80vh] px-6 pb-6",children:[s&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-muted/20 rounded-xl p-4",children:e.jsx(ce,{variant:"outline",className:"mb-2",children:"Conteúdo assistivo. Revisão humana obrigatória."})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(l,{label:"CNJ",value:s.cnj,copyable:!0}),e.jsx(l,{label:"Status",value:s.status}),e.jsx(l,{label:"UF",value:s.uf}),e.jsx(l,{label:"Comarca",value:s.comarca,copyable:!0}),e.jsx(l,{label:"Fase",value:s.fase}),e.jsx(l,{label:"Reclamante",value:s.reclamante_limpo,copyable:!0})]}),e.jsx(ot,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold",children:"Advogados Parte Ativa"}),e.jsx(it,{items:s.advogados_parte_ativa,maxVisible:5,isPiiMasked:o})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold",children:"Testemunhas"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Polo Ativo"}),e.jsx(it,{items:s.testemunhas_ativo_limpo,maxVisible:5,isPiiMasked:o})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Polo Passivo"}),e.jsx(it,{items:s.testemunhas_passivo_limpo,maxVisible:5,isPiiMasked:o})]})]})]}),e.jsx(ot,{}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Reclamante foi Testemunha"}),e.jsx(m,{value:s.reclamante_foi_testemunha})]}),e.jsx(l,{label:"Qtd Vezes Reclamante foi Testemunha",value:s.qtd_vezes_reclamante_foi_testemunha}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Troca Direta"}),e.jsx(m,{value:s.troca_direta})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Triangulação Confirmada"}),e.jsx(m,{value:s.triangulacao_confirmada})]})]}),e.jsx(ot,{}),e.jsx(l,{label:"Classificação Final",value:s.classificacao_final}),e.jsx(l,{label:"Insight Estratégico",value:s.insight_estrategico,copyable:!0})]}),r&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-muted/20 rounded-xl p-4",children:e.jsx(ce,{variant:"outline",className:"mb-2",children:"Conteúdo assistivo. Revisão humana obrigatória."})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(l,{label:"Nome da Testemunha",value:r.nome_testemunha,copyable:!0}),e.jsx(l,{label:"Quantidade de Depoimentos",value:r.qtd_depoimentos})]}),e.jsx(ot,{}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Já Foi Reclamante"}),e.jsx(m,{value:r.ja_foi_reclamante})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Foi Testemunha em Ambos os Polos"}),e.jsx(m,{value:r.foi_testemunha_em_ambos_polos})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Participou Troca Favor"}),e.jsx(m,{value:r.participou_troca_favor})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Participou Triangulação"}),e.jsx(m,{value:r.participou_triangulacao})]})]}),e.jsx(ot,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold",children:"CNJs como Testemunha"}),e.jsx(it,{items:r.cnjs_como_testemunha,maxVisible:5,isPiiMasked:o})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold",children:"CNJs como Reclamante"}),e.jsx(it,{items:r.cnjs_como_reclamante,maxVisible:5,isPiiMasked:o})]}),e.jsx(ot,{}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(l,{label:"Classificação",value:r.classificacao}),e.jsx(l,{label:"Classificação Estratégica",value:r.classificacao_estrategica})]})]})]})]})})}const Xo=Xr,Zo=Zr,ei=en;function ti(t,a="Você tem alterações não salvas. Deseja sair?"){_.useEffect(()=>{if(!t)return;const s=r=>(r.preventDefault(),r.returnValue=a,a);return window.addEventListener("beforeunload",s),()=>{window.removeEventListener("beforeunload",s)}},[t,a])}const Zt=t=>String(t??"").replace(/\D/g,""),Rs=t=>Zt(t).length===20,Es=t=>{const a=String(t??"").trim();if(!a||a==="[]")return[];if(a.startsWith("[")&&a.endsWith("]"))try{return JSON.parse(a.replace(/'/g,'"')).map(s=>String(s).trim()).filter(Boolean)}catch{}return a.split(/[;,]/).map(s=>s.trim()).filter(Boolean)},si=["Nome_Testemunha","CNJs_Como_Testemunha"],ai=["CNJ","Reclamante_Limpo","Reu_Nome"],Ds=(t,a)=>(a.utils.sheet_to_json(t,{header:1,blankrows:!1})[0]||[]).map(r=>String(r||"").trim()),Ps=(t,a)=>{const s=new Set(t.map(o=>o.toLowerCase())),r=a.filter(o=>!s.has(o.toLowerCase()));return{ok:r.length===0,missing:r}},ri=({currentStep:t,validationResults:a,isProcessing:s})=>{const r=[{id:"upload",title:"Upload do Arquivo",icon:Ut,description:"Selecione o arquivo Excel"},{id:"validation",title:"Validação",icon:ja,description:"Verificação da qualidade dos dados"},{id:"preview",title:"Prévia",icon:Ye,description:"Visualização antes da importação"},{id:"publish",title:"Importação",icon:Je,description:"Processamento final"}],o=i=>{const m=r.findIndex(u=>u.id===t),l=r.findIndex(u=>u.id===i);return s&&i===t?"processing":l<m?"completed":l===m?i==="validation"&&a?.errors.length>0?"error":"current":"pending"},n=(i,m)=>{const l=i.icon;return m==="processing"?e.jsx(ba,{className:"h-5 w-5 animate-pulse"}):m==="completed"?e.jsx(Je,{className:"h-5 w-5"}):m==="error"?e.jsx(Pt,{className:"h-5 w-5"}):e.jsx(l,{className:"h-5 w-5"})};return e.jsx("div",{className:"mb-8",children:e.jsx("div",{className:"flex items-center justify-between",children:r.map((i,m)=>{const l=o(i.id),u=l==="current"||l==="processing",h=l==="completed",p=l==="error";return e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:`
                  flex items-center justify-center w-12 h-12 rounded-full border-2 
                  ${h?"bg-green-100 border-green-500 text-green-700 dark:bg-green-950 dark:border-green-400 dark:text-green-300":""}
                  ${u&&!p?"bg-primary/10 border-primary text-primary":""}
                  ${p?"bg-red-100 border-red-500 text-red-700 dark:bg-red-950 dark:border-red-400 dark:text-red-300":""}
                  ${l==="pending"?"bg-muted border-muted-foreground/25 text-muted-foreground":""}
                  transition-all duration-200
                `,children:n(i,l)}),e.jsxs("div",{className:"mt-3 text-center",children:[e.jsx("span",{className:`text-sm font-medium ${u?"text-foreground":h?"text-green-700 dark:text-green-300":p?"text-red-700 dark:text-red-300":"text-muted-foreground"}`,children:i.title}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:i.description})]})]}),m<r.length-1&&e.jsx("div",{className:`
                  w-16 h-0.5 mx-4 
                  ${m<r.findIndex(j=>j.id===t)?"bg-green-500":"bg-muted-foreground/25"}
                  transition-colors duration-200
                `})]},i.id)})})})},ni=({validationResults:t,fileName:a})=>{const{toast:s}=Be();_.useState("empty"),_.useState(!1);const r=()=>{Ca(async()=>{const i=[["Linha","Coluna","Tipo","Mensagem","Valor"].join(","),`"Resumo","Total: ${t.totalRows}","Válidos: ${t.validRows}","Erros: ${t.errors.length}","Avisos: ${t.warnings.length}"`,"",...t.errors.map(u=>[u.row,`"${u.column}"`,"Erro",`"${u.message}"`,`"${u.value||""}"`].join(",")),...t.warnings.map(u=>[u.row,`"${u.column}"`,"Aviso",`"${u.message}"`,`"${u.value||""}"`].join(","))].join(`
`),m=new Blob(["\uFEFF"+i],{type:"text/csv;charset=utf-8;"}),l=document.createElement("a");l.href=URL.createObjectURL(m),l.download=`relatorio-validacao-${a.replace(/\.[^/.]+$/,"")}-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(l),l.click(),document.body.removeChild(l),s({title:"Relatório CSV gerado",description:"Download iniciado com sucesso"})},"ImportModal.generateCSVReport")};return e.jsxs(pe,{children:[e.jsxs(De,{children:[e.jsxs(Pe,{className:"flex items-center gap-2",children:[e.jsx(ut,{className:"h-5 w-5"}),"Relatório de Validação"]}),e.jsx(_t,{children:"Gere relatórios detalhados dos erros e avisos encontrados"})]}),e.jsxs(we,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center p-3 bg-muted rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold",children:t.totalRows.toLocaleString()}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Total de linhas"})]}),e.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold text-green-600",children:t.validRows.toLocaleString()}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Linhas válidas"})]}),e.jsxs("div",{className:"text-center p-3 bg-red-50 rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold text-red-600",children:t.errors.length}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Erros"})]}),e.jsxs("div",{className:"text-center p-3 bg-orange-50 rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold text-orange-600",children:t.warnings.length}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Avisos"})]})]}),e.jsxs(H,{variant:"outline",onClick:r,className:"flex items-center gap-2",children:[e.jsx(nn,{className:"h-4 w-4"}),"Exportar Relatório CSV"]})]})]})};function oi(){const t=K(uo),a=K(v=>v.setIsImportModalOpen),{toast:s}=Be(),[r,o]=_.useState("upload"),[n,i]=_.useState(null),[m,l]=_.useState(!1),[u,h]=_.useState(0),[p,j]=_.useState(null),[y,M]=_.useState(null),[f,w]=_.useState("empty"),[P,S]=_.useState(!1),[$,D]=_.useState(!1),ee=()=>{o("upload"),i(null),l(!1),h(0),j(null),M(null),w("empty"),S(!1)},ae=!!n||r!=="upload";ti(ae);const C=v=>{v?a(!0):ae?D(!0):(ee(),a(!1))},c=_.useCallback(v=>{const T=v[0];T&&(i(T),j(null),M(null),o("upload"),b(T))},[]),{getRootProps:d,getInputProps:x,isDragActive:g}=tn({onDrop:c,accept:{"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"],"application/vnd.ms-excel":[".xls"]},maxFiles:1}),b=v=>{l(!0),h(0);const T=setInterval(()=>{h(O=>O>=95?(clearInterval(T),95):O+Math.random()*15)},200);te(v)},A=v=>{const T=[];return v.forEach((O,U)=>{(!O.nome_testemunha||String(O.nome_testemunha).trim()==="")&&T.push({row:U+2,column:"Nome_Testemunha",message:"Nome_Testemunha é obrigatório",type:"error"});const Y=Array.isArray(O.cnjs_como_testemunha)?O.cnjs_como_testemunha:Es(O.cnjs_como_testemunha);Y.length||T.push({row:U+2,column:"CNJs_Como_Testemunha",message:"Lista de CNJs vazia",type:"error"}),Y.some(Rs)||T.push({row:U+2,column:"CNJs_Como_Testemunha",message:"Nenhum CNJ com 20 dígitos na lista",type:"error"})}),T},Q=v=>{const T=[];return v.forEach((O,U)=>{(!O.cnj||!Rs(O.cnj))&&T.push({row:U+2,column:"CNJ",message:"CNJ deve ter 20 dígitos (removendo máscara)",value:O.cnj,type:"error"}),(!O.reclamante_limpo||String(O.reclamante_limpo).trim()==="")&&T.push({row:U+2,column:"Reclamante_Limpo",message:"Reclamante_Limpo é obrigatório",type:"error"}),(!O.reu_nome||String(O.reu_nome).trim()==="")&&T.push({row:U+2,column:"Reu_Nome",message:"Reu_Nome é obrigatório",type:"error"})}),T},te=async v=>{await Ca(async()=>{const{porProcesso:T,porTestemunha:O,errors:U,warnings:Y}=await re(v),L=T.length+O.length,J=L-U.length;j({totalRows:L,validRows:J,errors:U,warnings:Y||[],processos:T,testemunhas:O}),o("validation")},"ImportModal.processFileValidation").finally(()=>{l(!1),h(100)})},re=async v=>{const T=await bn(()=>import("./xlsx-swoO1KcU.js"),[]);return new Promise((O,U)=>{const Y=new FileReader;Y.onload=L=>{try{const J=new Uint8Array(L.target?.result),ne=T.read(J,{type:"array"}),F=ne.Sheets["Por Processo"],oe=ne.Sheets["Por Testemunha"];if(!F&&!oe)throw new Error('Arquivo deve conter ao menos uma aba: "Por Processo" ou "Por Testemunha".');const R=[],Z=[];let X=[];if(F){const W=Ds(F,T),{ok:ye,missing:V}=Ps(W,ai);if(!ye)throw new Error(`Modo Processo: faltam colunas: ${V.join(", ")}`);T.utils.sheet_to_json(F,{defval:""}).forEach(fe=>{const Ae=String(fe.CNJ??"").trim(),xe={cnj:Ae,cnj_digits:Zt(Ae),reclamante_limpo:fe.Reclamante_Limpo,reu_nome:fe.Reu_Nome,comarca:fe.Comarca??"",fase:fe.Fase??"",status:fe.Status??""};R.push(xe)}),X=X.concat(Q(R))}if(oe){const W=Ds(oe,T),{ok:ye,missing:V}=Ps(W,si);if(!ye)throw new Error(`Modo Testemunha: faltam colunas: ${V.join(", ")}`);T.utils.sheet_to_json(oe,{defval:""}).forEach(fe=>{const Ae=Es(fe.CNJs_Como_Testemunha),xe={nome_testemunha:fe.Nome_Testemunha,cnjs_como_testemunha:Ae};Z.push(xe)}),X=X.concat(A(Z))}O({porProcesso:R,porTestemunha:Z,errors:X})}catch(J){U(J)}},Y.onerror=()=>U(new Error("Erro ao ler arquivo")),Y.readAsArrayBuffer(v)})},k=async()=>{if(p){if(!navigator.onLine){w("offline"),S(!0);return}l(!0),h(0),o("publish"),w("loading");try{const v=setInterval(()=>{h(L=>L>=90?(clearInterval(v),90):L+Math.random()*10)},300),T=p.testemunhas.flatMap(L=>L.cnjs_como_testemunha.map(J=>({nome_testemunha:L.nome_testemunha,cnj:J,cnj_digits:Zt(J)}))),O={};p.processos.length&&(O.processos=p.processos),T.length&&(O.testemunhas=T);const{data:U,error:Y}=await pt.functions.invoke("import-mapa-testemunhas",{body:O});if(h(100),Y)throw Y;M(U),w("success"),S(!1),s({title:"Importação concluída!",description:`${U?.upserts??0} registros processados com sucesso.`})}catch(v){console.error("Import error:",v),w(navigator.onLine?"error":"offline"),S(!0),s({title:"Erro na importação",description:v.message||"Ocorreu um erro durante a importação.",variant:"destructive"})}finally{l(!1),h(100)}}},G=()=>{a(!1),i(null),j(null),M(null),o("upload"),h(0)},I=()=>e.jsxs(pe,{children:[e.jsxs(De,{children:[e.jsxs(Pe,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ut,{className:"h-5 w-5"}),"Upload de Arquivo Excel"]}),e.jsxs(Xo,{children:[e.jsx(Zo,{asChild:!0,children:e.jsxs(H,{variant:"ghost",size:"sm",className:"text-muted-foreground",children:[e.jsx(sn,{className:"h-4 w-4 mr-2"}),"Precisa de ajuda?",e.jsx(xt,{className:"h-4 w-4 ml-2"})]})}),e.jsx(ei,{className:"absolute z-10 mt-2 p-4 bg-background border rounded-lg shadow-lg max-w-md right-0",children:e.jsx("div",{className:"space-y-3",children:e.jsxs(He,{className:"border-blue-200 bg-blue-50 dark:bg-blue-950",children:[e.jsx(an,{className:"h-4 w-4 text-blue-600"}),e.jsxs(We,{className:"text-blue-800 dark:text-blue-200",children:[e.jsx("strong",{children:"Formato requerido:"})," Arquivo Excel (.xlsx) com abas:",e.jsx("br",{}),"• ",e.jsx("strong",{children:"Por Processo:"})," CNJ, Reclamante_Limpo, Reu_Nome",e.jsx("br",{}),"• ",e.jsx("strong",{children:"Por Testemunha:"})," Nome_Testemunha, CNJs_Como_Testemunha"]})]})})})]})]}),e.jsx(_t,{children:"Faça upload do arquivo Excel com os dados do mapa de testemunhas"})]}),e.jsxs(we,{children:[e.jsxs("div",{...d(),className:`border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors ${g?"border-primary bg-primary/5":"border-muted-foreground/25 hover:border-primary"}`,children:[e.jsx("input",{...x()}),e.jsx(Ut,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),g?e.jsx("p",{className:"text-lg",children:"Solte o arquivo aqui..."}):e.jsxs("div",{children:[e.jsx("p",{className:"text-lg mb-2",children:"Arraste e solte o arquivo aqui"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"ou clique para selecionar"}),e.jsx(H,{variant:"outline",children:"Selecionar Arquivo"})]})]}),n&&e.jsxs("div",{className:"mt-4 p-4 bg-muted rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:n.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[(n.size/1024/1024).toFixed(2)," MB • Excel"]})]}),e.jsx(H,{variant:"ghost",size:"sm",onClick:()=>{i(null),j(null),o("upload")},children:e.jsx(rn,{className:"h-4 w-4"})})]}),m&&e.jsxs("div",{className:"mt-3",children:[e.jsx(kt,{value:u,className:"w-full"}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-1 flex items-center gap-2",children:[e.jsx(va,{className:"h-3 w-3 animate-pulse"}),u<95?`Enviando arquivo... ${Math.round(u)}%`:"Processando e validando dados..."]})]})]})]})]}),ue=()=>e.jsxs(pe,{children:[e.jsxs(De,{children:[e.jsxs(Pe,{className:"flex items-center gap-2",children:[e.jsx(ja,{className:"h-5 w-5"}),"Validação e Normalização"]}),e.jsx(_t,{children:"Verificando a qualidade e consistência dos dados"})]}),e.jsx(we,{children:p?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold",children:p.totalRows?.toLocaleString()}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Linhas analisadas"})]}),e.jsxs("div",{className:"text-center p-4 bg-green-50 dark:bg-green-950 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:p.validRows?.toLocaleString()}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Linhas válidas"})]}),e.jsxs("div",{className:"text-center p-4 bg-red-50 dark:bg-red-950 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:p.errors?.length||0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Erros"})]}),e.jsxs("div",{className:"text-center p-4 bg-orange-50 dark:bg-orange-950 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600 dark:text-orange-400",children:p.warnings?.length||0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Avisos"})]})]}),p.errors?.length===0&&p.validRows>0&&e.jsxs(He,{className:"border-green-200 bg-green-50 dark:bg-green-950 dark:border-green-800",children:[e.jsx(Je,{className:"h-4 w-4 text-green-600"}),e.jsxs(We,{className:"text-green-800 dark:text-green-200",children:["✅ Arquivo pronto para importação! ",p.validRows," registros serão processados."]})]}),p.errors?.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium",children:"Erros Encontrados:"}),p.errors.slice(0,5).map((v,T)=>e.jsxs(He,{variant:"destructive",children:[e.jsx(Pt,{className:"h-4 w-4"}),e.jsxs(We,{children:[e.jsxs("strong",{children:["Linha ",v.row,":"]})," ",v.message," (",v.column,")"]})]},T)),p.errors.length>5&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["... e mais ",p.errors.length-5," erros"]})]}),(p.errors?.length>0||p.warnings?.length>0)&&e.jsx(ni,{validationResults:p,fileName:n?.name||"arquivo"}),e.jsxs("div",{className:"flex gap-2 justify-between",children:[e.jsx(H,{variant:"outline",onClick:()=>o("upload"),children:"Voltar"}),e.jsx("div",{className:"flex gap-2",children:e.jsx(H,{onClick:()=>o("preview"),disabled:p.validRows===0||(p.errors?.length||0)>0,children:p.errors?.length>0?"Corrigir Erros Primeiro":"Continuar para Prévia"})})]})]}):e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx(hs,{className:"h-8 w-8 animate-spin mx-auto mb-4"}),e.jsx("p",{children:"Validando arquivo..."})]})})})]}),z=()=>e.jsxs(pe,{children:[e.jsxs(De,{children:[e.jsxs(Pe,{className:"flex items-center gap-2",children:[e.jsx(Ye,{className:"h-5 w-5"}),"Prévia dos Dados"]}),e.jsx(_t,{children:"Visualização dos dados processados e normalizados"})]}),e.jsx(we,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold",children:p?.processos.length||0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Processos"})]}),e.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold",children:p?.testemunhas.length||0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Testemunhas"})]}),e.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[e.jsxs("div",{className:"text-2xl font-bold",children:[p?Math.round(p.validRows/p.totalRows*100):0,"%"]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Taxa de sucesso"})]})]}),e.jsxs(He,{className:"border-blue-200 bg-blue-50 dark:bg-blue-950 dark:border-blue-800",children:[e.jsx(Ye,{className:"h-4 w-4 text-blue-600"}),e.jsxs(We,{className:"text-blue-800 dark:text-blue-200",children:[e.jsx("strong",{children:"Prévia da Importação:"})," ",p?.validRows||0," registros serão processados e inseridos no mapa de testemunhas."]})]}),p?.processos.length>0&&e.jsx("div",{className:"border rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-muted",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 text-left",children:"CNJ"}),e.jsx("th",{className:"p-3 text-left",children:"Reclamante"}),e.jsx("th",{className:"p-3 text-left",children:"Réu"})]})}),e.jsx("tbody",{children:p.processos.slice(0,3).map((v,T)=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"p-3 font-mono text-sm",children:v.cnj}),e.jsx("td",{className:"p-3",children:v.reclamante_limpo}),e.jsx("td",{className:"p-3",children:v.reu_nome})]},T))})]})}),e.jsxs("div",{className:"flex gap-2 justify-between",children:[e.jsx(H,{variant:"outline",onClick:()=>o("validation"),children:"Voltar para Validação"}),e.jsx(H,{onClick:k,className:"bg-green-600 hover:bg-green-700",disabled:(p?.errors?.length||0)>0,children:"Confirmar Importação"})]})]})})]}),N=()=>e.jsxs(pe,{children:[e.jsxs(De,{children:[e.jsxs(Pe,{className:"flex items-center gap-2",children:[e.jsx(Je,{className:"h-5 w-5"}),"Importação"]}),e.jsx(_t,{children:"Processamento dos dados no sistema"})]}),e.jsx(we,{children:e.jsx("div",{className:"space-y-4",children:y?e.jsxs("div",{className:"space-y-4",children:[e.jsxs(He,{className:"border-green-200 bg-green-50 dark:bg-green-950",children:[e.jsx(Je,{className:"h-4 w-4 text-green-600"}),e.jsxs(We,{className:"text-green-800 dark:text-green-200",children:[e.jsx("strong",{children:"Importação concluída com sucesso!"}),e.jsx("br",{}),"• Registros processados: ",y.upserts,y.errors?.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),"• Erros: ",y.errors.length]})]})]}),e.jsx(H,{className:"w-full",onClick:G,children:"Fechar"})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(hs,{className:"h-8 w-8 animate-spin mx-auto mb-4"}),e.jsx("p",{className:"font-medium",children:"Importando dados..."}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Processando e inserindo registros no mapa de testemunhas."}),e.jsxs("div",{className:"mt-4",children:[e.jsx(kt,{value:u,className:"w-full"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:u<100?"Processando...":"Finalizando..."})]})]})})})]});return e.jsxs(e.Fragment,{children:[e.jsx(An,{open:t,onOpenChange:C,children:e.jsxs(Pa,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(Aa,{children:[e.jsxs(Oa,{className:"flex items-center gap-2",children:[e.jsx(ns,{className:"h-5 w-5"}),"Importar Mapa de Testemunhas"]}),e.jsx(ka,{children:'Importe dados do Excel com as abas "Por Processo" e/ou "Por Testemunha"'})]}),P&&e.jsx(He,{variant:"destructive",className:"mb-4",children:e.jsx(We,{children:"Integração CNJ indisponível"})}),f!=="empty"&&f!=="success"&&e.jsx(Nt,{status:f,onRetry:k}),e.jsx(ri,{currentStep:r,validationResults:p,isProcessing:m}),e.jsxs("div",{className:"space-y-6",children:[r==="upload"&&I(),r==="validation"&&ue(),r==="preview"&&z(),r==="publish"&&N()]})]})}),e.jsx(ds,{open:$,title:"Descartar alterações?",description:"Você possui alterações não salvas. Deseja realmente sair?",confirmText:"Sair",onConfirm:()=>{D(!1),ee(),a(!1)},onCancel:()=>D(!1)})]})}const ii=()=>{const t=K(s=>s.isPiiMasked),a=K(s=>s.setIsPiiMasked);return e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Ve,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ia,{id:"mask-pii",checked:t,onCheckedChange:a}),e.jsx(Ee,{htmlFor:"mask-pii",className:"text-sm font-medium cursor-pointer flex items-center gap-1",children:t?e.jsxs(e.Fragment,{children:[e.jsx(Jt,{className:"h-3 w-3"}),"Mascarar PII"]}):e.jsxs(e.Fragment,{children:[e.jsx(Ye,{className:"h-3 w-3"}),"Mostrar PII"]})})]})]})};function li(t){if(t.length!==18)throw new Error("CNJ without check digits must have exactly 18 digits");const a=[2,3,4,5,6,7,8,9,2,3,4,5,6,7,8,9,2,3];let s=0;const r=t.split("").map(Number);for(let i=0;i<r.length;i++)s+=r[i]*a[i];return(98-s%97).toString().padStart(2,"0")}function ci(t){const a=t?.year||2018+Math.floor(Math.random()*8),s=t?.sequential||String(Math.floor(Math.random()*9999999)+1).padStart(7,"0"),r=t?.justice,o=t?.tribunal,n=t?.origin||String(Math.floor(Math.random()*9999)+1).padStart(4,"0"),i=s+a+r+o+n,m=li(i);return`${s}-${m}.${a}.${r}.${o}.${n}`}function di(t,a=2024){const s=[];for(let o=0;o<t;o++){const n=String(1e6+o).padStart(7,"0");s.push(ci({sequential:n,year:a,justice:"5",tribunal:"02",origin:String(1e3+o).padStart(4,"0")}))}return s}const $e=di(12,2024),Xi=[{Aba:"Por Processo",Campo:"CNJ",Tipo:"texto",Obrigatorio:"Sim",Regra:"String com 20 dígitos (preserva formato original). Validação interna remove pontuação.",Exemplo:$e[0]},{Aba:"Por Processo",Campo:"reclamante_nome",Tipo:"texto",Obrigatorio:"Sim (legado)",Regra:"Nome principal do reclamante (campo de compatibilidade)",Exemplo:"Ana Lima"},{Aba:"Por Processo",Campo:"reu_nome",Tipo:"texto",Obrigatorio:"Sim (legado)",Regra:"Nome do réu/empresa (campo de compatibilidade)",Exemplo:"Empresa XYZ Ltda"},{Aba:"Por Processo",Campo:"Status",Tipo:"texto",Obrigatorio:"Não",Regra:"Status atual do processo",Exemplo:"Em andamento"},{Aba:"Por Processo",Campo:"Fase",Tipo:"texto",Obrigatorio:"Não",Regra:"Fase processual atual",Exemplo:"Instrução"},{Aba:"Por Processo",Campo:"UF",Tipo:"texto",Obrigatorio:"Sim",Regra:"Sigla de 2 letras do estado",Exemplo:"SP"},{Aba:"Por Processo",Campo:"Comarca",Tipo:"texto",Obrigatorio:"Sim",Regra:"Nome da comarca",Exemplo:"São Paulo"},{Aba:"Por Processo",Campo:"Reclamantes",Tipo:"lista",Obrigatorio:"Sim",Regra:"Lista separada por ; (ponto e vírgula). Não usar []",Exemplo:"Ana Lima; Pedro Santos"},{Aba:"Por Processo",Campo:"Advogados_Ativo",Tipo:"lista",Obrigatorio:"Sim",Regra:"Lista separada por ; (primeiro é principal na UI)",Exemplo:"Dr. Xavier Silva; Dra. Yasmim Oliveira"},{Aba:"Por Processo",Campo:"Testemunhas_Ativo",Tipo:"lista",Obrigatorio:"Não",Regra:"Lista separada por ; ou — se vazio",Exemplo:"João Pereira; Carlos Costa"},{Aba:"Por Processo",Campo:"Testemunhas_Passivo",Tipo:"lista",Obrigatorio:"Não",Regra:"Lista separada por ; ou — se vazio",Exemplo:"Ana Silva"},{Aba:"Por Processo",Campo:"Todas_Testemunhas",Tipo:"lista",Obrigatorio:"Sim",Regra:"União de todas as testemunhas, separadas por ;",Exemplo:"João Pereira; Beatriz Nunes; Carlos Costa"},{Aba:"Por Processo",Campo:"Reclamante_Foi_Testemunha",Tipo:"boolean",Obrigatorio:"Não",Regra:"true/false",Exemplo:"true"},{Aba:"Por Processo",Campo:"Qtd_Reclamante_Testemunha",Tipo:"número",Obrigatorio:"Não",Regra:"Quantidade de vezes que reclamante foi testemunha",Exemplo:"1"},{Aba:"Por Processo",Campo:"CNJs_Reclamante_Testemunha",Tipo:"lista",Obrigatorio:"Não",Regra:"Lista de CNJs separados por ; ou — se vazio",Exemplo:`${$e[9]}`},{Aba:"Por Processo",Campo:"Reclamante_Testemunha_Polo_Passivo",Tipo:"boolean",Obrigatorio:"Não",Regra:"true/false",Exemplo:"false"},{Aba:"Por Processo",Campo:"CNJs_Passivo",Tipo:"lista",Obrigatorio:"Não",Regra:"CNJs onde reclamante foi testemunha do polo passivo",Exemplo:"—"},{Aba:"Por Processo",Campo:"Triangulacao_Confirmada",Tipo:"boolean",Obrigatorio:"Não",Regra:"true/false",Exemplo:"true"},{Aba:"Por Processo",Campo:"Desenho_Triangulacao",Tipo:"texto",Obrigatorio:"Não",Regra:"Padrão da triangulação (A→B→C→A) ou — se não houver",Exemplo:"A→B→C→A"},{Aba:"Por Processo",Campo:"CNJs_Triangulacao",Tipo:"lista",Obrigatorio:"Não",Regra:"CNJs envolvidos na triangulação, separados por ;",Exemplo:`${$e[1]}; ${$e[2]}; ${$e[3]}`},{Aba:"Por Processo",Campo:"Contem_Prova_Emprestada",Tipo:"boolean",Obrigatorio:"Não",Regra:"true/false",Exemplo:"true"},{Aba:"Por Processo",Campo:"Testemunhas_Prova_Emprestada",Tipo:"lista",Obrigatorio:"Não",Regra:"Nomes das testemunhas de prova emprestada, separados por ;",Exemplo:"João Pereira"},{Aba:"Por Processo",Campo:"Classificacao_Final",Tipo:"texto",Obrigatorio:"Não",Regra:"Classificação de risco (Risco Alto, Risco Médio, Risco Baixo)",Exemplo:"Risco Alto"},{Aba:"Por Processo",Campo:"Insight_Estrategico",Tipo:"texto",Obrigatorio:"Não",Regra:"Resumo dos principais achados",Exemplo:"Triangulação + prova emprestada"},{Aba:"Por Testemunha",Campo:"Nome_Testemunha",Tipo:"texto",Obrigatorio:"Sim",Regra:"Nome completo da testemunha",Exemplo:"João Pereira"},{Aba:"Por Testemunha",Campo:"Qtd_Depoimentos",Tipo:"número",Obrigatorio:"Sim",Regra:"Quantidade total de depoimentos",Exemplo:"12"},{Aba:"Por Testemunha",Campo:"CNJs_Como_Testemunha",Tipo:"lista",Obrigatorio:"Sim",Regra:"Lista de CNJs separados por ;",Exemplo:`${$e[0]}; ${$e[9]}`},{Aba:"Por Testemunha",Campo:"Ja_Foi_Reclamante",Tipo:"boolean",Obrigatorio:"Não",Regra:"true/false",Exemplo:"false"},{Aba:"Por Testemunha",Campo:"CNJs_Como_Reclamante",Tipo:"lista",Obrigatorio:"Não",Regra:"CNJs onde foi reclamante, separados por ; ou — se vazio",Exemplo:"—"},{Aba:"Por Testemunha",Campo:"Foi_Testemunha_Ativo",Tipo:"boolean",Obrigatorio:"Não",Regra:"true/false",Exemplo:"true"},{Aba:"Por Testemunha",Campo:"Foi_Testemunha_Passivo",Tipo:"boolean",Obrigatorio:"Não",Regra:"true/false",Exemplo:"false"},{Aba:"Por Testemunha",Campo:"CNJs_Passivo",Tipo:"lista",Obrigatorio:"Não",Regra:"CNJs onde foi testemunha do polo passivo",Exemplo:"—"},{Aba:"Por Testemunha",Campo:"Foi_Ambos_Polos",Tipo:"boolean",Obrigatorio:"Não",Regra:"true/false",Exemplo:"false"},{Aba:"Por Testemunha",Campo:"Participou_Troca_Favor",Tipo:"boolean",Obrigatorio:"Não",Regra:"true/false",Exemplo:"true"},{Aba:"Por Testemunha",Campo:"CNJs_Troca_Favor",Tipo:"lista",Obrigatorio:"Não",Regra:"Padrão CNJ_A↔CNJ_B ou lista separada por ;",Exemplo:`${$e[4]}↔${$e[5]}`},{Aba:"Por Testemunha",Campo:"Participou_Triangulacao",Tipo:"boolean",Obrigatorio:"Não",Regra:"true/false",Exemplo:"true"},{Aba:"Por Testemunha",Campo:"CNJs_Triangulacao",Tipo:"lista",Obrigatorio:"Não",Regra:"CNJs da triangulação, separados por ;",Exemplo:`${$e[1]}; ${$e[2]}; ${$e[3]}`},{Aba:"Por Testemunha",Campo:"E_Prova_Emprestada",Tipo:"boolean",Obrigatorio:"Não",Regra:"true/false",Exemplo:"true"},{Aba:"Por Testemunha",Campo:"Classificacao",Tipo:"texto",Obrigatorio:"Não",Regra:"ALTA, MÉDIA, BAIXA",Exemplo:"ALTA"},{Aba:"Por Testemunha",Campo:"Classificacao_Estrategica",Tipo:"texto",Obrigatorio:"Não",Regra:"CRÍTICO, ATENÇÃO, NORMAL",Exemplo:"CRÍTICO"}];function Ie(t){if(!t||t.length===0)return"—";const a=t.map(s=>String(s).trim()).filter(s=>s.length>0);return a.length>0?a.join("; "):"—"}const ui=t=>({CNJ:t.cnj||"—",Status:t.status||"—",Fase:t.fase||"—",UF:t.uf||"—",Comarca:t.comarca||"—",Reclamantes:t.reclamante_limpo||"—",Advogados_Ativo:Ie(t.advogados_parte_ativa||[]),Testemunhas_Ativo:Ie(t.testemunhas_ativo_limpo||[]),Testemunhas_Passivo:Ie(t.testemunhas_passivo_limpo||[]),Todas_Testemunhas:Ie(t.todas_testemunhas||[]),Reclamante_Foi_Testemunha:t.reclamante_foi_testemunha||!1,Qtd_Reclamante_Testemunha:t.qtd_vezes_reclamante_foi_testemunha||0,CNJs_Reclamante_Testemunha:Ie(t.cnjs_em_que_reclamante_foi_testemunha||[]),Reclamante_Testemunha_Polo_Passivo:t.reclamante_testemunha_polo_passivo||!1,CNJs_Passivo:Ie(t.cnjs_passivo||[]),Triangulacao_Confirmada:t.triangulacao_confirmada||!1,Desenho_Triangulacao:t.desenho_triangulacao||"—",CNJs_Triangulacao:Ie(t.cnjs_triangulacao||[]),Contem_Prova_Emprestada:t.contem_prova_emprestada||!1,Testemunhas_Prova_Emprestada:Ie(t.testemunhas_prova_emprestada||[]),Classificacao_Final:t.classificacao_final||"—",Insight_Estrategico:t.insight_estrategico||"—"}),mi=t=>({Nome_Testemunha:t.nome_testemunha,Qtd_Depoimentos:t.qtd_depoimentos||0,CNJs_Como_Testemunha:Ie(t.cnjs_como_testemunha||[]),Ja_Foi_Reclamante:t.ja_foi_reclamante||!1,CNJs_Como_Reclamante:Ie(t.cnjs_como_reclamante||[]),Foi_Testemunha_Ativo:t.foi_testemunha_ativo||!1,Foi_Testemunha_Passivo:t.foi_testemunha_passivo||!1,CNJs_Passivo:Ie(t.cnjs_passivo||[]),Foi_Ambos_Polos:t.foi_testemunha_em_ambos_polos||!1,Participou_Troca_Favor:t.participou_troca_favor||!1,CNJs_Troca_Favor:Ie(t.cnjs_troca_favor||[]),Participou_Triangulacao:t.participou_triangulacao||!1,CNJs_Triangulacao:Ie(t.cnjs_triangulacao||[]),E_Prova_Emprestada:t.e_prova_emprestada||!1,Classificacao:t.classificacao||"—",Classificacao_Estrategica:t.classificacao_estrategica||"—"}),hi=t=>{if(!t)return"";const a=t.replace(/\D/g,"");return a.length===11?a.replace(/(\d{3})\d{6}(\d{2})/,"$1******$2"):a.length>=3?a.substring(0,2)+"*".repeat(Math.max(1,a.length-4))+a.slice(-2):"*".repeat(t.length)},fi=t=>{if(!t)return"";const a=t.replace(/\D/g,"");return a.length===14?a.replace(/(\d{2})\d{9}(\d{4})/,"$1*********$2"):a.length>=6?a.substring(0,2)+"*".repeat(Math.max(1,a.length-6))+a.slice(-4):"*".repeat(t.length)},pi=t=>{if(!t)return"";const[a,s]=t.split("@");if(!a||!s)return t;const r=Math.min(2,a.length);return`${a.substring(0,r)+"*".repeat(Math.max(1,a.length-r))}@${s}`},xi=t=>{if(!t)return"";const a=t.replace(/\D/g,"");return a.length>=8?a.length===11?a.replace(/(\d{2})(\d{1})\d{4}(\d{2})/,"($1) $2****-**$3"):a.length===10?a.replace(/(\d{2})\d{4}(\d{2})/,"($1) ****-**$2"):a.substring(0,2)+"*".repeat(a.length-4)+a.slice(-2):"*".repeat(t.length)},gi=t=>{if(!t)return"";const a=t.replace(/\D/g,"");return a.length>=4?t.replace(/\d/g,(s,r,o)=>{const n=o.substring(0,r+1).replace(/\D/g,"").length-1;return n===0||n===a.length-1?s:"*"}):t.replace(/\d/g,"*")},ft=t=>{if(!t)return"";let a=t;return a=a.replace(/\b\d{3}\.?\d{3}\.?\d{3}-?\d{2}\b/g,s=>hi(s)),a=a.replace(/\b\d{2}\.?\d{3}\.?\d{3}\/?\d{4}-?\d{2}\b/g,s=>fi(s)),a=a.replace(/\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b/g,s=>pi(s)),a=a.replace(/\(\d{2}\)?\s*\d{4,5}-?\d{4}\b/g,s=>xi(s)),a=a.replace(/\bOAB\/?\w{2}\s*\d+/gi,s=>gi(s)),a},vi=(t,a={})=>{const{filename:s=`processos-${new Date().toISOString().split("T")[0]}.csv`,maskPII:r=!1,selectedOnly:o=!1,selectedIds:n=[]}=a;let i=t;o&&n.length>0&&(i=t.filter(j=>n.includes(j.cnj)));const m=i.map(j=>{const y=ui(j);return r?{...y,Reclamantes:ft(y.Reclamantes),Todas_Testemunhas:ft(y.Todas_Testemunhas),Insight_Estrategico:ft(y.Insight_Estrategico)}:y}),u="\uFEFF"+Ka.unparse(m,{delimiter:",",header:!0}),h=new Blob([u],{type:"text/csv;charset=utf-8;"}),p=document.createElement("a");if(p.download!==void 0){const j=URL.createObjectURL(h);p.setAttribute("href",j),p.setAttribute("download",s),p.style.visibility="hidden",document.body.appendChild(p),p.click(),document.body.removeChild(p)}return m.length},ji=(t,a={})=>{const{filename:s=`testemunhas-${new Date().toISOString().split("T")[0]}.csv`,maskPII:r=!1,selectedOnly:o=!1,selectedIds:n=[]}=a;let i=t;o&&n.length>0&&(i=t.filter(j=>n.includes(j.nome_testemunha)));const m=i.map(j=>{const y=mi(j);return r?{...y,Nome_Testemunha:ft(y.Nome_Testemunha),CNJs_Como_Testemunha:ft(y.CNJs_Como_Testemunha),CNJs_Como_Reclamante:ft(y.CNJs_Como_Reclamante)}:y}),u="\uFEFF"+Ka.unparse(m,{delimiter:",",header:!0}),h=new Blob([u],{type:"text/csv;charset=utf-8;"}),p=document.createElement("a");if(p.download!==void 0){const j=URL.createObjectURL(h);p.setAttribute("href",j),p.setAttribute("download",s),p.style.visibility="hidden",document.body.appendChild(p),p.click(),document.body.removeChild(p)}return m.length},bi=(t,a=!0)=>{const r=t*(a?500:350);return r<1024?`${r} bytes`:r<1024*1024?`${(r/1024).toFixed(1)} KB`:`${(r/(1024*1024)).toFixed(1)} MB`},_i=(t,a=!1)=>t===0?{isValid:!1,message:a?"Nenhum registro selecionado para exportação.":"Nenhum registro encontrado para exportação.",maxRecords:5e3}:t>5e3?{isValid:!1,message:`Limite de exportação excedido. Máximo permitido: ${5e3.toLocaleString()} registros. ${a?"Selecione menos registros":"Aplique filtros para reduzir o resultado"}.`,maxRecords:5e3}:{isValid:!0,maxRecords:5e3},Ni=({data:t,fileName:a,disabled:s=!1})=>{const[r,o]=_.useState(!1),n=K(Za),i=h=>h.length>0&&"cnj"in h[0]&&"reclamante_limpo"in h[0],m=async()=>{o(!0);try{const h=t.length,p=_i(h,!1);if(!p.isValid){Lt.error("Erro na exportação",{description:p.message});return}let j=0;const y=i(t)?"processos.csv":"testemunhas.csv";if(i(t)){const M=t.map(f=>({cnj:f.cnj,status:f.status||null,uf:f.uf||null,comarca:f.comarca||null,fase:f.fase||null,reclamante_limpo:f.reclamante_limpo||null,advogados_parte_ativa:f.advogados_parte_ativa||null,testemunhas_ativo_limpo:f.testemunhas_ativo_limpo||null,testemunhas_passivo_limpo:f.testemunhas_passivo_limpo||null,todas_testemunhas:f.todas_testemunhas||null,reclamante_foi_testemunha:f.reclamante_foi_testemunha||null,qtd_vezes_reclamante_foi_testemunha:f.qtd_vezes_reclamante_foi_testemunha||null,cnjs_em_que_reclamante_foi_testemunha:f.cnjs_em_que_reclamante_foi_testemunha||null,reclamante_testemunha_polo_passivo:f.reclamante_testemunha_polo_passivo||null,cnjs_passivo:f.cnjs_passivo||null,troca_direta:f.troca_direta||null,desenho_troca_direta:f.desenho_troca_direta||null,cnjs_troca_direta:f.cnjs_troca_direta||null,triangulacao_confirmada:f.triangulacao_confirmada||null,desenho_triangulacao:f.desenho_triangulacao||null,cnjs_triangulacao:f.cnjs_triangulacao||null,testemunha_do_reclamante_ja_foi_testemunha_antes:f.testemunha_do_reclamante_ja_foi_testemunha_antes||null,qtd_total_depos_unicos:f.qtd_total_depos_unicos||null,cnjs_depos_unicos:f.cnjs_depos_unicos||null,contem_prova_emprestada:f.contem_prova_emprestada||null,testemunhas_prova_emprestada:f.testemunhas_prova_emprestada||null,classificacao_final:f.classificacao_final||null,insight_estrategico:f.insight_estrategico||null,org_id:f.org_id||null,created_at:f.created_at||new Date().toISOString(),updated_at:f.updated_at||new Date().toISOString()}));j=vi(M,{filename:a||y,maskPII:n,selectedOnly:!1,selectedIds:[]})}else{const M=t.map(f=>({nome_testemunha:f.nome_testemunha,qtd_depoimentos:f.qtd_depoimentos||null,cnjs_como_testemunha:f.cnjs_como_testemunha||null,ja_foi_reclamante:f.ja_foi_reclamante||null,cnjs_como_reclamante:f.cnjs_como_reclamante||null,foi_testemunha_ativo:f.foi_testemunha_ativo||null,cnjs_ativo:f.cnjs_ativo||null,foi_testemunha_passivo:f.foi_testemunha_passivo||null,cnjs_passivo:f.cnjs_passivo||null,foi_testemunha_em_ambos_polos:f.foi_testemunha_em_ambos_polos||null,participou_troca_favor:f.participou_troca_favor||null,cnjs_troca_favor:f.cnjs_troca_favor||null,participou_triangulacao:f.participou_triangulacao||null,cnjs_triangulacao:f.cnjs_triangulacao||null,e_prova_emprestada:f.e_prova_emprestada||null,classificacao:f.classificacao||null,classificacao_estrategica:f.classificacao_estrategica||null,org_id:f.org_id||null,created_at:f.created_at||new Date().toISOString(),updated_at:f.updated_at||new Date().toISOString()}));j=ji(M,{filename:a||y,maskPII:n,selectedOnly:!1,selectedIds:[]})}Lt.success("Exportação concluída!",{description:`${j} registros exportados com sucesso.`})}catch(h){console.error("Export error:",h),Lt.error("Erro na exportação",{description:"Não foi possível exportar os dados. Tente novamente."})}finally{o(!1)}},u=(()=>{const h=Math.min(t.length,5e3),p=i(t);return{count:h,size:bi(h,p)}})();return e.jsxs(is,{children:[e.jsx(ls,{asChild:!0,children:e.jsxs(H,{variant:"outline",disabled:s||r||t.length===0,className:"gap-2","aria-label":"Exportar dados como CSV",children:[r?e.jsx(Ft,{className:"h-4 w-4 animate-spin","aria-hidden":"true"}):e.jsx(_a,{className:"h-4 w-4","aria-hidden":"true"}),"Exportar CSV"]})}),e.jsxs(Mt,{align:"end",className:"w-56",children:[e.jsx("div",{className:"px-3 py-2 text-xs text-muted-foreground",children:e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsx(ns,{className:"h-3 w-3","aria-hidden":"true"}),"Exportar como CSV"]})}),e.jsx(Kt,{}),e.jsx(Ot,{onClick:m,disabled:r,children:e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Todos os registros"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:u.count.toLocaleString()})]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:u.size})]})}),t.length>5e3&&e.jsxs(e.Fragment,{children:[e.jsx(Kt,{}),e.jsx("div",{className:"px-3 py-2 text-xs text-warning",children:"⚠️ Máximo de 5.000 registros por exportação"})]})]})]})},Ce=[];for(let t=0;t<256;++t)Ce.push((t+256).toString(16).slice(1));function wi(t,a=0){return(Ce[t[a+0]]+Ce[t[a+1]]+Ce[t[a+2]]+Ce[t[a+3]]+"-"+Ce[t[a+4]]+Ce[t[a+5]]+"-"+Ce[t[a+6]]+Ce[t[a+7]]+"-"+Ce[t[a+8]]+Ce[t[a+9]]+"-"+Ce[t[a+10]]+Ce[t[a+11]]+Ce[t[a+12]]+Ce[t[a+13]]+Ce[t[a+14]]+Ce[t[a+15]]).toLowerCase()}let Bt;const yi=new Uint8Array(16);function Ci(){if(!Bt){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Bt=crypto.getRandomValues.bind(crypto)}return Bt(yi)}const Ti=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),As={randomUUID:Ti};function br(t,a,s){if(As.randomUUID&&!a&&!t)return As.randomUUID();t=t||{};const r=t.random??t.rng?.()??Ci();if(r.length<16)throw new Error("Random bytes length must be >= 16");return r[6]=r[6]&15|64,r[8]=r[8]&63|128,wi(r)}const Si=["uf","status","fase","search","testemunha","qtdDeposMin","qtdDeposMax","temTriangulacao","temTroca","temProvaEmprestada","ambosPolos","jaFoiReclamante"],Ri=new Set(["temTriangulacao","temTroca","temProvaEmprestada","ambosPolos","jaFoiReclamante"]);function Os(t){let a=Number(t?.page??1);(!Number.isFinite(a)||a<1)&&(a=1);let s=Number(t?.limit??20);(!Number.isFinite(s)||s<1)&&(s=20),s>200&&(s=200);const r={};if(t?.filters&&typeof t.filters=="object")for(const[n,i]of Object.entries(t.filters)){if(!Si.includes(n))continue;let m=i;if(Ri.has(n)){if(typeof m=="string")if(m==="true")m=!0;else if(m==="false")m=!1;else continue;else if(typeof m!="boolean")continue}else if((n==="search"||n==="testemunha")&&typeof m=="string")m=m.trim();else if(n==="qtdDeposMin"||n==="qtdDeposMax"){const l=typeof m=="number"?m:Number(m);if(!Number.isFinite(l))continue;m=l}r[n]=m}const o={page:a,limit:s,filters:r};return typeof t?.sortBy=="string"&&(o.sortBy=t.sortBy),(t?.sortDir==="asc"||t?.sortDir==="desc")&&(o.sortDir=t.sortDir),o}function Ei(t){if(!t)return t;const a={temTriangulacao:"tem_triangulacao",temTroca:"tem_troca",temProvaEmprestada:"tem_prova_emprestada",qtdDeposMin:"qtd_depoimentos_min",qtdDeposMax:"qtd_depoimentos_max",ambosPolos:"ambos_polos",jaFoiReclamante:"ja_foi_reclamante"};return Object.fromEntries(Object.entries(t).map(([s,r])=>[a[s]??s.replace(/[A-Z]/g,o=>`_${o.toLowerCase()}`),r]))}function It(t){const{page:a,limit:s,filters:r,sortBy:o,sortDir:n}=t,i={paginacao:{page:a,limit:s},filtros:Ei(r)};return o&&(i.sort_by=o),n&&(i.sort_dir=n),i}const Di=[{cnj:"0001234-56.2024.5.01.0001",status:"Ativo",uf:"RJ",comarca:"Rio de Janeiro",fase:"Instrução",reclamante_limpo:"Ana Lima",advogados_parte_ativa:["Dr. João Silva","Dra. Maria Santos"],testemunhas_ativo_limpo:["João Pereira","Beatriz Nunes"],testemunhas_passivo_limpo:["Carlos Oliveira"],todas_testemunhas:["João Pereira","Beatriz Nunes","Carlos Oliveira"],reclamante_foi_testemunha:!0,qtd_vezes_reclamante_foi_testemunha:2,cnjs_em_que_reclamante_foi_testemunha:["0009876-12.2023.5.04.0002"],reclamante_testemunha_polo_passivo:!1,cnjs_passivo:[],troca_direta:!1,desenho_troca_direta:null,cnjs_troca_direta:[],triangulacao_confirmada:!0,desenho_triangulacao:"Ana Lima → João Pereira → Beatriz Nunes",cnjs_triangulacao:["0009876-12.2023.5.04.0002","0012345-00.2022.5.02.0003"],testemunha_do_reclamante_ja_foi_testemunha_antes:!0,qtd_total_depos_unicos:2,cnjs_depos_unicos:["0009876-12.2023.5.04.0002","0012345-00.2022.5.02.0003"],contem_prova_emprestada:!0,testemunhas_prova_emprestada:["João Pereira"],classificacao_final:"Risco Médio",insight_estrategico:"Atenção especial à testemunha João Pereira que aparece em múltiplos processos.",org_id:"org-1",created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{cnj:"0009876-12.2023.5.04.0002",status:"Ativo",uf:"RS",comarca:"Porto Alegre",fase:"Recurso",reclamante_limpo:"Carlos Souza",advogados_parte_ativa:["Dr. Pedro Costa"],testemunhas_ativo_limpo:["Rafael Gomes"],testemunhas_passivo_limpo:["Ana Lima"],todas_testemunhas:["Rafael Gomes","Ana Lima"],reclamante_foi_testemunha:!1,qtd_vezes_reclamante_foi_testemunha:0,cnjs_em_que_reclamante_foi_testemunha:[],reclamante_testemunha_polo_passivo:!1,cnjs_passivo:[],troca_direta:!0,desenho_troca_direta:"Carlos Souza ↔ Ana Lima",cnjs_troca_direta:["0001234-56.2024.5.01.0001"],triangulacao_confirmada:!0,desenho_triangulacao:"Carlos Souza → Rafael Gomes → Ana Lima",cnjs_triangulacao:["0001234-56.2024.5.01.0001"],testemunha_do_reclamante_ja_foi_testemunha_antes:!1,qtd_total_depos_unicos:1,cnjs_depos_unicos:["0001234-56.2024.5.01.0001"],contem_prova_emprestada:!1,testemunhas_prova_emprestada:[],classificacao_final:"Risco Alto",insight_estrategico:"Troca direta confirmada entre reclamante e testemunha de processo anterior.",org_id:"org-1",created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{cnj:"0012345-00.2022.5.02.0003",status:"Encerrado",uf:"SP",comarca:"São Paulo",fase:"Sentença",reclamante_limpo:"Marina Rocha",advogados_parte_ativa:["Dra. Lucia Fernandes"],testemunhas_ativo_limpo:[],testemunhas_passivo_limpo:["João Pereira"],todas_testemunhas:["João Pereira"],reclamante_foi_testemunha:!1,qtd_vezes_reclamante_foi_testemunha:0,cnjs_em_que_reclamante_foi_testemunha:[],reclamante_testemunha_polo_passivo:!1,cnjs_passivo:[],troca_direta:!1,desenho_troca_direta:null,cnjs_troca_direta:[],triangulacao_confirmada:!1,desenho_triangulacao:null,cnjs_triangulacao:[],testemunha_do_reclamante_ja_foi_testemunha_antes:!1,qtd_total_depos_unicos:0,cnjs_depos_unicos:[],contem_prova_emprestada:!1,testemunhas_prova_emprestada:[],classificacao_final:"Baixo",insight_estrategico:null,org_id:"org-1",created_at:new Date().toISOString(),updated_at:new Date().toISOString()}],Pi=[{nome_testemunha:"João Pereira",qtd_depoimentos:4,cnjs_como_testemunha:["0001234-56.2024.5.01.0001","0009876-12.2023.5.04.0002","0012345-00.2022.5.02.0003"],ja_foi_reclamante:!1,cnjs_como_reclamante:[],foi_testemunha_ativo:!0,cnjs_ativo:["0001234-56.2024.5.01.0001"],foi_testemunha_passivo:!0,cnjs_passivo:["0012345-00.2022.5.02.0003"],foi_testemunha_em_ambos_polos:!0,participou_troca_favor:!1,cnjs_troca_favor:[],participou_triangulacao:!0,cnjs_triangulacao:["0001234-56.2024.5.01.0001","0009876-12.2023.5.04.0002"],e_prova_emprestada:!0,classificacao:"Testemunha Recorrente",classificacao_estrategica:"Atenção",org_id:"org-1",created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{nome_testemunha:"Beatriz Nunes",qtd_depoimentos:2,cnjs_como_testemunha:["0001234-56.2024.5.01.0001"],ja_foi_reclamante:!0,cnjs_como_reclamante:["0009876-12.2023.5.04.0002"],foi_testemunha_ativo:!0,cnjs_ativo:["0001234-56.2024.5.01.0001"],foi_testemunha_passivo:!1,cnjs_passivo:[],foi_testemunha_em_ambos_polos:!1,participou_troca_favor:!0,cnjs_troca_favor:["0009876-12.2023.5.04.0002"],participou_triangulacao:!0,cnjs_triangulacao:["0001234-56.2024.5.01.0001"],e_prova_emprestada:!1,classificacao:"Testemunha e Reclamante",classificacao_estrategica:"Observação",org_id:"org-1",created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{nome_testemunha:"Rafael Gomes",qtd_depoimentos:6,cnjs_como_testemunha:["0009876-12.2023.5.04.0002","0012345-00.2022.5.02.0003"],ja_foi_reclamante:!1,cnjs_como_reclamante:[],foi_testemunha_ativo:!0,cnjs_ativo:["0009876-12.2023.5.04.0002"],foi_testemunha_passivo:!0,cnjs_passivo:["0012345-00.2022.5.02.0003"],foi_testemunha_em_ambos_polos:!0,participou_troca_favor:!1,cnjs_troca_favor:[],participou_triangulacao:!0,cnjs_triangulacao:["0009876-12.2023.5.04.0002"],e_prova_emprestada:!1,classificacao:"Testemunha Profissional",classificacao_estrategica:"Crítico",org_id:"org-1",created_at:new Date().toISOString(),updated_at:new Date().toISOString()}],_r=()=>{try{return!!(pt&&pt.auth)}catch{return!1}},Nr=gs({page:Tt().int().min(1).default(1),limit:Tt().int().min(1).default(20).transform(t=>t>200?200:t),sortBy:ht().trim().optional(),sortDir:_n(["asc","desc"]).optional(),filters:gs({uf:ht().trim().optional(),status:ht().trim().optional(),fase:ht().trim().optional(),search:ht().trim().optional(),testemunha:ht().trim().optional(),ambosPolos:vt().optional(),jaFoiReclamante:vt().optional(),temTriangulacao:vt().optional(),temTroca:vt().optional(),temProvaEmprestada:vt().optional(),qtdDeposMin:Tt().optional(),qtdDeposMax:Tt().optional()}).passthrough().default({})}),Ai=async(t,a)=>{const s=Nr.parse(t);It({...s,filters:s.filters?Object.fromEntries(Object.keys(s.filters).map(o=>[o,"[redacted]"])):void 0});let r=br();try{if(!_r())throw new Error("Supabase not configured");const{data:o}=await pt.auth.getSession(),n=o?.session?.access_token;if(!n)throw new Error("Usuário não autenticado");const m=`https://${os()}.functions.supabase.co/mapa-testemunhas-processos`,l=await fetch(m,{method:"POST",body:JSON.stringify(It(s)),headers:{"Content-Type":"application/json","x-request-id":r,Authorization:`Bearer ${n}`},signal:a});r=l.headers.get("x-request-id")??r;let u;try{u=await l.json()}catch{}if(!l.ok){const{error:p,detail:j,hint:y,example:M}=u||{};return{data:[],total:0,error:j||y||"Verifique filtros e tente novamente."}}const h=u;return!h?.data||h.data.length,{data:h.data||[],total:h.count||h.total||0}}catch(o){if(o instanceof DOMException&&o.name==="AbortError")throw o;let n=[...Di];if(s.filters.search){const l=s.filters.search.toLowerCase();n=n.filter(u=>u.cnj?.toLowerCase().includes(l)||u.reclamante_limpo?.toLowerCase().includes(l)||u.comarca?.toLowerCase().includes(l))}if(s.filters.testemunha){const l=s.filters.testemunha.toLowerCase();n=n.filter(u=>u.todas_testemunhas?.some(h=>h.toLowerCase().includes(l)))}if(s.filters.uf?.length&&(n=n.filter(l=>s.filters.uf.includes(l.uf))),s.filters.status?.length&&(n=n.filter(l=>s.filters.status.includes(l.status))),s.filters.fase?.length&&(n=n.filter(l=>s.filters.fase.includes(l.fase))),s.filters.testemunha){const l=s.filters.testemunha.toLowerCase();n=n.filter(u=>u.testemunhas_ativo_limpo?.some(h=>h.toLowerCase().includes(l))||u.testemunhas_passivo_limpo?.some(h=>h.toLowerCase().includes(l))||u.todas_testemunhas?.some(h=>h.toLowerCase().includes(l)))}if(s.filters.temTriangulacao&&(n=n.filter(l=>l.triangulacao_confirmada===!0)),s.filters.temProvaEmprestada&&(n=n.filter(l=>l.contem_prova_emprestada===!0)),s.filters.testemunha){const l=s.filters.testemunha.toLowerCase();n=n.filter(u=>u.todas_testemunhas?.some(h=>h.toLowerCase().includes(l)))}const i=(s.page-1)*s.limit,m=i+s.limit;return{data:n.slice(i,m),total:n.length}}},Oi=async(t,a)=>{const s=Nr.parse(t);It({...s,filters:s.filters?Object.fromEntries(Object.keys(s.filters).map(o=>[o,"[redacted]"])):void 0});let r=br();try{if(!_r())throw new Error("Supabase not configured");const{data:o}=await pt.auth.getSession(),n=o?.session?.access_token;if(!n)throw new Error("Usuário não autenticado");const m=`https://${os()}.functions.supabase.co/mapa-testemunhas-testemunhas`,l=await fetch(m,{method:"POST",body:JSON.stringify(It(s)),headers:{"Content-Type":"application/json","x-request-id":r,Authorization:`Bearer ${n}`},signal:a});r=l.headers.get("x-request-id")??r;let u;try{u=await l.json()}catch{}if(!l.ok){const{error:p,detail:j,hint:y,example:M}=u||{};return{data:[],total:0,error:j||y||"Verifique filtros e tente novamente."}}const h=u;return!h?.data||h.data.length,{data:h.data||[],total:h.count||h.total||0}}catch(o){if(o instanceof DOMException&&o.name==="AbortError")throw o;let n=[...Pi];if(s.filters.search){const l=s.filters.search.toLowerCase();n=n.filter(u=>u.nome_testemunha?.toLowerCase().includes(l))}s.filters.ambosPolos!==void 0&&(n=n.filter(l=>l.foi_testemunha_em_ambos_polos===s.filters.ambosPolos)),s.filters.jaFoiReclamante!==void 0&&(n=n.filter(l=>l.ja_foi_reclamante===s.filters.jaFoiReclamante)),s.filters.temTriangulacao!==void 0&&(n=n.filter(l=>l.participou_triangulacao===s.filters.temTriangulacao)),s.filters.temTroca!==void 0&&(n=n.filter(l=>l.participou_troca_favor===s.filters.temTroca));const i=(s.page-1)*s.limit,m=i+s.limit;return{data:n.slice(i,m),total:n.length}}};function ki(){const{toast:t}=Be(),{error:a}=Bn(),{chatKind:s,chatInput:r,chatStatus:o,chatResult:n,agentOnline:i,setChatStatus:m,setChatResult:l,addChatMessage:u,updateChatMessage:h,setAgentOnline:p}=K(),j=_.useCallback(f=>{switch(f){case"processo":return"process_analysis";case"testemunha":return"witness_analysis";case"reclamante":return"claimant_analysis";default:return"risk_analysis"}},[]),y=_.useCallback((f,w)=>[{type:"executive",title:"📌 Resumo Executivo",icon:"Sparkles",data:{cnj:w.match(/\d{7}-\d{2}\.\d{4}\.\d{1}\.\d{2}\.\d{4}/)?w:"1000000-09.2024.5.02.1000",reclamante:f==="reclamante"?w:"Maria Silva Santos",reu:"Empresa ABC Ltda",status:"Em andamento",observacoes:"Processo com potencial risco de triangulação detectado.",riscoNivel:"alto",confianca:.85,alerta:"Testemunhas conectadas em múltiplos processos"},citations:[{source:"por_processo",ref:"1000000-09.2024.5.02.1000"},{source:"por_testemunha",ref:"João Santos"}]},{type:"details",title:"📋 Análise Detalhada",icon:"FileText",data:{secoes:[{titulo:"Vínculos Identificados",conteudo:"Foram identificadas 3 testemunhas que aparecem em processos similares.",evidencias:["João Santos: 5 processos","Maria Oliveira: 3 processos"]},{titulo:"Padrões Temporais",conteudo:"Concentração de depoimentos entre Jan-Mar 2024.",evidencias:["Janeiro: 8 depoimentos","Fevereiro: 12 depoimentos"]}],textoOriginal:w}},{type:"alerts",title:"⚠️ Alertas Estratégicos",icon:"AlertTriangle",data:{suspiciousPatterns:["Triangulação detectada entre 3 testemunhas","Depoimentos com narrativas similares","Mesmo advogado em processos conexos"]}},{type:"strategies",title:"🎯 Polo Ativo & Estratégias",icon:"Target",data:{estrategias:[{texto:"Questionar vínculos entre testemunhas",prioridade:"ALTA"},{texto:"Investigar histórico de depoimentos",prioridade:"MÉDIA"}],proximosPassos:["Solicitar certidões de processos anteriores","Preparar questionário específico para audiência"]}}],[]);return{runAnalysis:_.useCallback(async(f,w)=>{if(!f.trim()){t({title:"Campo obrigatório",description:"Digite uma consulta para executar a análise.",variant:"destructive"});return}if(!i){t({title:"Agente indisponível",description:"O assistente está temporariamente em manutenção.",variant:"destructive"});return}m("loading"),u({role:"user",content:f});const P=u({role:"assistant",content:"",blocks:[]});try{const{data:S,error:$}=await pt.functions.invoke("chat-legal",{body:{message:f,queryType:j(w)}});if($){if($.status===402||$.message?.includes("Workspace out of credits")){const ee=`https://${os()}.functions.supabase.co/chat-legal`;console.warn(`Lovable API ${$.status} at ${ee}`),a("Limite de créditos atingido","As funções de chat/assistente estão temporariamente indisponíveis. Tente novamente mais tarde.",{duration:null}),p(!1),h(P,{content:"Créditos esgotados. Função indisponível."}),m("error");return}throw $}const D=y(w,f);h(P,{content:S.content||"Análise concluída com sucesso.",blocks:D}),l(D),m("success"),t({title:"Análise concluída",description:`Análise ${w==="processo"?"por processo":w==="testemunha"?"por testemunha":"por reclamante"} executada com sucesso.`})}catch(S){console.error("Error in analysis:",S),h(P,{content:"Erro ao executar análise. Tente novamente."}),m("error"),t({title:"Erro na análise",description:S instanceof Error?S.message:"Erro desconhecido ao executar análise.",variant:"destructive"})}},[i,j,y,m,l,u,h,t,a,p]),chatStatus:o,chatResult:n,agentOnline:i}}const Ii=[{kind:"processo",label:"Por Processo",icon:Ht},{kind:"testemunha",label:"Por Testemunha",icon:Wt},{kind:"reclamante",label:"Por Reclamante",icon:Na}];function Fi(){const t=_.useRef(null),[a,s]=_.useState(!1),{chatKind:r,chatInput:o,chatStatus:n,agentOnline:i,setChatKind:m,setChatInput:l,isPiiMasked:u}=K(),{runAnalysis:h}=ki();_.useEffect(()=>{const f=/\d{7}-\d{2}\.\d{4}\.\d{1}\.\d{2}\.\d{4}/.test(o);s(f),f&&r!=="processo"&&m("processo")},[o,r,m]),_.useEffect(()=>{t.current&&(t.current.style.height="auto",t.current.style.height=`${t.current.scrollHeight}px`)},[o]),_.useEffect(()=>{const M=f=>{if(f.key==="/"&&!f.ctrlKey&&!f.altKey&&!f.metaKey){const w=document.activeElement;w?.tagName!=="INPUT"&&w?.tagName!=="TEXTAREA"&&(f.preventDefault(),t.current?.focus())}else f.key==="Escape"&&document.activeElement===t.current&&(l(""),t.current?.blur())};return document.addEventListener("keydown",M),()=>document.removeEventListener("keydown",M)},[l]);const p=async()=>{await h(o.trim(),r)},j=M=>{M.key==="Enter"&&M.ctrlKey&&(M.preventDefault(),p())},y=n==="loading";return e.jsxs("div",{className:"space-y-4",children:[!u&&e.jsxs(He,{className:"bg-amber-50 border-amber-200",children:[e.jsx(lt,{className:"h-4 w-4 text-amber-600"}),e.jsxs(We,{className:"text-amber-800",children:[e.jsx("strong",{children:"Conteúdo assistivo."})," Revisão humana obrigatória. Dados tratados conforme LGPD.",e.jsx("a",{href:"/privacy",className:"underline ml-2",children:"Política de Privacidade"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[Ii.map(({kind:M,label:f,icon:w})=>e.jsxs(H,{variant:r===M?"default":"outline",size:"sm",onClick:()=>m(M),className:"h-8",disabled:y,children:[e.jsx(w,{className:"h-3 w-3 mr-1"}),f]},M)),e.jsx("div",{className:"flex items-center gap-2 ml-auto",children:e.jsxs("div",{className:"flex items-center gap-1",children:[i?e.jsx(Je,{className:"h-3 w-3 text-status-success"}):e.jsx(on,{className:"h-3 w-3 text-status-warning"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:i?"Online":"Manutenção"})]})})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Ya,{ref:t,value:o,onChange:M=>l(M.target.value),onKeyDown:j,placeholder:r==="processo"?"Digite o número CNJ do processo...":r==="testemunha"?"Digite o nome da testemunha...":"Digite o nome do reclamante...",className:"min-h-[80px] max-h-[200px] resize-none pr-20",disabled:y}),a&&e.jsx(ce,{variant:"secondary",className:"absolute top-2 right-2 text-xs",children:"CNJ detectado"}),e.jsx(H,{onClick:p,disabled:!o.trim()||y||!i,className:"absolute bottom-2 right-2 h-8 gap-1",size:"sm",children:y?e.jsxs(e.Fragment,{children:[e.jsx(Ft,{className:"h-3 w-3 animate-spin"}),"Analisando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(va,{className:"h-3 w-3"}),"Executar Análise"]})})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("kbd",{className:"px-1 py-0.5 text-xs font-mono bg-muted border rounded",children:"Ctrl"}),e.jsx("span",{children:"+"}),e.jsx("kbd",{className:"px-1 py-0.5 text-xs font-mono bg-muted border rounded",children:"Enter"}),e.jsx("span",{children:"executar"})]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("kbd",{className:"px-1 py-0.5 text-xs font-mono bg-muted border rounded",children:"/"}),e.jsx("span",{children:"foco"})]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("kbd",{className:"px-1 py-0.5 text-xs font-mono bg-muted border rounded",children:"Esc"}),e.jsx("span",{children:"limpar"})]})]})]})}function Et({label:t,value:a,type:s="default"}){const r=()=>{switch(s){case"reclamante":return"text-blue-700 font-medium";case"reu":return"text-red-700 font-medium";case"status":return"text-green-700";case"observacoes":return"text-muted-foreground text-sm";default:return"text-foreground"}},o=()=>{switch(s){case"status":return a.toLowerCase().includes("ativo")?"default":"secondary";default:return"outline"}};return e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wide",children:t}),e.jsx("div",{className:q("font-medium",r()),children:s==="status"&&a!=="Não informado"?e.jsx(ce,{variant:o(),className:"text-xs",children:a}):e.jsx("span",{children:a})})]})}function Mi({cnj:t,reclamante:a,reu:s,status:r="Não informado",observacoes:o="Sem observações registradas",riscoNivel:n,confianca:i,alerta:m,citacoes:l}){const{toast:u}=Be(),[h,p]=_.useState(!1),j=3,y=l.length>j,M=h?l:l.slice(0,j),f=l.length-j,w=async()=>{const $=`Resumo Executivo - ${t}

Reclamante: ${a}
Réu: ${s}
Status: ${r}
Observações: ${o}

Risco: ${n.toUpperCase()}
Confiança: ${Math.round(i*100)}%
${m?`Alerta: ${m}`:""}

Citações:
${l.map(D=>`• ${D.label}`).join(`
`)}`;try{await navigator.clipboard.writeText($),u({title:"Copiado!",description:"Resumo executivo copiado para a área de transferência."})}catch{u({title:"Erro ao copiar",description:"Não foi possível copiar o conteúdo.",variant:"destructive"})}},P=()=>{window.print(),u({title:"PDF",description:"Abrindo diálogo de impressão..."})},S=()=>{const $={cnj:t,reclamante:a,reu:s,status:r,observacoes:o,riscoNivel:n,confianca:i,alerta:m,citacoes:l},D=new Blob([JSON.stringify($,null,2)],{type:"application/json"}),ee=URL.createObjectURL(D),ae=document.createElement("a");ae.href=ee,ae.download=`resumo-executivo-${t.replace(/[^\w]/g,"-")}.json`,document.body.appendChild(ae),ae.click(),document.body.removeChild(ae),URL.revokeObjectURL(ee),u({title:"JSON exportado",description:"Arquivo JSON baixado com sucesso."})};return e.jsxs(pe,{className:"rounded-2xl border-border/50 transition-shadow hover:shadow-sm","aria-labelledby":"executive-summary",children:[e.jsx(De,{className:"pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(Pe,{id:"executive-summary",className:"text-base font-semibold flex items-center gap-2",children:[e.jsx(ln,{className:"h-4 w-4 text-violet-600","aria-hidden":"true"}),"Resumo Executivo"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(H,{variant:"ghost",size:"sm",onClick:w,className:"h-8 w-8 p-0","aria-label":"Copiar resumo",children:e.jsx(dt,{className:"h-3 w-3"})}),e.jsx(H,{variant:"ghost",size:"sm",onClick:P,className:"h-8 w-8 p-0","aria-label":"Exportar PDF",children:e.jsx(cn,{className:"h-3 w-3"})}),e.jsx(H,{variant:"ghost",size:"sm",onClick:S,className:"h-8 w-8 p-0","aria-label":"Exportar JSON",children:e.jsx(dn,{className:"h-3 w-3"})})]})]})}),e.jsxs(we,{className:"pt-0 space-y-5",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(Et,{label:"Reclamante",value:a,type:"reclamante"}),e.jsx(Et,{label:"Réu",value:s,type:"reu"}),e.jsx(Et,{label:"Status",value:r,type:"status"}),e.jsx(Et,{label:"Observações",value:o,type:"observacoes"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Nível de Risco"}),e.jsx(er,{riscoNivel:n})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Confiança"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(kt,{value:i*100,className:"w-16 h-2"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[Math.round(i*100),"%"]})]})]})]}),m&&e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-muted/50 rounded-lg","aria-live":"polite",children:[e.jsx(wa,{className:"h-4 w-4 text-violet-600","aria-hidden":"true"}),e.jsx("span",{className:"text-sm font-medium",children:m})]})]}),l.length>0&&e.jsxs("div",{className:"pt-3 border-t",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(fs,{className:"h-3 w-3 text-muted-foreground","aria-hidden":"true"}),e.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Citações:"})]}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[M.map(($,D)=>e.jsxs(ce,{variant:"secondary",className:q("text-xs flex items-center gap-1 cursor-pointer hover:bg-secondary/80",$.href&&"underline"),onClick:$.onClick||(()=>$.href&&window.open($.href,"_blank")),children:[e.jsx(fs,{className:"h-3 w-3","aria-hidden":"true"}),$.label]},D)),y&&e.jsx(H,{variant:"ghost",size:"sm",onClick:()=>p(!h),className:"h-6 px-2 text-xs text-muted-foreground hover:text-foreground",children:h?e.jsxs(e.Fragment,{children:[e.jsx(la,{className:"h-3 w-3 mr-1"}),"Menos"]}):e.jsxs(e.Fragment,{children:[e.jsx(xt,{className:"h-3 w-3 mr-1"}),"+",f]})})]})]})]})]})}function Li({secoes:t,textoOriginal:a}){const s=r=>{switch(r){case"alta":return e.jsx(ce,{variant:"destructive",className:"text-xs",children:"Alta"});case"media":return e.jsx(ce,{variant:"secondary",className:"text-xs",children:"Média"});case"baixa":return e.jsx(ce,{variant:"outline",className:"text-xs",children:"Baixa"});default:return null}};return e.jsx("div",{className:"space-y-4",children:e.jsxs(Nn,{type:"multiple",className:"w-full",children:[t.map((r,o)=>e.jsxs(vs,{value:`secao-${o}`,children:[e.jsx(js,{className:"text-left",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:r.titulo}),r.evidencias&&r.evidencias.length>0&&e.jsxs(ce,{variant:"outline",className:"text-xs",children:[r.evidencias.length," evidência",r.evidencias.length>1?"s":""]})]})}),e.jsx(bs,{children:e.jsxs("div",{className:"space-y-4 pt-2",children:[e.jsx("div",{className:"prose prose-sm max-w-none",children:e.jsx("p",{className:"text-sm text-muted-foreground leading-relaxed",children:r.conteudo})}),r.evidencias&&r.evidencias.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h5",{className:"text-xs font-semibold text-muted-foreground uppercase tracking-wide",children:"Evidências"}),e.jsx("div",{className:"grid gap-2",children:r.evidencias.map((n,i)=>typeof n=="string"?e.jsx(pe,{className:"p-3 bg-muted/30",children:e.jsx("p",{className:"text-sm",children:n})},i):e.jsx(pe,{className:"p-3 bg-muted/30",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1",children:[n.tipo&&e.jsx("div",{className:"text-xs text-muted-foreground font-medium mb-1",children:n.tipo}),e.jsx("p",{className:"text-sm",children:n.descricao})]}),n.relevancia&&s(n.relevancia)]})},i))})]}),r.metadados&&e.jsx("div",{className:"pt-2 border-t border-muted",children:e.jsxs("div",{className:"flex flex-wrap gap-4 text-xs text-muted-foreground",children:[r.metadados.fonte&&e.jsxs("span",{children:[e.jsx("strong",{children:"Fonte:"})," ",r.metadados.fonte]}),r.metadados.confiabilidade&&e.jsxs("span",{children:[e.jsx("strong",{children:"Confiabilidade:"})," ",Math.round(r.metadados.confiabilidade*100),"%"]}),r.metadados.timestamp&&e.jsxs("span",{children:[e.jsx("strong",{children:"Processado:"})," ",new Date(r.metadados.timestamp).toLocaleString("pt-BR")]})]})})]})})]},o)),a&&e.jsxs(vs,{value:"texto-original",children:[e.jsx(js,{className:"text-left",children:e.jsx("span",{className:"font-medium",children:"Consulta Original"})}),e.jsx(bs,{children:e.jsx(pe,{className:"p-4 bg-muted/30",children:e.jsx("pre",{className:"text-sm whitespace-pre-wrap font-mono text-muted-foreground",children:a})})})]})]})})}function Dt({citations:t}){if(!t.length)return null;const a=r=>{switch(r){case"por_processo":return e.jsx(ut,{className:"h-3 w-3"});case"por_testemunha":return e.jsx(Na,{className:"h-3 w-3"});default:return e.jsx(ps,{className:"h-3 w-3"})}},s=r=>{switch(r){case"por_processo":return"default";case"por_testemunha":return"secondary";default:return"outline"}};return e.jsxs("div",{className:"pt-3 border-t",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ps,{className:"h-3 w-3 text-muted-foreground"}),e.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Citações:"})]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:t.map((r,o)=>e.jsxs(ce,{variant:s(r.source),className:"text-xs flex items-center gap-1",children:[a(r.source),r.ref]},o))})]})}function $i({onToggle:t,isAnonymized:a,variant:s="default",className:r=""}){const[o,n]=_.useState(!1),i=async()=>{n(!0);try{await new Promise(m=>setTimeout(m,300)),t(!a)}finally{n(!1)}};return s==="minimal"?e.jsx(H,{variant:a?"default":"outline",size:"sm",onClick:i,disabled:o,className:r,children:a?e.jsxs(e.Fragment,{children:[e.jsx(Jt,{className:"h-4 w-4 mr-2"}),"Dados Anonimizados"]}):e.jsxs(e.Fragment,{children:[e.jsx(Ye,{className:"h-4 w-4 mr-2"}),"Dados Completos"]})}):e.jsxs(is,{children:[e.jsx(ls,{asChild:!0,children:e.jsxs(H,{variant:"outline",className:r,children:[e.jsx(Ve,{className:"h-4 w-4 mr-2"}),"Privacidade",e.jsx(xt,{className:"h-4 w-4 ml-2"})]})}),e.jsxs(Mt,{align:"end",className:"w-56",children:[e.jsx(Ot,{onClick:i,disabled:o,children:a?e.jsxs(e.Fragment,{children:[e.jsx(Ye,{className:"h-4 w-4 mr-2"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Mostrar Dados Completos"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Revelar CPFs e nomes reais"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(Jt,{className:"h-4 w-4 mr-2"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Anonimizar Dados"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Mascarar informações sensíveis"})]})]})}),e.jsxs(Ot,{disabled:!0,className:"border-t mt-1 pt-2",children:[e.jsx(Ve,{className:"h-4 w-4 mr-2 text-muted-foreground"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Conforme Art. 6º, VII da LGPD"})]})]})]})}function zi({variant:t="compact",showDetails:a=!1,className:s=""}){return t==="badge"?e.jsx(En,{children:e.jsxs(Dn,{children:[e.jsx(Pn,{asChild:!0,children:e.jsxs(ce,{variant:"secondary",className:`bg-success/10 text-success border-success/20 ${s}`,children:[e.jsx(Ve,{className:"h-3 w-3 mr-1"}),"LGPD Ready"]})}),e.jsx(Ea,{children:e.jsx("p",{children:"Documento em conformidade com a LGPD"})})]})}):t==="compact"?e.jsxs("div",{className:`inline-flex items-center gap-2 px-3 py-2 bg-success/10 border border-success/20 rounded-lg ${s}`,children:[e.jsx(Ve,{className:"h-4 w-4 text-success"}),e.jsx("span",{className:"text-sm font-medium text-success",children:"LGPD Compliant"}),e.jsx(Je,{className:"h-3 w-3 text-success"})]}):e.jsxs("div",{className:`border border-success/20 rounded-lg p-4 bg-success/5 ${s}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"flex items-center justify-center w-10 h-10 bg-success/10 rounded-full",children:e.jsx(Ve,{className:"h-5 w-5 text-success"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-success",children:"Documento LGPD-Ready"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Conforme Lei 13.709/2018"})]}),e.jsx(Je,{className:"h-5 w-5 text-success ml-auto"})]}),a&&e.jsxs("div",{className:"space-y-2 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(un,{className:"h-3 w-3"}),e.jsx("span",{children:"Dados criptografados em trânsito e repouso"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(Ye,{className:"h-3 w-3"}),e.jsx("span",{children:"Informações sensíveis anonimizadas por padrão"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(ut,{className:"h-3 w-3"}),e.jsx("span",{children:"Base legal: Execução regular de direitos (Art. 7º, VI)"})]})]}),e.jsx("div",{className:"mt-3 pt-3 border-t border-success/20",children:e.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.jsx("strong",{children:"Aviso:"})," Este documento contém análise assistida por IA. Validação jurídica humana é obrigatória antes do uso processual."]})})]})}function qi({onExport:t,showPrint:a=!0,disabled:s=!1,showAnonymizeOption:r=!0,isAnonymized:o=!1,onAnonymizeToggle:n,className:i=""}){const{toast:m}=Be(),l=()=>{window.print(),m({title:"Imprimindo",description:"Preparando documento para impressão..."})},u=h=>{t(h,o);const p=o?" (dados anonimizados)":" (dados completos)";m({title:"Exportando",description:`Gerando arquivo ${h.toUpperCase()}${p}... Será registrado no log de auditoria.`})};return e.jsxs("div",{className:`space-y-3 ${i}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(zi,{variant:"badge"}),r&&n&&e.jsx($i,{isAnonymized:o,onToggle:n,variant:"minimal"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[a&&e.jsxs(H,{variant:"outline",size:"sm",onClick:l,disabled:s,className:"gap-2",children:[e.jsx(mn,{className:"h-4 w-4"}),"Imprimir",o&&e.jsx(Ve,{className:"h-3 w-3 text-success"})]}),e.jsxs(H,{variant:"outline",size:"sm",onClick:()=>u("pdf"),disabled:s,className:"gap-2",children:[e.jsx(ut,{className:"h-4 w-4"}),"PDF",o&&e.jsx(Ve,{className:"h-3 w-3 text-success"})]}),e.jsxs(H,{variant:"outline",size:"sm",onClick:()=>u("csv"),disabled:s,className:"gap-2",children:[e.jsx(ns,{className:"h-4 w-4"}),"CSV",o&&e.jsx(Ve,{className:"h-3 w-3 text-success"})]}),e.jsxs(H,{variant:"outline",size:"sm",onClick:()=>u("docx"),disabled:s,className:"gap-2",children:[e.jsx(ut,{className:"h-4 w-4"}),"DOCX",o&&e.jsx(Ve,{className:"h-3 w-3 text-success"})]}),e.jsxs(H,{variant:"outline",size:"sm",onClick:()=>u("json"),disabled:s,className:"gap-2",children:[e.jsx(_a,{className:"h-4 w-4"}),"JSON",o&&e.jsx(Ve,{className:"h-3 w-3 text-success"})]})]})]})}function Vi({blocks:t}){const{toast:a}=Be(),s=()=>{window.print(),a({title:"PDF",description:"Abrindo diálogo de impressão..."})},r=()=>{const i=["Tipo,Conteudo",...t.map(h=>({Tipo:h.title,Conteudo:JSON.stringify(h.data)})).map(h=>`"${h.Tipo}","${h.Conteudo}"`)].join(`
`),m=new Blob([i],{type:"text/csv;charset=utf-8;"}),l=document.createElement("a"),u=URL.createObjectURL(m);l.setAttribute("href",u),l.setAttribute("download",`analise-${Date.now()}.csv`),document.body.appendChild(l),l.click(),document.body.removeChild(l),a({title:"CSV exportado",description:"Arquivo CSV baixado com sucesso."})},o=()=>{const n={timestamp:new Date().toISOString(),blocks:t},i=new Blob([JSON.stringify(n,null,2)],{type:"application/json"}),m=URL.createObjectURL(i),l=document.createElement("a");l.href=m,l.download=`analise-completa-${Date.now()}.json`,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(m),a({title:"JSON exportado",description:"Arquivo JSON baixado com sucesso."})};return!t||t.length===0?null:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-brand-ink",children:"Resultado da Análise"}),e.jsx(qi,{onExport:n=>{switch(n){case"pdf":s();break;case"csv":r();break;case"json":o();break}},showPrint:!0})]}),e.jsx("div",{className:"space-y-4",children:t.map((n,i)=>{switch(n.type){case"executive":return e.jsx(Mi,{cnj:n.data.cnj,reclamante:n.data.reclamante,reu:n.data.reu,status:n.data.status,observacoes:n.data.observacoes,riscoNivel:n.data.riscoNivel,confianca:n.data.confianca,alerta:n.data.alerta,citacoes:n.citations?.map(m=>({label:m.ref,onClick:()=>{console.log("Citation clicked:",m)}}))||[]},i);case"details":return e.jsxs(pe,{className:"rounded-2xl border-border/50",children:[e.jsx(De,{children:e.jsxs(Pe,{className:"text-base font-semibold flex items-center gap-2",children:[e.jsx(ut,{className:"h-4 w-4 text-primary"}),n.title]})}),e.jsxs(we,{children:[e.jsx(Li,{secoes:n.data.secoes,textoOriginal:n.data.textoOriginal}),n.citations&&e.jsx(Dt,{citations:n.citations})]})]},i);case"alerts":return e.jsxs(pe,{className:"rounded-2xl border-status-critical/30 bg-status-critical/5",children:[e.jsx(De,{children:e.jsxs(Pe,{className:"text-base font-semibold flex items-center gap-2",children:[e.jsx(lt,{className:"h-4 w-4 text-destructive"}),n.title]})}),e.jsxs(we,{className:"space-y-3",children:[e.jsxs(He,{className:"border-destructive/30 bg-destructive/10",children:[e.jsx(lt,{className:"h-4 w-4 text-destructive"}),e.jsxs(We,{className:"text-destructive-foreground",children:[e.jsx("strong",{children:"Triangulação Detectada"})," - Padrões suspeitos identificados entre testemunhas"]})]}),e.jsxs(He,{className:"border-status-warning/30 bg-status-warning/10",children:[e.jsx(lt,{className:"h-4 w-4 text-status-warning"}),e.jsxs(We,{className:"text-status-warning",children:[e.jsx("strong",{children:"Depoimentos Repetidos"})," - Narrativas similares encontradas"]})]}),n.data.suspiciousPatterns?.map((m,l)=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-destructive/10 rounded-lg",children:[e.jsx(lt,{className:"h-3 w-3 text-destructive"}),e.jsx("span",{className:"text-sm text-destructive-foreground",children:m})]},l)),e.jsx("div",{className:"mt-4 p-3 bg-muted/50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:["⚠️ ",e.jsx("strong",{children:"Atenção:"})," Possível coordenação entre depoimentos de testemunhas. Recomenda-se investigação detalhada dos vínculos identificados."]})}),n.citations&&e.jsx(Dt,{citations:n.citations})]})]},i);case"strategies":return e.jsx(Bi,{block:n},i);default:return e.jsxs(pe,{className:"rounded-2xl border-border/50",children:[e.jsx(De,{children:e.jsx(Pe,{className:"text-base font-semibold",children:n.title})}),e.jsxs(we,{children:[e.jsx("pre",{className:"text-sm text-muted-foreground whitespace-pre-wrap",children:JSON.stringify(n.data,null,2)}),n.citations&&e.jsx(Dt,{citations:n.citations})]})]},i)}})}),e.jsxs("div",{className:"text-xs text-muted-foreground text-center pt-4 border-t",children:["Relatório gerado às ",new Date().toLocaleTimeString("pt-BR")," • Dados sujeitos à verificação manual conforme LGPD"]})]})}function Bi({block:t}){const{toast:a}=Be(),s=async o=>{try{await navigator.clipboard.writeText(o),a({title:"Copiado!",description:"Recomendação copiada para a área de transferência."})}catch{a({title:"Erro ao copiar",description:"Não foi possível copiar o conteúdo.",variant:"destructive"})}},r=o=>{switch(o?.toUpperCase()){case"ALTA":return"bg-status-critical/15 text-status-critical border-status-critical/30";case"MÉDIA":return"bg-status-warning/15 text-status-warning border-status-warning/30";case"BAIXA":return"bg-status-success/15 text-status-success border-status-success/30";default:return"bg-muted text-muted-foreground border-border"}};return e.jsxs(pe,{className:"rounded-2xl border-status-success/30 bg-status-success/10",children:[e.jsx(De,{children:e.jsxs(Pe,{className:"text-base font-semibold flex items-center gap-2",children:[e.jsx(xs,{className:"h-4 w-4 text-emerald-600"}),t.title]})}),e.jsxs(we,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-medium text-emerald-800",children:"Estratégias Ativas"}),e.jsx(ce,{variant:"secondary",className:"text-xs",children:"Polo Ativo"})]}),t.data.estrategias?.map((o,n)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white/70 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ce,{className:q("text-xs",r(o.prioridade)),children:o.prioridade}),e.jsx("span",{className:"text-sm",children:o.texto})]}),e.jsx(H,{variant:"ghost",size:"sm",onClick:()=>s(o.texto),className:"h-8 w-8 p-0 shrink-0",children:e.jsx(dt,{className:"h-3 w-3"})})]},n))]}),t.data.acoesDefensivas&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-emerald-800",children:"Ações Defensivas"}),t.data.acoesDefensivas.map((o,n)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white/70 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ce,{className:q("text-xs",r(o.prioridade)),children:o.prioridade}),e.jsx("span",{className:"text-sm",children:o.texto})]}),e.jsx(H,{variant:"ghost",size:"sm",onClick:()=>s(o.texto),className:"h-8 w-8 p-0 shrink-0",children:e.jsx(dt,{className:"h-3 w-3"})})]},n))]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xs,{className:"h-4 w-4 text-emerald-600"}),e.jsx("h4",{className:"font-medium text-emerald-800",children:"Próximos Passos"})]}),t.data.proximosPassos?.map((o,n)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white/70 rounded-lg border",children:[e.jsx("span",{className:"text-sm",children:o}),e.jsx(H,{variant:"ghost",size:"sm",onClick:()=>s(o),className:"h-8 w-8 p-0 shrink-0",children:e.jsx(dt,{className:"h-3 w-3"})})]},n))]}),t.citations&&e.jsx(Dt,{citations:t.citations})]})]})}function Ui(){const{loadingHints:t,currentHintIndex:a,nextHint:s}=K(),r=_.useRef(null);return _.useEffect(()=>(r.current&&clearInterval(r.current),r.current=setInterval(()=>{s()},800),()=>{r.current&&clearInterval(r.current)}),[s]),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx(hn,{className:"h-4 w-4 text-primary"})}),e.jsx("div",{className:"flex-1 max-w-4xl",children:e.jsx(pe,{className:"bg-card border-violet-200 shadow-sm",children:e.jsxs(we,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ft,{className:"h-4 w-4 animate-spin text-violet-600"}),e.jsx("span",{className:"text-sm text-violet-700 font-medium",children:t[a]})]}),e.jsx("div",{className:"mt-3 flex gap-1",children:Array.from({length:3}).map((o,n)=>e.jsx("div",{className:"h-1 w-8 rounded-full bg-violet-200 animate-pulse",style:{animationDelay:`${n*.2}s`,animationDuration:"1s"}},n))})]})})})]})}const Ji=()=>{const t=fn(),[a,s]=pn(),{user:r,loading:o}=wn(),{toast:n}=Be(),i=K(Xa),m=K(so),l=K(ao),u=K(ro);K(Za);const h=K(no),p=K(oo),j=K(io),y=K(lo),M=K(co),f=_s(y,400),w=_s(M,400),P=_.useRef(null),S=_.useRef(null),$=K(N=>N.chatResult),D=K(N=>N.chatStatus),ee=K(N=>N.setActiveTab),ae=K(N=>N.setProcessos),C=K(N=>N.setTestemunhas),c=K(N=>N.setIsLoading),d=K(N=>N.setLastUpdate),x=K(N=>N.setError),g=K(N=>N.setIsImportModalOpen),b=K(N=>N.loadViews),[A,Q]=_.useState(!0),te=N=>N.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),re=_.useMemo(()=>{const N=m.length,v=l.length,T=m.filter(Y=>Y.classificacao_final==="Risco Alto").length,O=l.filter(Y=>Y.foi_testemunha_em_ambos_polos===!0).length,U=(Y,L)=>L>0?Math.round(Y/L*100):0;return{totalProcessos:N,totalTestemunhas:v,processosAltoRisco:T,testemunhasAmbosPolos:O,pctProcAlto:U(T,N),pctAmbos:U(O,v)}},[m,l]),k=N=>u?"loading":h?navigator.onLine?"error":"offline":N.length?"success":"empty",G=k(m),I=k(l);_.useEffect(()=>{if(!o&&!r){t("/login");return}},[r,o,t]),_.useEffect(()=>{r&&b(r.id)},[r,b]),_.useEffect(()=>{const N=a.get("tab"),v=a.get("view");N&&(N==="processos"||N==="testemunhas")&&N!==i&&ee(N),v==="chat"&&setTimeout(()=>{document.getElementById("chat-assistant-section")?.scrollIntoView({behavior:"smooth",block:"start"})},100)},[a,i,ee]);const ue=N=>{const v=N;ee(v),s({tab:v})},z=_.useCallback(async()=>{if(!r)return;P.current?.abort(),S.current?.abort();const N=new AbortController,v=new AbortController;P.current=N,S.current=v,c(!0),x(!1);try{const[T,O]=await Promise.all([Ai(Os({page:1,limit:1e3,filters:f}),N.signal),Oi(Os({page:1,limit:1e3,filters:w}),v.signal)]);if(N.signal.aborted||v.signal.aborted)return;ae(T.data),C(O.data);const U=T.error||O.error;U?(x(!0,U),n({title:"Falha ao carregar dados",description:U,variant:"destructive"})):(A&&(d(new Date),Q(!1)),console.log("Data loaded successfully:",{processos:T.data.length,testemunhas:O.data.length}))}catch(T){if(T?.name==="AbortError")return;console.error("Erro ao carregar dados:",T);const O=T instanceof Error?T.message:"Verifique filtros e tente novamente.";x(!0,O),n({title:"Falha ao carregar dados",description:O,variant:"destructive"})}finally{!N.signal.aborted&&!v.signal.aborted&&c(!1)}},[r,f,w,ae,C,c,x,d,A,n]);return _.useEffect(()=>(z(),()=>{P.current?.abort(),S.current?.abort()}),[z]),o?e.jsx("div",{className:"min-h-screen flex items-center justify-center","aria-live":"polite",children:e.jsx("div",{className:"animate-pulse text-muted-foreground",children:"Verificando autenticação..."})}):r?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("div",{className:"border-b border-border/50 bg-card",children:e.jsx("div",{className:"container mx-auto px-6 py-6",children:e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold flex items-center gap-3",children:[e.jsx(xn,{className:"h-8 w-8 text-primary","aria-hidden":"true"}),"Mapa de Testemunhas"]}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Análise estratégica de testemunhas e processos judiciais"}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(gn,{className:"h-4 w-4","aria-hidden":"true"}),e.jsxs("span",{children:["Última atualização: ",j?te(j):"—"]})]}),e.jsx(ot,{orientation:"vertical",className:"h-4"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ba,{className:"h-4 w-4","aria-hidden":"true"}),e.jsx("span",{children:"Dados em tempo real"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(H,{variant:"outline",onClick:()=>g(!0),className:"gap-2","aria-label":"Importar dados via Excel",children:[e.jsx(ut,{className:"h-4 w-4","aria-hidden":"true"}),"Importar Dados"]}),e.jsx(ii,{}),e.jsx(Ni,{data:i==="processos"?m:l,fileName:i==="processos"?"por_processo.csv":"por_testemunha.csv"})]})]})})}),e.jsxs("div",{className:"container mx-auto px-6 py-6",children:[h&&e.jsx(pe,{className:"rounded-2xl border-destructive/50 bg-destructive/5 mb-6",children:e.jsx(we,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2 text-destructive",children:[e.jsx(lt,{className:"h-4 w-4","aria-hidden":"true"}),e.jsx("span",{className:"font-medium",children:"Erro:"}),e.jsx("span",{className:"text-sm",children:p})]})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsxs(pe,{className:"rounded-2xl border-border/50 hover:shadow-md transition-shadow",children:[e.jsx(De,{className:"pb-3",children:e.jsxs(Pe,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Ht,{className:"h-4 w-4 text-primary","aria-hidden":"true"}),"Total de Processos"]})}),e.jsxs(we,{children:[e.jsx("div",{className:"text-3xl font-bold text-primary",children:re.totalProcessos}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Processos cadastrados"})]})]}),e.jsxs(pe,{className:"rounded-2xl border-border/50 hover:shadow-md transition-shadow",children:[e.jsx(De,{className:"pb-3",children:e.jsxs(Pe,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Wt,{className:"h-4 w-4 text-emerald-600","aria-hidden":"true"}),"Total de Testemunhas"]})}),e.jsxs(we,{children:[e.jsx("div",{className:"text-3xl font-bold text-emerald-600",children:re.totalTestemunhas}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Testemunhas identificadas"})]})]}),e.jsxs(pe,{className:"rounded-2xl border-border/50 hover:shadow-md transition-shadow",children:[e.jsx(De,{className:"pb-3",children:e.jsxs(Pe,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(lt,{className:"h-4 w-4 text-destructive","aria-hidden":"true"}),"Processos Alto Risco"]})}),e.jsxs(we,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-3xl font-bold text-destructive",children:re.processosAltoRisco}),e.jsxs(ce,{variant:"destructive",className:"text-xs",children:[re.pctProcAlto,"%"]})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Requerem atenção especial"})]})]}),e.jsxs(pe,{className:"rounded-2xl border-border/50 hover:shadow-md transition-shadow",children:[e.jsx(De,{className:"pb-3",children:e.jsxs(Pe,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(wa,{className:"h-4 w-4 text-orange-500","aria-hidden":"true"}),"Ambos os Polos"]})}),e.jsxs(we,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-3xl font-bold text-orange-600",children:re.testemunhasAmbosPolos}),e.jsxs(ce,{variant:"secondary",className:"text-xs",children:[re.pctAmbos,"%"]})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Testemunhas em ambos os polos"})]})]})]}),e.jsxs("div",{id:"chat-assistant-section",className:"mb-8 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Assistente de Análise"}),e.jsx(ce,{variant:"outline",className:"text-xs",children:"IA Assistiva • LGPD Compliant"})]}),e.jsx(Fi,{}),$&&e.jsx("div",{className:"mt-6",children:e.jsx(Vi,{blocks:$})}),D==="loading"&&e.jsx("div",{className:"mt-6",children:e.jsx(Ui,{})})]}),e.jsx("div",{className:"mt-8",children:e.jsxs(yn,{value:i,onValueChange:ue,children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4 mb-6",children:[e.jsxs(Cn,{className:"grid w-full lg:w-auto grid-cols-2",children:[e.jsxs(Ns,{value:"processos",className:"flex items-center gap-2",children:[e.jsx(Ht,{className:"h-4 w-4","aria-hidden":"true"}),"Por Processo"]}),e.jsxs(Ns,{value:"testemunhas",className:"flex items-center gap-2",children:[e.jsx(Wt,{className:"h-4 w-4","aria-hidden":"true"}),"Por Testemunha"]})]}),e.jsxs("div",{className:"flex gap-2",children:[r&&e.jsx(No,{userId:r.id}),e.jsx(_o,{})]})]}),e.jsxs(ws,{value:"processos",className:"space-y-6",children:[e.jsx(jo,{}),G!=="success"?e.jsx(Nt,{status:G,onRetry:z}):e.jsx(fo,{data:m})]}),e.jsxs(ws,{value:"testemunhas",className:"space-y-6",children:[e.jsx(bo,{}),I!=="success"?e.jsx(Nt,{status:I,onRetry:z}):e.jsx(po,{data:l,status:I,onRetry:z})]})]})}),e.jsx(Yo,{}),e.jsx(oi,{})]})]}):null},Zi=Object.freeze(Object.defineProperty({__proto__:null,default:Ji},Symbol.toStringTag,{value:"Module"}));export{Un as A,qa as B,Ba as C,An as D,qi as E,Ua as F,Va as G,Ha as H,Ja as I,Gi as J,Yi as K,Ge as L,it as M,Zi as N,kt as P,et as S,Ya as T,Ke as a,tt as b,Qe as c,ve as d,Pa as e,Aa as f,Oa as g,En as h,Dn as i,Pn as j,Ea as k,is as l,ls as m,Mt as n,Ot as o,Kt as p,Ma as q,Nt as r,Ia as s,Xi as t,Bn as u,di as v,kn as w,Ka as x,ka as y,za as z};
