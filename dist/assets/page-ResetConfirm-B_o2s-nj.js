import{r as u,j as e,a7 as y,ap as S,u as P,y as k,L as C,v as T,ac as w,t as E}from"./vendor-Dx8Do5_C.js";import{r as L,x as l,B as d,u as z,s as c,w as O}from"./page-About-B_AWXTGA.js";import{A as V,g as A,L as U,I as G,u as v,M as H}from"./page-Login-DUMc8B3X.js";import{U as M}from"./page-MapaPage-CgcLbSOW.js";import"./page-DemoMapaTestemunhas-Dgaec6yI.js";const p=[{label:"Pelo menos 6 caracteres",test:s=>s.length>=6}],F=({password:s})=>{const m=u.useMemo(()=>{if(!s)return{score:0,percentage:0,strength:"Muito fraca",color:"bg-gray-300",requirements:p.map(t=>({...t,met:!1}))};const i=p.map(t=>({...t,met:t.test(s)})),r=i.filter(t=>t.met).length,b=r/p.length*100,a=r>=1?"Forte":"Muito fraca",N=r>=1?"bg-green-500":"bg-red-500";return{score:r,percentage:b,strength:a,color:N,requirements:i}},[s]);return s?e.jsxDEV("div",{className:"space-y-3 p-3 bg-muted/30 rounded-lg border",children:[e.jsxDEV("div",{className:"space-y-1",children:[e.jsxDEV("div",{className:"flex justify-between text-sm",children:[e.jsxDEV("span",{className:"text-muted-foreground",children:"Força da senha:"},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/components/auth/PasswordStrength.tsx",lineNumber:59,columnNumber:11},void 0),e.jsxDEV("span",{className:"font-medium",children:m.strength},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/components/auth/PasswordStrength.tsx",lineNumber:60,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/components/auth/PasswordStrength.tsx",lineNumber:58,columnNumber:9},void 0),e.jsxDEV(M,{value:m.percentage,className:"h-2"},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/components/auth/PasswordStrength.tsx",lineNumber:62,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/components/auth/PasswordStrength.tsx",lineNumber:57,columnNumber:7},void 0),e.jsxDEV("div",{className:"space-y-1",children:m.requirements.map((i,r)=>e.jsxDEV("div",{className:"flex items-center gap-2 text-xs",children:[i.met?e.jsxDEV(y,{className:"h-3 w-3 text-green-600","aria-hidden":"true",focusable:"false"},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/components/auth/PasswordStrength.tsx",lineNumber:69,columnNumber:15},void 0):e.jsxDEV(S,{className:"h-3 w-3 text-muted-foreground","aria-hidden":"true",focusable:"false"},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/components/auth/PasswordStrength.tsx",lineNumber:75,columnNumber:15},void 0),e.jsxDEV("span",{className:i.met?"text-green-600":"text-muted-foreground",children:i.label},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/components/auth/PasswordStrength.tsx",lineNumber:81,columnNumber:13},void 0)]},r,!0,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/components/auth/PasswordStrength.tsx",lineNumber:67,columnNumber:11},void 0))},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/components/auth/PasswordStrength.tsx",lineNumber:65,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/components/auth/PasswordStrength.tsx",lineNumber:56,columnNumber:5},void 0):null},_=z({password:O().min(H,`Mínimo de ${H} caracteres`),confirmPassword:O()}).refine(s=>s.password===s.confirmPassword,{message:"Senhas não conferem",path:["confirmPassword"]}),$=()=>{const s=P(),[m,i]=u.useState(!1),[r,b]=u.useState(!1),[a,N]=u.useState(!1),[t,f]=u.useState(null),h=new URLSearchParams(window.location.hash.slice(1)),x=h.get("access_token"),D=h.get("refresh_token");u.useEffect(()=>{window.location.hash.includes("access_token")&&(window.location.hash="")},[]);const n=k({resolver:L(_),defaultValues:{password:"",confirmPassword:""}}),j=n.watch("password");u.useEffect(()=>{(async()=>{if(!x||!D){f(!1);return}if(!c){f(!0);return}try{const{error:o}=await c.auth.setSession({access_token:x,refresh_token:D});f(!o)}catch(o){console.error("Token validation error:",o),f(!1)}})()},[x,D]);const R=async g=>{i(!0);try{if(!c){v.success("Senha atualizada!",{description:"Sua senha foi redefinida com sucesso (modo demo)."}),s("/login");return}const{error:o}=await c.auth.updateUser({password:g.password});if(o)throw o;v.success("Senha atualizada!",{description:"Sua senha foi redefinida com sucesso. Faça login com a nova senha."});try{await c.auth.refreshSession()}catch{}await c.auth.signOut(),s("/login")}catch(o){console.error("Password update error:",o),v.error("Erro ao atualizar senha",{description:"Não foi possível atualizar a senha. Tente novamente."})}finally{i(!1)}};return t===null?e.jsxDEV("div",{className:"min-h-screen bg-gradient-subtle flex flex-col justify-center px-6 py-12",children:e.jsxDEV("div",{className:"mx-auto w-full max-w-md",children:e.jsxDEV("div",{className:"text-center space-y-4",children:[e.jsxDEV(C,{className:"h-8 w-8 animate-spin mx-auto text-primary"},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:138,columnNumber:13},void 0),e.jsxDEV("p",{className:"text-sm text-muted-foreground",children:"Validando link de redefinição..."},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:139,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:137,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:136,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:135,columnNumber:7},void 0):t?e.jsxDEV("div",{className:"min-h-screen bg-gradient-subtle flex flex-col justify-center px-6 py-12",children:e.jsxDEV("div",{className:"mx-auto w-full max-w-md",children:[e.jsxDEV("div",{className:"flex items-center justify-center mb-8",children:e.jsxDEV("div",{className:"flex items-center space-x-3",children:[e.jsxDEV("img",{src:l.logo.mark,alt:l.name,className:"w-10 h-10 object-contain",loading:"lazy"},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:215,columnNumber:13},void 0),e.jsxDEV("div",{children:[e.jsxDEV("h1",{className:"text-2xl font-bold text-foreground",children:l.name},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:222,columnNumber:15},void 0),e.jsxDEV("p",{className:"text-sm text-muted-foreground",children:"Assistente de Testemunhas"},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:225,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:221,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:214,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:213,columnNumber:9},void 0),e.jsxDEV(V,{title:"Nova senha",description:"Defina uma senha segura para sua conta",children:e.jsxDEV("div",{className:"space-y-6",children:[e.jsxDEV("div",{className:"text-center",children:[e.jsxDEV("div",{className:"mx-auto p-3 bg-primary/10 rounded-full w-fit mb-4",children:e.jsxDEV(T,{className:"h-6 w-6 text-primary"},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:239,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:238,columnNumber:15},void 0),e.jsxDEV("p",{className:"text-sm text-muted-foreground",children:"Link válido. Defina sua nova senha abaixo."},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:241,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:237,columnNumber:13},void 0),e.jsxDEV("form",{onSubmit:n.handleSubmit(R),className:"space-y-4",children:[e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(U,{htmlFor:"password",children:"Nova senha"},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:252,columnNumber:17},void 0),e.jsxDEV("div",{className:"relative",children:[e.jsxDEV(G,{id:"password",type:r?"text":"password",placeholder:"••••••••","aria-invalid":!!n.formState.errors.password,"aria-describedby":"reset-password-error",...n.register("password"),className:n.formState.errors.password?"border-destructive pr-10":"pr-10"},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:254,columnNumber:19},void 0),e.jsxDEV(d,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 hover:bg-transparent",onClick:()=>b(!r),"aria-label":r?"Ocultar senha":"Mostrar senha","aria-pressed":r,children:r?e.jsxDEV(w,{className:"h-4 w-4 text-muted-foreground","aria-hidden":"true",focusable:"false"},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:279,columnNumber:23},void 0):e.jsxDEV(E,{className:"h-4 w-4 text-muted-foreground","aria-hidden":"true",focusable:"false"},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:285,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:267,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:253,columnNumber:17},void 0),n.formState.errors.password&&e.jsxDEV("p",{id:"reset-password-error",className:"text-sm text-destructive",role:"alert","aria-live":"polite",children:n.formState.errors.password.message},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:294,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:251,columnNumber:15},void 0),j&&e.jsxDEV(F,{password:j},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:306,columnNumber:33},void 0),e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(U,{htmlFor:"confirmPassword",children:"Confirmar nova senha"},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:310,columnNumber:17},void 0),e.jsxDEV("div",{className:"relative",children:[e.jsxDEV(G,{id:"confirmPassword",type:a?"text":"password",placeholder:"••••••••","aria-invalid":!!n.formState.errors.confirmPassword,"aria-describedby":"reset-confirm-password-error",...n.register("confirmPassword"),className:n.formState.errors.confirmPassword?"border-destructive pr-10":"pr-10"},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:312,columnNumber:19},void 0),e.jsxDEV(d,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 hover:bg-transparent",onClick:()=>N(!a),"aria-label":a?"Ocultar senha":"Mostrar senha","aria-pressed":a,children:a?e.jsxDEV(w,{className:"h-4 w-4 text-muted-foreground","aria-hidden":"true",focusable:"false"},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:337,columnNumber:23},void 0):e.jsxDEV(E,{className:"h-4 w-4 text-muted-foreground","aria-hidden":"true",focusable:"false"},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:343,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:325,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:311,columnNumber:17},void 0),n.formState.errors.confirmPassword&&e.jsxDEV("p",{id:"reset-confirm-password-error",className:"text-sm text-destructive",role:"alert","aria-live":"polite",children:n.formState.errors.confirmPassword.message},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:352,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:309,columnNumber:15},void 0),e.jsxDEV(d,{type:"submit",className:"w-full",disabled:m,children:m?e.jsxDEV(e.Fragment,{children:[e.jsxDEV(C,{className:"h-4 w-4 animate-spin mr-2"},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:366,columnNumber:21},void 0),"Atualizando senha..."]},void 0,!0,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:365,columnNumber:19},void 0):"Atualizar senha"},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:363,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:246,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:236,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:232,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:211,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:210,columnNumber:5},void 0):e.jsxDEV("div",{className:"min-h-screen bg-gradient-subtle flex flex-col justify-center px-6 py-12",children:e.jsxDEV("div",{className:"mx-auto w-full max-w-md",children:[e.jsxDEV("div",{className:"flex items-center justify-center mb-8",children:e.jsxDEV("div",{className:"flex items-center space-x-3",children:[e.jsxDEV("img",{src:l.logo.mark,alt:l.name,className:"w-10 h-10 object-contain",loading:"lazy"},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:156,columnNumber:15},void 0),e.jsxDEV("div",{children:[e.jsxDEV("h1",{className:"text-2xl font-bold text-foreground",children:l.name},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:163,columnNumber:17},void 0),e.jsxDEV("p",{className:"text-sm text-muted-foreground",children:"Assistente de Testemunhas"},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:166,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:162,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:155,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:154,columnNumber:11},void 0),e.jsxDEV(V,{title:"Link inválido",description:"O link de redefinição não é válido",children:e.jsxDEV("div",{className:"text-center space-y-6",children:[e.jsxDEV(A,{variant:"error",title:"Link expirado ou inválido",children:e.jsxDEV("div",{className:"space-y-2 text-sm",children:[e.jsxDEV("p",{children:"Este link pode ter expirado ou já foi usado."},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:180,columnNumber:19},void 0),e.jsxDEV("ul",{className:"list-disc list-inside space-y-1 text-left",children:[e.jsxDEV("li",{children:"Links de redefinição expiram em 1 hora"},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:182,columnNumber:21},void 0),e.jsxDEV("li",{children:"Cada link só pode ser usado uma vez"},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:183,columnNumber:21},void 0),e.jsxDEV("li",{children:"Certifique-se de usar o link mais recente"},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:184,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:181,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:179,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:178,columnNumber:15},void 0),e.jsxDEV("div",{className:"space-y-3",children:[e.jsxDEV(d,{onClick:()=>s("/reset"),className:"w-full",children:"Solicitar novo link"},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:190,columnNumber:17},void 0),e.jsxDEV(d,{variant:"ghost",onClick:()=>s("/login"),className:"w-full",children:"Voltar ao login"},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:194,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:189,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:177,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:173,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:152,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/pages/ResetConfirm.tsx",lineNumber:151,columnNumber:7},void 0)};export{$ as default};
