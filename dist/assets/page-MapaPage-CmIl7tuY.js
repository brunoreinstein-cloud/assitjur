import{r as h,j as e,ai as ka,aj as Mn,ak as Ln,al as qn,am as kt,an as hs,ao as At,ap as Aa,aq as ut,ar as Ht,as as Jt,at as fs,au as Pa,av as Oa,aw as zn,ax as Ia,ay as Bn,az as Fa,aA as $a,aB as Ma,aC as Vn,aD as La,aE as qa,aF as za,aG as Ba,a9 as Hs,aH as Va,aI as Un,aJ as Ua,aK as Ha,aL as Hn,aM as Jn,aN as Tt,aO as pt,aP as zt,N as Rt,S as Wn,aQ as Ja,aR as Kn,aS as Gn,aT as Wa,aU as Yn,a2 as Ka,aV as Ga,aW as Qn,aX as Ya,aY as Qa,aZ as Xa,a_ as Za,a$ as er,b0 as Xn,b1 as Zn,b2 as eo,b3 as to,b4 as tr,b5 as so,C as Pt,b6 as ao,b7 as sr,b8 as ro,b9 as ar,ba as no,bb as oo,bc as rr,n as nr,bd as or,be as ir,bf as lr,bg as mt,bh as io,L as Dt,w as nt,bi as cr,bj as dr,af as Bt,bk as lo,bl as co,R as q,x as Ze,bm as Ds,bn as uo,bo as mo,bp as ho,bq as fo,br as Js,bs as ks,q as rs,X as po,z as Ws,bt as xo,Z as go,ad as ns,V as ur,bu as et,bv as vo,f as Qe,ae as As,D as mr,bw as jo,u as Ks,ag as tt,U as Vt,bx as bo,by as os,bz as No,E as Ps,bA as wo,W as Os,bB as yo,bC as _o,bD as Co,i as hr,bE as ia,t as So,bF as To,m as la,bG as Eo,bH as Ro,bI as fr,bJ as Do,bK as ko,bL as Ao,ah as Po,K as Oo,h as Io,bM as Fo,ac as ca,bN as da}from"./vendor-DjGBFEeb.js";import{j as k,l as $o,x as pr,y as Mo,z as Lo,D as Ve,a as te,B as K,S as jt,n as Ge,p as Ye,s as Fe,C as ge,b as Ae,c as Pe,m as Nt,d as we,_ as qo,r as Ot,E as Be,v as ze,Z as is,G as zo,H as xs,I as Bo,J as Vo,K as Uo,A as Ho,f as ua,g as ma,h as ha}from"./page-About-C9AEn_cr.js";import{L as ke,I as lt,T as xr,a as gr,b as ls,c as cs,w as vr,u as gs,d as Is,l as Ie,e as Jo}from"./page-Login-BicjLTnC.js";import{P as jr,a as br,b as Nr,T as wr,c as yr,d as ds,e as Re,f as _r,g as De}from"./page-DemoMapaTestemunhas-DGvz_qiH.js";const Cr=Mn,Lt=Ln,qt=qn,St=h.forwardRef(({className:t,sideOffset:a=4,...s},r)=>e.jsx(ka,{ref:r,sideOffset:a,className:k("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...s}));St.displayName=ka.displayName;const Sr=fs,Qc=Pa,Wo=hs,Tr=h.forwardRef(({className:t,...a},s)=>e.jsx(kt,{ref:s,className:k("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...a}));Tr.displayName=kt.displayName;const Gs=h.forwardRef(({className:t,children:a,...s},r)=>e.jsxs(Wo,{children:[e.jsx(Tr,{}),e.jsxs(At,{ref:r,className:k("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...s,children:[a,e.jsxs(Aa,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(ut,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Gs.displayName=At.displayName;const Er=({className:t,...a})=>e.jsx("div",{className:k("flex flex-col space-y-1.5 text-center sm:text-left",t),...a});Er.displayName="DialogHeader";const Ko=({className:t,...a})=>e.jsx("div",{className:k("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a});Ko.displayName="DialogFooter";const Rr=h.forwardRef(({className:t,...a},s)=>e.jsx(Ht,{ref:s,className:k("text-lg font-semibold leading-none tracking-tight",t),...a}));Rr.displayName=Ht.displayName;const Dr=h.forwardRef(({className:t,...a},s)=>e.jsx(Jt,{ref:s,className:k("text-sm text-muted-foreground",t),...a}));Dr.displayName=Jt.displayName;const Ys=h.forwardRef(({className:t,...a},s)=>e.jsx(Oa,{className:k("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...a,ref:s,children:e.jsx(zn,{className:k("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));Ys.displayName=Oa.displayName;const us=h.forwardRef(({className:t,value:a,...s},r)=>e.jsx(Ia,{ref:r,className:k("relative h-2 w-full overflow-hidden rounded-full bg-secondary",t),...s,children:e.jsx(Bn,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(a||0)}%)`}})}));us.displayName=Ia.displayName;const kr=fs,Go=Pa,Yo=hs,Ar=h.forwardRef(({className:t,...a},s)=>e.jsx(kt,{className:k("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...a,ref:s}));Ar.displayName=kt.displayName;const Qo=$o("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),Qs=h.forwardRef(({side:t="right",className:a,children:s,...r},n)=>e.jsxs(Yo,{children:[e.jsx(Ar,{}),e.jsxs(At,{ref:n,className:k(Qo({side:t}),a),...r,children:[s,e.jsxs(Aa,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[e.jsx(ut,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Qs.displayName=At.displayName;const Xs=({className:t,...a})=>e.jsx("div",{className:k("flex flex-col space-y-2 text-center sm:text-left",t),...a});Xs.displayName="SheetHeader";const Zs=h.forwardRef(({className:t,...a},s)=>e.jsx(Ht,{ref:s,className:k("text-lg font-semibold text-foreground",t),...a}));Zs.displayName=Ht.displayName;const ea=h.forwardRef(({className:t,...a},s)=>e.jsx(Jt,{ref:s,className:k("text-sm text-muted-foreground",t),...a}));ea.displayName=Jt.displayName;const Wt=Hn,Kt=Jn,Xo=h.forwardRef(({className:t,inset:a,children:s,...r},n)=>e.jsxs(Fa,{ref:n,className:k("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",a&&"pl-8",t),...r,children:[s,e.jsx($a,{className:"ml-auto h-4 w-4"})]}));Xo.displayName=Fa.displayName;const Zo=h.forwardRef(({className:t,...a},s)=>e.jsx(Ma,{ref:s,className:k("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...a}));Zo.displayName=Ma.displayName;const It=h.forwardRef(({className:t,sideOffset:a=4,...s},r)=>e.jsx(Vn,{children:e.jsx(La,{ref:r,sideOffset:a,className:k("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...s})}));It.displayName=La.displayName;const ht=h.forwardRef(({className:t,inset:a,...s},r)=>e.jsx(qa,{ref:r,className:k("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a&&"pl-8",t),...s}));ht.displayName=qa.displayName;const Pr=h.forwardRef(({className:t,children:a,checked:s,...r},n)=>e.jsxs(za,{ref:n,className:k("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:s,...r,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Ba,{children:e.jsx(Hs,{className:"h-4 w-4"})})}),a]}));Pr.displayName=za.displayName;const ei=h.forwardRef(({className:t,children:a,...s},r)=>e.jsxs(Va,{ref:r,className:k("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...s,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Ba,{children:e.jsx(Un,{className:"h-2 w-2 fill-current"})})}),a]}));ei.displayName=Va.displayName;const ti=h.forwardRef(({className:t,inset:a,...s},r)=>e.jsx(Ua,{ref:r,className:k("px-2 py-1.5 text-sm font-semibold",a&&"pl-8",t),...s}));ti.displayName=Ua.displayName;const Fs=h.forwardRef(({className:t,...a},s)=>e.jsx(Ha,{ref:s,className:k("-mx-1 my-1 h-px bg-muted",t),...a}));Fs.displayName=Ha.displayName;var fa=1,si=.9,ai=.8,ri=.17,vs=.1,js=.999,ni=.9999,oi=.99,ii=/[\\\/_+.#"@\[\(\{&]/,li=/[\\\/_+.#"@\[\(\{&]/g,ci=/[\s-]/,Or=/[\s-]/g;function $s(t,a,s,r,n,o,i){if(o===a.length)return n===t.length?fa:oi;var l=`${n},${o}`;if(i[l]!==void 0)return i[l];for(var m=r.charAt(o),d=s.indexOf(m,n),x=0,f,w,y,z;d>=0;)f=$s(t,a,s,r,d+1,o+1,i),f>x&&(d===n?f*=fa:ii.test(t.charAt(d-1))?(f*=ai,y=t.slice(n,d-1).match(li),y&&n>0&&(f*=Math.pow(js,y.length))):ci.test(t.charAt(d-1))?(f*=si,z=t.slice(n,d-1).match(Or),z&&n>0&&(f*=Math.pow(js,z.length))):(f*=ri,n>0&&(f*=Math.pow(js,d-n))),t.charAt(d)!==a.charAt(o)&&(f*=ni)),(f<vs&&s.charAt(d-1)===r.charAt(o+1)||r.charAt(o+1)===r.charAt(o)&&s.charAt(d-1)!==r.charAt(o))&&(w=$s(t,a,s,r,d+1,o+2,i),w*vs>f&&(f=w*vs)),f>x&&(x=f),d=s.indexOf(m,d+1);return i[l]=x,x}function pa(t){return t.toLowerCase().replace(Or," ")}function di(t,a,s){return t=s&&s.length>0?`${t+" "+s.join(" ")}`:t,$s(t,a,pa(t),pa(a),0,0,{})}var Ft='[cmdk-group=""]',bs='[cmdk-group-items=""]',ui='[cmdk-group-heading=""]',Ir='[cmdk-item=""]',xa=`${Ir}:not([aria-disabled="true"])`,Ms="cmdk-item-select",_t="data-value",mi=(t,a,s)=>di(t,a,s),Fr=h.createContext(void 0),Gt=()=>h.useContext(Fr),$r=h.createContext(void 0),ta=()=>h.useContext($r),Mr=h.createContext(void 0),Lr=h.forwardRef((t,a)=>{let s=Ct(()=>{var j,b;return{search:"",value:(b=(j=t.value)!=null?j:t.defaultValue)!=null?b:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),r=Ct(()=>new Set),n=Ct(()=>new Map),o=Ct(()=>new Map),i=Ct(()=>new Set),l=qr(t),{label:m,children:d,value:x,onValueChange:f,filter:w,shouldFilter:y,loop:z,disablePointerSelection:v=!1,vimBindings:J=!0,...A}=t,D=Tt(),I=Tt(),P=Tt(),G=h.useRef(null),U=yi();wt(()=>{if(x!==void 0){let j=x.trim();s.current.value=j,S.emit()}},[x]),wt(()=>{U(6,$)},[]);let S=h.useMemo(()=>({subscribe:j=>(i.current.add(j),()=>i.current.delete(j)),snapshot:()=>s.current,setState:(j,b,C)=>{var g,E,F,O;if(!Object.is(s.current[j],b)){if(s.current[j]=b,j==="search")T(),p(),U(1,N);else if(j==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let R=document.getElementById(P);R?R.focus():(g=document.getElementById(D))==null||g.focus()}if(U(7,()=>{var R;s.current.selectedItemId=(R=Z())==null?void 0:R.id,S.emit()}),C||U(5,$),((E=l.current)==null?void 0:E.value)!==void 0){let R=b??"";(O=(F=l.current).onValueChange)==null||O.call(F,R);return}}S.emit()}},emit:()=>{i.current.forEach(j=>j())}}),[]),c=h.useMemo(()=>({value:(j,b,C)=>{var g;b!==((g=o.current.get(j))==null?void 0:g.value)&&(o.current.set(j,{value:b,keywords:C}),s.current.filtered.items.set(j,u(b,C)),U(2,()=>{p(),S.emit()}))},item:(j,b)=>(r.current.add(j),b&&(n.current.has(b)?n.current.get(b).add(j):n.current.set(b,new Set([j]))),U(3,()=>{T(),p(),s.current.value||N(),S.emit()}),()=>{o.current.delete(j),r.current.delete(j),s.current.filtered.items.delete(j);let C=Z();U(4,()=>{T(),C?.getAttribute("id")===j&&N(),S.emit()})}),group:j=>(n.current.has(j)||n.current.set(j,new Set),()=>{o.current.delete(j),n.current.delete(j)}),filter:()=>l.current.shouldFilter,label:m||t["aria-label"],getDisablePointerSelection:()=>l.current.disablePointerSelection,listId:D,inputId:P,labelId:I,listInnerRef:G}),[]);function u(j,b){var C,g;let E=(g=(C=l.current)==null?void 0:C.filter)!=null?g:mi;return j?E(j,s.current.search,b):0}function p(){if(!s.current.search||l.current.shouldFilter===!1)return;let j=s.current.filtered.items,b=[];s.current.filtered.groups.forEach(g=>{let E=n.current.get(g),F=0;E.forEach(O=>{let R=j.get(O);F=Math.max(R,F)}),b.push([g,F])});let C=G.current;oe().sort((g,E)=>{var F,O;let R=g.getAttribute("id"),ie=E.getAttribute("id");return((F=j.get(ie))!=null?F:0)-((O=j.get(R))!=null?O:0)}).forEach(g=>{let E=g.closest(bs);E?E.appendChild(g.parentElement===E?g:g.closest(`${bs} > *`)):C.appendChild(g.parentElement===C?g:g.closest(`${bs} > *`))}),b.sort((g,E)=>E[1]-g[1]).forEach(g=>{var E;let F=(E=G.current)==null?void 0:E.querySelector(`${Ft}[${_t}="${encodeURIComponent(g[0])}"]`);F?.parentElement.appendChild(F)})}function N(){let j=oe().find(C=>C.getAttribute("aria-disabled")!=="true"),b=j?.getAttribute(_t);S.setState("value",b||void 0)}function T(){var j,b,C,g;if(!s.current.search||l.current.shouldFilter===!1){s.current.filtered.count=r.current.size;return}s.current.filtered.groups=new Set;let E=0;for(let F of r.current){let O=(b=(j=o.current.get(F))==null?void 0:j.value)!=null?b:"",R=(g=(C=o.current.get(F))==null?void 0:C.keywords)!=null?g:[],ie=u(O,R);s.current.filtered.items.set(F,ie),ie>0&&E++}for(let[F,O]of n.current)for(let R of O)if(s.current.filtered.items.get(R)>0){s.current.filtered.groups.add(F);break}s.current.filtered.count=E}function $(){var j,b,C;let g=Z();g&&(((j=g.parentElement)==null?void 0:j.firstChild)===g&&((C=(b=g.closest(Ft))==null?void 0:b.querySelector(ui))==null||C.scrollIntoView({block:"nearest"})),g.scrollIntoView({block:"nearest"}))}function Z(){var j;return(j=G.current)==null?void 0:j.querySelector(`${Ir}[aria-selected="true"]`)}function oe(){var j;return Array.from(((j=G.current)==null?void 0:j.querySelectorAll(xa))||[])}function de(j){let b=oe()[j];b&&S.setState("value",b.getAttribute(_t))}function L(j){var b;let C=Z(),g=oe(),E=g.findIndex(O=>O===C),F=g[E+j];(b=l.current)!=null&&b.loop&&(F=E+j<0?g[g.length-1]:E+j===g.length?g[0]:g[E+j]),F&&S.setState("value",F.getAttribute(_t))}function re(j){let b=Z(),C=b?.closest(Ft),g;for(;C&&!g;)C=j>0?Ni(C,Ft):wi(C,Ft),g=C?.querySelector(xa);g?S.setState("value",g.getAttribute(_t)):L(j)}let B=()=>de(oe().length-1),ue=j=>{j.preventDefault(),j.metaKey?B():j.altKey?re(1):L(1)},Y=j=>{j.preventDefault(),j.metaKey?de(0):j.altKey?re(-1):L(-1)};return h.createElement(pt.div,{ref:a,tabIndex:-1,...A,"cmdk-root":"",onKeyDown:j=>{var b;(b=A.onKeyDown)==null||b.call(A,j);let C=j.nativeEvent.isComposing||j.keyCode===229;if(!(j.defaultPrevented||C))switch(j.key){case"n":case"j":{J&&j.ctrlKey&&ue(j);break}case"ArrowDown":{ue(j);break}case"p":case"k":{J&&j.ctrlKey&&Y(j);break}case"ArrowUp":{Y(j);break}case"Home":{j.preventDefault(),de(0);break}case"End":{j.preventDefault(),B();break}case"Enter":{j.preventDefault();let g=Z();if(g){let E=new Event(Ms);g.dispatchEvent(E)}}}}},h.createElement("label",{"cmdk-label":"",htmlFor:c.inputId,id:c.labelId,style:Ci},m),ps(t,j=>h.createElement($r.Provider,{value:S},h.createElement(Fr.Provider,{value:c},j))))}),hi=h.forwardRef((t,a)=>{var s,r;let n=Tt(),o=h.useRef(null),i=h.useContext(Mr),l=Gt(),m=qr(t),d=(r=(s=m.current)==null?void 0:s.forceMount)!=null?r:i?.forceMount;wt(()=>{if(!d)return l.item(n,i?.id)},[d]);let x=zr(n,o,[t.value,t.children,o],t.keywords),f=ta(),w=ft(U=>U.value&&U.value===x.current),y=ft(U=>d||l.filter()===!1?!0:U.search?U.filtered.items.get(n)>0:!0);h.useEffect(()=>{let U=o.current;if(!(!U||t.disabled))return U.addEventListener(Ms,z),()=>U.removeEventListener(Ms,z)},[y,t.onSelect,t.disabled]);function z(){var U,S;v(),(S=(U=m.current).onSelect)==null||S.call(U,x.current)}function v(){f.setState("value",x.current,!0)}if(!y)return null;let{disabled:J,value:A,onSelect:D,forceMount:I,keywords:P,...G}=t;return h.createElement(pt.div,{ref:zt(o,a),...G,id:n,"cmdk-item":"",role:"option","aria-disabled":!!J,"aria-selected":!!w,"data-disabled":!!J,"data-selected":!!w,onPointerMove:J||l.getDisablePointerSelection()?void 0:v,onClick:J?void 0:z},t.children)}),fi=h.forwardRef((t,a)=>{let{heading:s,children:r,forceMount:n,...o}=t,i=Tt(),l=h.useRef(null),m=h.useRef(null),d=Tt(),x=Gt(),f=ft(y=>n||x.filter()===!1?!0:y.search?y.filtered.groups.has(i):!0);wt(()=>x.group(i),[]),zr(i,l,[t.value,t.heading,m]);let w=h.useMemo(()=>({id:i,forceMount:n}),[n]);return h.createElement(pt.div,{ref:zt(l,a),...o,"cmdk-group":"",role:"presentation",hidden:f?void 0:!0},s&&h.createElement("div",{ref:m,"cmdk-group-heading":"","aria-hidden":!0,id:d},s),ps(t,y=>h.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":s?d:void 0},h.createElement(Mr.Provider,{value:w},y))))}),pi=h.forwardRef((t,a)=>{let{alwaysRender:s,...r}=t,n=h.useRef(null),o=ft(i=>!i.search);return!s&&!o?null:h.createElement(pt.div,{ref:zt(n,a),...r,"cmdk-separator":"",role:"separator"})}),xi=h.forwardRef((t,a)=>{let{onValueChange:s,...r}=t,n=t.value!=null,o=ta(),i=ft(d=>d.search),l=ft(d=>d.selectedItemId),m=Gt();return h.useEffect(()=>{t.value!=null&&o.setState("search",t.value)},[t.value]),h.createElement(pt.input,{ref:a,...r,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":m.listId,"aria-labelledby":m.labelId,"aria-activedescendant":l,id:m.inputId,type:"text",value:n?t.value:i,onChange:d=>{n||o.setState("search",d.target.value),s?.(d.target.value)}})}),gi=h.forwardRef((t,a)=>{let{children:s,label:r="Suggestions",...n}=t,o=h.useRef(null),i=h.useRef(null),l=ft(d=>d.selectedItemId),m=Gt();return h.useEffect(()=>{if(i.current&&o.current){let d=i.current,x=o.current,f,w=new ResizeObserver(()=>{f=requestAnimationFrame(()=>{let y=d.offsetHeight;x.style.setProperty("--cmdk-list-height",y.toFixed(1)+"px")})});return w.observe(d),()=>{cancelAnimationFrame(f),w.unobserve(d)}}},[]),h.createElement(pt.div,{ref:zt(o,a),...n,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":l,"aria-label":r,id:m.listId},ps(t,d=>h.createElement("div",{ref:zt(i,m.listInnerRef),"cmdk-list-sizer":""},d)))}),vi=h.forwardRef((t,a)=>{let{open:s,onOpenChange:r,overlayClassName:n,contentClassName:o,container:i,...l}=t;return h.createElement(fs,{open:s,onOpenChange:r},h.createElement(hs,{container:i},h.createElement(kt,{"cmdk-overlay":"",className:n}),h.createElement(At,{"aria-label":t.label,"cmdk-dialog":"",className:o},h.createElement(Lr,{ref:a,...l}))))}),ji=h.forwardRef((t,a)=>ft(s=>s.filtered.count===0)?h.createElement(pt.div,{ref:a,...t,"cmdk-empty":"",role:"presentation"}):null),bi=h.forwardRef((t,a)=>{let{progress:s,children:r,label:n="Loading...",...o}=t;return h.createElement(pt.div,{ref:a,...o,"cmdk-loading":"",role:"progressbar","aria-valuenow":s,"aria-valuemin":0,"aria-valuemax":100,"aria-label":n},ps(t,i=>h.createElement("div",{"aria-hidden":!0},i)))}),$e=Object.assign(Lr,{List:gi,Item:hi,Input:xi,Group:fi,Separator:pi,Dialog:vi,Empty:ji,Loading:bi});function Ni(t,a){let s=t.nextElementSibling;for(;s;){if(s.matches(a))return s;s=s.nextElementSibling}}function wi(t,a){let s=t.previousElementSibling;for(;s;){if(s.matches(a))return s;s=s.previousElementSibling}}function qr(t){let a=h.useRef(t);return wt(()=>{a.current=t}),a}var wt=typeof window>"u"?h.useEffect:h.useLayoutEffect;function Ct(t){let a=h.useRef();return a.current===void 0&&(a.current=t()),a}function ft(t){let a=ta(),s=()=>t(a.snapshot());return h.useSyncExternalStore(a.subscribe,s,s)}function zr(t,a,s,r=[]){let n=h.useRef(),o=Gt();return wt(()=>{var i;let l=(()=>{var d;for(let x of s){if(typeof x=="string")return x.trim();if(typeof x=="object"&&"current"in x)return x.current?(d=x.current.textContent)==null?void 0:d.trim():n.current}})(),m=r.map(d=>d.trim());o.value(t,l,m),(i=a.current)==null||i.setAttribute(_t,l),n.current=l}),n}var yi=()=>{let[t,a]=h.useState(),s=Ct(()=>new Map);return wt(()=>{s.current.forEach(r=>r()),s.current=new Map},[t]),(r,n)=>{s.current.set(r,n),a({})}};function _i(t){let a=t.type;return typeof a=="function"?a(t.props):"render"in a?a.render(t.props):t}function ps({asChild:t,children:a},s){return t&&h.isValidElement(a)?h.cloneElement(_i(a),{ref:a.ref},s(a.props.children)):s(a)}var Ci={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const sa=h.forwardRef(({className:t,...a},s)=>e.jsx($e,{ref:s,className:k("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",t),...a}));sa.displayName=$e.displayName;const Xc=({children:t,...a})=>e.jsx(Sr,{...a,children:e.jsx(Gs,{className:"overflow-hidden p-0 shadow-lg",children:e.jsx(sa,{className:"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5",children:t})})}),Si=h.forwardRef(({className:t,...a},s)=>e.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[e.jsx(Rt,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),e.jsx($e.Input,{ref:s,className:k("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",t),...a})]}));Si.displayName=$e.Input.displayName;const Br=h.forwardRef(({className:t,...a},s)=>e.jsx($e.List,{ref:s,className:k("max-h-[300px] overflow-y-auto overflow-x-hidden",t),...a}));Br.displayName=$e.List.displayName;const Vr=h.forwardRef((t,a)=>e.jsx($e.Empty,{ref:a,className:"py-6 text-center text-sm",...t}));Vr.displayName=$e.Empty.displayName;const Ur=h.forwardRef(({className:t,...a},s)=>e.jsx($e.Group,{ref:s,className:k("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",t),...a}));Ur.displayName=$e.Group.displayName;const Ti=h.forwardRef(({className:t,...a},s)=>e.jsx($e.Separator,{ref:s,className:k("-mx-1 h-px bg-border",t),...a}));Ti.displayName=$e.Separator.displayName;const Hr=h.forwardRef(({className:t,...a},s)=>e.jsx($e.Item,{ref:s,className:k("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50",t),...a}));Hr.displayName=$e.Item.displayName;const Jr=h.forwardRef(({...t},a)=>e.jsx("nav",{ref:a,"aria-label":"breadcrumb",...t}));Jr.displayName="Breadcrumb";const Wr=h.forwardRef(({className:t,...a},s)=>e.jsx("ol",{ref:s,className:k("flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5",t),...a}));Wr.displayName="BreadcrumbList";const Ls=h.forwardRef(({className:t,...a},s)=>e.jsx("li",{ref:s,className:k("inline-flex items-center gap-1.5",t),...a}));Ls.displayName="BreadcrumbItem";const qs=h.forwardRef(({asChild:t,className:a,...s},r)=>{const n=t?Wn:"a";return e.jsx(n,{ref:r,className:k("transition-colors hover:text-foreground",a),...s})});qs.displayName="BreadcrumbLink";const Kr=h.forwardRef(({className:t,...a},s)=>e.jsx("span",{ref:s,role:"link","aria-disabled":"true","aria-current":"page",className:k("font-normal text-foreground",t),...a}));Kr.displayName="BreadcrumbPage";const Gr=({children:t,className:a,...s})=>e.jsx("li",{role:"presentation","aria-hidden":"true",className:k("[&>svg]:size-3.5",a),...s,children:t??e.jsx($a,{})});Gr.displayName="BreadcrumbSeparator";const Yr=h.forwardRef(({className:t,children:a,...s},r)=>e.jsxs(Ja,{ref:r,className:k("relative overflow-hidden",t),...s,children:[e.jsx(Kn,{className:"h-full w-full rounded-[inherit] min-h-0",children:a}),e.jsx(Qr,{}),e.jsx(Gn,{})]}));Yr.displayName=Ja.displayName;const Qr=h.forwardRef(({className:t,orientation:a="vertical",...s},r)=>e.jsx(Wa,{ref:r,orientation:a,className:k("flex touch-none select-none transition-colors",a==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",a==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...s,children:e.jsx(Yn,{className:"relative flex-1 rounded-full bg-border"})}));Qr.displayName=Wa.displayName;function Ei(t,a){let s;try{s=t()}catch{return}return{getItem:n=>{var o;const i=m=>m===null?null:JSON.parse(m,void 0),l=(o=s.getItem(n))!=null?o:null;return l instanceof Promise?l.then(i):i(l)},setItem:(n,o)=>s.setItem(n,JSON.stringify(o,void 0)),removeItem:n=>s.removeItem(n)}}const zs=t=>a=>{try{const s=t(a);return s instanceof Promise?s:{then(r){return zs(r)(s)},catch(r){return this}}}catch(s){return{then(r){return this},catch(r){return zs(r)(s)}}}},Ri=(t,a)=>(s,r,n)=>{let o={storage:Ei(()=>localStorage),partialize:v=>v,version:0,merge:(v,J)=>({...J,...v}),...a},i=!1;const l=new Set,m=new Set;let d=o.storage;if(!d)return t((...v)=>{console.warn(`[zustand persist middleware] Unable to update item '${o.name}', the given storage is currently unavailable.`),s(...v)},r,n);const x=()=>{const v=o.partialize({...r()});return d.setItem(o.name,{state:v,version:o.version})},f=n.setState;n.setState=(v,J)=>(f(v,J),x());const w=t((...v)=>(s(...v),x()),r,n);n.getInitialState=()=>w;let y;const z=()=>{var v,J;if(!d)return;i=!1,l.forEach(D=>{var I;return D((I=r())!=null?I:w)});const A=((J=o.onRehydrateStorage)==null?void 0:J.call(o,(v=r())!=null?v:w))||void 0;return zs(d.getItem.bind(d))(o.name).then(D=>{if(D)if(typeof D.version=="number"&&D.version!==o.version){if(o.migrate){const I=o.migrate(D.state,D.version);return I instanceof Promise?I.then(P=>[!0,P]):[!0,I]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,D.state];return[!1,void 0]}).then(D=>{var I;const[P,G]=D;if(y=o.merge(G,(I=r())!=null?I:w),s(y,!0),P)return x()}).then(()=>{A?.(y,void 0),y=r(),i=!0,m.forEach(D=>D(y))}).catch(D=>{A?.(void 0,D)})};return n.persist={setOptions:v=>{o={...o,...v},v.storage&&(d=v.storage)},clearStorage:()=>{d?.removeItem(o.name)},getOptions:()=>o,rehydrate:()=>z(),hasHydrated:()=>i,onHydrate:v=>(l.add(v),()=>{l.delete(v)}),onFinishHydration:v=>(m.add(v),()=>{m.delete(v)})},o.skipHydration||z(),y||w},Di=Ri,ki=Ka()(Di((t,a)=>({notifications:[],unreadCount:0,addNotification:s=>{const r=`notification-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,n={...s,id:r,createdAt:new Date,read:!1,duration:s.duration??5e3};return t(o=>({notifications:[n,...o.notifications],unreadCount:o.unreadCount+1})),n.duration&&setTimeout(()=>{a().removeNotification(r)},n.duration),r},removeNotification:s=>{t(r=>{const n=r.notifications.find(i=>i.id===s),o=n&&!n.read;return{notifications:r.notifications.filter(i=>i.id!==s),unreadCount:o?r.unreadCount-1:r.unreadCount}})},markAsRead:s=>{t(r=>{const n=r.notifications.map(i=>i.id===s?{...i,read:!0}:i),o=n.filter(i=>!i.read).length;return{notifications:n,unreadCount:o}})},markAllAsRead:()=>{t(s=>({notifications:s.notifications.map(r=>({...r,read:!0})),unreadCount:0}))},clearAll:()=>{t({notifications:[],unreadCount:0})},clearRead:()=>{t(s=>({notifications:s.notifications.filter(r=>!r.read),unreadCount:s.unreadCount}))}}),{name:"assistjur-notifications",partialize:t=>({notifications:t.notifications.slice(0,50)})})),Ai=()=>{const{addNotification:t,...a}=ki();return{...a,success:(s,r,n)=>t({type:"success",title:s,message:r,...n}),error:(s,r,n)=>t({type:"error",title:s,message:r,duration:void 0,...n}),warning:(s,r,n)=>t({type:"warning",title:s,message:r,...n}),info:(s,r,n)=>t({type:"info",title:s,message:r,...n}),addNotification:t}},Pi=Xn,Zc=Zn,Oi=Qn,Xr=h.forwardRef(({className:t,...a},s)=>e.jsx(Ga,{className:k("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...a,ref:s}));Xr.displayName=Ga.displayName;const Zr=h.forwardRef(({className:t,...a},s)=>e.jsxs(Oi,{children:[e.jsx(Xr,{}),e.jsx(Ya,{ref:s,className:k("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...a})]}));Zr.displayName=Ya.displayName;const en=({className:t,...a})=>e.jsx("div",{className:k("flex flex-col space-y-2 text-center sm:text-left",t),...a});en.displayName="AlertDialogHeader";const tn=({className:t,...a})=>e.jsx("div",{className:k("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a});tn.displayName="AlertDialogFooter";const sn=h.forwardRef(({className:t,...a},s)=>e.jsx(Qa,{ref:s,className:k("text-lg font-semibold",t),...a}));sn.displayName=Qa.displayName;const an=h.forwardRef(({className:t,...a},s)=>e.jsx(Xa,{ref:s,className:k("text-sm text-muted-foreground",t),...a}));an.displayName=Xa.displayName;const rn=h.forwardRef(({className:t,...a},s)=>e.jsx(Za,{ref:s,className:k(pr(),t),...a}));rn.displayName=Za.displayName;const nn=h.forwardRef(({className:t,...a},s)=>e.jsx(er,{ref:s,className:k(pr({variant:"outline"}),"mt-2 sm:mt-0",t),...a}));nn.displayName=er.displayName;const ct=eo,dt=to,st=h.forwardRef(({className:t,children:a,...s},r)=>e.jsxs(tr,{ref:r,className:k("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...s,children:[a,e.jsx(so,{asChild:!0,children:e.jsx(Pt,{className:"h-4 w-4 opacity-50"})})]}));st.displayName=tr.displayName;const on=h.forwardRef(({className:t,...a},s)=>e.jsx(rr,{ref:s,className:k("flex cursor-default items-center justify-center py-1",t),...a,children:e.jsx(nr,{className:"h-4 w-4"})}));on.displayName=rr.displayName;const ln=h.forwardRef(({className:t,...a},s)=>e.jsx(or,{ref:s,className:k("flex cursor-default items-center justify-center py-1",t),...a,children:e.jsx(Pt,{className:"h-4 w-4"})}));ln.displayName=or.displayName;const at=h.forwardRef(({className:t,children:a,position:s="popper",...r},n)=>e.jsx(ao,{children:e.jsxs(sr,{ref:n,className:k("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:s,...r,children:[e.jsx(on,{}),e.jsx(ro,{className:k("p-1",s==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),e.jsx(ln,{})]})}));at.displayName=sr.displayName;const Ii=h.forwardRef(({className:t,...a},s)=>e.jsx(ir,{ref:s,className:k("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...a}));Ii.displayName=ir.displayName;const ye=h.forwardRef(({className:t,children:a,...s},r)=>e.jsxs(ar,{ref:r,className:k("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...s,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(no,{children:e.jsx(Hs,{className:"h-4 w-4"})})}),e.jsx(oo,{children:a})]}));ye.displayName=ar.displayName;const Fi=h.forwardRef(({className:t,...a},s)=>e.jsx(lr,{ref:s,className:k("-mx-1 my-1 h-px bg-muted",t),...a}));Fi.displayName=lr.displayName;var cn={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/(function(t,a){((s,r)=>{t.exports=r()})(Lo,function s(){var r=typeof self<"u"?self:typeof window<"u"?window:r!==void 0?r:{},n,o=!r.document&&!!r.postMessage,i=r.IS_PAPA_WORKER||!1,l={},m=0,d={};function x(c){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(u){var p=G(u);p.chunkSize=parseInt(p.chunkSize),u.step||u.chunk||(p.chunkSize=null),this._handle=new v(p),(this._handle.streamer=this)._config=p}.call(this,c),this.parseChunk=function(u,p){var N=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<N){let $=this._config.newline;$||(T=this._config.quoteChar||'"',$=this._handle.guessLineEndings(u,T)),u=[...u.split($).slice(N)].join($)}this.isFirstChunk&&S(this._config.beforeFirstChunk)&&(T=this._config.beforeFirstChunk(u))!==void 0&&(u=T),this.isFirstChunk=!1,this._halted=!1;var N=this._partialLine+u,T=(this._partialLine="",this._handle.parse(N,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(u=T.meta.cursor,N=(this._finished||(this._partialLine=N.substring(u-this._baseIndex),this._baseIndex=u),T&&T.data&&(this._rowCount+=T.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),i)r.postMessage({results:T,workerId:d.WORKER_ID,finished:N});else if(S(this._config.chunk)&&!p){if(this._config.chunk(T,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=T=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(T.data),this._completeResults.errors=this._completeResults.errors.concat(T.errors),this._completeResults.meta=T.meta),this._completed||!N||!S(this._config.complete)||T&&T.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),N||T&&T.meta.paused||this._nextChunk(),T}this._halted=!0},this._sendError=function(u){S(this._config.error)?this._config.error(u):i&&this._config.error&&r.postMessage({workerId:d.WORKER_ID,error:u,finished:!1})}}function f(c){var u;(c=c||{}).chunkSize||(c.chunkSize=d.RemoteChunkSize),x.call(this,c),this._nextChunk=o?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(p){this._input=p,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(u=new XMLHttpRequest,this._config.withCredentials&&(u.withCredentials=this._config.withCredentials),o||(u.onload=U(this._chunkLoaded,this),u.onerror=U(this._chunkError,this)),u.open(this._config.downloadRequestBody?"POST":"GET",this._input,!o),this._config.downloadRequestHeaders){var p,N=this._config.downloadRequestHeaders;for(p in N)u.setRequestHeader(p,N[p])}var T;this._config.chunkSize&&(T=this._start+this._config.chunkSize-1,u.setRequestHeader("Range","bytes="+this._start+"-"+T));try{u.send(this._config.downloadRequestBody)}catch($){this._chunkError($.message)}o&&u.status===0&&this._chunkError()}},this._chunkLoaded=function(){u.readyState===4&&(u.status<200||400<=u.status?this._chunkError():(this._start+=this._config.chunkSize||u.responseText.length,this._finished=!this._config.chunkSize||this._start>=(p=>(p=p.getResponseHeader("Content-Range"))!==null?parseInt(p.substring(p.lastIndexOf("/")+1)):-1)(u),this.parseChunk(u.responseText)))},this._chunkError=function(p){p=u.statusText||p,this._sendError(new Error(p))}}function w(c){(c=c||{}).chunkSize||(c.chunkSize=d.LocalChunkSize),x.call(this,c);var u,p,N=typeof FileReader<"u";this.stream=function(T){this._input=T,p=T.slice||T.webkitSlice||T.mozSlice,N?((u=new FileReader).onload=U(this._chunkLoaded,this),u.onerror=U(this._chunkError,this)):u=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var T=this._input,$=(this._config.chunkSize&&($=Math.min(this._start+this._config.chunkSize,this._input.size),T=p.call(T,this._start,$)),u.readAsText(T,this._config.encoding));N||this._chunkLoaded({target:{result:$}})},this._chunkLoaded=function(T){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(T.target.result)},this._chunkError=function(){this._sendError(u.error)}}function y(c){var u;x.call(this,c=c||{}),this.stream=function(p){return u=p,this._nextChunk()},this._nextChunk=function(){var p,N;if(!this._finished)return p=this._config.chunkSize,u=p?(N=u.substring(0,p),u.substring(p)):(N=u,""),this._finished=!u,this.parseChunk(N)}}function z(c){x.call(this,c=c||{});var u=[],p=!0,N=!1;this.pause=function(){x.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){x.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(T){this._input=T,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){N&&u.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),u.length?this.parseChunk(u.shift()):p=!0},this._streamData=U(function(T){try{u.push(typeof T=="string"?T:T.toString(this._config.encoding)),p&&(p=!1,this._checkIsFinished(),this.parseChunk(u.shift()))}catch($){this._streamError($)}},this),this._streamError=U(function(T){this._streamCleanUp(),this._sendError(T)},this),this._streamEnd=U(function(){this._streamCleanUp(),N=!0,this._streamData("")},this),this._streamCleanUp=U(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function v(c){var u,p,N,T,$=Math.pow(2,53),Z=-$,oe=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,de=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,L=this,re=0,B=0,ue=!1,Y=!1,j=[],b={data:[],errors:[],meta:{}};function C(O){return c.skipEmptyLines==="greedy"?O.join("").trim()==="":O.length===1&&O[0].length===0}function g(){if(b&&N&&(F("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+d.DefaultDelimiter+"'"),N=!1),c.skipEmptyLines&&(b.data=b.data.filter(function(H){return!C(H)})),E()){let H=function(ce,M){S(c.transformHeader)&&(ce=c.transformHeader(ce,M)),j.push(ce)};if(b)if(Array.isArray(b.data[0])){for(var O=0;E()&&O<b.data.length;O++)b.data[O].forEach(H);b.data.splice(0,1)}else b.data.forEach(H)}function R(H,ce){for(var M=c.header?{}:[],ne=0;ne<H.length;ne++){var le=ne,_=H[ne],_=((se,V)=>(Q=>(c.dynamicTypingFunction&&c.dynamicTyping[Q]===void 0&&(c.dynamicTyping[Q]=c.dynamicTypingFunction(Q)),(c.dynamicTyping[Q]||c.dynamicTyping)===!0))(se)?V==="true"||V==="TRUE"||V!=="false"&&V!=="FALSE"&&((Q=>{if(oe.test(Q)&&(Q=parseFloat(Q),Z<Q&&Q<$))return 1})(V)?parseFloat(V):de.test(V)?new Date(V):V===""?null:V):V)(le=c.header?ne>=j.length?"__parsed_extra":j[ne]:le,_=c.transform?c.transform(_,le):_);le==="__parsed_extra"?(M[le]=M[le]||[],M[le].push(_)):M[le]=_}return c.header&&(ne>j.length?F("FieldMismatch","TooManyFields","Too many fields: expected "+j.length+" fields but parsed "+ne,B+ce):ne<j.length&&F("FieldMismatch","TooFewFields","Too few fields: expected "+j.length+" fields but parsed "+ne,B+ce)),M}var ie;b&&(c.header||c.dynamicTyping||c.transform)&&(ie=1,!b.data.length||Array.isArray(b.data[0])?(b.data=b.data.map(R),ie=b.data.length):b.data=R(b.data,0),c.header&&b.meta&&(b.meta.fields=j),B+=ie)}function E(){return c.header&&j.length===0}function F(O,R,ie,H){O={type:O,code:R,message:ie},H!==void 0&&(O.row=H),b.errors.push(O)}S(c.step)&&(T=c.step,c.step=function(O){b=O,E()?g():(g(),b.data.length!==0&&(re+=O.data.length,c.preview&&re>c.preview?p.abort():(b.data=b.data[0],T(b,L))))}),this.parse=function(O,R,ie){var H=c.quoteChar||'"',H=(c.newline||(c.newline=this.guessLineEndings(O,H)),N=!1,c.delimiter?S(c.delimiter)&&(c.delimiter=c.delimiter(O),b.meta.delimiter=c.delimiter):((H=((ce,M,ne,le,_)=>{var se,V,Q,ae;_=_||[",","	","|",";",d.RECORD_SEP,d.UNIT_SEP];for(var Ne=0;Ne<_.length;Ne++){for(var fe,Te=_[Ne],pe=0,Ee=0,ve=0,_e=(Q=void 0,new A({comments:le,delimiter:Te,newline:M,preview:10}).parse(ce)),We=0;We<_e.data.length;We++)ne&&C(_e.data[We])?ve++:(fe=_e.data[We].length,Ee+=fe,Q===void 0?Q=fe:0<fe&&(pe+=Math.abs(fe-Q),Q=fe));0<_e.data.length&&(Ee/=_e.data.length-ve),(V===void 0||pe<=V)&&(ae===void 0||ae<Ee)&&1.99<Ee&&(V=pe,se=Te,ae=Ee)}return{successful:!!(c.delimiter=se),bestDelimiter:se}})(O,c.newline,c.skipEmptyLines,c.comments,c.delimitersToGuess)).successful?c.delimiter=H.bestDelimiter:(N=!0,c.delimiter=d.DefaultDelimiter),b.meta.delimiter=c.delimiter),G(c));return c.preview&&c.header&&H.preview++,u=O,p=new A(H),b=p.parse(u,R,ie),g(),ue?{meta:{paused:!0}}:b||{meta:{paused:!1}}},this.paused=function(){return ue},this.pause=function(){ue=!0,p.abort(),u=S(c.chunk)?"":u.substring(p.getCharIndex())},this.resume=function(){L.streamer._halted?(ue=!1,L.streamer.parseChunk(u,!0)):setTimeout(L.resume,3)},this.aborted=function(){return Y},this.abort=function(){Y=!0,p.abort(),b.meta.aborted=!0,S(c.complete)&&c.complete(b),u=""},this.guessLineEndings=function(ce,H){ce=ce.substring(0,1048576);var H=new RegExp(J(H)+"([^]*?)"+J(H),"gm"),ie=(ce=ce.replace(H,"")).split("\r"),H=ce.split(`
`),ce=1<H.length&&H[0].length<ie[0].length;if(ie.length===1||ce)return`
`;for(var M=0,ne=0;ne<ie.length;ne++)ie[ne][0]===`
`&&M++;return M>=ie.length/2?`\r
`:"\r"}}function J(c){return c.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function A(c){var u=(c=c||{}).delimiter,p=c.newline,N=c.comments,T=c.step,$=c.preview,Z=c.fastMode,oe=null,de=!1,L=c.quoteChar==null?'"':c.quoteChar,re=L;if(c.escapeChar!==void 0&&(re=c.escapeChar),(typeof u!="string"||-1<d.BAD_DELIMITERS.indexOf(u))&&(u=","),N===u)throw new Error("Comment character same as delimiter");N===!0?N="#":(typeof N!="string"||-1<d.BAD_DELIMITERS.indexOf(N))&&(N=!1),p!==`
`&&p!=="\r"&&p!==`\r
`&&(p=`
`);var B=0,ue=!1;this.parse=function(Y,j,b){if(typeof Y!="string")throw new Error("Input must be a string");var C=Y.length,g=u.length,E=p.length,F=N.length,O=S(T),R=[],ie=[],H=[],ce=B=0;if(!Y)return pe();if(Z||Z!==!1&&Y.indexOf(L)===-1){for(var M=Y.split(p),ne=0;ne<M.length;ne++){if(H=M[ne],B+=H.length,ne!==M.length-1)B+=p.length;else if(b)return pe();if(!N||H.substring(0,F)!==N){if(O){if(R=[],ae(H.split(u)),Ee(),ue)return pe()}else ae(H.split(u));if($&&$<=ne)return R=R.slice(0,$),pe(!0)}}return pe()}for(var le=Y.indexOf(u,B),_=Y.indexOf(p,B),se=new RegExp(J(re)+J(L),"g"),V=Y.indexOf(L,B);;)if(Y[B]===L)for(V=B,B++;;){if((V=Y.indexOf(L,V+1))===-1)return b||ie.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:R.length,index:B}),fe();if(V===C-1)return fe(Y.substring(B,V).replace(se,L));if(L===re&&Y[V+1]===re)V++;else if(L===re||V===0||Y[V-1]!==re){le!==-1&&le<V+1&&(le=Y.indexOf(u,V+1));var Q=Ne((_=_!==-1&&_<V+1?Y.indexOf(p,V+1):_)===-1?le:Math.min(le,_));if(Y.substr(V+1+Q,g)===u){H.push(Y.substring(B,V).replace(se,L)),Y[B=V+1+Q+g]!==L&&(V=Y.indexOf(L,B)),le=Y.indexOf(u,B),_=Y.indexOf(p,B);break}if(Q=Ne(_),Y.substring(V+1+Q,V+1+Q+E)===p){if(H.push(Y.substring(B,V).replace(se,L)),Te(V+1+Q+E),le=Y.indexOf(u,B),V=Y.indexOf(L,B),O&&(Ee(),ue))return pe();if($&&R.length>=$)return pe(!0);break}ie.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:R.length,index:B}),V++}}else if(N&&H.length===0&&Y.substring(B,B+F)===N){if(_===-1)return pe();B=_+E,_=Y.indexOf(p,B),le=Y.indexOf(u,B)}else if(le!==-1&&(le<_||_===-1))H.push(Y.substring(B,le)),B=le+g,le=Y.indexOf(u,B);else{if(_===-1)break;if(H.push(Y.substring(B,_)),Te(_+E),O&&(Ee(),ue))return pe();if($&&R.length>=$)return pe(!0)}return fe();function ae(ve){R.push(ve),ce=B}function Ne(ve){var _e=0;return _e=ve!==-1&&(ve=Y.substring(V+1,ve))&&ve.trim()===""?ve.length:_e}function fe(ve){return b||(ve===void 0&&(ve=Y.substring(B)),H.push(ve),B=C,ae(H),O&&Ee()),pe()}function Te(ve){B=ve,ae(H),H=[],_=Y.indexOf(p,B)}function pe(ve){if(c.header&&!j&&R.length&&!de){var _e=R[0],We=Object.create(null),yt=new Set(_e);let Qt=!1;for(let Ue=0;Ue<_e.length;Ue++){let Me=_e[Ue];if(We[Me=S(c.transformHeader)?c.transformHeader(Me,Ue):Me]){let xt,Xt=We[Me];for(;xt=Me+"_"+Xt,Xt++,yt.has(xt););yt.add(xt),_e[Ue]=xt,We[Me]++,Qt=!0,(oe=oe===null?{}:oe)[xt]=Me}else We[Me]=1,_e[Ue]=Me;yt.add(Me)}Qt&&console.warn("Duplicate headers found and renamed."),de=!0}return{data:R,errors:ie,meta:{delimiter:u,linebreak:p,aborted:ue,truncated:!!ve,cursor:ce+(j||0),renamedHeaders:oe}}}function Ee(){T(pe()),R=[],ie=[]}},this.abort=function(){ue=!0},this.getCharIndex=function(){return B}}function D(c){var u=c.data,p=l[u.workerId],N=!1;if(u.error)p.userError(u.error,u.file);else if(u.results&&u.results.data){var T={abort:function(){N=!0,I(u.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:P,resume:P};if(S(p.userStep)){for(var $=0;$<u.results.data.length&&(p.userStep({data:u.results.data[$],errors:u.results.errors,meta:u.results.meta},T),!N);$++);delete u.results}else S(p.userChunk)&&(p.userChunk(u.results,T,u.file),delete u.results)}u.finished&&!N&&I(u.workerId,u.results)}function I(c,u){var p=l[c];S(p.userComplete)&&p.userComplete(u),p.terminate(),delete l[c]}function P(){throw new Error("Not implemented.")}function G(c){if(typeof c!="object"||c===null)return c;var u,p=Array.isArray(c)?[]:{};for(u in c)p[u]=G(c[u]);return p}function U(c,u){return function(){c.apply(u,arguments)}}function S(c){return typeof c=="function"}return d.parse=function(c,u){var p=(u=u||{}).dynamicTyping||!1;if(S(p)&&(u.dynamicTypingFunction=p,p={}),u.dynamicTyping=p,u.transform=!!S(u.transform)&&u.transform,!u.worker||!d.WORKERS_SUPPORTED)return p=null,d.NODE_STREAM_INPUT,typeof c=="string"?(c=(N=>N.charCodeAt(0)!==65279?N:N.slice(1))(c),p=new(u.download?f:y)(u)):c.readable===!0&&S(c.read)&&S(c.on)?p=new z(u):(r.File&&c instanceof File||c instanceof Object)&&(p=new w(u)),p.stream(c);(p=(()=>{var N;return!!d.WORKERS_SUPPORTED&&(N=(()=>{var T=r.URL||r.webkitURL||null,$=s.toString();return d.BLOB_URL||(d.BLOB_URL=T.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",$,")();"],{type:"text/javascript"})))})(),(N=new r.Worker(N)).onmessage=D,N.id=m++,l[N.id]=N)})()).userStep=u.step,p.userChunk=u.chunk,p.userComplete=u.complete,p.userError=u.error,u.step=S(u.step),u.chunk=S(u.chunk),u.complete=S(u.complete),u.error=S(u.error),delete u.worker,p.postMessage({input:c,config:u,workerId:p.id})},d.unparse=function(c,u){var p=!1,N=!0,T=",",$=`\r
`,Z='"',oe=Z+Z,de=!1,L=null,re=!1,B=((()=>{if(typeof u=="object"){if(typeof u.delimiter!="string"||d.BAD_DELIMITERS.filter(function(j){return u.delimiter.indexOf(j)!==-1}).length||(T=u.delimiter),typeof u.quotes!="boolean"&&typeof u.quotes!="function"&&!Array.isArray(u.quotes)||(p=u.quotes),typeof u.skipEmptyLines!="boolean"&&typeof u.skipEmptyLines!="string"||(de=u.skipEmptyLines),typeof u.newline=="string"&&($=u.newline),typeof u.quoteChar=="string"&&(Z=u.quoteChar),typeof u.header=="boolean"&&(N=u.header),Array.isArray(u.columns)){if(u.columns.length===0)throw new Error("Option columns is empty");L=u.columns}u.escapeChar!==void 0&&(oe=u.escapeChar+Z),u.escapeFormulae instanceof RegExp?re=u.escapeFormulae:typeof u.escapeFormulae=="boolean"&&u.escapeFormulae&&(re=/^[=+\-@\t\r].*$/)}})(),new RegExp(J(Z),"g"));if(typeof c=="string"&&(c=JSON.parse(c)),Array.isArray(c)){if(!c.length||Array.isArray(c[0]))return ue(null,c,de);if(typeof c[0]=="object")return ue(L||Object.keys(c[0]),c,de)}else if(typeof c=="object")return typeof c.data=="string"&&(c.data=JSON.parse(c.data)),Array.isArray(c.data)&&(c.fields||(c.fields=c.meta&&c.meta.fields||L),c.fields||(c.fields=Array.isArray(c.data[0])?c.fields:typeof c.data[0]=="object"?Object.keys(c.data[0]):[]),Array.isArray(c.data[0])||typeof c.data[0]=="object"||(c.data=[c.data])),ue(c.fields||[],c.data||[],de);throw new Error("Unable to serialize unrecognized input");function ue(j,b,C){var g="",E=(typeof j=="string"&&(j=JSON.parse(j)),typeof b=="string"&&(b=JSON.parse(b)),Array.isArray(j)&&0<j.length),F=!Array.isArray(b[0]);if(E&&N){for(var O=0;O<j.length;O++)0<O&&(g+=T),g+=Y(j[O],O);0<b.length&&(g+=$)}for(var R=0;R<b.length;R++){var ie=(E?j:b[R]).length,H=!1,ce=E?Object.keys(b[R]).length===0:b[R].length===0;if(C&&!E&&(H=C==="greedy"?b[R].join("").trim()==="":b[R].length===1&&b[R][0].length===0),C==="greedy"&&E){for(var M=[],ne=0;ne<ie;ne++){var le=F?j[ne]:ne;M.push(b[R][le])}H=M.join("").trim()===""}if(!H){for(var _=0;_<ie;_++){0<_&&!ce&&(g+=T);var se=E&&F?j[_]:_;g+=Y(b[R][se],_)}R<b.length-1&&(!C||0<ie&&!ce)&&(g+=$)}}return g}function Y(j,b){var C,g;return j==null?"":j.constructor===Date?JSON.stringify(j).slice(1,25):(g=!1,re&&typeof j=="string"&&re.test(j)&&(j="'"+j,g=!0),C=j.toString().replace(B,oe),(g=g||p===!0||typeof p=="function"&&p(j,b)||Array.isArray(p)&&p[b]||((E,F)=>{for(var O=0;O<F.length;O++)if(-1<E.indexOf(F[O]))return!0;return!1})(C,d.BAD_DELIMITERS)||-1<C.indexOf(T)||C.charAt(0)===" "||C.charAt(C.length-1)===" ")?Z+C+Z:C)}},d.RECORD_SEP="",d.UNIT_SEP="",d.BYTE_ORDER_MARK="\uFEFF",d.BAD_DELIMITERS=["\r",`
`,'"',d.BYTE_ORDER_MARK],d.WORKERS_SUPPORTED=!o&&!!r.Worker,d.NODE_STREAM_INPUT=1,d.LocalChunkSize=10485760,d.RemoteChunkSize=5242880,d.DefaultDelimiter=",",d.Parser=A,d.ParserHandle=v,d.NetworkStreamer=f,d.FileStreamer=w,d.StringStreamer=y,d.ReadableStreamStreamer=z,r.jQuery&&((n=r.jQuery).fn.parse=function(c){var u=c.config||{},p=[];return this.each(function($){if(!(n(this).prop("tagName").toUpperCase()==="INPUT"&&n(this).attr("type").toLowerCase()==="file"&&r.FileReader)||!this.files||this.files.length===0)return!0;for(var Z=0;Z<this.files.length;Z++)p.push({file:this.files[Z],inputElem:this,instanceConfig:n.extend({},u)})}),N(),this;function N(){if(p.length===0)S(c.complete)&&c.complete();else{var $,Z,oe,de,L=p[0];if(S(c.before)){var re=c.before(L.file,L.inputElem);if(typeof re=="object"){if(re.action==="abort")return $="AbortError",Z=L.file,oe=L.inputElem,de=re.reason,void(S(c.error)&&c.error({name:$},Z,oe,de));if(re.action==="skip")return void T();typeof re.config=="object"&&(L.instanceConfig=n.extend(L.instanceConfig,re.config))}else if(re==="skip")return void T()}var B=L.instanceConfig.complete;L.instanceConfig.complete=function(ue){S(B)&&B(ue,L.file,L.inputElem),T()},d.parse(L.file,L.instanceConfig)}}function T(){p.splice(0,1),N()}}),i&&(r.onmessage=function(c){c=c.data,d.WORKER_ID===void 0&&c&&(d.WORKER_ID=c.workerId),typeof c.input=="string"?r.postMessage({workerId:d.WORKER_ID,results:d.parse(c.input,c.config),finished:!0}):(r.File&&c.input instanceof File||c.input instanceof Object)&&(c=d.parse(c.input,c.config))&&r.postMessage({workerId:d.WORKER_ID,results:c,finished:!0})}),(f.prototype=Object.create(x.prototype)).constructor=f,(w.prototype=Object.create(x.prototype)).constructor=w,(y.prototype=Object.create(y.prototype)).constructor=y,(z.prototype=Object.create(x.prototype)).constructor=z,d})})(cn);var $i=cn.exports;const dn=Mo($i);function Mi(t){return t&&t.replace(/(\d{3})\.\d{3}\.\d{3}-(\d{2})/,"$1.***.***-$2")}function Li(t){return t&&t.replace(/(\d{2})\.\d{3}\.\d{3}\/\d{4}-(\d{2})/,"$1.***.***/**-$2")}function qi(t){if(!t)return t;const[a,s]=t.split("@");return a.length<=2?`${a}***@${s}`:`${a.slice(0,2)}***@${s}`}function zi(t){return t&&t.replace(/(\d{2})\d{4,5}(\d{4})/,"$1****$2")}function Bi(t){return t&&t.replace(/(\d{2,3})\d+/,"$1***")}function Vi(t){if(!t)return t;let a=t;return a=a.replace(/\d{3}\.\d{3}\.\d{3}-\d{2}/g,s=>Mi(s)),a=a.replace(/\d{2}\.\d{3}\.\d{3}\/\d{4}-\d{2}/g,s=>Li(s)),a=a.replace(/[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}/g,s=>qi(s)),a=a.replace(/\(\d{2}\)\s?\d{4,5}-?\d{4}/g,s=>zi(s)),a=a.replace(/OAB[-\/]?\s?\d{3,6}/gi,s=>{const r=s.match(/\d{3,6}/)?.[0]||"";return s.replace(r,Bi(r))}),a}function rt(t,a){if(!a||!t)return t;if(typeof t=="string")return Vi(t);if(Array.isArray(t))return t.map(s=>rt(s,a));if(typeof t=="object"){const s={};for(const[r,n]of Object.entries(t))s[r]=rt(n,a);return s}return t}function bt({items:t,maxVisible:a=2,isPiiMasked:s=!1}){const{toast:r}=Ve();if(!t||t.length===0)return e.jsx("span",{className:"text-muted-foreground",children:""});const n=rt(t,s),o=n.slice(0,a),i=t.length-a,l=async()=>{try{await navigator.clipboard.writeText(t.join(`
`)),r({title:"Copiado!",description:"Lista copiada para a rea de transferncia."})}catch{r({title:"Erro ao copiar",description:"No foi possvel copiar a lista.",variant:"destructive"})}};return t.length<=a?e.jsx("div",{className:"flex flex-wrap gap-1",children:o.map((m,d)=>e.jsx(te,{variant:"secondary",className:"text-xs",children:m},d))}):e.jsxs("div",{className:"flex items-center gap-1",children:[o.map((m,d)=>e.jsx(te,{variant:"secondary",className:"text-xs",children:m},d)),i>0&&e.jsxs(jr,{children:[e.jsx(br,{asChild:!0,children:e.jsxs(K,{variant:"ghost",size:"sm",className:"h-6 px-2 text-xs",children:["+",i," ",e.jsx(Pt,{className:"ml-1 h-3 w-3"})]})}),e.jsx(Nr,{className:"w-80",align:"start",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h4",{className:"font-medium",children:["Lista completa (",t.length," itens)"]}),e.jsx(K,{variant:"ghost",size:"sm",onClick:l,className:"h-8 px-2",children:e.jsx(mt,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"flex flex-wrap gap-1 max-h-48 overflow-y-auto",children:n.map((m,d)=>e.jsx(te,{variant:"outline",className:"text-xs",children:m},d))})]})})]})]})}const Ui=[" Mapeando conexes de testemunhas"," Checando histrico probatrio"," Analisando padres de triangulao"," Identificando riscos processuais"," Cruzando dados do polo ativo"," Gerando insights estratgicos"," Compilando relatrio executivo"],W=Ka((t,a)=>({processos:[],testemunhas:[],activeTab:"processos",selectedProcesso:null,selectedTestemunha:null,isDetailDrawerOpen:!1,isImportModalOpen:!1,isLoading:!1,isPiiMasked:!1,hasError:!1,errorMessage:"",lastUpdate:null,processoFilters:{},testemunhaFilters:{},columnVisibility:{processos:{cnj:!0,uf:!0,comarca:!0,fase:!0,status:!0,reclamante:!0,qtdDepos:!0,testemunhas:!0,classificacao:!0,acoes:!0},testemunhas:{nome:!0,qtdDepo:!0,ambosPolos:!0,jaReclamante:!0,cnjs:!0,classificacao:!0,acoes:!0}},savedViews:{},activeView:null,processosPage:1,testemunhasPage:1,pageSize:100,totalProcessos:0,totalTestemunhas:0,hasMoreProcessos:!1,hasMoreTestemunhas:!1,chatKind:"processo",chatInput:"",chatMessages:[],chatStatus:"idle",agentOnline:!0,chatResult:null,loadingHints:Ui,currentHintIndex:0,density:"comfortable",navigationHistory:[{label:"Mapa de Testemunhas",path:"/mapa-testemunhas"}],setActiveTab:s=>t({activeTab:s}),setProcessos:s=>t({processos:s}),setTestemunhas:s=>t({testemunhas:s}),setSelectedProcesso:s=>t({selectedProcesso:s}),setSelectedTestemunha:s=>t({selectedTestemunha:s}),setIsDetailDrawerOpen:s=>t({isDetailDrawerOpen:s}),setIsImportModalOpen:s=>t({isImportModalOpen:s}),setIsLoading:s=>t({isLoading:s}),setIsPiiMasked:s=>t({isPiiMasked:s}),setError:(s,r="")=>t({hasError:s,errorMessage:r}),setLastUpdate:s=>t({lastUpdate:s}),setProcessoFilters:s=>t(r=>{const n={...r.processoFilters,...s};return Object.keys(s).forEach(o=>{s[o]===void 0&&delete n[o]}),{processoFilters:n,processosPage:1}}),setTestemunhaFilters:s=>t(r=>{const n={...r.testemunhaFilters,...s};return Object.keys(s).forEach(o=>{s[o]===void 0&&delete n[o]}),{testemunhaFilters:n,testemunhasPage:1}}),setColumnVisibility:(s,r,n)=>t(o=>({columnVisibility:{...o.columnVisibility,[s]:{...o.columnVisibility[s],[r]:n}}})),saveView:(s,r)=>t(n=>{const o={...n.savedViews,[s]:{processoFilters:n.processoFilters,testemunhaFilters:n.testemunhaFilters,columnVisibility:n.columnVisibility}};return typeof window<"u"&&(localStorage.setItem(`mapaViews_${r}`,JSON.stringify(o)),localStorage.setItem(`mapaActiveView_${r}`,s)),{savedViews:o,activeView:s}}),loadViews:s=>{if(typeof window>"u")return;const r=localStorage.getItem(`mapaViews_${s}`),n=r?JSON.parse(r):{},o=localStorage.getItem(`mapaActiveView_${s}`);t({savedViews:n,activeView:o}),o&&n[o]&&t({processoFilters:n[o].processoFilters,testemunhaFilters:n[o].testemunhaFilters,columnVisibility:n[o].columnVisibility})},setActiveViewName:(s,r)=>t(n=>{const o=n.savedViews[s];return o?(typeof window<"u"&&localStorage.setItem(`mapaActiveView_${r}`,s),{activeView:s,processoFilters:o.processoFilters,testemunhaFilters:o.testemunhaFilters,columnVisibility:o.columnVisibility}):{}}),setProcessosPage:s=>t({processosPage:s}),setTestemunhasPage:s=>t({testemunhasPage:s}),setTotalProcessos:s=>t({totalProcessos:s}),setTotalTestemunhas:s=>t({totalTestemunhas:s}),setHasMoreProcessos:s=>t({hasMoreProcessos:s}),setHasMoreTestemunhas:s=>t({hasMoreTestemunhas:s}),loadMoreProcessos:()=>t(s=>({processosPage:s.processosPage+1})),loadMoreTestemunhas:()=>t(s=>({testemunhasPage:s.testemunhasPage+1})),removeProcesso:s=>{let r=null;return t(n=>{const o=n.processos.findIndex(l=>l.cnj===s);if(o===-1)return{};r=n.processos[o];const i=[...n.processos];return i.splice(o,1),{processos:i,totalProcessos:n.totalProcessos-1}}),r},restoreProcesso:s=>t(r=>({processos:[s,...r.processos],totalProcessos:r.totalProcessos+1})),removeTestemunha:s=>{let r=null;return t(n=>{const o=n.testemunhas.findIndex(l=>l.nome_testemunha===s);if(o===-1)return{};r=n.testemunhas[o];const i=[...n.testemunhas];return i.splice(o,1),{testemunhas:i,totalTestemunhas:n.totalTestemunhas-1}}),r},restoreTestemunha:s=>t(r=>({testemunhas:[s,...r.testemunhas],totalTestemunhas:r.totalTestemunhas+1})),resetFilters:()=>t({processoFilters:{},testemunhaFilters:{},processosPage:1,testemunhasPage:1}),setChatKind:s=>t({chatKind:s}),setChatInput:s=>t({chatInput:s}),addChatMessage:s=>{const r={...s,id:`msg-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,timestamp:new Date};return t(n=>({chatMessages:[...n.chatMessages,r]})),r.id},updateChatMessage:(s,r)=>t(n=>({chatMessages:n.chatMessages.map(o=>o.id===s?{...o,...r}:o)})),setChatStatus:s=>t({chatStatus:s}),setAgentOnline:s=>t({agentOnline:s}),setChatResult:s=>t({chatResult:s}),resetChat:()=>t({chatInput:"",chatMessages:[],chatStatus:"idle",chatResult:null,currentHintIndex:0}),nextHint:()=>t(s=>({currentHintIndex:(s.currentHintIndex+1)%s.loadingHints.length})),setDensity:s=>t({density:s}),pushNavigation:s=>t(r=>r.navigationHistory[r.navigationHistory.length-1]?.path===s.path?{}:{navigationHistory:[...r.navigationHistory,s]}),popNavigation:s=>t(r=>({navigationHistory:r.navigationHistory.slice(0,s+1)})),clearNavigation:()=>t({navigationHistory:[{label:"Mapa de Testemunhas",path:"/mapa-testemunhas"}]})})),un=t=>t.activeTab,Hi=t=>t.processos,Ji=t=>t.testemunhas,Wi=t=>t.isLoading,mn=t=>t.isPiiMasked,Ki=t=>t.hasError,Gi=t=>t.errorMessage,Yi=t=>t.lastUpdate,Qi=t=>t.processoFilters,Xi=t=>t.testemunhaFilters,Zi=t=>t.isImportModalOpen,aa=t=>t.columnVisibility,el=t=>t.savedViews,tl=t=>t.activeView;function hn({score:t,riscoNivel:a,className:s}){const o=a?(i=>{switch(i){case"alto":return{level:"Alto",color:"bg-destructive text-destructive-foreground"};case"medio":return{level:"Mdio",color:"bg-amber-500/15 text-amber-600 border-amber-500/30"};case"baixo":return{level:"Baixo",color:"bg-emerald-500/15 text-emerald-600 border-emerald-500/30"}}})(a):t!==void 0?(i=>i>=70?{level:"VALIDAR",color:"bg-destructive text-destructive-foreground",riscoNivel:"alto"}:i>=50?{level:"AVALIAR",color:"bg-warning text-warning-foreground",riscoNivel:"medio"}:i>=30?{level:"CONHECER",color:"bg-success text-success-foreground",riscoNivel:"baixo"}:{level:"DESCARTAR",color:"bg-muted text-muted-foreground",riscoNivel:"baixo"})(t):{level:"N/A",color:"bg-muted text-muted-foreground"};return e.jsxs(te,{className:k("font-semibold px-3 py-1 shadow-sm",o.color,s),children:[o.level,t!==void 0&&!a?` (${t})`:""]})}function fn(t){const{toast:a}=Ve(),s=h.useRef(new Map);return{remove:({key:n,label:o,onDelete:i,onRestore:l})=>{const m=i();if(!m)return;s.current.set(n,m);const d=()=>{const x=s.current.get(n);x&&(l(x),s.current.delete(n))};a({title:`${t} removido`,description:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:o}),e.jsxs(K,{variant:"outline",size:"sm",onClick:d,className:"ml-2 h-6 px-2 text-xs",children:[e.jsx(io,{className:"h-3 w-3 mr-1"}),"Desfazer"]})]}),duration:5e3}),setTimeout(()=>{s.current.delete(n)},5e3)}}}function ra({open:t,title:a,description:s,confirmText:r="Confirmar",cancelText:n="Cancelar",loading:o=!1,onConfirm:i,onCancel:l}){return e.jsx(Pi,{open:t,onOpenChange:m=>!m&&l(),children:e.jsxs(Zr,{children:[e.jsxs(en,{children:[e.jsx(sn,{children:a}),s&&e.jsx(an,{children:s})]}),e.jsxs(tn,{children:[e.jsx(nn,{disabled:o,children:n}),e.jsxs(rn,{onClick:i,disabled:o,children:[o&&e.jsx(Dt,{className:"mr-2 h-4 w-4 animate-spin"}),r]})]})]})})}const pn={density:{compact:{row:"py-1",cell:"px-3 py-1",text:"text-xs",badge:"text-[10px] px-1.5 py-0",button:"h-6 w-6",icon:"h-3 w-3"},comfortable:{row:"py-3",cell:"px-4 py-3",text:"text-sm",badge:"text-xs px-2 py-0.5",button:"h-8 w-8",icon:"h-4 w-4"}}};function sl({data:t}){const{setSelectedProcesso:a,setIsDetailDrawerOpen:s,isPiiMasked:r,removeProcesso:n,restoreProcesso:o,density:i}=W(),l=W(aa).processos,{remove:m}=fn("Processo"),[d,x]=h.useState(null),[f,w]=h.useState(!1),y=pn.density[i],z=D=>{a(D),s(!0)},v=D=>{x(D),w(!0)},J=()=>{d&&m({key:d.cnj,label:d.cnj,onDelete:()=>n(d.cnj),onRestore:o}),w(!1),x(null)},A=D=>{switch(D?.toLowerCase()){case"ativo":return"bg-success text-success-foreground";case"arquivado":return"bg-muted text-muted-foreground";case"suspenso":return"bg-warning text-warning-foreground";case"baixado":return"bg-secondary text-secondary-foreground";case"cancelado":return"bg-destructive text-destructive-foreground";default:return"bg-muted text-muted-foreground"}};return t.length?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"border border-border/50 rounded-2xl overflow-hidden",children:e.jsxs(wr,{children:[e.jsx(yr,{children:e.jsxs(ds,{className:"bg-muted/30",children:[l.cnj&&e.jsx(Re,{className:"font-semibold",children:"CNJ"}),l.uf&&e.jsx(Re,{className:"font-semibold",children:"UF"}),l.comarca&&e.jsx(Re,{className:"font-semibold",children:"Comarca"}),l.fase&&e.jsx(Re,{className:"font-semibold",children:"Fase"}),l.status&&e.jsx(Re,{className:"font-semibold",children:"Status"}),l.reclamante&&e.jsx(Re,{className:"font-semibold",children:"Reclamante"}),l.qtdDepos&&e.jsx(Re,{className:"font-semibold",children:"Qtd Depo nicos"}),l.testemunhas&&e.jsx(Re,{className:"font-semibold",children:"Testemunhas Ativo"}),l.classificacao&&e.jsx(Re,{className:"font-semibold",children:"Classificao"}),l.acoes&&e.jsx(Re,{className:"font-semibold text-center",children:"Aes"})]})}),e.jsx(_r,{children:t.map(D=>e.jsxs(ds,{className:k("hover:bg-muted/20",y.row),children:[l.cnj&&e.jsx(De,{className:k("font-mono",y.cell,y.text),children:rt(D.cnj,r)}),l.uf&&e.jsx(De,{className:y.cell,children:e.jsx(te,{variant:"outline",className:y.badge,children:D.uf})}),l.comarca&&e.jsx(De,{className:k("max-w-[150px] truncate",y.cell,y.text),title:D.comarca||"",children:rt(D.comarca,r)||""}),l.fase&&e.jsx(De,{className:y.cell,children:e.jsx(te,{variant:"secondary",className:y.badge,children:D.fase||""})}),l.status&&e.jsx(De,{className:y.cell,children:e.jsx(te,{className:k(y.badge,A(D.status)),children:D.status||""})}),l.reclamante&&e.jsx(De,{className:k("max-w-[180px] truncate",y.cell,y.text),title:D.reclamante_limpo||"",children:rt(D.reclamante_limpo,r)||""}),l.qtdDepos&&e.jsx(De,{className:k("text-center",y.cell),children:D.qtd_total_depos_unicos?e.jsx(hn,{score:D.qtd_total_depos_unicos}):""}),l.testemunhas&&e.jsx(De,{className:y.cell,children:e.jsx(bt,{items:D.testemunhas_ativo_limpo,maxVisible:2,isPiiMasked:r})}),l.classificacao&&e.jsx(De,{className:y.cell,children:e.jsx(te,{variant:D.classificacao_final==="ALTO RISCO"?"destructive":"secondary",className:y.badge,children:D.classificacao_final||""})}),l.acoes&&e.jsx(De,{className:y.cell,children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(K,{variant:"ghost",size:"sm",onClick:()=>z(D),className:k("p-0",y.button),children:e.jsx(nt,{className:y.icon})}),e.jsx(K,{variant:"ghost",size:"sm",className:k("p-0",y.button),children:e.jsx(cr,{className:y.icon})}),e.jsx(K,{variant:"ghost",size:"sm",className:k("p-0 text-destructive hover:text-destructive",y.button),onClick:()=>v(D),children:e.jsx(dr,{className:y.icon})})]})})]},D.cnj))})]})}),e.jsx(ra,{open:f,title:"Excluir processo?",description:d?`Deseja excluir o processo ${d.cnj}?`:void 0,confirmText:"Excluir",onConfirm:J,onCancel:()=>{w(!1),x(null)}})]}):e.jsx("div",{className:"border border-border/50 rounded-2xl p-12 text-center",children:e.jsxs("div",{className:"text-muted-foreground space-y-2",children:[e.jsx("p",{className:"text-lg",children:"Nenhum processo encontrado"}),e.jsx("p",{className:"text-sm",children:"Ajuste os filtros ou importe dados via Excel"})]})})}function ga({value:t,trueLabel:a="Sim",falseLabel:s="No",size:r="md",className:n}){return t==null?e.jsx(te,{variant:"outline",className:k("font-normal text-muted-foreground",r==="sm"?"text-[10px] px-1.5":"text-xs px-2",n),children:""}):t===!0?e.jsx(te,{variant:"outline",className:k("bg-green-100 text-green-800 border-green-200 font-medium","dark:bg-green-950/30 dark:text-green-400 dark:border-green-900",r==="sm"?"text-[10px] px-1.5":"text-xs px-2",n),children:a}):e.jsx(te,{variant:"outline",className:k("bg-gray-100 text-gray-600 border-gray-200 font-normal","dark:bg-gray-900/30 dark:text-gray-400 dark:border-gray-800",r==="sm"?"text-[10px] px-1.5":"text-xs px-2",n),children:s})}function al({value:t,size:a="md"}){if(!t||t===""||t==="PENDENTE"||t==="")return e.jsx(te,{variant:"outline",className:k("font-normal text-muted-foreground",a==="sm"?"text-[10px] px-1.5 py-0":"text-xs"),children:"No classificada"});const s=t.toLowerCase(),r=()=>s.includes("crtica")||s.includes("alto")||s.includes("alta")?"bg-red-100 text-red-800 border-red-200 dark:bg-red-950/30 dark:text-red-400 dark:border-red-900":s.includes("relevante")||s.includes("mdio")||s.includes("media")?"bg-yellow-100 text-yellow-800 border-yellow-200 dark:bg-yellow-950/30 dark:text-yellow-400 dark:border-yellow-900":s.includes("comum")||s.includes("baixo")||s.includes("baixa")?"bg-green-100 text-green-800 border-green-200 dark:bg-green-950/30 dark:text-green-400 dark:border-green-900":"bg-secondary text-secondary-foreground";return e.jsx(te,{variant:"outline",className:k("font-medium border",r(),a==="sm"?"text-[10px] px-1.5 py-0":"text-xs"),children:t})}function Ut({status:t,onRetry:a,children:s}){return t==="loading"?e.jsx("div",{className:"p-8 text-center text-sm text-muted-foreground",children:"Carregando..."}):t==="error"?e.jsxs("div",{className:"p-8 text-center space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 text-destructive",children:[e.jsx(Bt,{className:"h-4 w-4"}),e.jsx("span",{children:"Erro ao carregar"})]}),a&&e.jsx(K,{variant:"outline",size:"sm",onClick:a,children:"Tentar novamente"})]}):t==="offline"?e.jsxs("div",{className:"p-8 text-center space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 text-destructive",children:[e.jsx(Bt,{className:"h-4 w-4"}),e.jsx("span",{children:"Sem conexo"})]}),a&&e.jsx(K,{variant:"outline",size:"sm",onClick:a,children:"Tentar novamente"})]}):t==="empty"?e.jsx("div",{className:"p-12 text-center text-muted-foreground",children:"Nenhum dado encontrado"}):e.jsx(e.Fragment,{children:s})}function rl({data:t,status:a,onRetry:s}){const{setSelectedTestemunha:r,setIsDetailDrawerOpen:n,isPiiMasked:o,removeTestemunha:i,restoreTestemunha:l,density:m}=W(),d=W(aa).testemunhas,{remove:x}=fn("Testemunha"),[f,w]=h.useState(null),[y,z]=h.useState(!1),v=pn.density[m],J=h.useCallback(I=>{r(I),n(!0)},[r,n]);if(a!=="success")return e.jsx(Ut,{status:a,onRetry:s});if(!t.length)return e.jsx(Ut,{status:"empty",onRetry:s});const A=h.useCallback(I=>{w(I),z(!0)},[]),D=h.useCallback(()=>{f&&x({key:f.nome_testemunha,label:f.nome_testemunha,onDelete:()=>i(f.nome_testemunha),onRestore:l}),z(!1),w(null)},[f,x,i,l]);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"border border-border/50 rounded-2xl overflow-hidden",children:e.jsxs(wr,{children:[e.jsx(yr,{children:e.jsxs(ds,{className:"bg-muted/30",children:[d.nome&&e.jsx(Re,{className:"font-semibold",children:"Nome da Testemunha"}),d.qtdDepo&&e.jsx(Re,{className:"font-semibold text-center",children:"Qtd Depoimentos"}),d.ambosPolos&&e.jsx(Re,{className:"font-semibold text-center",children:"Ambos os Polos"}),d.jaReclamante&&e.jsx(Re,{className:"font-semibold text-center",children:"J Foi Reclamante"}),d.cnjs&&e.jsx(Re,{className:"font-semibold",children:"CNJs como Testemunha"}),d.classificacao&&e.jsx(Re,{className:"font-semibold",children:"Classificao Estratgica"}),d.acoes&&e.jsx(Re,{className:"font-semibold text-center",children:"Aes"})]})}),e.jsx(_r,{children:t.map(I=>e.jsxs(ds,{className:k("group hover:bg-muted/20",v.row),children:[d.nome&&e.jsx(De,{className:k("font-medium max-w-[200px] truncate",v.cell,v.text),title:I.nome_testemunha,children:rt(I.nome_testemunha,o)}),d.qtdDepo&&e.jsx(De,{className:k("text-center",v.cell),children:e.jsx(te,{variant:"secondary",className:v.badge,children:I.qtd_depoimentos||0})}),d.ambosPolos&&e.jsx(De,{className:k("text-center",v.cell),children:e.jsx(ga,{value:I.foi_testemunha_em_ambos_polos,size:"sm"})}),d.jaReclamante&&e.jsx(De,{className:k("text-center",v.cell),children:e.jsx(ga,{value:I.ja_foi_reclamante,size:"sm"})}),d.cnjs&&e.jsx(De,{className:v.cell,children:e.jsx(bt,{items:I.cnjs_como_testemunha,maxVisible:2,isPiiMasked:o})}),d.classificacao&&e.jsx(De,{className:v.cell,children:e.jsx(al,{value:I.classificacao||I.classificacao_estrategica,size:"sm"})}),d.acoes&&e.jsx(De,{className:v.cell,children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(K,{variant:"ghost",size:"sm",onClick:()=>J(I),className:k("p-0 text-primary hover:bg-primary/10 hover:text-primary",v.button),title:"Visualizar detalhes",children:e.jsx(nt,{className:v.icon,strokeWidth:2})}),e.jsx(K,{variant:"ghost",size:"sm",className:k("p-0 text-muted-foreground hover:text-foreground hover:bg-muted",v.button),title:"Editar",children:e.jsx(cr,{className:v.icon,strokeWidth:1.5})}),e.jsx(K,{variant:"ghost",size:"sm",className:k("p-0 opacity-0 group-hover:opacity-100 text-destructive hover:bg-destructive/10 hover:text-destructive transition-opacity",v.button),onClick:()=>A(I),title:"Excluir",children:e.jsx(dr,{className:v.icon,strokeWidth:1.5})})]})})]},I.nome_testemunha))})]})}),e.jsx(ra,{open:y,title:"Excluir testemunha?",description:f?`Deseja excluir ${f.nome_testemunha}?`:void 0,confirmText:"Excluir",onConfirm:D,onCancel:()=>{z(!1),w(null)}})]})}const nl=["AC","AL","AP","AM","BA","CE","DF","ES","GO","MA","MT","MS","MG","PA","PB","PR","PE","PI","RJ","RN","RS","RO","RR","SC","SP","SE","TO"],ol=["Ativo","Arquivado","Suspenso","Baixado","Cancelado"],il=["Conhecimento","Execuo","Recursal","Liquidao"];function ll(){const{processoFilters:t,setProcessoFilters:a,resetFilters:s}=W(),r=(i,l)=>{if(l===""||l===void 0||l==="TODAS"||l==="TODOS"){const m={...t};delete m[i],a(m)}else a({[i]:l})},n=()=>{s()},o=Object.keys(t).length>0;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(Rt,{className:"h-5 w-5"}),"Filtros - Por Processo"]}),o&&e.jsxs(K,{variant:"ghost",size:"sm",onClick:n,children:[e.jsx(ut,{className:"h-4 w-4 mr-1"}),"Limpar"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(ke,{htmlFor:"search",children:"Buscar"}),e.jsx(lt,{id:"search",placeholder:"CNJ, comarca, reclamante...",value:t.search||"",onChange:i=>r("search",i.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ke,{htmlFor:"testemunha",children:"Testemunha"}),e.jsx(lt,{id:"testemunha",placeholder:"Nome da testemunha...",value:t.testemunha||"",onChange:i=>r("testemunha",i.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ke,{htmlFor:"uf",children:"UF"}),e.jsxs(ct,{value:t.uf||"TODAS",onValueChange:i=>r("uf",i),children:[e.jsx(st,{id:"uf",children:e.jsx(dt,{placeholder:"Selecione..."})}),e.jsxs(at,{children:[e.jsx(ye,{value:"TODAS",children:"Todas"}),nl.map(i=>e.jsx(ye,{value:i,children:i},i))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ke,{htmlFor:"status",children:"Status"}),e.jsxs(ct,{value:t.status||"TODOS",onValueChange:i=>r("status",i),children:[e.jsx(st,{id:"status",children:e.jsx(dt,{placeholder:"Selecione..."})}),e.jsxs(at,{children:[e.jsx(ye,{value:"TODOS",children:"Todos"}),ol.map(i=>e.jsx(ye,{value:i,children:i},i))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ke,{htmlFor:"fase",children:"Fase"}),e.jsxs(ct,{value:t.fase||"TODAS",onValueChange:i=>r("fase",i),children:[e.jsx(st,{id:"fase",children:e.jsx(dt,{placeholder:"Selecione..."})}),e.jsxs(at,{children:[e.jsx(ye,{value:"TODAS",children:"Todas"}),il.map(i=>e.jsx(ye,{value:i,children:i},i))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ke,{htmlFor:"qtdMin",children:"Qtd Depo nicos (Mn)"}),e.jsx(lt,{id:"qtdMin",type:"number",placeholder:"0",value:t.qtdDeposMin||"",onChange:i=>r("qtdDeposMin",i.target.value?Number(i.target.value):void 0)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ke,{htmlFor:"qtdMax",children:"Qtd Depo nicos (Mx)"}),e.jsx(lt,{id:"qtdMax",type:"number",placeholder:"",value:t.qtdDeposMax||"",onChange:i=>r("qtdDeposMax",i.target.value?Number(i.target.value):void 0)})]})]})]})}function cl(){const{testemunhaFilters:t,setTestemunhaFilters:a,resetFilters:s}=W(),r=(i,l)=>{if(l===""||l===void 0||l==="TODOS"){const m={...t};delete m[i],a(m)}else a({[i]:l})},n=()=>{s()},o=Object.keys(t).length>0;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(Rt,{className:"h-5 w-5"}),"Filtros - Por Testemunha"]}),o&&e.jsxs(K,{variant:"ghost",size:"sm",onClick:n,children:[e.jsx(ut,{className:"h-4 w-4 mr-1"}),"Limpar"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(ke,{htmlFor:"search",children:"Buscar"}),e.jsx(lt,{id:"search",placeholder:"Nome da testemunha...",value:t.search||"",onChange:i=>r("search",i.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ke,{htmlFor:"ambosPolos",children:"Em Ambos os Polos"}),e.jsxs(ct,{value:t.ambosPolos!==void 0?t.ambosPolos.toString():"TODOS",onValueChange:i=>r("ambosPolos",i==="TODOS"?void 0:i==="true"),children:[e.jsx(st,{id:"ambosPolos",children:e.jsx(dt,{placeholder:"Selecione..."})}),e.jsxs(at,{children:[e.jsx(ye,{value:"TODOS",children:"Todos"}),e.jsx(ye,{value:"true",children:"Sim"}),e.jsx(ye,{value:"false",children:"No"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ke,{htmlFor:"jaFoiReclamante",children:"J Foi Reclamante"}),e.jsxs(ct,{value:t.jaFoiReclamante!==void 0?t.jaFoiReclamante.toString():"TODOS",onValueChange:i=>r("jaFoiReclamante",i==="TODOS"?void 0:i==="true"),children:[e.jsx(st,{id:"jaFoiReclamante",children:e.jsx(dt,{placeholder:"Selecione..."})}),e.jsxs(at,{children:[e.jsx(ye,{value:"TODOS",children:"Todos"}),e.jsx(ye,{value:"true",children:"Sim"}),e.jsx(ye,{value:"false",children:"No"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ke,{htmlFor:"temTriangulacao",children:"Participou Triangulao"}),e.jsxs(ct,{value:t.temTriangulacao!==void 0?t.temTriangulacao.toString():"TODOS",onValueChange:i=>r("temTriangulacao",i==="TODOS"?void 0:i==="true"),children:[e.jsx(st,{id:"temTriangulacao",children:e.jsx(dt,{placeholder:"Selecione..."})}),e.jsxs(at,{children:[e.jsx(ye,{value:"TODOS",children:"Todos"}),e.jsx(ye,{value:"true",children:"Sim"}),e.jsx(ye,{value:"false",children:"No"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ke,{htmlFor:"temTroca",children:"Participou Troca"}),e.jsxs(ct,{value:t.temTroca!==void 0?t.temTroca.toString():"TODOS",onValueChange:i=>r("temTroca",i==="TODOS"?void 0:i==="true"),children:[e.jsx(st,{id:"temTroca",children:e.jsx(dt,{placeholder:"Selecione..."})}),e.jsxs(at,{children:[e.jsx(ye,{value:"TODOS",children:"Todos"}),e.jsx(ye,{value:"true",children:"Sim"}),e.jsx(ye,{value:"false",children:"No"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ke,{htmlFor:"qtdMin",children:"Qtd Depoimentos (Mn)"}),e.jsx(lt,{id:"qtdMin",type:"number",placeholder:"0",value:t.qtdDeposMin||"",onChange:i=>r("qtdDeposMin",i.target.value?Number(i.target.value):void 0)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ke,{htmlFor:"qtdMax",children:"Qtd Depoimentos (Mx)"}),e.jsx(lt,{id:"qtdMax",type:"number",placeholder:"",value:t.qtdDeposMax||"",onChange:i=>r("qtdDeposMax",i.target.value?Number(i.target.value):void 0)})]})]})]})}function dl({open:t,onOpenChange:a}){const s=W(o=>o.activeTab),[r,n]=h.useState(s==="processos"?"processos":"testemunhas");return h.useEffect(()=>{n(s==="processos"?"processos":"testemunhas")},[s]),e.jsx(kr,{open:t,onOpenChange:a,children:e.jsxs(Qs,{side:"right",className:"w-[600px] sm:w-[700px] overflow-y-auto",children:[e.jsxs(Xs,{children:[e.jsx(Zs,{children:"Filtros Avanados"}),e.jsx(ea,{children:"Refine sua busca com filtros especficos por processo ou testemunha"})]}),e.jsx("div",{className:"mt-6",children:e.jsxs(xr,{value:r,onValueChange:n,children:[e.jsxs(gr,{className:"grid w-full grid-cols-2",children:[e.jsx(ls,{value:"processos",children:"Por Processo"}),e.jsx(ls,{value:"testemunhas",children:"Por Testemunha"})]}),e.jsx(cs,{value:"processos",className:"mt-4",children:e.jsx(ll,{})}),e.jsx(cs,{value:"testemunhas",className:"mt-4",children:e.jsx(cl,{})})]})})]})})}function ul(){const t=W(un),a=W(aa),s=W(o=>o.setColumnVisibility),r=t==="processos"?[{key:"cnj",label:"CNJ"},{key:"uf",label:"UF"},{key:"comarca",label:"Comarca"},{key:"fase",label:"Fase"},{key:"status",label:"Status"},{key:"reclamante",label:"Reclamante"},{key:"qtdDepos",label:"Qtd Depo nicos"},{key:"testemunhas",label:"Testemunhas Ativo"},{key:"classificacao",label:"Classificao"},{key:"acoes",label:"Aes"}]:[{key:"nome",label:"Nome da Testemunha"},{key:"qtdDepo",label:"Qtd Depoimentos"},{key:"ambosPolos",label:"Ambos os Polos"},{key:"jaReclamante",label:"J Foi Reclamante"},{key:"cnjs",label:"CNJs como Testemunha"},{key:"classificacao",label:"Classificao Estratgica"},{key:"acoes",label:"Aes"}],n=a[t];return e.jsxs(Wt,{children:[e.jsx(Kt,{asChild:!0,children:e.jsxs(K,{variant:"outline",size:"sm",className:"flex items-center gap-2",children:[e.jsx(lo,{className:"h-4 w-4"})," Colunas"]})}),e.jsx(It,{align:"end",children:r.map(o=>e.jsx(Pr,{checked:n[o.key],onCheckedChange:i=>s(t,o.key,i),children:o.label},o.key))})]})}function ml({userId:t}){const a=W(el),s=W(tl),r=W(i=>i.saveView),n=W(i=>i.setActiveViewName),o=()=>{const i=window.prompt("Nome da visualizao");i&&r(i,t)};return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(ct,{value:s||"",onValueChange:i=>n(i,t),children:[e.jsx(st,{className:"w-[200px]",children:e.jsx(dt,{placeholder:"Visualizaes"})}),e.jsx(at,{children:Object.keys(a).map(i=>e.jsx(ye,{value:i,children:i},i))})]}),e.jsxs(K,{variant:"outline",size:"sm",onClick:o,className:"flex items-center gap-2",children:[e.jsx(co,{className:"h-4 w-4"})," Salvar viso"]})]})}function hl(t){if(typeof document>"u")return;let a=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",a.appendChild(s),s.styleSheet?s.styleSheet.cssText=t:s.appendChild(document.createTextNode(t))}const xn=q.createContext({drawerRef:{current:null},overlayRef:{current:null},onPress:()=>{},onRelease:()=>{},onDrag:()=>{},onNestedDrag:()=>{},onNestedOpenChange:()=>{},onNestedRelease:()=>{},openProp:void 0,dismissible:!1,isOpen:!1,isDragging:!1,keyboardIsOpen:{current:!1},snapPointsOffset:null,snapPoints:null,handleOnly:!1,modal:!1,shouldFade:!1,activeSnapPoint:null,onOpenChange:()=>{},setActiveSnapPoint:()=>{},closeDrawer:()=>{},direction:"bottom",shouldScaleBackground:!1,setBackgroundColorOnScale:!0,noBodyStyles:!1,container:null,autoFocus:!1}),Yt=()=>{const t=q.useContext(xn);if(!t)throw new Error("useDrawerContext must be used within a Drawer.Root");return t};hl(`[data-vaul-drawer]{touch-action:none;will-change:transform;transition:transform .5s cubic-bezier(.32, .72, 0, 1);animation-duration:.5s;animation-timing-function:cubic-bezier(0.32,0.72,0,1)}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=bottom][data-state=open]{animation-name:slideFromBottom}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=bottom][data-state=closed]{animation-name:slideToBottom}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=top][data-state=open]{animation-name:slideFromTop}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=top][data-state=closed]{animation-name:slideToTop}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=left][data-state=open]{animation-name:slideFromLeft}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=left][data-state=closed]{animation-name:slideToLeft}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=right][data-state=open]{animation-name:slideFromRight}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=right][data-state=closed]{animation-name:slideToRight}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=bottom]{transform:translate3d(0,100%,0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=top]{transform:translate3d(0,-100%,0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=left]{transform:translate3d(-100%,0,0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=right]{transform:translate3d(100%,0,0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=top]{transform:translate3d(0,var(--snap-point-height,0),0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=bottom]{transform:translate3d(0,var(--snap-point-height,0),0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=left]{transform:translate3d(var(--snap-point-height,0),0,0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=right]{transform:translate3d(var(--snap-point-height,0),0,0)}[data-vaul-overlay][data-vaul-snap-points=false]{animation-duration:.5s;animation-timing-function:cubic-bezier(0.32,0.72,0,1)}[data-vaul-overlay][data-vaul-snap-points=false][data-state=open]{animation-name:fadeIn}[data-vaul-overlay][data-state=closed]{animation-name:fadeOut}[data-vaul-overlay][data-vaul-snap-points=true]{opacity:0;transition:opacity .5s cubic-bezier(.32, .72, 0, 1)}[data-vaul-overlay][data-vaul-snap-points=true]{opacity:1}[data-vaul-drawer]:not([data-vaul-custom-container=true])::after{content:'';position:absolute;background:inherit;background-color:inherit}[data-vaul-drawer][data-vaul-drawer-direction=top]::after{top:initial;bottom:100%;left:0;right:0;height:200%}[data-vaul-drawer][data-vaul-drawer-direction=bottom]::after{top:100%;bottom:initial;left:0;right:0;height:200%}[data-vaul-drawer][data-vaul-drawer-direction=left]::after{left:initial;right:100%;top:0;bottom:0;width:200%}[data-vaul-drawer][data-vaul-drawer-direction=right]::after{left:100%;right:initial;top:0;bottom:0;width:200%}[data-vaul-overlay][data-vaul-snap-points=true]:not([data-vaul-snap-points-overlay=true]):not(
[data-state=closed]
){opacity:0}[data-vaul-overlay][data-vaul-snap-points-overlay=true]{opacity:1}[data-vaul-handle]{display:block;position:relative;opacity:.7;background:#e2e2e4;margin-left:auto;margin-right:auto;height:5px;width:32px;border-radius:1rem;touch-action:pan-y}[data-vaul-handle]:active,[data-vaul-handle]:hover{opacity:1}[data-vaul-handle-hitarea]{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);width:max(100%,2.75rem);height:max(100%,2.75rem);touch-action:inherit}@media (hover:hover) and (pointer:fine){[data-vaul-drawer]{user-select:none}}@media (pointer:fine){[data-vaul-handle-hitarea]:{width:100%;height:100%}}@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes fadeOut{to{opacity:0}}@keyframes slideFromBottom{from{transform:translate3d(0,100%,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToBottom{to{transform:translate3d(0,100%,0)}}@keyframes slideFromTop{from{transform:translate3d(0,-100%,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToTop{to{transform:translate3d(0,-100%,0)}}@keyframes slideFromLeft{from{transform:translate3d(-100%,0,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToLeft{to{transform:translate3d(-100%,0,0)}}@keyframes slideFromRight{from{transform:translate3d(100%,0,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToRight{to{transform:translate3d(100%,0,0)}}`);const fl=24,pl=typeof window<"u"?h.useLayoutEffect:h.useEffect;function va(...t){return(...a)=>{for(let s of t)typeof s=="function"&&s(...a)}}function xl(){return na(/^Mac/)}function gl(){return na(/^iPhone/)}function ja(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}function vl(){return na(/^iPad/)||xl()&&navigator.maxTouchPoints>1}function gn(){return gl()||vl()}function na(t){return typeof window<"u"&&window.navigator!=null?t.test(window.navigator.platform):void 0}const Ns=typeof document<"u"&&window.visualViewport;function ba(t){let a=window.getComputedStyle(t);return/(auto|scroll)/.test(a.overflow+a.overflowX+a.overflowY)}function vn(t){for(ba(t)&&(t=t.parentElement);t&&!ba(t);)t=t.parentElement;return t||document.scrollingElement||document.documentElement}const jl=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);let es=0,ws;function bl(t={}){let{isDisabled:a}=t;pl(()=>{if(!a)return es++,es===1&&gn()&&(ws=Nl()),()=>{es--,es===0&&ws?.()}},[a])}function Nl(){let t,a=0,s=f=>{t=vn(f.target),!(t===document.documentElement&&t===document.body)&&(a=f.changedTouches[0].pageY)},r=f=>{if(!t||t===document.documentElement||t===document.body){f.preventDefault();return}let w=f.changedTouches[0].pageY,y=t.scrollTop,z=t.scrollHeight-t.clientHeight;z!==0&&((y<=0&&w>a||y>=z&&w<a)&&f.preventDefault(),a=w)},n=f=>{let w=f.target;Bs(w)&&w!==document.activeElement&&(f.preventDefault(),w.style.transform="translateY(-2000px)",w.focus(),requestAnimationFrame(()=>{w.style.transform=""}))},o=f=>{let w=f.target;Bs(w)&&(w.style.transform="translateY(-2000px)",requestAnimationFrame(()=>{w.style.transform="",Ns&&(Ns.height<window.innerHeight?requestAnimationFrame(()=>{Na(w)}):Ns.addEventListener("resize",()=>Na(w),{once:!0}))}))},i=()=>{window.scrollTo(0,0)},l=window.pageXOffset,m=window.pageYOffset,d=va(wl(document.documentElement,"paddingRight",`${window.innerWidth-document.documentElement.clientWidth}px`));window.scrollTo(0,0);let x=va($t(document,"touchstart",s,{passive:!1,capture:!0}),$t(document,"touchmove",r,{passive:!1,capture:!0}),$t(document,"touchend",n,{passive:!1,capture:!0}),$t(document,"focus",o,!0),$t(window,"scroll",i));return()=>{d(),x(),window.scrollTo(l,m)}}function wl(t,a,s){let r=t.style[a];return t.style[a]=s,()=>{t.style[a]=r}}function $t(t,a,s,r){return t.addEventListener(a,s,r),()=>{t.removeEventListener(a,s,r)}}function Na(t){let a=document.scrollingElement||document.documentElement;for(;t&&t!==a;){let s=vn(t);if(s!==document.documentElement&&s!==document.body&&s!==t){let r=s.getBoundingClientRect().top,n=t.getBoundingClientRect().top,o=t.getBoundingClientRect().bottom;const i=s.getBoundingClientRect().bottom+fl;o>i&&(s.scrollTop+=n-r)}t=s.parentElement}}function Bs(t){return t instanceof HTMLInputElement&&!jl.has(t.type)||t instanceof HTMLTextAreaElement||t instanceof HTMLElement&&t.isContentEditable}function yl(t,a){typeof t=="function"?t(a):t!=null&&(t.current=a)}function _l(...t){return a=>t.forEach(s=>yl(s,a))}function jn(...t){return h.useCallback(_l(...t),t)}const bn=new WeakMap;function Ce(t,a,s=!1){if(!t||!(t instanceof HTMLElement))return;let r={};Object.entries(a).forEach(([n,o])=>{if(n.startsWith("--")){t.style.setProperty(n,o);return}r[n]=t.style[n],t.style[n]=o}),!s&&bn.set(t,r)}function Cl(t,a){if(!t||!(t instanceof HTMLElement))return;let s=bn.get(t);s&&(t.style[a]=s[a])}const Se=t=>{switch(t){case"top":case"bottom":return!0;case"left":case"right":return!1;default:return t}};function ts(t,a){if(!t)return null;const s=window.getComputedStyle(t),r=s.transform||s.webkitTransform||s.mozTransform;let n=r.match(/^matrix3d\((.+)\)$/);return n?parseFloat(n[1].split(", ")[Se(a)?13:12]):(n=r.match(/^matrix\((.+)\)$/),n?parseFloat(n[1].split(", ")[Se(a)?5:4]):null)}function Sl(t){return 8*(Math.log(t+1)-2)}function ys(t,a){if(!t)return()=>{};const s=t.style.cssText;return Object.assign(t.style,a),()=>{t.style.cssText=s}}function Tl(...t){return(...a)=>{for(const s of t)typeof s=="function"&&s(...a)}}const be={DURATION:.5,EASE:[.32,.72,0,1]},Nn=.4,El=.25,Rl=100,wn=8,vt=16,Vs=26,_s="vaul-dragging";function yn(t){const a=q.useRef(t);return q.useEffect(()=>{a.current=t}),q.useMemo(()=>(...s)=>a.current==null?void 0:a.current.call(a,...s),[])}function Dl({defaultProp:t,onChange:a}){const s=q.useState(t),[r]=s,n=q.useRef(r),o=yn(a);return q.useEffect(()=>{n.current!==r&&(o(r),n.current=r)},[r,n,o]),s}function _n({prop:t,defaultProp:a,onChange:s=()=>{}}){const[r,n]=Dl({defaultProp:a,onChange:s}),o=t!==void 0,i=o?t:r,l=yn(s),m=q.useCallback(d=>{if(o){const f=typeof d=="function"?d(t):d;f!==t&&l(f)}else n(d)},[o,t,n,l]);return[i,m]}function kl({activeSnapPointProp:t,setActiveSnapPointProp:a,snapPoints:s,drawerRef:r,overlayRef:n,fadeFromIndex:o,onSnapPointChange:i,direction:l="bottom",container:m,snapToSequentialPoint:d}){const[x,f]=_n({prop:t,defaultProp:s?.[0],onChange:a}),[w,y]=q.useState(typeof window<"u"?{innerWidth:window.innerWidth,innerHeight:window.innerHeight}:void 0);q.useEffect(()=>{function S(){y({innerWidth:window.innerWidth,innerHeight:window.innerHeight})}return window.addEventListener("resize",S),()=>window.removeEventListener("resize",S)},[]);const z=q.useMemo(()=>x===s?.[s.length-1]||null,[s,x]),v=q.useMemo(()=>s?.findIndex(S=>S===x),[s,x]),J=s&&s.length>0&&(o||o===0)&&!Number.isNaN(o)&&s[o]===x||!s,A=q.useMemo(()=>{const S=m?{width:m.getBoundingClientRect().width,height:m.getBoundingClientRect().height}:typeof window<"u"?{width:window.innerWidth,height:window.innerHeight}:{width:0,height:0};var c;return(c=s?.map(u=>{const p=typeof u=="string";let N=0;if(p&&(N=parseInt(u,10)),Se(l)){const $=p?N:w?u*S.height:0;return w?l==="bottom"?S.height-$:-S.height+$:$}const T=p?N:w?u*S.width:0;return w?l==="right"?S.width-T:-S.width+T:T}))!=null?c:[]},[s,w,m]),D=q.useMemo(()=>v!==null?A?.[v]:null,[A,v]),I=q.useCallback(S=>{var c;const u=(c=A?.findIndex(p=>p===S))!=null?c:null;i(u),Ce(r.current,{transition:`transform ${be.DURATION}s cubic-bezier(${be.EASE.join(",")})`,transform:Se(l)?`translate3d(0, ${S}px, 0)`:`translate3d(${S}px, 0, 0)`}),A&&u!==A.length-1&&u!==o&&u<o?Ce(n.current,{transition:`opacity ${be.DURATION}s cubic-bezier(${be.EASE.join(",")})`,opacity:"0"}):Ce(n.current,{transition:`opacity ${be.DURATION}s cubic-bezier(${be.EASE.join(",")})`,opacity:"1"}),f(s?.[Math.max(u,0)])},[r.current,s,A,o,n,f]);q.useEffect(()=>{if(x||t){var S;const c=(S=s?.findIndex(u=>u===t||u===x))!=null?S:-1;A&&c!==-1&&typeof A[c]=="number"&&I(A[c])}},[x,t,s,A,I]);function P({draggedDistance:S,closeDrawer:c,velocity:u,dismissible:p}){if(o===void 0)return;const N=l==="bottom"||l==="right"?(D??0)-S:(D??0)+S,T=v===o-1,$=v===0,Z=S>0;if(T&&Ce(n.current,{transition:`opacity ${be.DURATION}s cubic-bezier(${be.EASE.join(",")})`}),!d&&u>2&&!Z){p?c():I(A[0]);return}if(!d&&u>2&&Z&&A&&s){I(A[s.length-1]);return}const oe=A?.reduce((L,re)=>typeof L!="number"||typeof re!="number"?L:Math.abs(re-N)<Math.abs(L-N)?re:L),de=Se(l)?window.innerHeight:window.innerWidth;if(u>Nn&&Math.abs(S)<de*.4){const L=Z?1:-1;if(L>0&&z){I(A[s.length-1]);return}if($&&L<0&&p&&c(),v===null)return;I(A[v+L]);return}I(oe)}function G({draggedDistance:S}){if(D===null)return;const c=l==="bottom"||l==="right"?D-S:D+S;(l==="bottom"||l==="right")&&c<A[A.length-1]||(l==="top"||l==="left")&&c>A[A.length-1]||Ce(r.current,{transform:Se(l)?`translate3d(0, ${c}px, 0)`:`translate3d(${c}px, 0, 0)`})}function U(S,c){if(!s||typeof v!="number"||!A||o===void 0)return null;const u=v===o-1;if(v>=o&&c)return 0;if(u&&!c)return 1;if(!J&&!u)return null;const N=u?v+1:v-1,T=u?A[N]-A[N-1]:A[N+1]-A[N],$=S/Math.abs(T);return u?1-$:$}return{isLastSnapPoint:z,activeSnapPoint:x,shouldFade:J,getPercentageDragged:U,setActiveSnapPoint:f,activeSnapPointIndex:v,onRelease:P,onDrag:G,snapPointsOffset:A}}const Al=()=>()=>{};function Pl(){const{direction:t,isOpen:a,shouldScaleBackground:s,setBackgroundColorOnScale:r,noBodyStyles:n}=Yt(),o=q.useRef(null),i=h.useMemo(()=>document.body.style.backgroundColor,[]);function l(){return(window.innerWidth-Vs)/window.innerWidth}q.useEffect(()=>{if(a&&s){o.current&&clearTimeout(o.current);const m=document.querySelector("[data-vaul-drawer-wrapper]")||document.querySelector("[vaul-drawer-wrapper]");if(!m)return;Tl(r&&!n?ys(document.body,{background:"black"}):Al,ys(m,{transformOrigin:Se(t)?"top":"left",transitionProperty:"transform, border-radius",transitionDuration:`${be.DURATION}s`,transitionTimingFunction:`cubic-bezier(${be.EASE.join(",")})`}));const d=ys(m,{borderRadius:`${wn}px`,overflow:"hidden",...Se(t)?{transform:`scale(${l()}) translate3d(0, calc(env(safe-area-inset-top) + 14px), 0)`}:{transform:`scale(${l()}) translate3d(calc(env(safe-area-inset-top) + 14px), 0, 0)`}});return()=>{d(),o.current=window.setTimeout(()=>{i?document.body.style.background=i:document.body.style.removeProperty("background")},be.DURATION*1e3)}}},[a,s,i])}let Mt=null;function Ol({isOpen:t,modal:a,nested:s,hasBeenOpened:r,preventScrollRestoration:n,noBodyStyles:o}){const[i,l]=q.useState(()=>typeof window<"u"?window.location.href:""),m=q.useRef(0),d=q.useCallback(()=>{if(ja()&&Mt===null&&t&&!o){Mt={position:document.body.style.position,top:document.body.style.top,left:document.body.style.left,height:document.body.style.height,right:"unset"};const{scrollX:f,innerHeight:w}=window;document.body.style.setProperty("position","fixed","important"),Object.assign(document.body.style,{top:`${-m.current}px`,left:`${-f}px`,right:"0px",height:"auto"}),window.setTimeout(()=>window.requestAnimationFrame(()=>{const y=w-window.innerHeight;y&&m.current>=w&&(document.body.style.top=`${-(m.current+y)}px`)}),300)}},[t]),x=q.useCallback(()=>{if(ja()&&Mt!==null&&!o){const f=-parseInt(document.body.style.top,10),w=-parseInt(document.body.style.left,10);Object.assign(document.body.style,Mt),window.requestAnimationFrame(()=>{if(n&&i!==window.location.href){l(window.location.href);return}window.scrollTo(w,f)}),Mt=null}},[i]);return q.useEffect(()=>{function f(){m.current=window.scrollY}return f(),window.addEventListener("scroll",f),()=>{window.removeEventListener("scroll",f)}},[]),q.useEffect(()=>{s||!r||(t?(!window.matchMedia("(display-mode: standalone)").matches&&d(),a||window.setTimeout(()=>{x()},500)):x())},[t,r,i,a,s,d,x]),{restorePositionSetting:x}}function Il({open:t,onOpenChange:a,children:s,onDrag:r,onRelease:n,snapPoints:o,shouldScaleBackground:i=!1,setBackgroundColorOnScale:l=!0,closeThreshold:m=El,scrollLockTimeout:d=Rl,dismissible:x=!0,handleOnly:f=!1,fadeFromIndex:w=o&&o.length-1,activeSnapPoint:y,setActiveSnapPoint:z,fixed:v,modal:J=!0,onClose:A,nested:D,noBodyStyles:I,direction:P="bottom",defaultOpen:G=!1,disablePreventScroll:U=!0,snapToSequentialPoint:S=!1,preventScrollRestoration:c=!1,repositionInputs:u=!0,onAnimationEnd:p,container:N,autoFocus:T=!1}){var $,Z;const[oe=!1,de]=_n({defaultProp:G,prop:t,onChange:ee=>{a?.(ee),!ee&&!D&&ve(),setTimeout(()=>{p?.(ee)},be.DURATION*1e3),ee&&!J&&typeof window<"u"&&window.requestAnimationFrame(()=>{document.body.style.pointerEvents="auto"}),ee||(document.body.style.pointerEvents="auto")}}),[L,re]=q.useState(!1),[B,ue]=q.useState(!1),[Y,j]=q.useState(!1),b=q.useRef(null),C=q.useRef(null),g=q.useRef(null),E=q.useRef(null),F=q.useRef(null),O=q.useRef(!1),R=q.useRef(null),ie=q.useRef(0),H=q.useRef(!1),ce=q.useRef(0),M=q.useRef(null),ne=q.useRef((($=M.current)==null?void 0:$.getBoundingClientRect().height)||0),le=q.useRef(((Z=M.current)==null?void 0:Z.getBoundingClientRect().width)||0),_=q.useRef(0),se=q.useCallback(ee=>{o&&ee===fe.length-1&&(C.current=new Date)},[]),{activeSnapPoint:V,activeSnapPointIndex:Q,setActiveSnapPoint:ae,onRelease:Ne,snapPointsOffset:fe,onDrag:Te,shouldFade:pe,getPercentageDragged:Ee}=kl({snapPoints:o,activeSnapPointProp:y,setActiveSnapPointProp:z,drawerRef:M,fadeFromIndex:w,overlayRef:b,onSnapPointChange:se,direction:P,container:N,snapToSequentialPoint:S});bl({isDisabled:!oe||B||!J||Y||!L||!u||!U});const{restorePositionSetting:ve}=Ol({isOpen:oe,modal:J,nested:D,hasBeenOpened:L,preventScrollRestoration:c,noBodyStyles:I});function _e(){return(window.innerWidth-Vs)/window.innerWidth}function We(ee){var me,xe;!x&&!o||M.current&&!M.current.contains(ee.target)||(ne.current=((me=M.current)==null?void 0:me.getBoundingClientRect().height)||0,le.current=((xe=M.current)==null?void 0:xe.getBoundingClientRect().width)||0,ue(!0),g.current=new Date,gn()&&window.addEventListener("touchend",()=>O.current=!1,{once:!0}),ee.target.setPointerCapture(ee.pointerId),ie.current=Se(P)?ee.pageY:ee.pageX)}function yt(ee,me){var xe,je;let he=ee;const He=(xe=window.getSelection())==null?void 0:xe.toString(),Oe=M.current?ts(M.current,P):null,Le=new Date;if(he.hasAttribute("data-vaul-no-drag")||he.closest("[data-vaul-no-drag]"))return!1;if(P==="right"||P==="left")return!0;if(C.current&&Le.getTime()-C.current.getTime()<500)return!1;if(Oe!==null&&(P==="bottom"?Oe>0:Oe<0))return!0;if(He&&He.length>0)return!1;if(Le.getTime()-((je=F.current)==null?void 0:je.getTime())<d&&Oe===0||me)return F.current=Le,!1;for(;he;){if(he.scrollHeight>he.clientHeight){if(he.scrollTop!==0)return F.current=new Date,!1;if(he.getAttribute("role")==="dialog")return!0}he=he.parentNode}return!0}function Qt(ee){if(M.current&&B){const me=P==="bottom"||P==="right"?1:-1,xe=(ie.current-(Se(P)?ee.pageY:ee.pageX))*me,je=xe>0,he=o&&!x&&!je;if(he&&Q===0)return;const He=Math.abs(xe),Oe=document.querySelector("[data-vaul-drawer-wrapper]"),Le=P==="bottom"||P==="top"?ne.current:le.current;let Ke=He/Le;const gt=Ee(He,je);if(gt!==null&&(Ke=gt),he&&Ke>=1||!O.current&&!yt(ee.target,je))return;if(M.current.classList.add(_s),O.current=!0,Ce(M.current,{transition:"none"}),Ce(b.current,{transition:"none"}),o&&Te({draggedDistance:xe}),je&&!o){const Xe=Sl(xe),Zt=Math.min(Xe*-1,0)*me;Ce(M.current,{transform:Se(P)?`translate3d(0, ${Zt}px, 0)`:`translate3d(${Zt}px, 0, 0)`});return}const it=1-Ke;if((pe||w&&Q===w-1)&&(r?.(ee,Ke),Ce(b.current,{opacity:`${it}`,transition:"none"},!0)),Oe&&b.current&&i){const Xe=Math.min(_e()+Ke*(1-_e()),1),Zt=8-Ke*8,oa=Math.max(0,14-Ke*14);Ce(Oe,{borderRadius:`${Zt}px`,transform:Se(P)?`scale(${Xe}) translate3d(0, ${oa}px, 0)`:`scale(${Xe}) translate3d(${oa}px, 0, 0)`,transition:"none"},!0)}if(!o){const Xe=He*me;Ce(M.current,{transform:Se(P)?`translate3d(0, ${Xe}px, 0)`:`translate3d(${Xe}px, 0, 0)`})}}}q.useEffect(()=>{var ee;function me(){if(!M.current||!u)return;const xe=document.activeElement;if(Bs(xe)||H.current){var je;const he=((je=window.visualViewport)==null?void 0:je.height)||0,He=window.innerHeight;let Oe=He-he;const Le=M.current.getBoundingClientRect().height||0,Ke=Le>He*.8;_.current||(_.current=Le);const gt=M.current.getBoundingClientRect().top;if(Math.abs(ce.current-Oe)>60&&(H.current=!H.current),o&&o.length>0&&fe&&Q){const it=fe[Q]||0;Oe+=it}if(ce.current=Oe,Le>he||H.current){const it=M.current.getBoundingClientRect().height;let Xe=it;it>he&&(Xe=he-(Ke?gt:Vs)),v?M.current.style.height=`${it-Math.max(Oe,0)}px`:M.current.style.height=`${Math.max(Xe,he-gt)}px`}else M.current.style.height=`${_.current}px`;o&&o.length>0&&!H.current?M.current.style.bottom="0px":M.current.style.bottom=`${Math.max(Oe,0)}px`}}return(ee=window.visualViewport)==null||ee.addEventListener("resize",me),()=>{var xe;return(xe=window.visualViewport)==null?void 0:xe.removeEventListener("resize",me)}},[Q,o,fe]);function Ue(ee){xt(),A?.(),ee||de(!1),setTimeout(()=>{o&&ae(o[0])},be.DURATION*1e3)}function Me(){if(!M.current)return;const ee=document.querySelector("[data-vaul-drawer-wrapper]"),me=ts(M.current,P);Ce(M.current,{transform:"translate3d(0, 0, 0)",transition:`transform ${be.DURATION}s cubic-bezier(${be.EASE.join(",")})`}),Ce(b.current,{transition:`opacity ${be.DURATION}s cubic-bezier(${be.EASE.join(",")})`,opacity:"1"}),i&&me&&me>0&&oe&&Ce(ee,{borderRadius:`${wn}px`,overflow:"hidden",...Se(P)?{transform:`scale(${_e()}) translate3d(0, calc(env(safe-area-inset-top) + 14px), 0)`,transformOrigin:"top"}:{transform:`scale(${_e()}) translate3d(calc(env(safe-area-inset-top) + 14px), 0, 0)`,transformOrigin:"left"},transitionProperty:"transform, border-radius",transitionDuration:`${be.DURATION}s`,transitionTimingFunction:`cubic-bezier(${be.EASE.join(",")})`},!0)}function xt(){!B||!M.current||(M.current.classList.remove(_s),O.current=!1,ue(!1),E.current=new Date)}function Xt(ee){if(!B||!M.current)return;M.current.classList.remove(_s),O.current=!1,ue(!1),E.current=new Date;const me=ts(M.current,P);if(!yt(ee.target,!1)||!me||Number.isNaN(me)||g.current===null)return;const xe=E.current.getTime()-g.current.getTime(),je=ie.current-(Se(P)?ee.pageY:ee.pageX),he=Math.abs(je)/xe;if(he>.05&&(j(!0),setTimeout(()=>{j(!1)},200)),o){Ne({draggedDistance:je*(P==="bottom"||P==="right"?1:-1),closeDrawer:Ue,velocity:he,dismissible:x}),n?.(ee,!0);return}if(P==="bottom"||P==="right"?je>0:je<0){Me(),n?.(ee,!0);return}if(he>Nn){Ue(),n?.(ee,!1);return}var He;const Oe=Math.min((He=M.current.getBoundingClientRect().height)!=null?He:0,window.innerHeight);var Le;const Ke=Math.min((Le=M.current.getBoundingClientRect().width)!=null?Le:0,window.innerWidth),gt=P==="left"||P==="right";if(Math.abs(me)>=(gt?Ke:Oe)*m){Ue(),n?.(ee,!1);return}n?.(ee,!0),Me()}q.useEffect(()=>(oe&&(Ce(document.documentElement,{scrollBehavior:"auto"}),C.current=new Date),()=>{Cl(document.documentElement,"scrollBehavior")}),[oe]);function In(ee){const me=ee?(window.innerWidth-vt)/window.innerWidth:1,xe=ee?-vt:0;R.current&&window.clearTimeout(R.current),Ce(M.current,{transition:`transform ${be.DURATION}s cubic-bezier(${be.EASE.join(",")})`,transform:`scale(${me}) translate3d(0, ${xe}px, 0)`}),!ee&&M.current&&(R.current=setTimeout(()=>{const je=ts(M.current,P);Ce(M.current,{transition:"none",transform:Se(P)?`translate3d(0, ${je}px, 0)`:`translate3d(${je}px, 0, 0)`})},500))}function Fn(ee,me){if(me<0)return;const xe=(window.innerWidth-vt)/window.innerWidth,je=xe+me*(1-xe),he=-vt+me*vt;Ce(M.current,{transform:Se(P)?`scale(${je}) translate3d(0, ${he}px, 0)`:`scale(${je}) translate3d(${he}px, 0, 0)`,transition:"none"})}function $n(ee,me){const xe=Se(P)?window.innerHeight:window.innerWidth,je=me?(xe-vt)/xe:1,he=me?-vt:0;me&&Ce(M.current,{transition:`transform ${be.DURATION}s cubic-bezier(${be.EASE.join(",")})`,transform:Se(P)?`scale(${je}) translate3d(0, ${he}px, 0)`:`scale(${je}) translate3d(${he}px, 0, 0)`})}return q.createElement(fs,{defaultOpen:G,onOpenChange:ee=>{!x&&!ee||(ee?re(!0):Ue(!0),de(ee))},open:oe},q.createElement(xn.Provider,{value:{activeSnapPoint:V,snapPoints:o,setActiveSnapPoint:ae,drawerRef:M,overlayRef:b,onOpenChange:a,onPress:We,onRelease:Xt,onDrag:Qt,dismissible:x,handleOnly:f,isOpen:oe,isDragging:B,shouldFade:pe,closeDrawer:Ue,onNestedDrag:Fn,onNestedOpenChange:In,onNestedRelease:$n,keyboardIsOpen:H,modal:J,snapPointsOffset:fe,direction:P,shouldScaleBackground:i,setBackgroundColorOnScale:l,noBodyStyles:I,container:N,autoFocus:T}},s))}const Cn=q.forwardRef(function({...t},a){const{overlayRef:s,snapPoints:r,onRelease:n,shouldFade:o,isOpen:i,modal:l}=Yt(),m=jn(a,s),d=r&&r.length>0;return l?q.createElement(kt,{onMouseUp:n,ref:m,"data-vaul-overlay":"","data-vaul-snap-points":i&&d?"true":"false","data-vaul-snap-points-overlay":i&&o?"true":"false",...t}):(typeof window<"u"&&window.requestAnimationFrame(()=>{document.body.style.pointerEvents="auto"}),null)});Cn.displayName="Drawer.Overlay";const Sn=q.forwardRef(function({onPointerDownOutside:t,style:a,onOpenAutoFocus:s,...r},n){const{drawerRef:o,onPress:i,onRelease:l,onDrag:m,keyboardIsOpen:d,snapPointsOffset:x,modal:f,isOpen:w,direction:y,snapPoints:z,container:v,handleOnly:J,autoFocus:A}=Yt(),[D,I]=q.useState(!1),P=jn(n,o),G=q.useRef(null),U=q.useRef(null),S=q.useRef(!1),c=z&&z.length>0;Pl();const u=(N,T,$=0)=>{if(S.current)return!0;const Z=Math.abs(N.y),oe=Math.abs(N.x),de=oe>Z,L=["bottom","right"].includes(T)?1:-1;if(T==="left"||T==="right"){if(!(N.x*L<0)&&oe>=0&&oe<=$)return de}else if(!(N.y*L<0)&&Z>=0&&Z<=$)return!de;return S.current=!0,!0};q.useEffect(()=>{c&&window.requestAnimationFrame(()=>{I(!0)})},[]);function p(N){G.current=null,S.current=!1,l(N)}return q.createElement(At,{"data-vaul-drawer-direction":y,"data-vaul-drawer":"","data-vaul-delayed-snap-points":D?"true":"false","data-vaul-snap-points":w&&c?"true":"false","data-vaul-custom-container":v?"true":"false",...r,ref:P,style:x&&x.length>0?{"--snap-point-height":`${x[0]}px`,...a}:a,onPointerDown:N=>{J||(r.onPointerDown==null||r.onPointerDown.call(r,N),G.current={x:N.pageX,y:N.pageY},i(N))},onOpenAutoFocus:N=>{s?.(N),A||N.preventDefault()},onPointerDownOutside:N=>{if(t?.(N),!f||N.defaultPrevented){N.preventDefault();return}d.current&&(d.current=!1)},onFocusOutside:N=>{if(!f){N.preventDefault();return}},onPointerMove:N=>{if(U.current=N,J||(r.onPointerMove==null||r.onPointerMove.call(r,N),!G.current))return;const T=N.pageY-G.current.y,$=N.pageX-G.current.x,Z=N.pointerType==="touch"?10:2;u({x:$,y:T},y,Z)?m(N):(Math.abs($)>Z||Math.abs(T)>Z)&&(G.current=null)},onPointerUp:N=>{r.onPointerUp==null||r.onPointerUp.call(r,N),G.current=null,S.current=!1,l(N)},onPointerOut:N=>{r.onPointerOut==null||r.onPointerOut.call(r,N),p(U.current)},onContextMenu:N=>{r.onContextMenu==null||r.onContextMenu.call(r,N),p(U.current)}})});Sn.displayName="Drawer.Content";const Fl=250,$l=120,Ml=q.forwardRef(function({preventCycle:t=!1,children:a,...s},r){const{closeDrawer:n,isDragging:o,snapPoints:i,activeSnapPoint:l,setActiveSnapPoint:m,dismissible:d,handleOnly:x,isOpen:f,onPress:w,onDrag:y}=Yt(),z=q.useRef(null),v=q.useRef(!1);function J(){if(v.current){I();return}window.setTimeout(()=>{A()},$l)}function A(){if(o||t||v.current){I();return}if(I(),(!i||i.length===0)&&d){n();return}if(l===i[i.length-1]&&d){n();return}const G=i.findIndex(S=>S===l);if(G===-1)return;const U=i[G+1];m(U)}function D(){z.current=window.setTimeout(()=>{v.current=!0},Fl)}function I(){window.clearTimeout(z.current),v.current=!1}return q.createElement("div",{onClick:J,onPointerCancel:I,onPointerDown:P=>{x&&w(P),D()},onPointerMove:P=>{x&&y(P)},ref:r,"data-vaul-drawer-visible":f?"true":"false","data-vaul-handle":"","aria-hidden":"true",...s},q.createElement("span",{"data-vaul-handle-hitarea":"","aria-hidden":"true"},a))});Ml.displayName="Drawer.Handle";function Ll(t){const a=Yt(),{container:s=a.container,...r}=t;return q.createElement(hs,{container:s,...r})}const ot={Root:Il,Content:Sn,Overlay:Cn,Portal:Ll,Title:Ht,Description:Jt},Tn=({shouldScaleBackground:t=!0,...a})=>e.jsx(ot.Root,{shouldScaleBackground:t,...a});Tn.displayName="Drawer";const ql=ot.Portal,En=h.forwardRef(({className:t,...a},s)=>e.jsx(ot.Overlay,{ref:s,className:k("fixed inset-0 z-50 bg-black/80",t),...a}));En.displayName=ot.Overlay.displayName;const Rn=h.forwardRef(({className:t,children:a,...s},r)=>e.jsxs(ql,{children:[e.jsx(En,{}),e.jsxs(ot.Content,{ref:r,className:k("fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background",t),...s,children:[e.jsx("div",{className:"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted"}),a]})]}));Rn.displayName="DrawerContent";const Dn=({className:t,...a})=>e.jsx("div",{className:k("grid gap-1.5 p-4 text-center sm:text-left",t),...a});Dn.displayName="DrawerHeader";const kn=h.forwardRef(({className:t,...a},s)=>e.jsx(ot.Title,{ref:s,className:k("text-lg font-semibold leading-none tracking-tight",t),...a}));kn.displayName=ot.Title.displayName;const zl=h.forwardRef(({className:t,...a},s)=>e.jsx(ot.Description,{ref:s,className:k("text-sm text-muted-foreground",t),...a}));zl.displayName=ot.Description.displayName;function Bl(){const{isDetailDrawerOpen:t,setIsDetailDrawerOpen:a,selectedProcesso:s,selectedTestemunha:r,isPiiMasked:n}=W(),{toast:o}=Ve(),i=async(d,x)=>{const f=rt(d,n);try{await navigator.clipboard.writeText(f),o({title:"Copiado!",description:`${x} copiado para a rea de transferncia.`})}catch{o({title:"Erro ao copiar",description:`No foi possvel copiar ${x}.`,variant:"destructive"})}},l=({value:d,label:x})=>e.jsxs("div",{className:"flex items-center gap-2",children:[d===null?e.jsx("span",{className:"text-muted-foreground",children:""}):d?e.jsxs(e.Fragment,{children:[e.jsx(Ze,{className:"h-4 w-4 text-success"}),e.jsx("span",{children:"Sim"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ds,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:"No"})]}),x&&e.jsx(K,{variant:"ghost",size:"sm",onClick:()=>i(d?.toString()||"N/A",x),className:"h-6 w-6 p-0",children:e.jsx(mt,{className:"h-3 w-3"})})]}),m=({label:d,value:x,copyable:f=!1})=>e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:d}),f&&x&&e.jsx(K,{variant:"ghost",size:"sm",onClick:()=>i(x.toString(),d),className:"h-6 w-6 p-0",children:e.jsx(mt,{className:"h-3 w-3"})})]}),e.jsx("p",{className:"font-mono text-sm break-all",children:x?rt(x.toString(),n):""})]});return!t||!s&&!r?null:e.jsx(Tn,{open:t,onOpenChange:a,children:e.jsxs(Rn,{className:"max-w-4xl mx-auto",children:[e.jsx(Dn,{children:e.jsx(kn,{children:s?`Processo ${s.cnj}`:`Testemunha ${r?.nome_testemunha}`})}),e.jsxs(Yr,{className:"h-[80vh] px-6 pb-6",children:[s&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-muted/20 rounded-xl p-4",children:e.jsx(te,{variant:"outline",className:"mb-2",children:"Contedo assistivo. Reviso humana obrigatria."})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(m,{label:"CNJ",value:s.cnj,copyable:!0}),e.jsx(m,{label:"Status",value:s.status}),e.jsx(m,{label:"UF",value:s.uf}),e.jsx(m,{label:"Comarca",value:s.comarca,copyable:!0}),e.jsx(m,{label:"Fase",value:s.fase}),e.jsx(m,{label:"Reclamante",value:s.reclamante_limpo,copyable:!0})]}),e.jsx(jt,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold",children:"Advogados Parte Ativa"}),e.jsx(bt,{items:s.advogados_parte_ativa,maxVisible:5,isPiiMasked:n})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold",children:"Testemunhas"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Polo Ativo"}),e.jsx(bt,{items:s.testemunhas_ativo_limpo,maxVisible:5,isPiiMasked:n})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Polo Passivo"}),e.jsx(bt,{items:s.testemunhas_passivo_limpo,maxVisible:5,isPiiMasked:n})]})]})]}),e.jsx(jt,{}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Reclamante foi Testemunha"}),e.jsx(l,{value:s.reclamante_foi_testemunha})]}),e.jsx(m,{label:"Qtd Vezes Reclamante foi Testemunha",value:s.qtd_vezes_reclamante_foi_testemunha}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Troca Direta"}),e.jsx(l,{value:s.troca_direta})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Triangulao Confirmada"}),e.jsx(l,{value:s.triangulacao_confirmada})]})]}),e.jsx(jt,{}),e.jsx(m,{label:"Classificao Final",value:s.classificacao_final}),e.jsx(m,{label:"Insight Estratgico",value:s.insight_estrategico,copyable:!0})]}),r&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-muted/20 rounded-xl p-4",children:e.jsx(te,{variant:"outline",className:"mb-2",children:"Contedo assistivo. Reviso humana obrigatria."})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(m,{label:"Nome da Testemunha",value:r.nome_testemunha,copyable:!0}),e.jsx(m,{label:"Quantidade de Depoimentos",value:r.qtd_depoimentos})]}),e.jsx(jt,{}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"J Foi Reclamante"}),e.jsx(l,{value:r.ja_foi_reclamante})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Foi Testemunha em Ambos os Polos"}),e.jsx(l,{value:r.foi_testemunha_em_ambos_polos})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Participou Troca Favor"}),e.jsx(l,{value:r.participou_troca_favor})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Participou Triangulao"}),e.jsx(l,{value:r.participou_triangulacao})]})]}),e.jsx(jt,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold",children:"CNJs como Testemunha"}),e.jsx(bt,{items:r.cnjs_como_testemunha??null,maxVisible:5,isPiiMasked:n})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold",children:"CNJs como Reclamante"}),e.jsx(bt,{items:r.cnjs_como_reclamante??null,maxVisible:5,isPiiMasked:n})]}),e.jsx(jt,{}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(m,{label:"Classificao",value:r.classificacao??null}),e.jsx(m,{label:"Classificao Estratgica",value:r.classificacao_estrategica??null})]})]})]})]})})}const Vl=uo,Ul=mo,Hl=ho;function Jl(t,a="Voc tem alteraes no salvas. Deseja sair?"){h.useEffect(()=>{if(!t)return;const s=r=>(r.preventDefault(),r.returnValue=a,a);return window.addEventListener("beforeunload",s),()=>{window.removeEventListener("beforeunload",s)}},[t,a])}const Us=t=>String(t??"").replace(/\D/g,""),wa=t=>Us(t).length===20,ya=t=>{const a=String(t??"").trim();if(!a||a==="[]")return[];if(a.startsWith("[")&&a.endsWith("]"))try{return JSON.parse(a.replace(/'/g,'"')).map(s=>String(s).trim()).filter(Boolean)}catch{}return a.split(/[;,]/).map(s=>s.trim()).filter(Boolean)},Wl=["Nome_Testemunha","CNJs_Como_Testemunha"],Kl=["CNJ","Reclamante_Limpo","Reu_Nome"],_a=(t,a)=>(a.utils.sheet_to_json(t,{header:1,blankrows:!1})[0]||[]).map(r=>String(r||"").trim()),Ca=(t,a)=>{const s=new Set(t.map(n=>n.toLowerCase())),r=a.filter(n=>!s.has(n.toLowerCase()));return{ok:r.length===0,missing:r}},Gl=({currentStep:t,validationResults:a,isProcessing:s})=>{const r=[{id:"upload",title:"Upload do Arquivo",icon:ks,description:"Selecione o arquivo Excel"},{id:"validation",title:"Validao",icon:rs,description:"Verificao da qualidade dos dados"},{id:"preview",title:"Prvia",icon:nt,description:"Visualizao antes da importao"},{id:"publish",title:"Importao",icon:Ze,description:"Processamento final"}],n=i=>{const l=r.findIndex(d=>d.id===t),m=r.findIndex(d=>d.id===i);return s&&i===t?"processing":m<l?"completed":m===l?i==="validation"&&(a?.errors?.length??0)>0?"error":"current":"pending"},o=(i,l)=>{const m=i.icon;return l==="processing"?e.jsx(ur,{className:"h-5 w-5 animate-pulse"}):l==="completed"?e.jsx(Ze,{className:"h-5 w-5"}):l==="error"?e.jsx(Bt,{className:"h-5 w-5"}):e.jsx(m,{className:"h-5 w-5"})};return e.jsx("div",{className:"mb-8",children:e.jsx("div",{className:"flex items-center justify-between",children:r.map((i,l)=>{const m=n(i.id),d=m==="current"||m==="processing",x=m==="completed",f=m==="error";return e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:`
                  flex items-center justify-center w-12 h-12 rounded-full border-2 
                  ${x?"bg-green-100 border-green-500 text-green-700 dark:bg-green-950 dark:border-green-400 dark:text-green-300":""}
                  ${d&&!f?"bg-primary/10 border-primary text-primary":""}
                  ${f?"bg-red-100 border-red-500 text-red-700 dark:bg-red-950 dark:border-red-400 dark:text-red-300":""}
                  ${m==="pending"?"bg-muted border-muted-foreground/25 text-muted-foreground":""}
                  transition-all duration-200
                `,children:o(i,m)}),e.jsxs("div",{className:"mt-3 text-center",children:[e.jsx("span",{className:`text-sm font-medium ${d?"text-foreground":x?"text-green-700 dark:text-green-300":f?"text-red-700 dark:text-red-300":"text-muted-foreground"}`,children:i.title}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:i.description})]})]}),l<r.length-1&&e.jsx("div",{className:`
                  w-16 h-0.5 mx-4 
                  ${l<r.findIndex(w=>w.id===t)?"bg-green-500":"bg-muted-foreground/25"}
                  transition-colors duration-200
                `})]},i.id)})})})},Yl=({validationResults:t,fileName:a})=>{const{toast:s}=Ve(),[r,n]=h.useState("empty"),[o,i]=h.useState(!1),l=()=>{vr(async()=>{const x=[["Linha","Coluna","Tipo","Mensagem","Valor"].join(","),`"Resumo","Total: ${t.totalRows}","Vlidos: ${t.validRows}","Erros: ${t.errors.length}","Avisos: ${t.warnings.length}"`,"",...t.errors.map(y=>[y.row,`"${y.column}"`,"Erro",`"${y.message}"`,`"${y.value||""}"`].join(",")),...t.warnings.map(y=>[y.row,`"${y.column}"`,"Aviso",`"${y.message}"`,`"${y.value||""}"`].join(","))].join(`
`),f=new Blob(["\uFEFF"+x],{type:"text/csv;charset=utf-8;"}),w=document.createElement("a");w.href=URL.createObjectURL(f),w.download=`relatorio-validacao-${a.replace(/\.[^/.]+$/,"")}-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(w),w.click(),document.body.removeChild(w),s({title:"Relatrio CSV gerado",description:"Download iniciado com sucesso"})},"ImportModal.generateCSVReport")};return e.jsxs(ge,{children:[e.jsxs(Ae,{children:[e.jsxs(Pe,{className:"flex items-center gap-2",children:[e.jsx(et,{className:"h-5 w-5"}),"Relatrio de Validao"]}),e.jsx(Nt,{children:"Gere relatrios detalhados dos erros e avisos encontrados"})]}),e.jsxs(we,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center p-3 bg-muted rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold",children:t.totalRows.toLocaleString()}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Total de linhas"})]}),e.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold text-green-600",children:t.validRows.toLocaleString()}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Linhas vlidas"})]}),e.jsxs("div",{className:"text-center p-3 bg-red-50 rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold text-red-600",children:t.errors.length}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Erros"})]}),e.jsxs("div",{className:"text-center p-3 bg-orange-50 rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold text-orange-600",children:t.warnings.length}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Avisos"})]})]}),e.jsxs(K,{variant:"outline",onClick:l,className:"flex items-center gap-2",children:[e.jsx(vo,{className:"h-4 w-4"}),"Exportar Relatrio CSV"]})]})]})};function Ql(){const t=W(Zi),a=W(b=>b.setIsImportModalOpen),{toast:s}=Ve(),[r,n]=h.useState("upload"),[o,i]=h.useState(null),[l,m]=h.useState(!1),[d,x]=h.useState(0),[f,w]=h.useState(null),[y,z]=h.useState(null),[v,J]=h.useState("empty"),[A,D]=h.useState(!1),[I,P]=h.useState(!1),G=()=>{n("upload"),i(null),m(!1),x(0),w(null),z(null),J("empty"),D(!1)},U=!!o||r!=="upload";Jl(U);const S=b=>{b?a(!0):U?P(!0):(G(),a(!1))},c=h.useCallback(b=>{const C=b[0];C&&(i(C),w(null),z(null),n("upload"),T(C))},[]),{getRootProps:u,getInputProps:p,isDragActive:N}=fo({onDrop:c,accept:{"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"],"application/vnd.ms-excel":[".xls"]},maxFiles:1}),T=b=>{m(!0),x(0);const C=setInterval(()=>{x(g=>g>=95?(clearInterval(C),95):g+Math.random()*15)},200);oe(b)},$=b=>{const C=[];return b.forEach((g,E)=>{(!g.nome_testemunha||String(g.nome_testemunha).trim()==="")&&C.push({row:E+2,column:"Nome_Testemunha",message:"Nome_Testemunha  obrigatrio",type:"error"});const F=Array.isArray(g.cnjs_como_testemunha)?g.cnjs_como_testemunha:ya(g.cnjs_como_testemunha);F.length||C.push({row:E+2,column:"CNJs_Como_Testemunha",message:"Lista de CNJs vazia",type:"error"}),F.some(wa)||C.push({row:E+2,column:"CNJs_Como_Testemunha",message:"Nenhum CNJ com 20 dgitos na lista",type:"error"})}),C},Z=b=>{const C=[];return b.forEach((g,E)=>{(!g.cnj||!wa(g.cnj))&&C.push({row:E+2,column:"CNJ",message:"CNJ deve ter 20 dgitos (removendo mscara)",value:g.cnj,type:"error"}),(!g.reclamante_limpo||String(g.reclamante_limpo).trim()==="")&&C.push({row:E+2,column:"Reclamante_Limpo",message:"Reclamante_Limpo  obrigatrio",type:"error"}),(!g.reu_nome||String(g.reu_nome).trim()==="")&&C.push({row:E+2,column:"Reu_Nome",message:"Reu_Nome  obrigatrio",type:"error"})}),C},oe=async b=>{await vr(async()=>{const{porProcesso:C,porTestemunha:g,errors:E,warnings:F}=await de(b),O=C.length+g.length,R=O-E.length;w({totalRows:O,validRows:R,errors:E,warnings:F||[],processos:C,testemunhas:g}),n("validation")},"ImportModal.processFileValidation").finally(()=>{m(!1),x(100)})},de=async b=>{const C=await qo(()=>import("./xlsx-BBMPxr6S.js"),[]);return new Promise((g,E)=>{const F=new FileReader;F.onload=O=>{try{const R=new Uint8Array(O.target?.result),ie=C.read(R,{type:"array"}),H=ie.Sheets["Por Processo"],ce=ie.Sheets["Por Testemunha"];if(!H&&!ce)throw new Error('Arquivo deve conter ao menos uma aba: "Por Processo" ou "Por Testemunha".');const M=[],ne=[];let le=[];if(H){const _=_a(H,C),{ok:se,missing:V}=Ca(_,Kl);if(!se)throw new Error(`Modo Processo: faltam colunas: ${V.join(", ")}`);C.utils.sheet_to_json(H,{defval:""}).forEach(ae=>{const Ne=String(ae.CNJ??"").trim(),fe={cnj:Ne,cnj_digits:Us(Ne),reclamante_limpo:ae.Reclamante_Limpo,reu_nome:ae.Reu_Nome,comarca:ae.Comarca??"",fase:ae.Fase??"",status:ae.Status??""};M.push(fe)}),le=le.concat(Z(M))}if(ce){const _=_a(ce,C),{ok:se,missing:V}=Ca(_,Wl);if(!se)throw new Error(`Modo Testemunha: faltam colunas: ${V.join(", ")}`);C.utils.sheet_to_json(ce,{defval:""}).forEach(ae=>{const Ne=ya(ae.CNJs_Como_Testemunha),fe={nome_testemunha:ae.Nome_Testemunha,cnjs_como_testemunha:Ne};ne.push(fe)}),le=le.concat($(ne))}g({porProcesso:M,porTestemunha:ne,errors:le})}catch(R){E(R)}},F.onerror=()=>E(new Error("Erro ao ler arquivo")),F.readAsArrayBuffer(b)})},L=async()=>{if(f){if(!navigator.onLine){J("offline"),D(!0);return}m(!0),x(0),n("publish"),J("loading");try{const b=setInterval(()=>{x(O=>O>=90?(clearInterval(b),90):O+Math.random()*10)},300),C=f.testemunhas.flatMap(O=>O.cnjs_como_testemunha.map(R=>({nome_testemunha:O.nome_testemunha,cnj:R,cnj_digits:Us(R)}))),g={};f.processos.length&&(g.processos=f.processos),C.length&&(g.testemunhas=C);const{data:E,error:F}=await Fe.functions.invoke("import-mapa-testemunhas",{body:g});if(x(100),F)throw F;z(E),J("success"),D(!1),s({title:"Importao concluda!",description:`${E?.upserts??0} registros processados com sucesso.`})}catch(b){console.error("Import error:",b),J(navigator.onLine?"error":"offline"),D(!0),s({title:"Erro na importao",description:b.message||"Ocorreu um erro durante a importao.",variant:"destructive"})}finally{m(!1),x(100)}}},re=()=>{a(!1),i(null),w(null),z(null),n("upload"),x(0)},B=()=>e.jsxs(ge,{children:[e.jsxs(Ae,{children:[e.jsxs(Pe,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ks,{className:"h-5 w-5"}),"Upload de Arquivo Excel"]}),e.jsxs(Vl,{children:[e.jsx(Ul,{asChild:!0,children:e.jsxs(K,{variant:"ghost",size:"sm",className:"text-muted-foreground",children:[e.jsx(po,{className:"h-4 w-4 mr-2"}),"Precisa de ajuda?",e.jsx(Pt,{className:"h-4 w-4 ml-2"})]})}),e.jsx(Hl,{className:"absolute z-10 mt-2 p-4 bg-background border rounded-lg shadow-lg max-w-md right-0",children:e.jsx("div",{className:"space-y-3",children:e.jsxs(Ge,{className:"border-blue-200 bg-blue-50 dark:bg-blue-950",children:[e.jsx(Ws,{className:"h-4 w-4 text-blue-600"}),e.jsxs(Ye,{className:"text-blue-800 dark:text-blue-200",children:[e.jsx("strong",{children:"Formato requerido:"})," Arquivo Excel (.xlsx) com abas:",e.jsx("br",{})," ",e.jsx("strong",{children:"Por Processo:"})," CNJ, Reclamante_Limpo, Reu_Nome",e.jsx("br",{})," ",e.jsx("strong",{children:"Por Testemunha:"})," Nome_Testemunha, CNJs_Como_Testemunha"]})]})})})]})]}),e.jsx(Nt,{children:"Faa upload do arquivo Excel com os dados do mapa de testemunhas"})]}),e.jsxs(we,{children:[e.jsxs("div",{...u(),className:`border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors ${N?"border-primary bg-primary/5":"border-muted-foreground/25 hover:border-primary"}`,children:[e.jsx("input",{...p()}),e.jsx(ks,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),N?e.jsx("p",{className:"text-lg",children:"Solte o arquivo aqui..."}):e.jsxs("div",{children:[e.jsx("p",{className:"text-lg mb-2",children:"Arraste e solte o arquivo aqui"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"ou clique para selecionar"}),e.jsx(K,{variant:"outline",children:"Selecionar Arquivo"})]})]}),o&&e.jsxs("div",{className:"mt-4 p-4 bg-muted rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:o.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[(o.size/1024/1024).toFixed(2)," MB  Excel"]})]}),e.jsx(K,{variant:"ghost",size:"sm",onClick:()=>{i(null),w(null),n("upload")},children:e.jsx(xo,{className:"h-4 w-4"})})]}),l&&e.jsxs("div",{className:"mt-3",children:[e.jsx(us,{value:d,className:"w-full"}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-1 flex items-center gap-2",children:[e.jsx(go,{className:"h-3 w-3 animate-pulse"}),d<95?`Enviando arquivo... ${Math.round(d)}%`:"Processando e validando dados..."]})]})]})]})]}),ue=()=>e.jsxs(ge,{children:[e.jsxs(Ae,{children:[e.jsxs(Pe,{className:"flex items-center gap-2",children:[e.jsx(rs,{className:"h-5 w-5"}),"Validao e Normalizao"]}),e.jsx(Nt,{children:"Verificando a qualidade e consistncia dos dados"})]}),e.jsx(we,{children:f?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold",children:f.totalRows?.toLocaleString()}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Linhas analisadas"})]}),e.jsxs("div",{className:"text-center p-4 bg-green-50 dark:bg-green-950 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:f.validRows?.toLocaleString()}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Linhas vlidas"})]}),e.jsxs("div",{className:"text-center p-4 bg-red-50 dark:bg-red-950 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:f.errors?.length||0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Erros"})]}),e.jsxs("div",{className:"text-center p-4 bg-orange-50 dark:bg-orange-950 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600 dark:text-orange-400",children:f.warnings?.length||0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Avisos"})]})]}),f.errors?.length===0&&f.validRows>0&&e.jsxs(Ge,{className:"border-green-200 bg-green-50 dark:bg-green-950 dark:border-green-800",children:[e.jsx(Ze,{className:"h-4 w-4 text-green-600"}),e.jsxs(Ye,{className:"text-green-800 dark:text-green-200",children:[" Arquivo pronto para importao!"," ",f.validRows," registros sero processados."]})]}),f.errors?.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium",children:"Erros Encontrados:"}),f.errors.slice(0,5).map((b,C)=>e.jsxs(Ge,{variant:"destructive",children:[e.jsx(Bt,{className:"h-4 w-4"}),e.jsxs(Ye,{children:[e.jsxs("strong",{children:["Linha ",b.row,":"]})," ",b.message," (",b.column,")"]})]},C)),f.errors.length>5&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["... e mais ",f.errors.length-5," erros"]})]}),(f.errors?.length>0||f.warnings?.length>0)&&e.jsx(Yl,{validationResults:f,fileName:o?.name||"arquivo"}),e.jsxs("div",{className:"flex gap-2 justify-between",children:[e.jsx(K,{variant:"outline",onClick:()=>n("upload"),children:"Voltar"}),e.jsx("div",{className:"flex gap-2",children:e.jsx(K,{onClick:()=>n("preview"),disabled:f.validRows===0||(f.errors?.length||0)>0,children:f.errors?.length>0?"Corrigir Erros Primeiro":"Continuar para Prvia"})})]})]}):e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ns,{className:"h-8 w-8 animate-spin mx-auto mb-4"}),e.jsx("p",{children:"Validando arquivo..."})]})})})]}),Y=()=>e.jsxs(ge,{children:[e.jsxs(Ae,{children:[e.jsxs(Pe,{className:"flex items-center gap-2",children:[e.jsx(nt,{className:"h-5 w-5"}),"Prvia dos Dados"]}),e.jsx(Nt,{children:"Visualizao dos dados processados e normalizados"})]}),e.jsx(we,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold",children:f?.processos.length||0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Processos"})]}),e.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold",children:f?.testemunhas.length||0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Testemunhas"})]}),e.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[e.jsxs("div",{className:"text-2xl font-bold",children:[f?Math.round(f.validRows/f.totalRows*100):0,"%"]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Taxa de sucesso"})]})]}),e.jsxs(Ge,{className:"border-blue-200 bg-blue-50 dark:bg-blue-950 dark:border-blue-800",children:[e.jsx(nt,{className:"h-4 w-4 text-blue-600"}),e.jsxs(Ye,{className:"text-blue-800 dark:text-blue-200",children:[e.jsx("strong",{children:"Prvia da Importao:"})," ",f?.validRows||0," registros sero processados e inseridos no mapa de testemunhas."]})]}),(f?.processos?.length??0)>0&&e.jsx("div",{className:"border rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-muted",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 text-left",children:"CNJ"}),e.jsx("th",{className:"p-3 text-left",children:"Reclamante"}),e.jsx("th",{className:"p-3 text-left",children:"Ru"})]})}),e.jsx("tbody",{children:f?.processos?.slice(0,3).map((b,C)=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"p-3 font-mono text-sm",children:b.cnj}),e.jsx("td",{className:"p-3",children:b.reclamante_limpo}),e.jsx("td",{className:"p-3",children:b.reu_nome})]},C))})]})}),e.jsxs("div",{className:"flex gap-2 justify-between",children:[e.jsx(K,{variant:"outline",onClick:()=>n("validation"),children:"Voltar para Validao"}),e.jsx(K,{onClick:L,className:"bg-green-600 hover:bg-green-700",disabled:(f?.errors?.length||0)>0,children:"Confirmar Importao"})]})]})})]}),j=()=>e.jsxs(ge,{children:[e.jsxs(Ae,{children:[e.jsxs(Pe,{className:"flex items-center gap-2",children:[e.jsx(Ze,{className:"h-5 w-5"}),"Importao"]}),e.jsx(Nt,{children:"Processamento dos dados no sistema"})]}),e.jsx(we,{children:e.jsx("div",{className:"space-y-4",children:y?e.jsxs("div",{className:"space-y-4",children:[e.jsxs(Ge,{className:"border-green-200 bg-green-50 dark:bg-green-950",children:[e.jsx(Ze,{className:"h-4 w-4 text-green-600"}),e.jsxs(Ye,{className:"text-green-800 dark:text-green-200",children:[e.jsx("strong",{children:"Importao concluda com sucesso!"}),e.jsx("br",{})," Registros processados: ",y.upserts,y.errors?.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("br",{})," Erros: ",y.errors.length]})]})]}),e.jsx(K,{className:"w-full",onClick:re,children:"Fechar"})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ns,{className:"h-8 w-8 animate-spin mx-auto mb-4"}),e.jsx("p",{className:"font-medium",children:"Importando dados..."}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Processando e inserindo registros no mapa de testemunhas."}),e.jsxs("div",{className:"mt-4",children:[e.jsx(us,{value:d,className:"w-full"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:d<100?"Processando...":"Finalizando..."})]})]})})})]});return e.jsxs(e.Fragment,{children:[e.jsx(Sr,{open:t,onOpenChange:S,children:e.jsxs(Gs,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(Er,{children:[e.jsxs(Rr,{className:"flex items-center gap-2",children:[e.jsx(Js,{className:"h-5 w-5"}),"Importar Mapa de Testemunhas"]}),e.jsx(Dr,{children:'Importe dados do Excel com as abas "Por Processo" e/ou "Por Testemunha"'})]}),A&&e.jsx(Ge,{variant:"destructive",className:"mb-4",children:e.jsx(Ye,{children:"Integrao CNJ indisponvel"})}),v!=="empty"&&v!=="success"&&e.jsx(Ut,{status:v,onRetry:L}),e.jsx(Gl,{currentStep:r,validationResults:f??void 0,isProcessing:l}),e.jsxs("div",{className:"space-y-6",children:[r==="upload"&&B(),r==="validation"&&ue(),r==="preview"&&Y(),r==="publish"&&j()]})]})}),e.jsx(ra,{open:I,title:"Descartar alteraes?",description:"Voc possui alteraes no salvas. Deseja realmente sair?",confirmText:"Sair",onConfirm:()=>{P(!1),G(),a(!1)},onCancel:()=>P(!1)})]})}const Xl=()=>{const t=W(s=>s.isPiiMasked),a=W(s=>s.setIsPiiMasked);return e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Qe,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ys,{id:"mask-pii",checked:t,onCheckedChange:a}),e.jsx(ke,{htmlFor:"mask-pii",className:"text-sm font-medium cursor-pointer flex items-center gap-1",children:t?e.jsxs(e.Fragment,{children:[e.jsx(As,{className:"h-3 w-3"}),"Mascarar PII"]}):e.jsxs(e.Fragment,{children:[e.jsx(nt,{className:"h-3 w-3"}),"Mostrar PII"]})})]})]})};function Zl(t){if(t.length!==18)throw new Error("CNJ without check digits must have exactly 18 digits");const a=[2,3,4,5,6,7,8,9,2,3,4,5,6,7,8,9,2,3];let s=0;const r=t.split("").map(Number);for(let i=0;i<r.length;i++)s+=r[i]*a[i];return(98-s%97).toString().padStart(2,"0")}function ec(t){const a=t?.year||2018+Math.floor(Math.random()*8),s=t?.sequential||String(Math.floor(Math.random()*9999999)+1).padStart(7,"0"),r=t?.justice,n=t?.tribunal,o=t?.origin||String(Math.floor(Math.random()*9999)+1).padStart(4,"0"),i=s+a+r+n+o,l=Zl(i);return`${s}-${l}.${a}.${r}.${n}.${o}`}function tc(t,a=2024){const s=[];for(let n=0;n<t;n++){const o=String(1e6+n).padStart(7,"0");s.push(ec({sequential:o,year:a,justice:"5",tribunal:"02",origin:String(1e3+n).padStart(4,"0")}))}return s}const Je=tc(12,2024),ed=[{Aba:"Por Processo",Campo:"CNJ",Tipo:"texto",Obrigatorio:"Sim",Regra:"String com 20 dgitos (preserva formato original). Validao interna remove pontuao.",Exemplo:Je[0]},{Aba:"Por Processo",Campo:"reclamante_nome",Tipo:"texto",Obrigatorio:"Sim (legado)",Regra:"Nome principal do reclamante (campo de compatibilidade)",Exemplo:"Ana Lima"},{Aba:"Por Processo",Campo:"reu_nome",Tipo:"texto",Obrigatorio:"Sim (legado)",Regra:"Nome do ru/empresa (campo de compatibilidade)",Exemplo:"Empresa XYZ Ltda"},{Aba:"Por Processo",Campo:"Status",Tipo:"texto",Obrigatorio:"No",Regra:"Status atual do processo",Exemplo:"Em andamento"},{Aba:"Por Processo",Campo:"Fase",Tipo:"texto",Obrigatorio:"No",Regra:"Fase processual atual",Exemplo:"Instruo"},{Aba:"Por Processo",Campo:"UF",Tipo:"texto",Obrigatorio:"Sim",Regra:"Sigla de 2 letras do estado",Exemplo:"SP"},{Aba:"Por Processo",Campo:"Comarca",Tipo:"texto",Obrigatorio:"Sim",Regra:"Nome da comarca",Exemplo:"So Paulo"},{Aba:"Por Processo",Campo:"Reclamantes",Tipo:"lista",Obrigatorio:"Sim",Regra:"Lista separada por ; (ponto e vrgula). No usar []",Exemplo:"Ana Lima; Pedro Santos"},{Aba:"Por Processo",Campo:"Advogados_Ativo",Tipo:"lista",Obrigatorio:"Sim",Regra:"Lista separada por ; (primeiro  principal na UI)",Exemplo:"Dr. Xavier Silva; Dra. Yasmim Oliveira"},{Aba:"Por Processo",Campo:"Testemunhas_Ativo",Tipo:"lista",Obrigatorio:"No",Regra:"Lista separada por ; ou  se vazio",Exemplo:"Joo Pereira; Carlos Costa"},{Aba:"Por Processo",Campo:"Testemunhas_Passivo",Tipo:"lista",Obrigatorio:"No",Regra:"Lista separada por ; ou  se vazio",Exemplo:"Ana Silva"},{Aba:"Por Processo",Campo:"Todas_Testemunhas",Tipo:"lista",Obrigatorio:"Sim",Regra:"Unio de todas as testemunhas, separadas por ;",Exemplo:"Joo Pereira; Beatriz Nunes; Carlos Costa"},{Aba:"Por Processo",Campo:"Reclamante_Foi_Testemunha",Tipo:"boolean",Obrigatorio:"No",Regra:"true/false",Exemplo:"true"},{Aba:"Por Processo",Campo:"Qtd_Reclamante_Testemunha",Tipo:"nmero",Obrigatorio:"No",Regra:"Quantidade de vezes que reclamante foi testemunha",Exemplo:"1"},{Aba:"Por Processo",Campo:"CNJs_Reclamante_Testemunha",Tipo:"lista",Obrigatorio:"No",Regra:"Lista de CNJs separados por ; ou  se vazio",Exemplo:`${Je[9]}`},{Aba:"Por Processo",Campo:"Reclamante_Testemunha_Polo_Passivo",Tipo:"boolean",Obrigatorio:"No",Regra:"true/false",Exemplo:"false"},{Aba:"Por Processo",Campo:"CNJs_Passivo",Tipo:"lista",Obrigatorio:"No",Regra:"CNJs onde reclamante foi testemunha do polo passivo",Exemplo:""},{Aba:"Por Processo",Campo:"Triangulacao_Confirmada",Tipo:"boolean",Obrigatorio:"No",Regra:"true/false",Exemplo:"true"},{Aba:"Por Processo",Campo:"Desenho_Triangulacao",Tipo:"texto",Obrigatorio:"No",Regra:"Padro da triangulao (ABCA) ou  se no houver",Exemplo:"ABCA"},{Aba:"Por Processo",Campo:"CNJs_Triangulacao",Tipo:"lista",Obrigatorio:"No",Regra:"CNJs envolvidos na triangulao, separados por ;",Exemplo:`${Je[1]}; ${Je[2]}; ${Je[3]}`},{Aba:"Por Processo",Campo:"Contem_Prova_Emprestada",Tipo:"boolean",Obrigatorio:"No",Regra:"true/false",Exemplo:"true"},{Aba:"Por Processo",Campo:"Testemunhas_Prova_Emprestada",Tipo:"lista",Obrigatorio:"No",Regra:"Nomes das testemunhas de prova emprestada, separados por ;",Exemplo:"Joo Pereira"},{Aba:"Por Processo",Campo:"Classificacao_Final",Tipo:"texto",Obrigatorio:"No",Regra:"Classificao de risco (Risco Alto, Risco Mdio, Risco Baixo)",Exemplo:"Risco Alto"},{Aba:"Por Processo",Campo:"Insight_Estrategico",Tipo:"texto",Obrigatorio:"No",Regra:"Resumo dos principais achados",Exemplo:"Triangulao + prova emprestada"},{Aba:"Por Testemunha",Campo:"Nome_Testemunha",Tipo:"texto",Obrigatorio:"Sim",Regra:"Nome completo da testemunha",Exemplo:"Joo Pereira"},{Aba:"Por Testemunha",Campo:"Qtd_Depoimentos",Tipo:"nmero",Obrigatorio:"Sim",Regra:"Quantidade total de depoimentos",Exemplo:"12"},{Aba:"Por Testemunha",Campo:"CNJs_Como_Testemunha",Tipo:"lista",Obrigatorio:"Sim",Regra:"Lista de CNJs separados por ;",Exemplo:`${Je[0]}; ${Je[9]}`},{Aba:"Por Testemunha",Campo:"Ja_Foi_Reclamante",Tipo:"boolean",Obrigatorio:"No",Regra:"true/false",Exemplo:"false"},{Aba:"Por Testemunha",Campo:"CNJs_Como_Reclamante",Tipo:"lista",Obrigatorio:"No",Regra:"CNJs onde foi reclamante, separados por ; ou  se vazio",Exemplo:""},{Aba:"Por Testemunha",Campo:"Foi_Testemunha_Ativo",Tipo:"boolean",Obrigatorio:"No",Regra:"true/false",Exemplo:"true"},{Aba:"Por Testemunha",Campo:"Foi_Testemunha_Passivo",Tipo:"boolean",Obrigatorio:"No",Regra:"true/false",Exemplo:"false"},{Aba:"Por Testemunha",Campo:"CNJs_Passivo",Tipo:"lista",Obrigatorio:"No",Regra:"CNJs onde foi testemunha do polo passivo",Exemplo:""},{Aba:"Por Testemunha",Campo:"Foi_Ambos_Polos",Tipo:"boolean",Obrigatorio:"No",Regra:"true/false",Exemplo:"false"},{Aba:"Por Testemunha",Campo:"Participou_Troca_Favor",Tipo:"boolean",Obrigatorio:"No",Regra:"true/false",Exemplo:"true"},{Aba:"Por Testemunha",Campo:"CNJs_Troca_Favor",Tipo:"lista",Obrigatorio:"No",Regra:"Padro CNJ_ACNJ_B ou lista separada por ;",Exemplo:`${Je[4]}${Je[5]}`},{Aba:"Por Testemunha",Campo:"Participou_Triangulacao",Tipo:"boolean",Obrigatorio:"No",Regra:"true/false",Exemplo:"true"},{Aba:"Por Testemunha",Campo:"CNJs_Triangulacao",Tipo:"lista",Obrigatorio:"No",Regra:"CNJs da triangulao, separados por ;",Exemplo:`${Je[1]}; ${Je[2]}; ${Je[3]}`},{Aba:"Por Testemunha",Campo:"E_Prova_Emprestada",Tipo:"boolean",Obrigatorio:"No",Regra:"true/false",Exemplo:"true"},{Aba:"Por Testemunha",Campo:"Classificacao",Tipo:"texto",Obrigatorio:"No",Regra:"ALTA, MDIA, BAIXA",Exemplo:"ALTA"},{Aba:"Por Testemunha",Campo:"Classificacao_Estrategica",Tipo:"texto",Obrigatorio:"No",Regra:"CRTICO, ATENO, NORMAL",Exemplo:"CRTICO"}];function qe(t){if(!t||t.length===0)return"";const a=t.map(s=>String(s).trim()).filter(s=>s.length>0);return a.length>0?a.join("; "):""}const sc=t=>({CNJ:t.cnj||"",Status:t.status||"",Fase:t.fase||"",UF:t.uf||"",Comarca:t.comarca||"",Reclamantes:t.reclamante_limpo||"",Advogados_Ativo:qe(t.advogados_parte_ativa||[]),Testemunhas_Ativo:qe(t.testemunhas_ativo_limpo||[]),Testemunhas_Passivo:qe(t.testemunhas_passivo_limpo||[]),Todas_Testemunhas:qe(t.todas_testemunhas||[]),Reclamante_Foi_Testemunha:t.reclamante_foi_testemunha||!1,Qtd_Reclamante_Testemunha:t.qtd_vezes_reclamante_foi_testemunha||0,CNJs_Reclamante_Testemunha:qe(t.cnjs_em_que_reclamante_foi_testemunha||[]),Reclamante_Testemunha_Polo_Passivo:t.reclamante_testemunha_polo_passivo||!1,CNJs_Passivo:qe(t.cnjs_passivo||[]),Triangulacao_Confirmada:t.triangulacao_confirmada||!1,Desenho_Triangulacao:t.desenho_triangulacao||"",CNJs_Triangulacao:qe(t.cnjs_triangulacao||[]),Contem_Prova_Emprestada:t.contem_prova_emprestada||!1,Testemunhas_Prova_Emprestada:qe(t.testemunhas_prova_emprestada||[]),Classificacao_Final:t.classificacao_final||"",Insight_Estrategico:t.insight_estrategico||""}),ac=t=>({Nome_Testemunha:t.nome_testemunha,Qtd_Depoimentos:t.qtd_depoimentos||0,CNJs_Como_Testemunha:qe(t.cnjs_como_testemunha||[]),Ja_Foi_Reclamante:t.ja_foi_reclamante||!1,CNJs_Como_Reclamante:qe(t.cnjs_como_reclamante||[]),Foi_Testemunha_Ativo:t.foi_testemunha_ativo||!1,Foi_Testemunha_Passivo:t.foi_testemunha_passivo||!1,CNJs_Passivo:qe(t.cnjs_passivo||[]),Foi_Ambos_Polos:t.foi_testemunha_em_ambos_polos||!1,Participou_Troca_Favor:t.participou_troca_favor||!1,CNJs_Troca_Favor:qe(t.cnjs_troca_favor||[]),Participou_Triangulacao:t.participou_triangulacao||!1,CNJs_Triangulacao:qe(t.cnjs_triangulacao||[]),E_Prova_Emprestada:t.e_prova_emprestada||!1,Classificacao:t.classificacao||"",Classificacao_Estrategica:t.classificacao_estrategica||""}),rc=t=>{if(!t)return"";const a=t.replace(/\D/g,"");return a.length===11?a.replace(/(\d{3})\d{6}(\d{2})/,"$1******$2"):a.length>=3?a.substring(0,2)+"*".repeat(Math.max(1,a.length-4))+a.slice(-2):"*".repeat(t.length)},nc=t=>{if(!t)return"";const a=t.replace(/\D/g,"");return a.length===14?a.replace(/(\d{2})\d{9}(\d{4})/,"$1*********$2"):a.length>=6?a.substring(0,2)+"*".repeat(Math.max(1,a.length-6))+a.slice(-4):"*".repeat(t.length)},oc=t=>{if(!t)return"";const[a,s]=t.split("@");if(!a||!s)return t;const r=Math.min(2,a.length);return`${a.substring(0,r)+"*".repeat(Math.max(1,a.length-r))}@${s}`},ic=t=>{if(!t)return"";const a=t.replace(/\D/g,"");return a.length>=8?a.length===11?a.replace(/(\d{2})(\d{1})\d{4}(\d{2})/,"($1) $2****-**$3"):a.length===10?a.replace(/(\d{2})\d{4}(\d{2})/,"($1) ****-**$2"):a.substring(0,2)+"*".repeat(a.length-4)+a.slice(-2):"*".repeat(t.length)},lc=t=>{if(!t)return"";const a=t.replace(/\D/g,"");return a.length>=4?t.replace(/\d/g,(s,r,n)=>{const o=n.substring(0,r+1).replace(/\D/g,"").length-1;return o===0||o===a.length-1?s:"*"}):t.replace(/\d/g,"*")},Et=t=>{if(!t)return"";let a=t;return a=a.replace(/\b\d{3}\.?\d{3}\.?\d{3}-?\d{2}\b/g,s=>rc(s)),a=a.replace(/\b\d{2}\.?\d{3}\.?\d{3}\/?\d{4}-?\d{2}\b/g,s=>nc(s)),a=a.replace(/\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b/g,s=>oc(s)),a=a.replace(/\(\d{2}\)?\s*\d{4,5}-?\d{4}\b/g,s=>ic(s)),a=a.replace(/\bOAB\/?\w{2}\s*\d+/gi,s=>lc(s)),a},cc=(t,a={})=>{const{filename:s=`processos-${new Date().toISOString().split("T")[0]}.csv`,maskPII:r=!1,selectedOnly:n=!1,selectedIds:o=[]}=a;let i=t;n&&o.length>0&&(i=t.filter(w=>o.includes(w.cnj)));const l=i.map(w=>{const y=sc(w);return r?{...y,Reclamantes:Et(y.Reclamantes),Todas_Testemunhas:Et(y.Todas_Testemunhas),Insight_Estrategico:Et(y.Insight_Estrategico)}:y}),d="\uFEFF"+dn.unparse(l,{delimiter:",",header:!0}),x=new Blob([d],{type:"text/csv;charset=utf-8;"}),f=document.createElement("a");if(f.download!==void 0){const w=URL.createObjectURL(x);f.setAttribute("href",w),f.setAttribute("download",s),f.style.visibility="hidden",document.body.appendChild(f),f.click(),document.body.removeChild(f)}return l.length},dc=(t,a={})=>{const{filename:s=`testemunhas-${new Date().toISOString().split("T")[0]}.csv`,maskPII:r=!1,selectedOnly:n=!1,selectedIds:o=[]}=a;let i=t;n&&o.length>0&&(i=t.filter(w=>o.includes(w.nome_testemunha)));const l=i.map(w=>{const y=ac(w);return r?{...y,Nome_Testemunha:Et(y.Nome_Testemunha),CNJs_Como_Testemunha:Et(y.CNJs_Como_Testemunha),CNJs_Como_Reclamante:Et(y.CNJs_Como_Reclamante)}:y}),d="\uFEFF"+dn.unparse(l,{delimiter:",",header:!0}),x=new Blob([d],{type:"text/csv;charset=utf-8;"}),f=document.createElement("a");if(f.download!==void 0){const w=URL.createObjectURL(x);f.setAttribute("href",w),f.setAttribute("download",s),f.style.visibility="hidden",document.body.appendChild(f),f.click(),document.body.removeChild(f)}return l.length},uc=(t,a=!0)=>{const r=t*(a?500:350);return r<1024?`${r} bytes`:r<1024*1024?`${(r/1024).toFixed(1)} KB`:`${(r/(1024*1024)).toFixed(1)} MB`},mc=(t,a=!1)=>t===0?{isValid:!1,message:a?"Nenhum registro selecionado para exportao.":"Nenhum registro encontrado para exportao.",maxRecords:5e3}:t>5e3?{isValid:!1,message:`Limite de exportao excedido. Mximo permitido: ${5e3.toLocaleString()} registros. ${a?"Selecione menos registros":"Aplique filtros para reduzir o resultado"}.`,maxRecords:5e3}:{isValid:!0,maxRecords:5e3},hc=({data:t,fileName:a,disabled:s=!1})=>{const[r,n]=h.useState(!1),o=W(mn),i=x=>x.length>0&&"cnj"in x[0]&&"reclamante_limpo"in x[0],l=async()=>{n(!0);try{const x=t.length,f=mc(x,!1);if(!f.isValid){gs.error("Erro na exportao",{description:f.message});return}let w=0;const y=i(t)?"processos.csv":"testemunhas.csv";if(i(t)){const z=t.map(v=>({cnj:v.cnj,status:v.status||null,uf:v.uf||null,comarca:v.comarca||null,fase:v.fase||null,reclamante_limpo:v.reclamante_limpo||null,advogados_parte_ativa:v.advogados_parte_ativa||null,testemunhas_ativo_limpo:v.testemunhas_ativo_limpo||null,testemunhas_passivo_limpo:v.testemunhas_passivo_limpo||null,todas_testemunhas:v.todas_testemunhas||null,reclamante_foi_testemunha:v.reclamante_foi_testemunha||null,qtd_vezes_reclamante_foi_testemunha:v.qtd_vezes_reclamante_foi_testemunha||null,cnjs_em_que_reclamante_foi_testemunha:v.cnjs_em_que_reclamante_foi_testemunha||null,reclamante_testemunha_polo_passivo:v.reclamante_testemunha_polo_passivo||null,cnjs_passivo:v.cnjs_passivo||null,troca_direta:v.troca_direta||null,desenho_troca_direta:v.desenho_troca_direta||null,cnjs_troca_direta:v.cnjs_troca_direta||null,triangulacao_confirmada:v.triangulacao_confirmada||null,desenho_triangulacao:v.desenho_triangulacao||null,cnjs_triangulacao:v.cnjs_triangulacao||null,testemunha_do_reclamante_ja_foi_testemunha_antes:v.testemunha_do_reclamante_ja_foi_testemunha_antes||null,qtd_total_depos_unicos:v.qtd_total_depos_unicos||null,cnjs_depos_unicos:v.cnjs_depos_unicos||null,contem_prova_emprestada:v.contem_prova_emprestada||null,testemunhas_prova_emprestada:v.testemunhas_prova_emprestada||null,classificacao_final:v.classificacao_final||null,insight_estrategico:v.insight_estrategico||null,org_id:v.org_id||null,created_at:v.created_at||new Date().toISOString(),updated_at:v.updated_at||new Date().toISOString()}));w=cc(z,{filename:a||y,maskPII:o,selectedOnly:!1,selectedIds:[]})}else{const z=t.map(v=>({nome_testemunha:v.nome_testemunha,qtd_depoimentos:v.qtd_depoimentos||null,cnjs_como_testemunha:v.cnjs_como_testemunha||null,ja_foi_reclamante:v.ja_foi_reclamante||null,cnjs_como_reclamante:v.cnjs_como_reclamante||null,foi_testemunha_ativo:v.foi_testemunha_ativo||null,cnjs_ativo:v.cnjs_ativo||null,foi_testemunha_passivo:v.foi_testemunha_passivo||null,cnjs_passivo:v.cnjs_passivo||null,foi_testemunha_em_ambos_polos:v.foi_testemunha_em_ambos_polos||null,participou_troca_favor:v.participou_troca_favor||null,cnjs_troca_favor:v.cnjs_troca_favor||null,participou_triangulacao:v.participou_triangulacao||null,cnjs_triangulacao:v.cnjs_triangulacao||null,e_prova_emprestada:v.e_prova_emprestada||null,classificacao:v.classificacao||null,classificacao_estrategica:v.classificacao_estrategica||null,org_id:v.org_id||null,created_at:v.created_at||new Date().toISOString(),updated_at:v.updated_at||new Date().toISOString()}));w=dc(z,{filename:a||y,maskPII:o,selectedOnly:!1,selectedIds:[]})}gs.success("Exportao concluda!",{description:`${w} registros exportados com sucesso.`})}catch(x){console.error("Export error:",x),gs.error("Erro na exportao",{description:"No foi possvel exportar os dados. Tente novamente."})}finally{n(!1)}},d=(()=>{const x=Math.min(t.length,5e3),f=i(t);return{count:x,size:uc(x,f)}})();return e.jsxs(Wt,{children:[e.jsx(Kt,{asChild:!0,children:e.jsxs(K,{variant:"outline",disabled:s||r||t.length===0,className:"gap-2","aria-label":"Exportar dados como CSV",children:[r?e.jsx(Dt,{className:"h-4 w-4 animate-spin","aria-hidden":"true"}):e.jsx(mr,{className:"h-4 w-4","aria-hidden":"true"}),"Exportar CSV"]})}),e.jsxs(It,{align:"end",className:"w-56",children:[e.jsx("div",{className:"px-3 py-2 text-xs text-muted-foreground",children:e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsx(Js,{className:"h-3 w-3","aria-hidden":"true"}),"Exportar como CSV"]})}),e.jsx(Fs,{}),e.jsx(ht,{onClick:l,disabled:r,children:e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Todos os registros"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:d.count.toLocaleString()})]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:d.size})]})}),t.length>5e3&&e.jsxs(e.Fragment,{children:[e.jsx(Fs,{}),e.jsx("div",{className:"px-3 py-2 text-xs text-warning",children:" Mximo de 5.000 registros por exportao"})]})]})]})},ms=t=>{if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return!1;const a=new Date(t);return!isNaN(a.valueOf())},Cs="mapa-testemunhas-processos",Ss="mapa-testemunhas-testemunhas",An=Ot({page:Be.number().int().min(1).default(1),limit:Be.number().int().min(1).max(1e3).default(20)}),fc=Ot({search:ze().trim().optional(),data_inicio:ze().trim().optional().refine(t=>!t||ms(t),{message:"data invlida"}),data_fim:ze().trim().optional().refine(t=>!t||ms(t),{message:"data invlida"}),uf:ze().trim().optional(),status:ze().trim().optional(),fase:ze().trim().optional(),testemunha:ze().trim().optional(),qtd_depoimentos_min:Be.number().int().optional(),qtd_depoimentos_max:Be.number().int().optional(),tem_triangulacao:Be.boolean().optional(),tem_troca:Be.boolean().optional(),tem_prova_emprestada:Be.boolean().optional()}).superRefine((t,a)=>{t.data_inicio&&t.data_fim&&new Date(t.data_inicio)>new Date(t.data_fim)&&a.addIssue({code:is.custom,message:"data_inicio deve ser menor ou igual a data_fim",path:["data_inicio"]}),t.qtd_depoimentos_min!==void 0&&t.qtd_depoimentos_max!==void 0&&t.qtd_depoimentos_min>t.qtd_depoimentos_max&&a.addIssue({code:is.custom,message:"qtd_depoimentos_min deve ser menor ou igual a qtd_depoimentos_max",path:["qtd_depoimentos_min"]})}).default({}),pc=Ot({paginacao:An.default({page:1,limit:20}),filtros:fc}).default(()=>({paginacao:{page:1,limit:20},filtros:{}})),xc=Ot({nome:ze().trim().optional(),documento:ze().trim().optional(),search:ze().trim().optional(),data_inicio:ze().trim().optional().refine(t=>!t||ms(t),{message:"data invlida"}),data_fim:ze().trim().optional().refine(t=>!t||ms(t),{message:"data invlida"}),ambos_polos:Be.boolean().optional(),ja_foi_reclamante:Be.boolean().optional(),qtd_depoimentos_min:Be.number().int().optional(),qtd_depoimentos_max:Be.number().int().optional(),tem_triangulacao:Be.boolean().optional(),tem_troca:Be.boolean().optional()}).superRefine((t,a)=>{t.data_inicio&&t.data_fim&&new Date(t.data_inicio)>new Date(t.data_fim)&&a.addIssue({code:is.custom,message:"data_inicio deve ser menor ou igual a data_fim",path:["data_inicio"]}),t.qtd_depoimentos_min!==void 0&&t.qtd_depoimentos_max!==void 0&&t.qtd_depoimentos_min>t.qtd_depoimentos_max&&a.addIssue({code:is.custom,message:"qtd_depoimentos_min deve ser menor ou igual a qtd_depoimentos_max",path:["qtd_depoimentos_min"]})}).default({}),gc=Ot({paginacao:An.default({page:1,limit:20}),filtros:xc}).default(()=>({paginacao:{page:1,limit:20},filtros:{}}));Ot({items:Bo(Vo()),page:xs().int().min(1),limit:xs().int().min(1).max(1e3),total:xs().int().nonnegative(),next_cursor:zo().default(null),requestId:ze()});const Ts="assistjur_debug_mode",X={isEnabled(){return typeof window>"u"?!1:localStorage.getItem(Ts)==="true"},enable(){typeof window>"u"||(localStorage.setItem(Ts,"true"),console.log(" Debug mode ATIVADO"))},disable(){typeof window>"u"||(localStorage.setItem(Ts,"false"),console.log(" Debug mode DESATIVADO"))},toggle(){const t=!this.isEnabled();return t?this.enable():this.disable(),t},log(t,...a){this.isEnabled()&&console.log(`[DEBUG] ${t}`,...a)},warn(t,...a){this.isEnabled()&&console.warn(`[DEBUG] ${t}`,...a)},error(t,...a){this.isEnabled()?console.error(`[DEBUG] ${t}`,...a):console.error(t,...a)}};function Pn(t){const a={temTriangulacao:"tem_triangulacao",temTroca:"tem_troca",temProvaEmprestada:"tem_prova_emprestada",qtdDeposMin:"qtd_depoimentos_min",qtdDeposMax:"qtd_depoimentos_max",ambosPolos:"ambos_polos",jaFoiReclamante:"ja_foi_reclamante"};return Object.fromEntries(Object.entries(t??{}).filter(([s,r])=>!(r==null||typeof r=="string"&&r.trim()==="")).map(([s,r])=>[a[s]??s,r]))}async function On(t,a=3,s=1e3){let r=null;for(let n=0;n<a;n++)try{return await t()}catch(o){if(r=o,n<a-1){const i=s*Math.pow(2,n);console.warn(`Tentativa ${n+1} falhou, aguardando ${i}ms...`),await new Promise(l=>setTimeout(l,i))}}throw r}function Sa(t,a){console.warn(" MODO FALLBACK: Usando dados mock para testemunhas (API no disponvel)"),X.isEnabled()&&console.table({mode:"FALLBACK",type:"TESTEMUNHAS",page:t,limit:a});const s=[{nome:"Maria Silva Santos",qtd_depoimentos:8,qtd_testemunha:6,qtd_reclamante:2,participa_troca_favor:!0,participa_triangulacao:!0,ambos_polos:!0,ja_foi_reclamante:!0},{nome:"Joo Paulo Oliveira",qtd_depoimentos:5,qtd_testemunha:5,qtd_reclamante:0,participa_troca_favor:!1,participa_triangulacao:!0,ambos_polos:!1,ja_foi_reclamante:!1},{nome:"Ana Costa Ferreira",qtd_depoimentos:12,qtd_testemunha:8,qtd_reclamante:4,participa_troca_favor:!0,participa_triangulacao:!1,ambos_polos:!0,ja_foi_reclamante:!0}],r=(t-1)*a,n=r+a;return{data:s.slice(r,n),total:s.length}}async function vc(t){const a=Math.random().toString(36).substring(7),s=t.filters?.search||t.filters?.nome;X.log(` [${a}] fetchTestemunhas iniciado`,{page:t.page,limit:t.limit,filters:t.filters,searchTerm:s,timestamp:new Date().toISOString()});try{const{data:r}=await Fe.auth.getSession();if(!r?.session?.access_token)return X.error(` [${a}] Usurio no autenticado`),Sa(t.page||1,t.limit||20);X.log(` [${a}] Sesso vlida`,{userId:r.session.user?.id,hasToken:!!r.session.access_token});const n=Pn(t.filters??{}),o={paginacao:{page:t.page||1,limit:t.limit||20},filtros:n};s&&console.log(` [${a}] SEARCH DETECTADO:`,{searchTerm:s,filtrosEnviados:o.filtros,hasSearchInFiltros:"search"in o.filtros||"nome"in o.filtros}),X.log(` [${a}] Payload preparado`,o),gc.parse(o);const i=await On(async()=>{X.log(` [${a}] ===== CHAMANDO EDGE FUNCTION =====`),X.log(` [${a}] Function: ${Ss}`),X.log(` [${a}] URL: ${Fe.functions.url}/${Ss}`),X.log(` [${a}] Body:`,o),X.log(` [${a}] Auth Token presente: ${!!r.session.access_token}`);const l=performance.now(),{data:m,error:d}=await Fe.functions.invoke(Ss,{body:o}),x=performance.now()-l;if(X.log(` [${a}] Tempo de resposta: ${x.toFixed(2)}ms`),d)throw X.error(` [${a}] ===== ERRO NA EDGE FUNCTION =====`),X.error(` [${a}] Error object:`,d),X.error(` [${a}] Error message:`,d.message),X.error(` [${a}] Error context:`,d.context),new Error(`Erro ao buscar testemunhas: ${d.message}`);if(!m||!m.items)return X.log(` [${a}] ===== DATASET VAZIO (VLIDO) =====`),X.log(` [${a}] Empty dataset (0 records) - this is valid, not an error`),{data:[],total:0};X.log(` [${a}] ===== RESPOSTA RECEBIDA COM SUCESSO =====`),X.log(` [${a}] Data structure:`,{hasData:!!m,dataKeys:m?Object.keys(m):[],itemsCount:m.items?.length||0,total:m.total,hasNextCursor:!!m.next_cursor});const f=m.items.map(w=>({nome_testemunha:w.nome_testemunha||"",qtd_depoimentos:Number(w.qtd_depoimentos)||0,foi_testemunha_em_ambos_polos:!!w.foi_testemunha_em_ambos_polos,ja_foi_reclamante:!!w.ja_foi_reclamante,participou_triangulacao:!!w.participou_triangulacao,participou_troca_favor:!!w.participou_troca_favor,classificacao:w.classificacao||null,classificacao_estrategica:w.classificacao_estrategica||null,cnjs_como_testemunha:w.cnjs_como_testemunha||null,cnjs_como_reclamante:w.cnjs_como_reclamante||null,foi_testemunha_ativo:!!w.foi_testemunha_ativo,cnjs_ativo:w.cnjs_ativo||null,foi_testemunha_passivo:!!w.foi_testemunha_passivo,cnjs_passivo:w.cnjs_passivo||null,cnjs_troca_favor:w.cnjs_troca_favor||null,cnjs_triangulacao:w.cnjs_triangulacao||null,e_prova_emprestada:!!w.e_prova_emprestada,org_id:w.org_id||null,created_at:w.created_at,updated_at:w.updated_at}));return X.log(` [${a}] Transformed ${f.length} items`),f.length>0&&X.log(` [${a}] Sample item:`,f[0]),{data:f,total:m.total||0}});return X.log(` [${a}] fetchTestemunhas concludo com sucesso`),i}catch(r){return X.error(` [${a}] Erro fatal ao buscar testemunhas:`,r),{...Sa(t.page||1,t.limit||20),error:r instanceof Error?r.message:"Erro desconhecido ao buscar testemunhas"}}}function Ta(t,a){console.warn(" MODO FALLBACK: Usando dados mock para processos (API no disponvel)"),X.isEnabled()&&console.table({mode:"FALLBACK",type:"PROCESSOS",page:t,limit:a});const s=[{cnj:"0001234-56.2024.5.02.0001",reclamante:"EMPRESA XYZ LTDA",reclamada:"FORNECEDOR ABC S.A.",testemunhas_ativo:["Maria Silva Santos","Joo Paulo Oliveira"],testemunhas_passivo:["Ana Costa Ferreira"],tem_triangulacao:!0,tem_troca:!0,tem_prova_emprestada:!1,comarca:"So Paulo",vara:"1 Vara do Trabalho"},{cnj:"0007890-12.2024.5.02.0002",reclamante:"TECH SOLUTIONS LTDA",reclamada:"CLIENTE SERVIOS S.A.",testemunhas_ativo:["Ana Costa Ferreira"],testemunhas_passivo:["Maria Silva Santos","Joo Paulo Oliveira"],tem_triangulacao:!1,tem_troca:!0,tem_prova_emprestada:!0,comarca:"Rio de Janeiro",vara:"3 Vara do Trabalho"}],r=(t-1)*a,n=r+a;return{data:s.slice(r,n),total:s.length}}async function jc(t){const a=Math.random().toString(36).substring(7);X.log(` [${a}] fetchProcessos iniciado`,{page:t.page,limit:t.limit,filters:t.filters,timestamp:new Date().toISOString()});try{const{data:s}=await Fe.auth.getSession();if(!s?.session?.access_token)return X.error(` [${a}] Usurio no autenticado`),Ta(t.page||1,t.limit||20);X.log(` [${a}] Sesso vlida`,{userId:s.session.user?.id,hasToken:!!s.session.access_token});const r=Pn(t.filters),n={paginacao:{page:t.page||1,limit:t.limit||20},filtros:r};X.log(` [${a}] Payload preparado`,n),pc.parse(n);const o=await On(async()=>{X.log(` [${a}] ===== CHAMANDO EDGE FUNCTION =====`),X.log(` [${a}] Function: ${Cs}`),X.log(` [${a}] URL: ${Fe.functions.url}/${Cs}`),X.log(` [${a}] Body:`,n),X.log(` [${a}] Auth Token presente: ${!!s.session.access_token}`);const i=performance.now(),{data:l,error:m}=await Fe.functions.invoke(Cs,{body:n}),d=performance.now()-i;if(X.log(` [${a}] Tempo de resposta: ${d.toFixed(2)}ms`),m)throw X.error(` [${a}] ===== ERRO NA EDGE FUNCTION =====`),X.error(` [${a}] Error object:`,m),X.error(` [${a}] Error message:`,m.message),X.error(` [${a}] Error context:`,m.context),new Error(`Erro ao buscar processos: ${m.message}`);if(!l||!l.items)return X.log(` [${a}] ===== DATASET VAZIO (VLIDO) =====`),X.log(` [${a}] Empty dataset (0 records) - this is valid, not an error`),{data:[],total:0};X.log(` [${a}] ===== RESPOSTA RECEBIDA COM SUCESSO =====`),X.log(` [${a}] Data structure:`,{hasData:!!l,dataKeys:l?Object.keys(l):[],itemsCount:l.items?.length||0,total:l.total,hasNextCursor:!!l.next_cursor});const x=Array.isArray(l.items)?l.items:[],f=isFinite(l.total)?l.total:x.length;return{data:x,total:f}});return X.log(` [${a}] fetchProcessos concludo com sucesso`),o}catch(s){return X.error(` [${a}] Erro fatal ao buscar processos:`,s),{...Ta(t.page||1,t.limit||20),error:s instanceof Error?s.message:"Erro desconhecido ao buscar processos"}}}function Es(t,a){if(!t||typeof t!="object")return 0;const r=a.filter(l=>{const m=t[l];return m!=null&&m!==""&&m!=="nan"}).length/a.length;let n=0;return n=["cnj","reclamante","status","classificacao"].filter(l=>a.includes(l)&&t[l]).length*.05,Math.min(1,r+n)}function bc(t){return!t||t==="null"||t==="undefined"?"Em andamento":t}function Nc(t){return!t||t==="null"||t==="undefined"?"Normal":t}function wc(t){if(t.situacao)return{status:t.situacao,inferido:!1};if(t.categoria)return{status:t.categoria,inferido:!1};const a=(t.classificacao_final||"").toLowerCase();if(a.includes("descartar"))return{status:"Arquivado",inferido:!0};if(a.includes("conhecer"))return{status:"Aguardando movimentao",inferido:!0};const s=t.quantidade_movimentos||0,r=t.quantidade_documentos||0;return s===0&&r===0?{status:"Aguardando distribuio",inferido:!0}:s>10?{status:"Em fase instrutria",inferido:!0}:{status:"Em andamento",inferido:!0}}function Ea(t){if(!t)return"Normal";const a=String(t).replace(/[\[\]]/g,"").trim().toLowerCase();return a.charAt(0).toUpperCase()+a.slice(1)}function Rs(t,a,s){if(a!=null)return a>=85?"critico":a>=70?"alto":a>=50?"medio":"baixo";if(s){const n=s.toLowerCase();if(n.includes("triangulao")||n.includes("troca de favor"))return"critico";if(n.includes("j foi testemunha")||n.includes("ambos polos"))return"alto";if(n.includes("prova emprestada"))return"medio"}const r=Nc(t).toLowerCase();return r.includes("crtico")||r.includes("alto")?"alto":r.includes("mdio")||r.includes("medio")?"medio":"baixo"}function yc(){const{toast:t}=Ve(),{error:a}=Ai(),{chatKind:s,chatInput:r,chatStatus:n,chatResult:o,agentOnline:i,selectedProcesso:l,selectedTestemunha:m,setChatStatus:d,setChatResult:x,addChatMessage:f,updateChatMessage:w,setAgentOnline:y}=W(),z=h.useCallback(A=>{switch(A){case"processo":return"process_analysis";case"testemunha":return"witness_analysis";case"reclamante":return"claimant_analysis";default:return"risk_analysis"}},[]),v=h.useCallback((A,D)=>[{type:"executive",title:" Resumo Executivo",icon:"Sparkles",data:{cnj:D.match(/\d{7}-\d{2}\.\d{4}\.\d{1}\.\d{2}\.\d{4}/)?D:"1000000-09.2024.5.02.1000",reclamante:A==="reclamante"?D:"Maria Silva Santos",reu:"Empresa ABC Ltda",status:"Em andamento",observacoes:"Processo com potencial risco de triangulao detectado.",riscoNivel:"alto",confianca:.85,confianca:.85,alerta:"Testemunhas conectadas em mltiplos processos"},citations:[{source:"por_processo",ref:"1000000-09.2024.5.02.1000"},{source:"por_testemunha",ref:"Joo Santos"}]},{type:"details",title:" Anlise Detalhada",icon:"FileText",data:{secoes:[{titulo:"Vnculos Identificados",conteudo:"Foram identificadas 3 testemunhas que aparecem em processos similares.",evidencias:["Joo Santos: 5 processos","Maria Oliveira: 3 processos"]},{titulo:"Padres Temporais",conteudo:"Concentrao de depoimentos entre Jan-Mar 2024.",evidencias:["Janeiro: 8 depoimentos","Fevereiro: 12 depoimentos"]}],textoOriginal:D}},{type:"alerts",title:" Alertas Estratgicos",icon:"AlertTriangle",data:{suspiciousPatterns:["Triangulao detectada entre 3 testemunhas","Depoimentos com narrativas similares","Mesmo advogado em processos conexos"]}},{type:"strategies",title:" Polo Ativo & Estratgias",icon:"Target",data:{estrategias:[{texto:"Questionar vnculos entre testemunhas",prioridade:"ALTA"},{texto:"Investigar histrico de depoimentos",prioridade:"MDIA"}],proximosPassos:["Solicitar certides de processos anteriores","Preparar questionrio especfico para audincia"]}}],[]);return{runAnalysis:h.useCallback(async(A,D)=>{if(!A.trim()){t({title:"Campo obrigatrio",description:"Digite uma consulta para executar a anlise.",variant:"destructive"});return}if(!i){t({title:"Agente indisponvel",description:"O assistente est temporariamente em manuteno.",variant:"destructive"});return}d("loading"),t({title:"Anlise iniciada",description:"Processando sua consulta..."}),f({role:"user",content:A});const I=f({role:"assistant",content:"",blocks:[]});try{const P={message:A,queryType:z(D)};if(l&&(D==="processo"||A.match(/\d{7}-\d{2}\.\d{4}\.\d\.\d{2}\.\d{4}/))){const p=wc(l),N=Ea(l.classificacao_final),T=Rs(l.classificacao_final,l.score_risco,l.insight_estrategico),$=Es(l,["cnj","reclamante_nome","reu_nome","status","classificacao_final"]);P.context={type:"processo",data:{cnj:l.cnj||l.numero_cnj,reclamante:l.reclamante_nome,reu:l.reu_nome,status:p.status,statusInferido:p.inferido,fase:l.fase,uf:l.uf,comarca:l.comarca,testemunhas_ativo:l.testemunhas_ativo,testemunhas_passivo:l.testemunhas_passivo,classificacao:N,classificacao_final:l.classificacao_final,score_risco:l.score_risco,insight_estrategico:l.insight_estrategico,riscoNivel:T},meta:{status:p.status,statusInferido:p.inferido,classificacao:N,riscoNivel:T,confidence:$}}}else if(m&&D==="testemunha"){const p=Ea(m.classificacao_final),N=Rs(m.classificacao_final,m.score_risco,null),T=Es(m,["nome_testemunha","qtd_depoimentos","classificacao_final"]);P.context={type:"testemunha",data:{nome:m.nome_testemunha,qtd_depoimentos:m.qtd_depoimentos,processos_cnj:m.processos_cnj,foi_testemunha_em_ambos_polos:m.foi_testemunha_em_ambos_polos,ja_foi_reclamante:m.ja_foi_reclamante,classificacao_final:p,score_risco:m.score_risco},meta:{status:m.foi_testemunha_em_ambos_polos?"Ativo em ambos polos":"Normal",statusInferido:!1,classificacao:p,riscoNivel:N,confidence:T}}}console.log(" [PAYLOAD] Enviando para chat-legal:",{message:P.message,queryType:P.queryType,hasContext:!!P.context,contextType:P.context?.type,hasMeta:!!P.context?.meta,meta:P.context?.meta,dataKeys:P.context?.data?Object.keys(P.context.data):[]});const{data:G,error:U}=await Fe.functions.invoke("chat-legal",{body:P});if(U){if(U.status===402||U.message?.includes("Workspace out of credits")){const p=`https://${Uo()}.functions.supabase.co/chat-legal`;console.warn(`Lovable API ${U.status} at ${p}`),a("Limite de crditos atingido","As funes de chat/assistente esto temporariamente indisponveis. Tente novamente mais tarde.",{duration:void 0}),y(!1),w(I,{content:"Crditos esgotados. Funo indisponvel."}),d("error");return}throw U}const S=G?.data||G?.content||"";console.log(" [FRONTEND] Raw AI Response type:",typeof S),console.log(" [FRONTEND] Response length:",S.length),console.log(" [FRONTEND] First 300 chars:",S.substring(0,300));let c=[];try{const p=JSON.parse(S);console.log(" [FRONTEND] Parsed JSON, type:",typeof p),p.blocks&&Array.isArray(p.blocks)?(c=p.blocks,console.log(" [FRONTEND] Extracted blocks array with",c.length,"items")):Array.isArray(p)&&p.length>0?(c=p,console.log(" [FRONTEND] Direct array with",c.length,"blocks")):p.type?(c=[p],console.log(" [FRONTEND] Single block object")):console.warn(" [FRONTEND] Parsed JSON but unexpected structure:",Object.keys(p))}catch(p){console.error(" [FRONTEND] JSON parse failed:",p);try{const N=S.match(/\{[\s\S]*"blocks"[\s\S]*\}/);N&&(c=JSON.parse(N[0]).blocks||[],console.log(" [FRONTEND] Extracted blocks from text:",c.length))}catch(N){console.error(" [FRONTEND] Extraction failed:",N)}}(!c||c.length===0)&&(console.log(" [FRONTEND] Gerando fallback blocks para input:",A),c=[{type:"executive",title:" Resumo Executivo",icon:"FileText",data:{cnj:A.match(/\d{7}-\d{2}\.\d{4}\.\d\.\d{2}\.\d{4}/)?A:"0000000-00.0000.0.00.0000",reclamante:l?.reclamante_nome||"Aguardando dados...",reu:l?.reu_nome||"Aguardando dados...",status:bc(l?.status),observacoes:l?.observacoes||`Anlise iniciada para: ${A.substring(0,100)}${A.length>100?"...":""}`,riscoNivel:Rs(l?.classificacao_final,l?.score_risco),confianca:l?Es(l,["cnj","reclamante_nome","reu_nome","status"]):.5,alerta:void 0,citacoes:[]}},{type:"details",title:" Anlise Detalhada",icon:"Search",data:{secoes:[{titulo:"Informaes Disponveis",conteudo:`Consulta realizada: ${A}`,evidencias:[]},{titulo:"Anlise",conteudo:"Aguardando processamento completo pelo sistema. Por favor, tente novamente em alguns instantes.",evidencias:[]},{titulo:"Recomendaes",conteudo:"Aes sugeridas:",evidencias:["Verificar se os dados esto disponveis no sistema","Confirmar formato da consulta (CNJ, nome, etc)","Aguardar alguns instantes e tentar novamente"]}]}}],console.log(" [FRONTEND] Fallback blocks gerados:",c.length));const u=c.map(p=>({...p,context:P.context,meta:P.context?.meta}));w(I,{content:u.length>0?"Anlise concluda":S,blocks:u}),x(u),d("success"),t({title:"Anlise concluda",description:`Anlise ${D==="processo"?"por processo":D==="testemunha"?"por testemunha":"por reclamante"} executada com sucesso.`})}catch(P){console.error("Error in analysis:",P),w(I,{content:"Erro ao executar anlise. Tente novamente."}),d("error"),t({title:"Erro na anlise",description:P instanceof Error?P.message:"Erro desconhecido ao executar anlise.",variant:"destructive"})}},[i,z,v,d,x,f,w,t,a,y]),chatStatus:n,chatResult:o,agentOnline:i}}function _c(t,a="all",s=!0){const r=Is(t,250);return jo({queryKey:["unified-search",r,a],queryFn:async()=>{if(!r||r.length<2)return{query:r,parsed:r,filters:{},scope:a,results:[],total:0};const{data:n,error:o}=await Fe.functions.invoke("search",{body:{q:r,scope:a,limit:20}});if(o)throw o;return n},enabled:s&&r.length>=2,staleTime:3e4})}const Ra={process:"Processo",witness:"Testemunha",claimant:"Reclamante",lawyer:"Advogado",comarca:"Comarca"},Cc={process:"bg-blue-500/10 text-blue-700 dark:text-blue-300",witness:"bg-purple-500/10 text-purple-700 dark:text-purple-300",claimant:"bg-green-500/10 text-green-700 dark:text-green-300",lawyer:"bg-orange-500/10 text-orange-700 dark:text-orange-300",comarca:"bg-gray-500/10 text-gray-700 dark:text-gray-300"},Sc=[{scope:"all",label:"Tudo",icon:Rt},{scope:"process",label:"Processos",icon:et},{scope:"witness",label:"Testemunhas",icon:Vt},{scope:"claimant",label:"Reclamantes",icon:os}],Tc={process:et,witness:Vt,claimant:os,lawyer:os,comarca:No};function Ec(){const t=h.useRef(null),[a,s]=h.useState(!1),[r,n]=h.useState("all"),[o,i]=h.useState(""),[l,m]=h.useState(!1),[d,x]=h.useState(0),f=Ks(),{toast:w}=Ve(),{chatKind:y,chatStatus:z,agentOnline:v,selectedProcesso:J,selectedTestemunha:A,setChatInput:D,setChatKind:I,setSelectedProcesso:P,setSelectedTestemunha:G,processos:U,testemunhas:S}=W(),{runAnalysis:c}=yc(),u=o,{data:p,isLoading:N}=_c(u,r,a&&u.length>=2),T=["Digite um nome... Ex: Joo Silva","Busque por CNJ... Ex: 0001234-56.2024.5.02.0001","Use operadores... Ex: risco:alto uf:RS","Filtros avanados... Ex: depoimentos:>3 comarca:POA"];h.useEffect(()=>{const g=setInterval(()=>{x(E=>(E+1)%T.length)},3e3);return()=>clearInterval(g)},[]);const $=T[d];h.useEffect(()=>{/\d{7}-\d{2}\.\d{4}\.\d{1}\.\d{2}\.\d{4}/.test(o)&&(n("process"),I("processo"))},[o,I]),h.useEffect(()=>{o.length>=2?s(!0):s(!1)},[o]),h.useEffect(()=>{const g=E=>{E.key==="k"&&E.ctrlKey&&(E.preventDefault(),t.current?.focus())};return document.addEventListener("keydown",g),()=>document.removeEventListener("keydown",g)},[]);const Z=g=>{switch(s(!1),i(g.title),D(g.title),g.type){case"process":{const E=U.find(F=>F.cnj===g.title||F.numero_cnj===g.title);E&&(P(E),w({title:"Processo selecionado",description:E.cnj||E.numero_cnj})),I("processo"),f(`/mapa-testemunhas?tab=processos&cnj=${encodeURIComponent(g.title)}`);break}case"witness":{const E=S.find(F=>F.nome_testemunha?.toLowerCase()===g.title.toLowerCase());E&&(G(E),w({title:"Testemunha selecionada",description:E.nome_testemunha})),I("testemunha"),f(`/mapa-testemunhas?tab=testemunhas&nome=${encodeURIComponent(g.title)}`);break}case"claimant":{I("reclamante"),f(`/mapa-testemunhas?tab=processos&reclamante=${encodeURIComponent(g.title)}`);break}}},oe=(g,E)=>{E.stopPropagation(),navigator.clipboard.writeText(g),w({title:"CNJ copiado",description:g})},de=()=>{P(null),G(null),D(""),i("")},L=J||A,re=J?`Processo: ${J.cnj||J.numero_cnj}`:A?`Testemunha: ${A.nome_testemunha}`:null,B=async()=>{if(!o.trim()||b||!v)return;s(!1),D(o);const g=y||(r==="process"?"processo":r==="witness"?"testemunha":"reclamante");I(g),await c(o.trim(),g)},ue=g=>{g.key==="Enter"&&(g.ctrlKey||g.metaKey)&&(g.preventDefault(),B())},Y=p&&p.results.length>0,j=p?.isAmbiguous||!1,b=j&&o.length>=2,C=o.trim().length>0&&!b&&v;return e.jsxs("div",{className:"w-full mx-auto max-w-7xl p-6 space-y-6",children:[!l&&e.jsxs(Ge,{className:"border-yellow-200 bg-yellow-50 dark:bg-yellow-950/20",children:[e.jsx(tt,{className:"h-4 w-4 text-yellow-600 dark:text-yellow-500"}),e.jsxs(Ye,{className:"flex items-center justify-between gap-4",children:[e.jsxs("span",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:[e.jsx("strong",{className:"font-semibold",children:"Contedo assistivo."})," ","Reviso humana obrigatria. Dados tratados conforme LGPD."," ",e.jsx("a",{href:"/privacy",className:"underline hover:no-underline",children:"Poltica de Privacidade"})]}),e.jsx(K,{variant:"ghost",size:"sm",onClick:()=>m(!0),className:"shrink-0 hover:bg-yellow-100 dark:hover:bg-yellow-900/30",children:e.jsx(ut,{className:"h-4 w-4"})})]})]}),j&&p?.suggestions&&e.jsxs(Ge,{className:"border-blue-200 bg-blue-50 dark:bg-blue-950/20 animate-in fade-in slide-in-from-top-2 duration-300",children:[e.jsx(Ws,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"}),e.jsx(Ye,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-blue-900 dark:text-blue-100",children:p.suggestions.message}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(p.suggestions.counts).map(([g,E])=>e.jsxs(te,{variant:"secondary",className:"text-xs",children:[g,": ",E]},g))})]})})]}),L&&re&&e.jsxs("div",{className:"flex items-center gap-2 bg-primary/10 border border-primary/20 rounded-lg px-4 py-3 animate-in fade-in slide-in-from-top-2 duration-300",children:[e.jsxs(te,{variant:"default",className:"gap-1.5 text-xs",children:[J&&e.jsx(et,{className:"h-3 w-3"}),A&&e.jsx(Vt,{className:"h-3 w-3"}),"Contexto Selecionado"]}),e.jsx("span",{className:"text-sm font-medium text-foreground flex-1",children:re}),e.jsxs(K,{variant:"ghost",size:"sm",onClick:de,className:"h-7 px-2 hover:bg-destructive/10 gap-1.5",children:[e.jsx(ut,{className:"h-3 w-3"}),e.jsx("span",{className:"text-xs",children:"Limpar"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:e.jsx(Rt,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Busca Inteligente Unificada"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Pesquise por processo, testemunha ou reclamante em um nico lugar"})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:v?e.jsxs(e.Fragment,{children:[e.jsx(Ze,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Online"})]}):e.jsxs(e.Fragment,{children:[e.jsx(bo,{className:"h-4 w-4 text-orange-500"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Manuteno"})]})})]}),e.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:Sc.map(g=>{const E=g.icon;return e.jsxs(K,{variant:r===g.scope?"default":"outline",size:"sm",onClick:()=>n(g.scope),className:"gap-2 h-8 transition-all hover:scale-105",children:[e.jsx(E,{className:"h-3.5 w-3.5",strokeWidth:1.5}),g.label]},g.scope)})})]}),e.jsx("div",{className:"relative",children:e.jsxs(jr,{open:a,onOpenChange:s,children:[e.jsx(br,{asChild:!0,children:e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-primary/20 to-primary/10 rounded-lg blur-sm group-hover:blur-md transition-all opacity-0 group-hover:opacity-100"}),e.jsxs("div",{className:"relative",children:[e.jsx(Rt,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground pointer-events-none z-10"}),e.jsx(lt,{ref:t,value:o,onChange:g=>i(g.target.value),onKeyDown:ue,placeholder:$,className:"pl-12 pr-12 h-14 text-base border-2 focus:border-primary/50 transition-all shadow-sm hover:shadow-md"}),o&&e.jsx(K,{variant:"ghost",size:"sm",onClick:()=>i(""),className:"absolute right-2 top-1/2 -translate-y-1/2 h-9 w-9 p-0 rounded-full hover:bg-destructive/10",children:e.jsx(ut,{className:"h-4 w-4"})})]})]})}),e.jsx(Nr,{className:"w-[--radix-popover-trigger-width] p-0",align:"start",onOpenAutoFocus:g=>g.preventDefault(),children:e.jsx(sa,{children:e.jsxs(Br,{children:[N&&e.jsx("div",{className:"flex items-center justify-center py-6",children:e.jsx(Dt,{className:"h-5 w-5 animate-spin text-muted-foreground"})}),!N&&Y&&e.jsxs(e.Fragment,{children:[j&&p?.suggestions&&e.jsx("div",{className:"px-3 py-2 border-b bg-muted/50",children:e.jsx("p",{className:"text-xs font-medium text-foreground",children:p.suggestions.message})}),["process","witness","claimant"].map(g=>{const E=p.results.filter(R=>R.type===g);if(E.length===0)return null;const F=Tc[g],O=Ra[g];return e.jsx(Ur,{heading:e.jsxs("div",{className:"flex items-center justify-between w-full pr-2",children:[e.jsx("span",{children:O}),e.jsx(te,{variant:"secondary",className:"text-[10px] px-1.5 py-0",children:E.length})]}),children:E.map(R=>e.jsxs(Hr,{onSelect:()=>Z(R),className:k("flex items-start gap-3 py-3 cursor-pointer transition-colors",j&&"hover:bg-blue-50 dark:hover:bg-blue-950/30"),children:[e.jsx("div",{className:"mt-0.5",children:e.jsx(F,{className:"h-4 w-4 text-muted-foreground"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-medium truncate",children:R.title}),e.jsx(te,{variant:"secondary",className:`text-[10px] px-1.5 py-0 ${Cc[R.type]}`,children:Ra[R.type]})]}),R.subtitle&&e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:R.subtitle}),R.type==="process"&&R.meta&&e.jsxs("div",{className:"flex items-center gap-2 mt-1 text-[10px] text-muted-foreground",children:[R.meta.status&&e.jsxs("span",{children:["Status: ",R.meta.status]}),R.meta.comarca&&e.jsxs("span",{children:[" ",R.meta.comarca]}),R.meta.classificacao&&e.jsx(te,{variant:"outline",className:"text-[9px] px-1 py-0",children:R.meta.classificacao})]}),R.type==="witness"&&R.meta&&e.jsxs("div",{className:"flex items-center gap-2 mt-1 text-[10px]",children:[e.jsxs("span",{className:"text-muted-foreground",children:[R.meta.depoimentos," depoimentos"]}),R.meta.ambosPoles&&e.jsx(te,{variant:"destructive",className:"text-[9px] px-1 py-0",children:" Ambos polos"}),R.meta.classificacao&&e.jsx(te,{variant:"outline",className:"text-[9px] px-1 py-0",children:R.meta.classificacao})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[R.type==="process"&&e.jsx(K,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 hover:bg-muted",onClick:ie=>oe(R.title,ie),title:"Copiar CNJ",children:e.jsx(mt,{className:"h-3 w-3"})}),e.jsx(K,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 hover:bg-muted",title:"Abrir detalhes",children:e.jsx(Ps,{className:"h-3 w-3"})})]})]},R.id))},g)})]}),!N&&!Y&&o.length>=2&&e.jsx(Vr,{children:e.jsxs("div",{className:"text-center py-6",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Nenhum resultado encontrado."}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Tente operadores:"," ",e.jsx("code",{className:"bg-muted px-1 rounded",children:"p:"})," ",e.jsx("code",{className:"bg-muted px-1 rounded",children:"w:"})," ",e.jsx("code",{className:"bg-muted px-1 rounded",children:"uf:RS"})]})]})})]})})})]})}),e.jsxs("div",{className:"flex items-center justify-between gap-4 pt-2",children:[e.jsxs("div",{className:"flex-1 flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground bg-muted/50 px-3 py-1.5 rounded-lg",children:[e.jsx(wo,{className:"h-3.5 w-3.5"}),e.jsxs("span",{children:[e.jsx("kbd",{className:"px-1.5 py-0.5 text-xs rounded bg-background shadow-sm",children:"Ctrl"}),e.jsx("span",{className:"mx-1",children:"+"}),e.jsx("kbd",{className:"px-1.5 py-0.5 text-xs rounded bg-background shadow-sm",children:"K"})]})]}),o.length>0&&e.jsxs("div",{className:"text-xs text-muted-foreground flex items-center gap-1.5 animate-in fade-in slide-in-from-left-2 duration-300",children:[e.jsx("div",{className:"h-1.5 w-1.5 rounded-full bg-green-500 animate-pulse"}),u.length>=2?`${p?.total||0} resultados`:"Digite para buscar"]})]}),e.jsx(K,{onClick:B,disabled:!C||z==="loading",size:"lg",className:k("gap-2 min-w-[180px] shadow-md hover:shadow-lg transition-all hover:scale-105 font-semibold",L&&"bg-primary/90 hover:bg-primary ring-2 ring-primary/20"),children:z==="loading"?e.jsxs(e.Fragment,{children:[e.jsx(Dt,{className:"h-5 w-5 animate-spin",strokeWidth:2}),e.jsx("span",{children:"Analisando dados..."})]}):b?e.jsxs(e.Fragment,{children:[e.jsx(Bt,{className:"h-5 w-5",strokeWidth:2}),e.jsx("span",{children:"Refinar busca"})]}):L?e.jsxs(e.Fragment,{children:[e.jsx(Os,{className:"h-5 w-5",strokeWidth:2}),e.jsx("span",{children:" Anlise Contextual"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Os,{className:"h-5 w-5",strokeWidth:2}),e.jsx("span",{children:" Executar Anlise"})]})})]})]})}function ss({label:t,value:a,type:s="default"}){const r=()=>{switch(s){case"reclamante":return"text-blue-700 font-medium";case"reu":return"text-red-700 font-medium";case"status":return"text-green-700";case"observacoes":return"text-muted-foreground text-sm";default:return"text-foreground"}},n=()=>{switch(s){case"status":return a.toLowerCase().includes("ativo")?"default":"secondary";default:return"outline"}};return e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wide",children:t}),e.jsx("div",{className:k("font-medium",r()),children:s==="status"&&a!=="No informado"?e.jsx(te,{variant:n(),className:"text-xs",children:a}):e.jsx("span",{children:a})})]})}function Rc({cnj:t,reclamante:a,reu:s,status:r="No informado",observacoes:n="Sem observaes registradas",riscoNivel:o,confianca:i,alerta:l,citacoes:m}){console.log(" [ExecutiveSummaryCard] Props recebidas:",{cnj:t,status:r,observacoes:n,riscoNivel:o,confianca:typeof i=="number"?`${i}%`:i,hasObservacoes:!!n&&n!=="Sem observaes registradas",hasStatus:!!r&&r!=="No informado",isDefaultData:r==="No informado"&&n==="Sem observaes registradas"});const{toast:d}=Ve(),[x,f]=h.useState(!1),w=typeof i=="number"&&!isNaN(i)&&isFinite(i)?Math.max(0,Math.min(1,i)):0,y=Math.round(w*100),z=3,v=m.length>z,J=x?m:m.slice(0,z),A=m.length-z,D=async()=>{const G=`Resumo Executivo - ${t}

Reclamante: ${a}
Ru: ${s}
Status: ${r}
Observaes: ${n}

Risco: ${o.toUpperCase()}
Confiana: ${y}%
${l?`Alerta: ${l}`:""}

Citaes:
${m.map(U=>` ${U.label}`).join(`
`)}`;try{await navigator.clipboard.writeText(G),d({title:"Copiado!",description:"Resumo executivo copiado para a rea de transferncia."})}catch{d({title:"Erro ao copiar",description:"No foi possvel copiar o contedo.",variant:"destructive"})}},I=()=>{window.print(),d({title:"PDF",description:"Abrindo dilogo de impresso..."})},P=()=>{const G={cnj:t,reclamante:a,reu:s,status:r,observacoes:n,riscoNivel:o,confianca:i,alerta:l,citacoes:m},U=new Blob([JSON.stringify(G,null,2)],{type:"application/json"}),S=URL.createObjectURL(U),c=document.createElement("a");c.href=S,c.download=`resumo-executivo-${t.replace(/[^\w]/g,"-")}.json`,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(S),d({title:"JSON exportado",description:"Arquivo JSON baixado com sucesso."})};return e.jsxs(ge,{className:"rounded-2xl border-border/50 transition-shadow hover:shadow-sm","aria-labelledby":"executive-summary",children:[e.jsx(Ae,{className:"pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(Pe,{id:"executive-summary",className:"text-base font-semibold flex items-center gap-2",children:[e.jsx(Os,{className:"h-4 w-4 text-violet-600","aria-hidden":"true"}),"Resumo Executivo"]}),e.jsxs(Wt,{children:[e.jsx(Kt,{asChild:!0,children:e.jsx(K,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0","aria-label":"Aes do resumo",children:e.jsx(yo,{className:"h-4 w-4"})})}),e.jsxs(It,{align:"end",children:[e.jsxs(ht,{onClick:D,children:[e.jsx(mt,{className:"h-4 w-4 mr-2"}),"Copiar resumo"]}),e.jsxs(ht,{onClick:I,children:[e.jsx(_o,{className:"h-4 w-4 mr-2"}),"Exportar PDF"]}),e.jsxs(ht,{onClick:P,children:[e.jsx(Co,{className:"h-4 w-4 mr-2"}),"Exportar JSON"]})]})]})]})}),e.jsxs(we,{className:"pt-0 space-y-5",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(ss,{label:"Reclamante",value:a,type:"reclamante"}),e.jsx(ss,{label:"Ru",value:s,type:"reu"}),e.jsx(ss,{label:"Status",value:r,type:"status"}),e.jsx(ss,{label:"Observaes",value:n,type:"observacoes"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Nvel de Risco"}),e.jsx(hn,{riscoNivel:o})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Confiana"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(us,{value:y,className:"w-16 h-2"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[y,"%"]})]})]})]}),l&&e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-muted/50 rounded-lg","aria-live":"polite",children:[e.jsx(hr,{className:"h-4 w-4 text-violet-600","aria-hidden":"true"}),e.jsx("span",{className:"text-sm font-medium",children:l})]})]}),m.length>0&&e.jsxs("div",{className:"pt-3 border-t",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ia,{className:"h-3 w-3 text-muted-foreground","aria-hidden":"true"}),e.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Citaes:"})]}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[J.map((G,U)=>e.jsxs(te,{variant:"secondary",className:k("text-xs flex items-center gap-1 cursor-pointer hover:bg-secondary/80",G.href&&"underline"),onClick:G.onClick||(()=>G.href&&window.open(G.href,"_blank")),children:[e.jsx(ia,{className:"h-3 w-3","aria-hidden":"true"}),G.label]},U)),v&&e.jsx(K,{variant:"ghost",size:"sm",onClick:()=>f(!x),className:"h-6 px-2 text-xs text-muted-foreground hover:text-foreground",children:x?e.jsxs(e.Fragment,{children:[e.jsx(nr,{className:"h-3 w-3 mr-1"}),"Menos"]}):e.jsxs(e.Fragment,{children:[e.jsx(Pt,{className:"h-3 w-3 mr-1"}),"+",A]})})]})]})]})]})}function Dc({secoes:t,textoOriginal:a}){const s=n=>{switch(n){case"alta":return e.jsx(te,{variant:"destructive",className:"text-xs",children:"Alta"});case"media":return e.jsx(te,{variant:"secondary",className:"text-xs",children:"Mdia"});case"baixa":return e.jsx(te,{variant:"outline",className:"text-xs",children:"Baixa"});default:return null}},r=Array.isArray(t)?t:[];return e.jsx("div",{className:"space-y-4",children:e.jsxs(Ho,{type:"multiple",className:"w-full",children:[r.map((n,o)=>e.jsxs(ua,{value:`secao-${o}`,children:[e.jsx(ma,{className:"text-left",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:n.titulo}),n.evidencias&&n.evidencias.length>0&&e.jsxs(te,{variant:"outline",className:"text-xs",children:[n.evidencias.length," evidncia",n.evidencias.length>1?"s":""]})]})}),e.jsx(ha,{children:e.jsxs("div",{className:"space-y-4 pt-2",children:[e.jsx("div",{className:"prose prose-sm max-w-none",children:e.jsx("p",{className:"text-sm text-muted-foreground leading-relaxed",children:n.conteudo})}),n.evidencias&&n.evidencias.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h5",{className:"text-xs font-semibold text-muted-foreground uppercase tracking-wide",children:"Evidncias"}),e.jsx("div",{className:"grid gap-2",children:n.evidencias.map((i,l)=>typeof i=="string"?e.jsx(ge,{className:"p-3 bg-muted/30",children:e.jsx("p",{className:"text-sm",children:i})},l):e.jsx(ge,{className:"p-3 bg-muted/30",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1",children:[i.tipo&&e.jsx("div",{className:"text-xs text-muted-foreground font-medium mb-1",children:i.tipo}),e.jsx("p",{className:"text-sm",children:i.descricao})]}),i.relevancia&&s(i.relevancia)]})},l))})]}),n.metadados&&e.jsx("div",{className:"pt-2 border-t border-muted",children:e.jsxs("div",{className:"flex flex-wrap gap-4 text-xs text-muted-foreground",children:[n.metadados.fonte&&e.jsxs("span",{children:[e.jsx("strong",{children:"Fonte:"})," ",n.metadados.fonte]}),n.metadados.confiabilidade&&e.jsxs("span",{children:[e.jsx("strong",{children:"Confiabilidade:"})," ",Math.round(n.metadados.confiabilidade*100),"%"]}),n.metadados.timestamp&&e.jsxs("span",{children:[e.jsx("strong",{children:"Processado:"})," ",new Date(n.metadados.timestamp).toLocaleString("pt-BR")]})]})})]})})]},o)),a&&e.jsxs(ua,{value:"texto-original",children:[e.jsx(ma,{className:"text-left",children:e.jsx("span",{className:"font-medium",children:"Consulta Original"})}),e.jsx(ha,{children:e.jsx(ge,{className:"p-4 bg-muted/30",children:e.jsx("pre",{className:"text-sm whitespace-pre-wrap font-mono text-muted-foreground",children:a})})})]})]})})}function as({citations:t}){if(!t.length)return null;const a=r=>{switch(r){case"por_processo":return e.jsx(et,{className:"h-3 w-3"});case"por_testemunha":return e.jsx(os,{className:"h-3 w-3"});default:return e.jsx(Ps,{className:"h-3 w-3"})}},s=r=>{switch(r){case"por_processo":return"default";case"por_testemunha":return"secondary";default:return"outline"}};return e.jsxs("div",{className:"pt-3 border-t",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ps,{className:"h-3 w-3 text-muted-foreground"}),e.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Citaes:"})]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:t.map((r,n)=>e.jsxs(te,{variant:s(r.source),className:"text-xs flex items-center gap-1",children:[a(r.source),r.ref]},n))})]})}function kc({onToggle:t,isAnonymized:a,variant:s="default",className:r=""}){const[n,o]=h.useState(!1),i=async()=>{o(!0);try{await new Promise(l=>setTimeout(l,300)),t(!a)}finally{o(!1)}};return s==="minimal"?e.jsx(K,{variant:a?"default":"outline",size:"sm",onClick:i,disabled:n,className:r,children:a?e.jsxs(e.Fragment,{children:[e.jsx(As,{className:"h-4 w-4 mr-2"}),"Dados Anonimizados"]}):e.jsxs(e.Fragment,{children:[e.jsx(nt,{className:"h-4 w-4 mr-2"}),"Dados Completos"]})}):e.jsxs(Wt,{children:[e.jsx(Kt,{asChild:!0,children:e.jsxs(K,{variant:"outline",className:r,children:[e.jsx(Qe,{className:"h-4 w-4 mr-2"}),"Privacidade",e.jsx(Pt,{className:"h-4 w-4 ml-2"})]})}),e.jsxs(It,{align:"end",className:"w-56",children:[e.jsx(ht,{onClick:i,disabled:n,children:a?e.jsxs(e.Fragment,{children:[e.jsx(nt,{className:"h-4 w-4 mr-2"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Mostrar Dados Completos"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Revelar CPFs e nomes reais"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(As,{className:"h-4 w-4 mr-2"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Anonimizar Dados"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Mascarar informaes sensveis"})]})]})}),e.jsxs(ht,{disabled:!0,className:"border-t mt-1 pt-2",children:[e.jsx(Qe,{className:"h-4 w-4 mr-2 text-muted-foreground"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Conforme Art. 6, VII da LGPD"})]})]})]})}function Ac({variant:t="compact",showDetails:a=!1,className:s=""}){return t==="badge"?e.jsx(Cr,{children:e.jsxs(Lt,{children:[e.jsx(qt,{asChild:!0,children:e.jsxs(te,{variant:"secondary",className:`bg-success/10 text-success border-success/20 ${s}`,children:[e.jsx(Qe,{className:"h-3 w-3 mr-1"}),"LGPD Ready"]})}),e.jsx(St,{children:e.jsx("p",{children:"Documento em conformidade com a LGPD"})})]})}):t==="compact"?e.jsxs("div",{className:`inline-flex items-center gap-2 px-3 py-2 bg-success/10 border border-success/20 rounded-lg ${s}`,children:[e.jsx(Qe,{className:"h-4 w-4 text-success"}),e.jsx("span",{className:"text-sm font-medium text-success",children:"LGPD Compliant"}),e.jsx(Ze,{className:"h-3 w-3 text-success"})]}):e.jsxs("div",{className:`border border-success/20 rounded-lg p-4 bg-success/5 ${s}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"flex items-center justify-center w-10 h-10 bg-success/10 rounded-full",children:e.jsx(Qe,{className:"h-5 w-5 text-success"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-success",children:"Documento LGPD-Ready"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Conforme Lei 13.709/2018"})]}),e.jsx(Ze,{className:"h-5 w-5 text-success ml-auto"})]}),a&&e.jsxs("div",{className:"space-y-2 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(So,{className:"h-3 w-3"}),e.jsx("span",{children:"Dados criptografados em trnsito e repouso"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(nt,{className:"h-3 w-3"}),e.jsx("span",{children:"Informaes sensveis anonimizadas por padro"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(et,{className:"h-3 w-3"}),e.jsx("span",{children:"Base legal: Execuo regular de direitos (Art. 7, VI)"})]})]}),e.jsx("div",{className:"mt-3 pt-3 border-t border-success/20",children:e.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.jsx("strong",{children:"Aviso:"})," Este documento contm anlise assistida por IA. Validao jurdica humana  obrigatria antes do uso processual."]})})]})}function Pc({onExport:t,showPrint:a=!0,disabled:s=!1,showAnonymizeOption:r=!0,isAnonymized:n=!1,onAnonymizeToggle:o,className:i=""}){const{toast:l}=Ve(),m=()=>{window.print(),l({title:"Imprimindo",description:"Preparando documento para impresso..."})},d=x=>{t(x,n);const f=n?" (dados anonimizados)":" (dados completos)";l({title:"Exportando",description:`Gerando arquivo ${x.toUpperCase()}${f}... Ser registrado no log de auditoria.`})};return e.jsxs("div",{className:`space-y-3 ${i}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Ac,{variant:"badge"}),r&&o&&e.jsx(kc,{isAnonymized:n,onToggle:o,variant:"minimal"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[a&&e.jsxs(K,{variant:"outline",size:"sm",onClick:m,disabled:s,className:"gap-2",children:[e.jsx(To,{className:"h-4 w-4"}),"Imprimir",n&&e.jsx(Qe,{className:"h-3 w-3 text-success"})]}),e.jsxs(K,{variant:"outline",size:"sm",onClick:()=>d("pdf"),disabled:s,className:"gap-2",children:[e.jsx(et,{className:"h-4 w-4"}),"PDF",n&&e.jsx(Qe,{className:"h-3 w-3 text-success"})]}),e.jsxs(K,{variant:"outline",size:"sm",onClick:()=>d("csv"),disabled:s,className:"gap-2",children:[e.jsx(Js,{className:"h-4 w-4"}),"CSV",n&&e.jsx(Qe,{className:"h-3 w-3 text-success"})]}),e.jsxs(K,{variant:"outline",size:"sm",onClick:()=>d("docx"),disabled:s,className:"gap-2",children:[e.jsx(et,{className:"h-4 w-4"}),"DOCX",n&&e.jsx(Qe,{className:"h-3 w-3 text-success"})]}),e.jsxs(K,{variant:"outline",size:"sm",onClick:()=>d("json"),disabled:s,className:"gap-2",children:[e.jsx(mr,{className:"h-4 w-4"}),"JSON",n&&e.jsx(Qe,{className:"h-3 w-3 text-success"})]})]})]})}function Oc({blocks:t}){const{toast:a}=Ve(),s=()=>{window.print(),a({title:"PDF",description:"Abrindo dilogo de impresso..."})},r=()=>{const i=["Tipo,Conteudo",...t.map(x=>({Tipo:x.title,Conteudo:JSON.stringify(x.data)})).map(x=>`"${x.Tipo}","${x.Conteudo}"`)].join(`
`),l=new Blob([i],{type:"text/csv;charset=utf-8;"}),m=document.createElement("a"),d=URL.createObjectURL(l);m.setAttribute("href",d),m.setAttribute("download",`analise-${Date.now()}.csv`),document.body.appendChild(m),m.click(),document.body.removeChild(m),a({title:"CSV exportado",description:"Arquivo CSV baixado com sucesso."})},n=()=>{const o={timestamp:new Date().toISOString(),blocks:t},i=new Blob([JSON.stringify(o,null,2)],{type:"application/json"}),l=URL.createObjectURL(i),m=document.createElement("a");m.href=l,m.download=`analise-completa-${Date.now()}.json`,document.body.appendChild(m),m.click(),document.body.removeChild(m),URL.revokeObjectURL(l),a({title:"JSON exportado",description:"Arquivo JSON baixado com sucesso."})};return!t||t.length===0?null:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-brand-ink",children:"Resultado da Anlise"}),e.jsx(Pc,{onExport:o=>{switch(o){case"pdf":s();break;case"csv":r();break;case"json":n();break}},showPrint:!0})]}),e.jsx("div",{className:"space-y-4",children:t.map((o,i)=>{switch(o.type){case"executive":return e.jsx(Rc,{cnj:o.data?.cnj||o.data?.processo||(o.context?.type==="testemunha","N/A"),reclamante:o.data?.reclamante||o.context?.data?.nome||o.data?.reclamada||"No informado",reu:o.data?.reu||o.data?.reclamada||(o.context?.type==="testemunha"?"N/A":"No informado"),status:o.data?.status||o.meta?.status||o.context?.meta?.status||"No informado",observacoes:o.data?.observacoes||o.meta?.observacoes||"Anlise contextual em progresso",riscoNivel:o.data?.riscoNivel||o.meta?.riscoNivel||o.context?.meta?.riscoNivel||"baixo",confianca:typeof o.data?.confianca=="number"?o.data.confianca:typeof o.meta?.confidence=="number"?Math.round(o.meta.confidence*100):typeof o.context?.meta?.confidence=="number"?Math.round(o.context.meta.confidence*100):typeof o.data?.score=="number"?o.data.score:0,alerta:o.data?.alerta,citacoes:o.citations?.map(l=>({label:l.ref,onClick:()=>{console.log("Citation clicked:",l)}}))||[]},i);case"details":return e.jsxs(ge,{className:"rounded-2xl border-border/50",children:[e.jsx(Ae,{children:e.jsxs(Pe,{className:"text-base font-semibold flex items-center gap-2",children:[e.jsx(et,{className:"h-4 w-4 text-primary"}),o.title]})}),e.jsxs(we,{children:[e.jsx(Dc,{secoes:o.data.secoes,textoOriginal:o.data.textoOriginal}),o.citations&&e.jsx(as,{citations:o.citations})]})]},i);case"alerts":return e.jsxs(ge,{className:"rounded-2xl border-status-critical/30 bg-status-critical/5",children:[e.jsx(Ae,{children:e.jsxs(Pe,{className:"text-base font-semibold flex items-center gap-2",children:[e.jsx(tt,{className:"h-4 w-4 text-destructive"}),o.title]})}),e.jsxs(we,{className:"space-y-3",children:[e.jsxs(Ge,{className:"border-destructive/30 bg-destructive/10",children:[e.jsx(tt,{className:"h-4 w-4 text-destructive"}),e.jsxs(Ye,{className:"text-destructive-foreground",children:[e.jsx("strong",{children:"Triangulao Detectada"})," - Padres suspeitos identificados entre testemunhas"]})]}),e.jsxs(Ge,{className:"border-status-warning/30 bg-status-warning/10",children:[e.jsx(tt,{className:"h-4 w-4 text-status-warning"}),e.jsxs(Ye,{className:"text-status-warning",children:[e.jsx("strong",{children:"Depoimentos Repetidos"})," - Narrativas similares encontradas"]})]}),o.data.suspiciousPatterns?.map((l,m)=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-destructive/10 rounded-lg",children:[e.jsx(tt,{className:"h-3 w-3 text-destructive"}),e.jsx("span",{className:"text-sm text-destructive-foreground",children:l})]},m)),e.jsx("div",{className:"mt-4 p-3 bg-muted/50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:[" ",e.jsx("strong",{children:"Ateno:"})," Possvel coordenao entre depoimentos de testemunhas. Recomenda-se investigao detalhada dos vnculos identificados."]})}),o.citations&&e.jsx(as,{citations:o.citations})]})]},i);case"strategies":return e.jsx(Ic,{block:o},i);default:return e.jsxs(ge,{className:"rounded-2xl border-border/50",children:[e.jsx(Ae,{children:e.jsx(Pe,{className:"text-base font-semibold",children:o.title})}),e.jsxs(we,{children:[e.jsx("pre",{className:"text-sm text-muted-foreground whitespace-pre-wrap",children:JSON.stringify(o.data,null,2)}),o.citations&&e.jsx(as,{citations:o.citations})]})]},i)}})}),e.jsxs("div",{className:"text-xs text-muted-foreground text-center pt-4 border-t",children:["Relatrio gerado s ",new Date().toLocaleTimeString("pt-BR"),"  Dados sujeitos  verificao manual conforme LGPD"]})]})}function Ic({block:t}){const{toast:a}=Ve(),s=async n=>{try{await navigator.clipboard.writeText(n),a({title:"Copiado!",description:"Recomendao copiada para a rea de transferncia."})}catch{a({title:"Erro ao copiar",description:"No foi possvel copiar o contedo.",variant:"destructive"})}},r=n=>{switch(n?.toUpperCase()){case"ALTA":return"bg-status-critical/15 text-status-critical border-status-critical/30";case"MDIA":return"bg-status-warning/15 text-status-warning border-status-warning/30";case"BAIXA":return"bg-status-success/15 text-status-success border-status-success/30";default:return"bg-muted text-muted-foreground border-border"}};return e.jsxs(ge,{className:"rounded-2xl border-status-success/30 bg-status-success/10",children:[e.jsx(Ae,{children:e.jsxs(Pe,{className:"text-base font-semibold flex items-center gap-2",children:[e.jsx(la,{className:"h-4 w-4 text-emerald-600"}),t.title]})}),e.jsxs(we,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-medium text-emerald-800",children:"Estratgias Ativas"}),e.jsx(te,{variant:"secondary",className:"text-xs",children:"Polo Ativo"})]}),t.data.estrategias?.map((n,o)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white/70 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(te,{className:k("text-xs",r(n.prioridade)),children:n.prioridade}),e.jsx("span",{className:"text-sm",children:n.texto})]}),e.jsx(K,{variant:"ghost",size:"sm",onClick:()=>s(n.texto),className:"h-8 w-8 p-0 shrink-0",children:e.jsx(mt,{className:"h-3 w-3"})})]},o))]}),t.data.acoesDefensivas&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-emerald-800",children:"Aes Defensivas"}),t.data.acoesDefensivas.map((n,o)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white/70 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(te,{className:k("text-xs",r(n.prioridade)),children:n.prioridade}),e.jsx("span",{className:"text-sm",children:n.texto})]}),e.jsx(K,{variant:"ghost",size:"sm",onClick:()=>s(n.texto),className:"h-8 w-8 p-0 shrink-0",children:e.jsx(mt,{className:"h-3 w-3"})})]},o))]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(la,{className:"h-4 w-4 text-emerald-600"}),e.jsx("h4",{className:"font-medium text-emerald-800",children:"Prximos Passos"})]}),t.data.proximosPassos?.map((n,o)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white/70 rounded-lg border",children:[e.jsx("span",{className:"text-sm",children:n}),e.jsx(K,{variant:"ghost",size:"sm",onClick:()=>s(n),className:"h-8 w-8 p-0 shrink-0",children:e.jsx(mt,{className:"h-3 w-3"})})]},o))]}),t.citations&&e.jsx(as,{citations:t.citations})]})]})}function Fc(){const{loadingHints:t,currentHintIndex:a,nextHint:s}=W(),r=h.useRef(null);return h.useEffect(()=>(r.current&&clearInterval(r.current),r.current=setInterval(()=>{s()},800),()=>{r.current&&clearInterval(r.current)}),[s]),e.jsxs("div",{className:"flex gap-4 animate-fade-in",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx(Eo,{className:"h-4 w-4 text-primary animate-pulse"})}),e.jsx("div",{className:"flex-1 max-w-4xl",children:e.jsx(ge,{className:"bg-card border-primary/20 shadow-sm",children:e.jsxs(we,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Dt,{className:"h-4 w-4 animate-spin text-primary"}),e.jsx("span",{className:"text-sm text-foreground font-medium transition-opacity duration-200",children:t[a]||"Carregando..."},a)]}),e.jsx("div",{className:"mt-3 flex gap-1",children:Array.from({length:3}).map((n,o)=>e.jsx("div",{className:"h-1 w-8 rounded-full bg-primary/20 animate-pulse",style:{animationDelay:`${o*.2}s`,animationDuration:"1s"}},o))})]})})})]})}const Da=({isLoading:t,hasError:a,errorMessage:s,isConnected:r,dataCount:n,dataType:o})=>t?e.jsx(ge,{className:"mb-4 border-blue-200 bg-blue-50/50",children:e.jsx(we,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Dt,{className:"h-5 w-5 text-blue-600 animate-spin"}),e.jsx("span",{className:"text-sm text-blue-800",children:"Conectando com servidor..."})]})})}):a&&!r?e.jsx(ge,{className:"mb-4 border-orange-200 bg-orange-50/50",children:e.jsx(we,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ro,{className:"h-5 w-5 text-orange-600"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm text-orange-800",children:"Servidor indisponvel - Exibindo dados simulados"}),s&&e.jsx("p",{className:"text-xs text-orange-700 mt-1",children:s})]}),e.jsx(te,{variant:"outline",className:"text-orange-700 border-orange-300",children:"Mock"})]})})}):a&&r?e.jsx(ge,{className:"mb-4 border-red-200 bg-red-50/50",children:e.jsx(we,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(tt,{className:"h-5 w-5 text-red-600"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm text-red-800",children:"Erro de validao nos filtros"}),s&&e.jsx("p",{className:"text-xs text-red-700 mt-1",children:s})]}),e.jsx(te,{variant:"destructive",className:"text-xs",children:"Erro"})]})})}):r&&n>0?e.jsx(ge,{className:"mb-4 border-green-200 bg-green-50/50",children:e.jsx(we,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ze,{className:"h-5 w-5 text-green-600"}),e.jsxs("span",{className:"text-sm text-green-800",children:[n," ",o," carregados do servidor"]}),e.jsx(te,{variant:"outline",className:"text-green-700 border-green-300",children:"Online"})]})})}):null;class $c extends h.Component{state={hasError:!1,error:null,errorInfo:null,errorCount:0};static getDerivedStateFromError(a){return{hasError:!0,error:a}}componentDidCatch(a,s){const r=this.state.errorCount+1;Ie.error(" [MapaErrorBoundary] Erro capturado",{error:a.message,stack:a.stack,componentStack:s.componentStack,errorCount:r,timestamp:new Date().toISOString(),userAgent:navigator.userAgent,online:navigator.onLine}),this.setState({error:a,errorInfo:s,errorCount:r}),r>3&&Ie.error(" [MapaErrorBoundary] Loop de erros detectado",{errorCount:r,lastError:a.message})}handleReset=()=>{Ie.info(" [MapaErrorBoundary] Resetando estado de erro"),this.setState({hasError:!1,error:null,errorInfo:null,errorCount:0})};handleGoHome=()=>{Ie.info(" [MapaErrorBoundary] Navegando para home"),window.location.href="/"};render(){if(this.state.hasError){const{error:a,errorInfo:s,errorCount:r}=this.state;return e.jsx("div",{className:"flex items-center justify-center min-h-screen p-4 bg-background",children:e.jsxs(ge,{className:"max-w-2xl w-full",children:[e.jsx(Ae,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(tt,{className:"h-8 w-8 text-destructive"}),e.jsxs("div",{children:[e.jsx(Pe,{className:"text-2xl",children:"Erro no Mapa de Testemunhas"}),e.jsx(Nt,{children:r>1?`Ocorreram ${r} erros consecutivos`:"Ocorreu um erro inesperado"})]})]})}),e.jsxs(we,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"font-semibold text-sm text-muted-foreground",children:"Mensagem de Erro"}),e.jsx("div",{className:"p-3 bg-destructive/10 border border-destructive/20 rounded-md",children:e.jsx("p",{className:"text-sm text-destructive font-mono",children:a?.message||"Erro desconhecido"})})]}),!1,e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"font-semibold text-sm text-muted-foreground",children:"Possveis Causas"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm text-muted-foreground",children:[e.jsx("li",{children:"Problemas de conexo com o servidor"}),e.jsx("li",{children:"Dados inconsistentes ou mal formatados"}),e.jsx("li",{children:"Erro na Edge Function do backend"}),e.jsx("li",{children:"Sesso expirada ou invlida"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[r<=3&&e.jsxs(K,{onClick:this.handleReset,className:"flex-1",children:[e.jsx(ns,{className:"mr-2 h-4 w-4"}),"Tentar Novamente"]}),e.jsxs(K,{onClick:this.handleGoHome,variant:"outline",className:"flex-1",children:[e.jsx(fr,{className:"mr-2 h-4 w-4"}),"Voltar ao Incio"]})]}),r>3&&e.jsx("div",{className:"p-3 bg-yellow-500/10 border border-yellow-500/20 rounded-md",children:e.jsx("p",{className:"text-sm text-yellow-600 dark:text-yellow-400",children:" Mltiplas tentativas falharam. Por favor, entre em contato com o suporte."})})]})]})})}return this.props.children}}const Mc=()=>{const[t,a]=h.useState(X.isEnabled()),{toast:s}=Ve();h.useEffect(()=>{a(X.isEnabled())},[]);const r=()=>{const n=X.toggle();a(n),s({title:n?" Debug Mode Ativado":"Debug Mode Desativado",description:n?"Logs detalhados esto sendo exibidos no console":"Logs de debug foram desativados",duration:2e3})};return e.jsxs("div",{className:"flex items-center space-x-2 bg-muted/50 px-3 py-2 rounded-md border border-border/40",children:[e.jsx(Do,{className:"h-4 w-4 text-muted-foreground"}),e.jsx(ke,{htmlFor:"debug-mode",className:"text-sm cursor-pointer",children:"Debug Mode"}),e.jsx(Ys,{id:"debug-mode",checked:t,onCheckedChange:r,className:"data-[state=checked]:bg-primary"})]})};async function Lc(t){const a={functionName:t,isReachable:!1,hasAuth:!1};try{const{data:{session:s},error:r}=await Fe.auth.getSession();if(r)return a.authError=r.message,Ie.error(`[EdgeDiagnostics] Erro de sesso para ${t}`,{error:r}),a;if(!s)return a.authError="Nenhuma sesso ativa",Ie.warn(`[EdgeDiagnostics] Nenhuma sesso ativa para ${t}`),a;a.hasAuth=!0,Ie.info(`[EdgeDiagnostics] Testando ${t}...`);const{data:n,error:o}=await Fe.functions.invoke(t,{body:{paginacao:{page:1,limit:1},filtros:{}}});return o?(a.testResult="error",a.errorDetails={message:o.message,context:o.context,status:o.status},Ie.error(`[EdgeDiagnostics] Erro ao testar ${t}`,{error:o,errorDetails:a.errorDetails})):(a.isReachable=!0,a.testResult="success",Ie.info(`[EdgeDiagnostics] ${t} respondeu com sucesso`,{hasData:!!n,dataKeys:n?Object.keys(n):[]})),a}catch(s){return a.testResult="error",a.errorDetails=s,Ie.error(`[EdgeDiagnostics] Exceo ao testar ${t}`,{error:s}),a}}async function qc(){Ie.info(" [EdgeDiagnostics] ===== INICIANDO DIAGNSTICO COMPLETO =====");const t=["mapa-testemunhas-processos","mapa-testemunhas-testemunhas"],a={};for(const r of t)Ie.info(` [EdgeDiagnostics] Testando funo: ${r}`),a[r]=await Lc(r);Ie.info(" [EdgeDiagnostics] ===== DIAGNSTICO CONCLUDO =====",{results:a});const s=Object.entries(a).map(([r,n])=>({function:r,reachable:n.isReachable,authenticated:n.hasAuth,testResult:n.testResult,error:n.errorDetails?.message||n.authError||"none"}));return console.table(s),a}function zc(){Ie.info(" [EdgeDiagnostics] ===== CONFIGURAO SUPABASE =====");const t={hasSupabaseClient:!!Fe,functionsUrl:Fe?.functions?.url||"NOT_CONFIGURED",hasAuth:!!Fe?.auth};return Ie.info(" [EdgeDiagnostics] Config:",t),console.table(t),t}function Bc(){const[t,a]=h.useState(null),[s,r]=h.useState(!1),n=async()=>{r(!0),zc();const o=await qc();a(o),r(!1)};return e.jsxs(ge,{className:"border-dashed border-yellow-500/50 bg-yellow-50/5",children:[e.jsxs(Ae,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ko,{className:"h-4 w-4 text-yellow-600"}),e.jsx(Pe,{className:"text-sm",children:"Diagnstico de Edge Functions"})]}),e.jsx(te,{variant:"outline",className:"text-yellow-600 border-yellow-600",children:"DEV ONLY"})]}),e.jsx(Nt,{className:"text-xs",children:"Teste a conectividade e configurao das Edge Functions"})]}),e.jsxs(we,{className:"space-y-3",children:[e.jsxs(K,{onClick:n,disabled:s,size:"sm",variant:"outline",className:"w-full",children:[s&&e.jsx(ns,{className:"mr-2 h-3 w-3 animate-spin"}),s?"Executando diagnstico...":"Executar Diagnstico"]}),t&&e.jsx("div",{className:"space-y-2",children:Object.entries(t).map(([o,i])=>e.jsx("div",{className:"flex items-start justify-between gap-2 rounded-lg border border-border/50 bg-card/50 p-2 text-xs",children:e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsx("div",{className:"font-mono font-medium",children:o}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[i.hasAuth?e.jsxs(te,{variant:"outline",className:"text-green-600 border-green-600 text-[10px]",children:[e.jsx(rs,{className:"mr-1 h-2 w-2"}),"Autenticado"]}):e.jsxs(te,{variant:"outline",className:"text-red-600 border-red-600 text-[10px]",children:[e.jsx(Ds,{className:"mr-1 h-2 w-2"}),"Sem Auth"]}),i.isReachable?e.jsxs(te,{variant:"outline",className:"text-green-600 border-green-600 text-[10px]",children:[e.jsx(rs,{className:"mr-1 h-2 w-2"}),"Alcanvel"]}):e.jsxs(te,{variant:"outline",className:"text-red-600 border-red-600 text-[10px]",children:[e.jsx(Ds,{className:"mr-1 h-2 w-2"}),"No Alcanvel"]})]}),(i.authError||i.errorDetails)&&e.jsx("div",{className:"text-[10px] text-destructive/80",children:i.authError||i.errorDetails?.message||"Erro desconhecido"})]})},o))})]})]})}function Vc(){const t=W(r=>r.density),a=W(r=>r.setDensity),s=[{value:"compact",label:"Compacto",description:"Espaamento mnimo"},{value:"comfortable",label:"Confortvel",description:"Espaamento amplo"}];return e.jsxs(Wt,{children:[e.jsx(Kt,{asChild:!0,children:e.jsxs(K,{variant:"outline",size:"sm",className:"gap-2",children:[e.jsx(Ao,{className:"h-4 w-4"}),"Densidade"]})}),e.jsx(It,{align:"end",className:"w-[200px]",children:s.map(r=>e.jsxs(ht,{onClick:()=>a(r.value),className:"flex items-center justify-between cursor-pointer",children:[e.jsxs("div",{className:"flex flex-col gap-0.5",children:[e.jsx("span",{className:"text-sm font-medium",children:r.label}),e.jsx("span",{className:"text-xs text-muted-foreground",children:r.description})]}),t===r.value&&e.jsx(Hs,{className:"h-4 w-4 text-primary"})]},r.value))})]})}function Uc(){const t=Ks(),a=W(n=>n.navigationHistory),s=W(n=>n.popNavigation),r=n=>{const o=a[n];o?.path&&(t(o.path),s(n))};return a.length<=1?null:e.jsx(Jr,{className:"mb-4",children:e.jsxs(Wr,{children:[e.jsx(Ls,{children:e.jsxs(qs,{onClick:()=>r(0),className:"flex items-center gap-1 cursor-pointer",children:[e.jsx(fr,{className:"h-3.5 w-3.5"}),e.jsx("span",{children:"Incio"})]})}),a.slice(1).map((n,o)=>{const i=o===a.length-2,l=o+1;return e.jsxs("div",{className:"flex items-center",children:[e.jsx(Gr,{}),e.jsx(Ls,{children:i?e.jsx(Kr,{className:"font-medium",children:n.label}):e.jsx(qs,{onClick:()=>r(l),className:"cursor-pointer hover:text-foreground",children:n.label})})]},l)})]})})}const Hc=()=>{const t=Ks(),[a,s]=Po(),{user:r,loading:n}=Jo(),{toast:o}=Ve(),i=W(un),l=W(Hi),m=W(Ji),d=W(Wi);W(mn);const x=W(Ki),f=W(Gi),w=W(Yi),y=W(Qi),z=W(Xi),v=h.useRef(null),J=h.useRef(null),A=h.useRef(!1),D=h.useRef(!0),I=h.useRef(!1),[P,G]=h.useState(!1),[U,S]=h.useState(!1),c=W(_=>_.chatResult),u=W(_=>_.chatStatus),p=W(_=>_.setActiveTab),N=W(_=>_.setProcessos),T=W(_=>_.setTestemunhas),$=W(_=>_.setIsLoading),Z=W(_=>_.setLastUpdate),oe=W(_=>_.setError),de=W(_=>_.setIsImportModalOpen),L=W(_=>_.loadViews),re=W(_=>_.setProcessoFilters),B=W(_=>_.setTestemunhaFilters),ue=W(_=>_.setSelectedProcesso),Y=W(_=>_.setSelectedTestemunha),[j,b]=h.useState(0),[C,g]=h.useState(0),E=_=>_.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),F=h.useMemo(()=>{const _=Array.isArray(l)?l:[],se=Array.isArray(m)?m:[],V=_.filter(Te=>Te?.classificacao_final==="Risco Alto"||Te?.classificacao_final==="Alto").length,Q=se.filter(Te=>Te?.foi_testemunha_em_ambos_polos===!0).length,ae=(Te,pe)=>{if(!isFinite(Te)||!isFinite(pe)||pe<=0)return 0;const Ee=Math.round(Te/pe*100);return isFinite(Ee)?Ee:0},Ne=isFinite(j)&&j>0?j:_.length,fe=isFinite(C)&&C>0?C:se.length;return{totalProcessos:Ne,totalTestemunhas:fe,processosAltoRisco:V,testemunhasAmbosPolos:Q,pctProcAlto:ae(V,Ne),pctAmbos:ae(Q,fe)}},[l,m,j,C]),O=_=>d?"loading":x?navigator.onLine?"error":"offline":_.length?"success":"empty",R=O(l),ie=O(m);h.useEffect(()=>{if(!n&&!r){t("/login");return}},[r,n,t]),h.useEffect(()=>{r&&L(r.id)},[r,L]),h.useEffect(()=>{if(I.current)return;const _=a.get("tab"),se=a.get("nome"),V=a.get("cnj"),Q=a.get("reclamante");if(_&&(_==="processos"||_==="testemunhas")&&_!==i&&p(_),se&&B({search:decodeURIComponent(se)}),V&&re({search:decodeURIComponent(V)}),Q&&re({search:decodeURIComponent(Q)}),se||V||Q){I.current=!0;const ae=new URLSearchParams(a);ae.delete("nome"),ae.delete("cnj"),ae.delete("reclamante"),s(ae,{replace:!0})}},[]),h.useEffect(()=>{if(!(!I.current||A.current)&&!(l.length===0&&m.length===0)){if(z.search&&m.length>0){const _=m.find(se=>se.nome_testemunha?.toLowerCase()===z.search?.toLowerCase());_&&!W.getState().selectedTestemunha&&(Y(_),o({title:"Testemunha selecionada",description:_.nome_testemunha}))}if(y.search&&l.length>0){const _=l.find(se=>se.cnj===y.search||se.numero_cnj===y.search);_&&!W.getState().selectedProcesso&&(ue(_),o({title:"Processo selecionado",description:_.cnj||_.numero_cnj}))}}},[l.length,m.length]);const H=_=>{const se=_;p(se),s({tab:se},{replace:!0}),ue(null),Y(null)},ce=Is(y,300),M=Is(z,300),ne=h.useCallback(async()=>{if(!r||A.current)return;v.current?.abort(),J.current?.abort();const _=new AbortController,se=new AbortController;v.current=_,J.current=se,A.current=!0,$(!0),oe(!1);try{const V=W.getState().processoFilters,Q=W.getState().testemunhaFilters,[ae,Ne]=await Promise.all([jc({page:1,limit:100,filters:V}),vc({page:1,limit:100,filters:Q})]);if(_.signal.aborted||se.signal.aborted)return;const fe=Array.isArray(ae.data)?ae.data:[],Te=Array.isArray(Ne.data)?Ne.data:[];N(fe),T(Te);const pe=isFinite(ae.total)?ae.total:fe.length,Ee=isFinite(Ne.total)?Ne.total:Te.length;b(pe),g(Ee);const ve=ae.error||Ne.error;ve?(oe(!0,`Erro ao conectar: ${ve}`),o({title:"Falha ao conectar",description:ve,variant:"destructive"})):D.current&&(Z(new Date),D.current=!1)}catch(V){if(V?.name==="AbortError")return;const Q=V instanceof Error?V.message:"Erro ao carregar dados";oe(!0,Q),o({title:"Falha na conexo",description:Q,variant:"destructive"})}finally{!_.signal.aborted&&!se.signal.aborted&&(A.current=!1,$(!1))}},[r]);h.useEffect(()=>(r&&ne(),()=>{v.current?.abort(),J.current?.abort()}),[r,ne]),h.useEffect(()=>{!D.current&&r&&ne()},[ce,M,ne]),h.useEffect(()=>{const _=se=>{(se.ctrlKey||se.metaKey)&&se.key==="f"&&(se.preventDefault(),G(!0))};return window.addEventListener("keydown",_),()=>window.removeEventListener("keydown",_)},[]);const le=()=>{const se=Object.entries(i==="processos"?y:z);if(se.length===0)return null;const V=Q=>{if(i==="processos"){const ae={...y};delete ae[Q],re(ae)}else{const ae={...z};delete ae[Q],B(ae)}};return e.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Filtros ativos:"}),se.map(([Q,ae])=>e.jsxs(te,{variant:"secondary",className:"gap-1",children:[e.jsxs("span",{className:"text-xs",children:[Q,": ",String(ae)]}),e.jsx("button",{onClick:()=>V(Q),className:"ml-1 hover:bg-secondary-foreground/10 rounded-full p-0.5","aria-label":`Remover filtro ${Q}`,children:e.jsx(ut,{className:"h-3 w-3"})})]},Q))]})};return n?e.jsx("div",{className:"min-h-screen flex items-center justify-center","aria-live":"polite",children:e.jsx("div",{className:"animate-pulse text-muted-foreground",children:"Verificando autenticao..."})}):r?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("div",{className:"border-b border-border/50 bg-card",children:e.jsxs("div",{className:"container mx-auto px-6 py-6",children:[e.jsx(Uc,{}),e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold flex items-center gap-3",children:[e.jsx(Oo,{className:"h-8 w-8 text-primary","aria-hidden":"true"}),"Mapa de Testemunhas",x&&e.jsx(te,{variant:"destructive",className:"text-xs",children:"Modo Fallback"})]}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Anlise estratgica de testemunhas e processos judiciais"}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Io,{className:"h-4 w-4","aria-hidden":"true"}),e.jsxs("span",{children:["ltima atualizao:"," ",w?E(w):""]})]}),e.jsx(jt,{orientation:"vertical",className:"h-4"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ur,{className:"h-4 w-4","aria-hidden":"true"}),e.jsx("span",{children:x?"Dados mock":"Dados em tempo real"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Vc,{}),e.jsxs(K,{variant:"outline",onClick:()=>de(!0),className:"gap-2","aria-label":"Importar dados via Excel",children:[e.jsx(et,{className:"h-4 w-4","aria-hidden":"true"}),"Importar Dados"]}),X.isEnabled()&&e.jsxs(kr,{open:U,onOpenChange:S,children:[e.jsx(Go,{asChild:!0,children:e.jsxs(K,{variant:"outline",size:"sm",className:"gap-2",children:[e.jsx(Fo,{className:"h-4 w-4"}),"Diagnstico"]})}),e.jsxs(Qs,{side:"right",className:"w-[400px]",children:[e.jsxs(Xs,{children:[e.jsx(Zs,{children:"Diagnstico do Sistema"}),e.jsx(ea,{children:"Ferramentas de desenvolvimento e diagnstico"})]}),e.jsx("div",{className:"mt-6",children:e.jsx(Bc,{})})]})]}),e.jsx(Mc,{}),e.jsx(Xl,{}),e.jsx(hc,{data:i==="processos"?l:m,fileName:i==="processos"?"por_processo.csv":"por_testemunha.csv"})]})]})]})}),e.jsxs("div",{className:"container mx-auto px-6 py-6",children:[x&&e.jsx(ge,{className:"rounded-2xl border-destructive/50 bg-destructive/5 mb-6",children:e.jsx(we,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2 text-destructive",children:[e.jsx(tt,{className:"h-4 w-4","aria-hidden":"true"}),e.jsx("span",{className:"font-medium",children:"Erro:"}),e.jsx("span",{className:"text-sm",children:f})]})})}),e.jsx(Cr,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsxs(Lt,{children:[e.jsx(qt,{asChild:!0,children:e.jsxs(ge,{className:"rounded-2xl border-border/50 hover:shadow-md transition-shadow cursor-help",children:[e.jsx(Ae,{className:"pb-3",children:e.jsxs(Pe,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(ca,{className:"h-4 w-4 text-primary","aria-hidden":"true"}),"Total de Processos"]})}),e.jsxs(we,{children:[e.jsx("div",{className:"text-3xl font-bold text-primary",children:F.totalProcessos.toLocaleString("pt-BR")}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Processos cadastrados"," ",l.length<F.totalProcessos&&`(exibindo ${l.length})`]})]})]})}),e.jsx(St,{children:e.jsx("p",{children:"Total de processos jurdicos cadastrados no sistema"})})]}),e.jsxs(Lt,{children:[e.jsx(qt,{asChild:!0,children:e.jsxs(ge,{className:"rounded-2xl border-border/50 hover:shadow-md transition-shadow cursor-help",children:[e.jsx(Ae,{className:"pb-3",children:e.jsxs(Pe,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Vt,{className:"h-4 w-4 text-emerald-600","aria-hidden":"true"}),"Total de Testemunhas"]})}),e.jsxs(we,{children:[e.jsx("div",{className:"text-3xl font-bold text-emerald-600",children:F.totalTestemunhas.toLocaleString("pt-BR")}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Testemunhas identificadas"," ",m.length<F.totalTestemunhas&&`(exibindo ${m.length})`]})]})]})}),e.jsx(St,{children:e.jsx("p",{children:"Total de testemunhas nicas identificadas em todos os processos"})})]}),e.jsxs(Lt,{children:[e.jsx(qt,{asChild:!0,children:e.jsxs(ge,{className:"rounded-2xl border-border/50 hover:shadow-md transition-shadow cursor-help",children:[e.jsx(Ae,{className:"pb-3",children:e.jsxs(Pe,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(tt,{className:"h-4 w-4 text-destructive","aria-hidden":"true"}),"Processos de Alto Risco"]})}),e.jsxs(we,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-3xl font-bold text-destructive",children:F.processosAltoRisco}),e.jsxs(te,{variant:"destructive",className:"text-xs",children:[F.pctProcAlto,"%"]})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Requerem ateno especial"})]})]})}),e.jsx(St,{children:e.jsx("p",{children:"Processos classificados como alto risco que necessitam ateno imediata"})})]}),e.jsxs(Lt,{children:[e.jsx(qt,{asChild:!0,children:e.jsxs(ge,{className:"rounded-2xl border-border/50 hover:shadow-md transition-shadow cursor-help",children:[e.jsx(Ae,{className:"pb-3",children:e.jsxs(Pe,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(hr,{className:"h-4 w-4 text-orange-500","aria-hidden":"true"}),"Atua nos Dois Polos"]})}),e.jsxs(we,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-3xl font-bold text-orange-600",children:F.testemunhasAmbosPolos}),e.jsxs(te,{variant:"secondary",className:"text-xs",children:[F.pctAmbos,"%"]})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Testemunhas em ambos os polos"})]})]})}),e.jsx(St,{children:e.jsx("p",{children:"Testemunhas que participaram tanto como testemunha da reclamante quanto da r"})})]})]})}),e.jsxs("div",{id:"chat-assistant-section",className:"mb-8 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Assistente de Anlise"}),e.jsxs(Ge,{className:"inline-flex items-center gap-2 py-2 px-3 w-auto border-violet-200 bg-violet-50",children:[e.jsx(Ws,{className:"h-4 w-4 text-violet-600"}),e.jsxs(Ye,{className:"text-xs text-violet-900",children:["IA Assistiva LGPD Compliant."," ",e.jsx("a",{href:"/privacidade",className:"underline font-medium hover:text-violet-700",children:"Saiba mais"})]})]})]}),e.jsx(Ec,{}),c&&e.jsx("div",{className:"mt-6",children:e.jsx(Oc,{blocks:c})}),u==="loading"&&e.jsx("div",{className:"mt-6",children:e.jsx(Fc,{})})]}),e.jsx("div",{className:"mt-8",children:e.jsxs(xr,{value:i,onValueChange:H,children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4 mb-6",children:[e.jsxs(gr,{className:"grid w-full lg:w-auto grid-cols-2",children:[e.jsxs(ls,{value:"processos",className:"flex items-center gap-2",children:[e.jsx(ca,{className:"h-4 w-4","aria-hidden":"true"}),"Por Processo"]}),e.jsxs(ls,{value:"testemunhas",className:"flex items-center gap-2",children:[e.jsx(Vt,{className:"h-4 w-4","aria-hidden":"true"}),"Por Testemunha"]})]}),e.jsxs("div",{className:"flex gap-2",children:[r&&e.jsx(ml,{userId:r.id}),e.jsx(ul,{})]})]}),e.jsxs(cs,{value:"processos",className:"space-y-6",children:[e.jsx(Da,{isLoading:d,hasError:x,errorMessage:f,isConnected:!x||l.length>3,dataCount:l.length,dataType:"processos"}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs(K,{variant:"outline",onClick:()=>G(!0),className:"w-full sm:w-auto gap-2",children:[e.jsx(da,{className:"h-4 w-4"}),"Filtros Avanados",e.jsxs("kbd",{className:"ml-auto hidden sm:inline-flex h-5 select-none items-center gap-1 rounded border bg-muted px-1.5 font-mono text-[10px] font-medium opacity-100",children:[e.jsx("span",{className:"text-xs",children:""}),"F"]})]}),le()]}),R!=="success"?e.jsx(Ut,{status:R,onRetry:ne}):e.jsx(sl,{data:l})]}),e.jsxs(cs,{value:"testemunhas",className:"space-y-6",children:[e.jsx(Da,{isLoading:d,hasError:x,errorMessage:f,isConnected:!x||m.length>3,dataCount:m.length,dataType:"testemunhas"}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs(K,{variant:"outline",onClick:()=>G(!0),className:"w-full sm:w-auto gap-2",children:[e.jsx(da,{className:"h-4 w-4"}),"Filtros Avanados",e.jsxs("kbd",{className:"ml-auto hidden sm:inline-flex h-5 select-none items-center gap-1 rounded border bg-muted px-1.5 font-mono text-[10px] font-medium opacity-100",children:[e.jsx("span",{className:"text-xs",children:""}),"F"]})]}),le()]}),ie!=="success"?e.jsx(Ut,{status:ie,onRetry:ne}):e.jsx(rl,{data:m,status:ie,onRetry:ne})]})]})}),e.jsx(Bl,{}),e.jsx(Ql,{}),e.jsx(dl,{open:P,onOpenChange:G})]})]}):null},Jc=()=>e.jsx($c,{children:e.jsx(Hc,{})}),td=Object.freeze(Object.defineProperty({__proto__:null,default:Jc},Symbol.toStringTag,{value:"Module"}));export{rt as $,Pi as A,Wt as B,Xc as C,Sr as D,Kt as E,It as F,ht as G,Fs as H,Ai as I,Yr as J,Jr as K,Wr as L,Ls as M,Kr as N,qs as O,Gr as P,Pc as Q,us as R,ct as S,Cr as T,Ut as U,ed as V,tc as W,Ko as X,dn as Y,Dr as Z,Qc as _,st as a,bt as a0,ti as a1,td as a2,dt as b,at as c,ye as d,Ys as e,Zc as f,Zr as g,en as h,sn as i,an as j,tn as k,nn as l,rn as m,Gs as n,Er as o,Rr as p,kr as q,Qs as r,Lt as s,qt as t,St as u,Si as v,Br as w,Vr as x,Ur as y,Hr as z};
