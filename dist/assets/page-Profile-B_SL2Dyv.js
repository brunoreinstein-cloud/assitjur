import{j as e,r as g,bQ as O,bR as J,bS as K,a0 as p,bq as Z,L as ee,bs as se,by as q,bT as ae,bw as re,bU as I,y as te,ad as ie,bV as oe,bW as le,G as ne,O as ce,i as F,bX as de,bY as me,bu as ue,D as L,bi as k,p as xe}from"./vendor-C39z5s1_.js";import{L as f,I as _,T as pe,a as he,b as P,c as C}from"./page-Login-CIhC_8G_.js";import{k as T,s as n,u as A,w as u,K as D,L as E,v as S,G as ge,r as fe,C as j,B as y,o as U,q as z,p as je}from"./page-About-DwBlllii.js";import{S as G,a as B,b as $,c as V,d as v,e as ve,A as Ne,f as be,g as ye,h as we,i as _e,j as Se,k as Ae,l as Ee,m as Te}from"./page-MapaPage-Bf3Cp2VY.js";import{T as Pe}from"./page-PortalTitular-5AlM2Zsd.js";function M({className:s,...a}){return e.jsx("div",{className:T("animate-shimmer rounded-md bg-muted relative overflow-hidden",s),...a})}const Q=g.forwardRef(({className:s,...a},t)=>e.jsx(O,{ref:t,className:T("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",s),...a}));Q.displayName=O.displayName;const W=g.forwardRef(({className:s,...a},t)=>e.jsx(J,{ref:t,className:T("aspect-square h-full w-full",s),...a}));W.displayName=J.displayName;const Y=g.forwardRef(({className:s,...a},t)=>e.jsx(K,{ref:t,className:T("flex h-full w-full items-center justify-center rounded-full bg-muted",s),...a}));Y.displayName=K.displayName;function Ce({currentAvatarUrl:s,userInitials:a="U",onUpload:t,isUploading:o=!1}){const[m,x]=g.useState(null),i=g.useCallback(b=>{const h=b[0];if(!h)return;if(h.size>2*1024*1024){p.error("Arquivo muito grande. Tamanho máximo: 2MB");return}if(!h.type.startsWith("image/")){p.error("Tipo de arquivo inválido. Use imagens (JPEG, PNG, WebP)");return}const w=new FileReader;w.onloadend=()=>{x(w.result)},w.readAsDataURL(h),t(h)},[t]),{getRootProps:l,getInputProps:c,isDragActive:r}=Z({onDrop:i,accept:{"image/jpeg":[".jpg",".jpeg"],"image/png":[".png"],"image/webp":[".webp"]},maxSize:2*1024*1024,multiple:!1}),N=m||s;return e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsxs(Q,{className:"h-32 w-32",children:[e.jsx(W,{src:N||void 0,alt:"Avatar"}),e.jsx(Y,{className:"text-2xl bg-primary text-primary-foreground",children:a})]}),e.jsxs("div",{...l(),className:`
          border-2 border-dashed rounded-lg p-6 text-center cursor-pointer transition-colors
          ${r?"border-primary bg-primary/5":"border-border hover:border-primary"}
          ${o?"opacity-50 pointer-events-none":""}
        `,children:[e.jsx("input",{...c()}),e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[o?e.jsx(ee,{className:"h-8 w-8 text-primary animate-spin"}):r?e.jsx(se,{className:"h-8 w-8 text-primary"}):e.jsx(q,{className:"h-8 w-8 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:o?"Fazendo upload...":r?"Solte a imagem aqui":"Clique ou arraste uma imagem"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"JPEG, PNG ou WebP (máx. 2MB)"})]})]})]})]})}function R(){const s=ae(),{data:a,isLoading:t,error:o}=re({queryKey:["profile"],queryFn:async()=>{const{data:{user:i}}=await n.auth.getUser();if(!i)throw new Error("Usuário não autenticado");const{data:l,error:c}=await n.from("profiles").select("*").eq("user_id",i.id).single();if(c)throw c;return l}}),m=I({mutationFn:async i=>{const{data:{user:l}}=await n.auth.getUser();if(!l)throw new Error("Usuário não autenticado");const{data:c,error:r}=await n.from("profiles").update(i).eq("user_id",l.id).select().single();if(r)throw r;return c},onSuccess:()=>{s.invalidateQueries({queryKey:["profile"]}),p.success("Perfil atualizado com sucesso!")},onError:i=>{p.error(`Erro ao atualizar perfil: ${i.message}`)}}),x=I({mutationFn:async i=>{const{data:{user:l}}=await n.auth.getUser();if(!l)throw new Error("Usuário não autenticado");const c=i.name.split(".").pop(),r=`${l.id}/avatar.${c}`,{error:N}=await n.storage.from("avatars").upload(r,i,{upsert:!0});if(N)throw N;const{data:{publicUrl:b}}=n.storage.from("avatars").getPublicUrl(r),{error:h}=await n.from("profiles").update({avatar_url:b}).eq("user_id",l.id);if(h)throw h;return b},onSuccess:()=>{s.invalidateQueries({queryKey:["profile"]}),p.success("Avatar atualizado com sucesso!")},onError:i=>{p.error(`Erro ao fazer upload do avatar: ${i.message}`)}});return{profile:a,isLoading:t,error:o,updateProfile:m,uploadAvatar:x}}const De=A({full_name:u().min(3,"Nome deve ter pelo menos 3 caracteres").max(100,"Nome muito longo"),email:u().email("Email inválido"),phone:u().regex(/^\(\d{2}\) \d{4,5}-\d{4}$/,"Telefone inválido (formato: (11) 98765-4321)").optional().or(E("")),job_title:u().max(100,"Cargo muito longo").optional().or(E("")),language:D(["pt-BR","en-US","es-ES"]),timezone:u().min(1,"Selecione um fuso horário")});A({language:D(["pt-BR","en-US","es-ES"]),timezone:u().min(1,"Selecione um fuso horário"),theme_preference:D(["light","dark","system"]),email_notifications:A({system_alerts:S(),weekly_reports:S(),security_alerts:S()})});const Ve=A({name:u().min(3,"Nome deve ter pelo menos 3 caracteres").max(100,"Nome muito longo"),code:u().min(2,"Código muito curto").max(20,"Código muito longo"),domain:u().url("Domínio inválido").optional().or(E("")),cnpj:u().regex(/^\d{2}\.\d{3}\.\d{3}\/\d{4}-\d{2}$/,"CNPJ inválido (formato: 12.345.678/0001-90)").optional().or(E("")),primary_color:u().regex(/^#[0-9A-Fa-f]{6}$/,"Cor primária inválida (formato: #RRGGBB)"),secondary_color:u().regex(/^#[0-9A-Fa-f]{6}$/,"Cor secundária inválida (formato: #RRGGBB)"),session_timeout_minutes:ge().min(5,"Mínimo de 5 minutos").max(480,"Máximo de 8 horas"),allow_concurrent_sessions:S()});function Ue(){const{profile:s,updateProfile:a,uploadAvatar:t}=R(),[o,m]=g.useState(!1),{register:x,handleSubmit:i,setValue:l,watch:c,formState:{errors:r,isDirty:N}}=te({resolver:fe(De),values:{full_name:s?.full_name||"",email:s?.email||"",phone:s?.phone||"",job_title:s?.job_title||"",language:s?.language||"pt-BR",timezone:s?.timezone||"America/Sao_Paulo"}}),b=c("language"),h=c("timezone"),w=async d=>{m(!0);try{await a.mutateAsync(d)}finally{m(!1)}},H=d=>{t.mutate(d)},X=()=>{if(s?.full_name){const d=s.full_name.split(" ");return d.length>=2?`${d[0][0]}${d[d.length-1][0]}`.toUpperCase():d[0][0].toUpperCase()}return"U"};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(j,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Foto de Perfil"}),e.jsx(Ce,{currentAvatarUrl:s?.avatar_url,userInitials:X(),onUpload:H,isUploading:t.isPending})]}),e.jsxs(j,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Informações Pessoais"}),e.jsxs("form",{onSubmit:i(w),className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{htmlFor:"full_name",children:"Nome Completo *"}),e.jsxs("div",{className:"relative",children:[e.jsx(q,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(_,{id:"full_name",...x("full_name"),placeholder:"João da Silva",className:"pl-10"})]}),r.full_name&&e.jsx("p",{className:"text-sm text-destructive",children:r.full_name.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{htmlFor:"email",children:"Email *"}),e.jsxs("div",{className:"relative",children:[e.jsx(ie,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(_,{id:"email",type:"email",...x("email"),placeholder:"joao@exemplo.com",className:"pl-10",disabled:!0})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Email não pode ser alterado"}),r.email&&e.jsx("p",{className:"text-sm text-destructive",children:r.email.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{htmlFor:"phone",children:"Telefone"}),e.jsxs("div",{className:"relative",children:[e.jsx(oe,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(_,{id:"phone",...x("phone"),placeholder:"(11) 98765-4321",className:"pl-10"})]}),r.phone&&e.jsx("p",{className:"text-sm text-destructive",children:r.phone.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{htmlFor:"job_title",children:"Cargo"}),e.jsxs("div",{className:"relative",children:[e.jsx(le,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(_,{id:"job_title",...x("job_title"),placeholder:"Advogado",className:"pl-10"})]}),r.job_title&&e.jsx("p",{className:"text-sm text-destructive",children:r.job_title.message})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{htmlFor:"language",children:"Idioma"}),e.jsxs("div",{className:"relative",children:[e.jsx(ne,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground z-10 pointer-events-none"}),e.jsxs(G,{value:b,onValueChange:d=>l("language",d,{shouldDirty:!0}),children:[e.jsx(B,{className:"pl-10",children:e.jsx($,{})}),e.jsxs(V,{children:[e.jsx(v,{value:"pt-BR",children:"Português (Brasil)"}),e.jsx(v,{value:"en-US",children:"English (US)"}),e.jsx(v,{value:"es-ES",children:"Español"})]})]})]}),r.language&&e.jsx("p",{className:"text-sm text-destructive",children:r.language.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{htmlFor:"timezone",children:"Fuso Horário"}),e.jsxs("div",{className:"relative",children:[e.jsx(ce,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground z-10 pointer-events-none"}),e.jsxs(G,{value:h,onValueChange:d=>l("timezone",d,{shouldDirty:!0}),children:[e.jsx(B,{className:"pl-10",children:e.jsx($,{})}),e.jsxs(V,{children:[e.jsx(v,{value:"America/Sao_Paulo",children:"São Paulo (UTC-3)"}),e.jsx(v,{value:"America/New_York",children:"Nova York (UTC-5)"}),e.jsx(v,{value:"Europe/London",children:"Londres (UTC+0)"}),e.jsx(v,{value:"Asia/Tokyo",children:"Tóquio (UTC+9)"})]})]})]}),r.timezone&&e.jsx("p",{className:"text-sm text-destructive",children:r.timezone.message})]})]}),e.jsx("div",{className:"flex justify-end gap-2 pt-4",children:e.jsx(y,{type:"submit",disabled:!N||o,isLoading:o,children:"Salvar Alterações"})})]})]})]})}function ze(){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(j,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(F,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Autenticação de Dois Fatores (2FA)"})]}),e.jsx(U,{className:"mb-4",children:e.jsx(z,{children:"Adicione uma camada extra de segurança à sua conta com autenticação de dois fatores."})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(f,{htmlFor:"2fa-toggle",children:"Ativar 2FA"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Use um aplicativo de autenticação para gerar códigos"})]}),e.jsx(ve,{id:"2fa-toggle"})]})]}),e.jsxs(j,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(de,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Senha"})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Altere sua senha regularmente para manter sua conta segura"}),e.jsx(y,{variant:"outline",children:"Alterar Senha"})]}),e.jsxs(j,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(me,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Sessões Ativas"})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Gerencie dispositivos conectados à sua conta"}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Navegador atual"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Última atividade: agora"})]}),e.jsx(y,{variant:"ghost",size:"sm",className:"text-destructive hover:text-destructive",children:"Encerrar"})]})})]})]})}async function qe(){const{data:{user:s}}=await n.auth.getUser();if(!s)throw new Error("Usuário não autenticado");const{data:a}=await n.from("profiles").select("organization_id, email").eq("user_id",s.id).single();if(!a)throw new Error("Perfil não encontrado");const{data:t,error:o}=await n.from("lgpd_requests").insert({org_id:a.organization_id,user_id:s.id,request_type:"DATA_EXPORT",requested_by_email:a.email,status:"PENDING"}).select().single();if(o)throw o;return t}async function Fe(s){const{data:{user:a}}=await n.auth.getUser();if(!a)throw new Error("Usuário não autenticado");const{data:t}=await n.from("profiles").select("organization_id, email").eq("user_id",a.id).single();if(!t)throw new Error("Perfil não encontrado");const{data:o,error:m}=await n.from("lgpd_requests").insert({org_id:t.organization_id,user_id:a.id,request_type:"ACCOUNT_DELETION",requested_by_email:t.email,justification:s,status:"PENDING"}).select().single();if(m)throw m;return o}function Re(){const{profile:s}=R(),[a,t]=g.useState(""),[o,m]=g.useState(!1),[x,i]=g.useState(!1),l=async()=>{m(!0);try{await qe(),p.success("Solicitação enviada! Você receberá seus dados por email em até 48h.")}catch{p.error("Erro ao solicitar exportação de dados")}finally{m(!1)}},c=async()=>{if(!a.trim()){p.error("Por favor, informe um motivo para a exclusão");return}i(!0);try{await Fe(a),p.success("Solicitação enviada! Sua conta será excluída em até 30 dias."),t("")}catch{p.error("Erro ao solicitar exclusão de conta")}finally{i(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(U,{children:[e.jsx(F,{className:"h-4 w-4"}),e.jsx(je,{children:"Seus Direitos de Privacidade (LGPD)"}),e.jsx(z,{children:"Você tem o direito de acessar, corrigir, deletar ou exportar seus dados pessoais a qualquer momento."})]}),e.jsxs(j,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(ue,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Termos de Uso"})]}),e.jsxs("p",{className:"text-sm text-muted-foreground mb-4",children:["Você aceitou os termos de uso em:"," ",e.jsx("strong",{children:s?.terms_accepted_at?new Date(s.terms_accepted_at).toLocaleDateString("pt-BR"):"Não aceito"})]}),e.jsx(y,{variant:"outline",size:"sm",children:"Visualizar Termos"})]}),e.jsxs(j,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(L,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Exportar Dados"})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Solicite uma cópia de todos os seus dados pessoais armazenados em nossa plataforma. Você receberá um arquivo JSON por email em até 48 horas."}),e.jsxs(y,{variant:"outline",onClick:l,isLoading:o,disabled:o,children:[e.jsx(L,{className:"mr-2 h-4 w-4"}),"Solicitar Exportação"]})]}),e.jsxs(j,{className:"p-6 border-destructive/50",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(k,{className:"h-5 w-5 text-destructive"}),e.jsx("h3",{className:"text-lg font-semibold text-destructive",children:"Excluir Conta"})]}),e.jsx(U,{variant:"destructive",className:"mb-4",children:e.jsxs(z,{children:[e.jsx("strong",{children:"Atenção:"})," Esta ação é irreversível. Todos os seus dados serão permanentemente excluídos após 30 dias."]})}),e.jsxs(Ne,{children:[e.jsx(be,{asChild:!0,children:e.jsxs(y,{variant:"destructive",children:[e.jsx(k,{className:"mr-2 h-4 w-4"}),"Solicitar Exclusão de Conta"]})}),e.jsxs(ye,{children:[e.jsxs(we,{children:[e.jsx(_e,{children:"Tem certeza?"}),e.jsx(Se,{children:"Esta ação não pode ser desfeita. Seus dados serão permanentemente excluídos após um período de 30 dias."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{htmlFor:"deletion-reason",children:"Motivo da exclusão (obrigatório)"}),e.jsx(Pe,{id:"deletion-reason",value:a,onChange:r=>t(r.target.value),placeholder:"Por favor, nos diga por que você está excluindo sua conta...",rows:4})]}),e.jsxs(Ae,{children:[e.jsx(Ee,{children:"Cancelar"}),e.jsx(Te,{onClick:c,disabled:!a.trim()||x,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:x?"Processando...":"Confirmar Exclusão"})]})]})]})]})]})}function Ie(){const{isLoading:s}=R();return s?e.jsxs("div",{className:"container mx-auto p-6 max-w-4xl space-y-6",children:[e.jsx(M,{className:"h-10 w-48"}),e.jsx(M,{className:"h-[600px] w-full"})]}):e.jsxs("div",{className:"container mx-auto p-6 max-w-4xl",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Meu Perfil"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Gerencie suas informações pessoais e preferências individuais"})]}),e.jsxs(pe,{defaultValue:"personal",className:"space-y-6",children:[e.jsxs(he,{className:"grid w-full grid-cols-3",children:[e.jsxs(P,{value:"personal",className:"gap-2",children:[e.jsx(q,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Pessoal"})]}),e.jsxs(P,{value:"security",className:"gap-2",children:[e.jsx(F,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Segurança"})]}),e.jsxs(P,{value:"privacy",className:"gap-2",children:[e.jsx(xe,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Privacidade"})]})]}),e.jsx(C,{value:"personal",children:e.jsx(Ue,{})}),e.jsx(C,{value:"security",children:e.jsx(ze,{})}),e.jsx(C,{value:"privacy",children:e.jsx(Re,{})})]})]})}const Me=Object.freeze(Object.defineProperty({__proto__:null,default:Ie},Symbol.toStringTag,{value:"Module"}));export{Q as A,Me as P,M as S,Y as a,W as b,Ve as o};
