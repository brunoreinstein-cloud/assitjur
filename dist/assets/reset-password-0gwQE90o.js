import{r,u as j,j as e}from"./vendor-B8znzfp2.js";import{s as i}from"./page-About-Cx_WpGeO.js";import"./page-Login-C96z17Ba.js";function S(){const[d,p]=r.useState(!1),[u,f]=r.useState(""),[l,N]=r.useState(""),[n,a]=r.useState(null),[c,h]=r.useState(null),[m,t]=r.useState(!1),w=j();r.useEffect(()=>{window.location.hash&&history.replaceState(null,"",window.location.pathname);const{data:{subscription:s}}=i.auth.onAuthStateChange(o=>{o==="PASSWORD_RECOVERY"?p(!0):a("Link inválido ou expirado. Solicite novamente.")});return i.auth.getSession().then(({data:{session:o}})=>{o||a("Link inválido ou expirado. Solicite novamente.")}),()=>s.unsubscribe()},[]);const x=async s=>{if(s.preventDefault(),a(null),t(!0),!u||u!==l){a("As senhas não conferem."),t(!1);return}const{data:o,error:b}=await i.auth.getUser();if(b||!o?.user){a("Link inválido ou expirado. Solicite novamente."),t(!1);return}const{error:v}=await i.auth.updateUser({password:u});if(v){a("Não foi possível redefinir a senha."),t(!1);return}await i.auth.signOut(),h("Senha atualizada com sucesso. Redirecionando para login..."),t(!1),setTimeout(()=>w("/login"),1500)};return d?e.jsxDEV("form",{onSubmit:x,className:"space-y-4 max-w-md mx-auto p-4",children:[e.jsxDEV("label",{className:"block",children:[e.jsxDEV("span",{className:"sr-only",children:"Nova senha"},void 0,!1,{fileName:"/workspaces/assitjur/src/routes/reset-password.tsx",lineNumber:73,columnNumber:9},this),e.jsxDEV("input",{type:"password",value:u,onChange:s=>f(s.target.value),required:!0,className:"border p-2 w-full",placeholder:"Nova senha"},void 0,!1,{fileName:"/workspaces/assitjur/src/routes/reset-password.tsx",lineNumber:74,columnNumber:9},this)]},void 0,!0,{fileName:"/workspaces/assitjur/src/routes/reset-password.tsx",lineNumber:72,columnNumber:7},this),e.jsxDEV("label",{className:"block",children:[e.jsxDEV("span",{className:"sr-only",children:"Confirmar senha"},void 0,!1,{fileName:"/workspaces/assitjur/src/routes/reset-password.tsx",lineNumber:84,columnNumber:9},this),e.jsxDEV("input",{type:"password",value:l,onChange:s=>N(s.target.value),required:!0,className:"border p-2 w-full",placeholder:"Confirme a senha"},void 0,!1,{fileName:"/workspaces/assitjur/src/routes/reset-password.tsx",lineNumber:85,columnNumber:9},this)]},void 0,!0,{fileName:"/workspaces/assitjur/src/routes/reset-password.tsx",lineNumber:83,columnNumber:7},this),e.jsxDEV("button",{type:"submit",disabled:m,className:`bg-primary text-white px-4 py-2 rounded ${m?"opacity-50 cursor-not-allowed":""}`,children:"Atualizar senha"},void 0,!1,{fileName:"/workspaces/assitjur/src/routes/reset-password.tsx",lineNumber:94,columnNumber:7},this),n&&e.jsxDEV("p",{className:"text-destructive text-sm",children:n},void 0,!1,{fileName:"/workspaces/assitjur/src/routes/reset-password.tsx",lineNumber:101,columnNumber:20},this),c&&e.jsxDEV("p",{className:"text-sm",children:c},void 0,!1,{fileName:"/workspaces/assitjur/src/routes/reset-password.tsx",lineNumber:102,columnNumber:17},this)]},void 0,!0,{fileName:"/workspaces/assitjur/src/routes/reset-password.tsx",lineNumber:71,columnNumber:5},this):n?e.jsxDEV("p",{className:"text-destructive text-sm text-center",children:n},void 0,!1,{fileName:"/workspaces/assitjur/src/routes/reset-password.tsx",lineNumber:67,columnNumber:7},this):null}export{S as default};
