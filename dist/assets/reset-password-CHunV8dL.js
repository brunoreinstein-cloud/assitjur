import{r,u as w,j as e}from"./vendor-D1d7OkBP.js";import{s as u}from"./page-About-DVDndw53.js";function C(){const[d,b]=r.useState(!1),[i,p]=r.useState(""),[l,f]=r.useState(""),[n,t]=r.useState(null),[m,N]=r.useState(null),[c,a]=r.useState(!1),h=w();r.useEffect(()=>{window.location.hash&&history.replaceState(null,"",window.location.pathname);const{data:{subscription:s}}=u.auth.onAuthStateChange(o=>{o==="PASSWORD_RECOVERY"?b(!0):t("Link inválido ou expirado. Solicite novamente.")});return u.auth.getSession().then(({data:{session:o}})=>{o||t("Link inválido ou expirado. Solicite novamente.")}),()=>s.unsubscribe()},[]);const v=async s=>{if(s.preventDefault(),t(null),a(!0),!i||i!==l){t("As senhas não conferem."),a(!1);return}const{data:o,error:x}=await u.auth.getUser();if(x||!o?.user){t("Link inválido ou expirado. Solicite novamente."),a(!1);return}const{error:D}=await u.auth.updateUser({password:i});if(D){t("Não foi possível redefinir a senha."),a(!1);return}await u.auth.signOut(),N("Senha atualizada com sucesso. Redirecionando para login..."),a(!1),setTimeout(()=>h("/login"),1500)};return d?e.jsxDEV("form",{onSubmit:v,className:"space-y-4 max-w-md mx-auto p-4",children:[e.jsxDEV("label",{className:"block",children:[e.jsxDEV("span",{className:"sr-only",children:"Nova senha"},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/routes/reset-password.tsx",lineNumber:73,columnNumber:9},this),e.jsxDEV("input",{type:"password",value:i,onChange:s=>p(s.target.value),required:!0,className:"border p-2 w-full",placeholder:"Nova senha"},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/routes/reset-password.tsx",lineNumber:74,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/routes/reset-password.tsx",lineNumber:72,columnNumber:7},this),e.jsxDEV("label",{className:"block",children:[e.jsxDEV("span",{className:"sr-only",children:"Confirmar senha"},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/routes/reset-password.tsx",lineNumber:84,columnNumber:9},this),e.jsxDEV("input",{type:"password",value:l,onChange:s=>f(s.target.value),required:!0,className:"border p-2 w-full",placeholder:"Confirme a senha"},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/routes/reset-password.tsx",lineNumber:85,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/routes/reset-password.tsx",lineNumber:83,columnNumber:7},this),e.jsxDEV("button",{type:"submit",disabled:c,className:`bg-primary text-white px-4 py-2 rounded ${c?"opacity-50 cursor-not-allowed":""}`,children:"Atualizar senha"},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/routes/reset-password.tsx",lineNumber:94,columnNumber:7},this),n&&e.jsxDEV("p",{className:"text-destructive text-sm",children:n},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/routes/reset-password.tsx",lineNumber:101,columnNumber:20},this),m&&e.jsxDEV("p",{className:"text-sm",children:m},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/routes/reset-password.tsx",lineNumber:102,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/routes/reset-password.tsx",lineNumber:71,columnNumber:5},this):n?e.jsxDEV("p",{className:"text-destructive text-sm text-center",children:n},void 0,!1,{fileName:"C:/Users/bruno/OneDrive/Documentos/GitHub/assitjur/src/routes/reset-password.tsx",lineNumber:67,columnNumber:7},this):null}export{C as default};
