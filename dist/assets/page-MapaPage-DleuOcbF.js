import{r as x,j as e,ah as Pt,ai as pr,aj as fr,ak as gr,al as Rs,am as At,an as Ps,ao as Dt,ap as We,aq as As,ar as Ds,as as kt,at as Ot,au as Ft,av as jr,aw as It,ax as vr,ay as $t,az as Mt,aA as Lt,aB as qt,aC as br,aD as Vt,aE as zt,aF as Bt,aG as Ut,a7 as Zs,aH as Jt,aI as Nr,aJ as Ht,aK as Kt,aL as _r,aM as yr,aN as Se,J as rs,S as wr,aO as Gt,aP as Cr,aQ as Sr,aR as Qt,aS as Tr,$ as Wt,aT as Er,aU as Zt,aV as Rr,aW as Xt,aX as Yt,aY as ea,aZ as sa,a_ as ta,a$ as Pr,b0 as Ar,b1 as Dr,b2 as kr,b3 as aa,b4 as Or,C as ns,b5 as Fr,b6 as ra,b7 as Ir,b8 as oa,b9 as $r,ba as Mr,bb as na,l as ia,bc as la,bd as ca,be as da,bf as Ze,bg as Lr,L as os,t as Ue,bh as ma,bi as ua,ae as us,bj as qr,bk as Vr,bl as Je,v as $e,bm as Vs,bn as zr,bo as Br,bp as Ur,bq as Jr,br as Xs,bs as zs,o as bs,V as Hr,x as Ys,bt as Kr,Z as Gr,ab as Ns,O as ha,bu as Me,bv as Qr,i as Oe,ac as Bs,D as xa,a0 as Os,bw as Wr,u as et,af as qe,U as hs,bx as Zr,by as _s,bz as Xr,E as Us,bA as Yr,P as Js,bB as eo,bC as so,bD as to,e as pa,bE as ut,p as ao,bF as ro,k as ht,bG as oo,bH as no,bI as fa,bJ as io,bK as lo,bL as co,ag as mo,F as uo,d as ho,bM as xo,aa as xt,bN as pt}from"./vendor-Bb7CRbSf.js";import{k as N,m as po,y as ga,z as fo,D as Pe,a as q,B as D,o as De,q as ke,s as Fe,C as ne,b as Ne,c as _e,n as es,d as de,_ as go,u as is,E as Re,w as Ee,Z as ys,F as jo,G as Fs,H as vo,I as bo,J as No,A as _o,f as ft,g as gt,h as jt}from"./page-About-D-sXwJf6.js";import{L as be,I as Ke,T as ja,a as va,b as ws,c as Cs,w as ba,l as we,u as yo}from"./page-Login-oCSbJqZb.js";import{P as Na,a as _a,b as ya,T as wa,c as Ca,d as Ss,e as ge,f as Sa,g as je}from"./page-DemoMapaTestemunhas-JiJ-wnCn.js";const Ta=pr,ds=fr,ms=gr,ts=x.forwardRef(({className:s,sideOffset:t=4,...a},r)=>e.jsx(Pt,{ref:r,sideOffset:t,className:N("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...a}));ts.displayName=Pt.displayName;const Ea=kt,ki=Ot,wo=At,Ra=x.forwardRef(({className:s,...t},a)=>e.jsx(Rs,{ref:a,className:N("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...t}));Ra.displayName=Rs.displayName;const st=x.forwardRef(({className:s,children:t,...a},r)=>e.jsxs(wo,{children:[e.jsx(Ra,{}),e.jsxs(Ps,{ref:r,className:N("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...a,children:[t,e.jsxs(Dt,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(We,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));st.displayName=Ps.displayName;const Pa=({className:s,...t})=>e.jsx("div",{className:N("flex flex-col space-y-1.5 text-center sm:text-left",s),...t});Pa.displayName="DialogHeader";const Co=({className:s,...t})=>e.jsx("div",{className:N("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t});Co.displayName="DialogFooter";const Aa=x.forwardRef(({className:s,...t},a)=>e.jsx(As,{ref:a,className:N("text-lg font-semibold leading-none tracking-tight",s),...t}));Aa.displayName=As.displayName;const Da=x.forwardRef(({className:s,...t},a)=>e.jsx(Ds,{ref:a,className:N("text-sm text-muted-foreground",s),...t}));Da.displayName=Ds.displayName;const tt=x.forwardRef(({className:s,...t},a)=>e.jsx(Ft,{className:N("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",s),...t,ref:a,children:e.jsx(jr,{className:N("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));tt.displayName=Ft.displayName;const Ts=x.forwardRef(({className:s,value:t,...a},r)=>e.jsx(It,{ref:r,className:N("relative h-2 w-full overflow-hidden rounded-full bg-secondary",s),...a,children:e.jsx(vr,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));Ts.displayName=It.displayName;const He=x.forwardRef(({className:s,orientation:t="horizontal",decorative:a=!0,...r},o)=>e.jsx($t,{ref:o,decorative:a,orientation:t,className:N("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",s),...r}));He.displayName=$t.displayName;const ka=kt,So=Ot,To=At,Oa=x.forwardRef(({className:s,...t},a)=>e.jsx(Rs,{className:N("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...t,ref:a}));Oa.displayName=Rs.displayName;const Eo=po("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),at=x.forwardRef(({side:s="right",className:t,children:a,...r},o)=>e.jsxs(To,{children:[e.jsx(Oa,{}),e.jsxs(Ps,{ref:o,className:N(Eo({side:s}),t),...r,children:[a,e.jsxs(Dt,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[e.jsx(We,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));at.displayName=Ps.displayName;const rt=({className:s,...t})=>e.jsx("div",{className:N("flex flex-col space-y-2 text-center sm:text-left",s),...t});rt.displayName="SheetHeader";const ot=x.forwardRef(({className:s,...t},a)=>e.jsx(As,{ref:a,className:N("text-lg font-semibold text-foreground",s),...t}));ot.displayName=As.displayName;const nt=x.forwardRef(({className:s,...t},a)=>e.jsx(Ds,{ref:a,className:N("text-sm text-muted-foreground",s),...t}));nt.displayName=Ds.displayName;const ps=_r,fs=yr,Ro=x.forwardRef(({className:s,inset:t,children:a,...r},o)=>e.jsxs(Mt,{ref:o,className:N("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",t&&"pl-8",s),...r,children:[a,e.jsx(Lt,{className:"ml-auto h-4 w-4"})]}));Ro.displayName=Mt.displayName;const Po=x.forwardRef(({className:s,...t},a)=>e.jsx(qt,{ref:a,className:N("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...t}));Po.displayName=qt.displayName;const ls=x.forwardRef(({className:s,sideOffset:t=4,...a},r)=>e.jsx(br,{children:e.jsx(Vt,{ref:r,sideOffset:t,className:N("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...a})}));ls.displayName=Vt.displayName;const Xe=x.forwardRef(({className:s,inset:t,...a},r)=>e.jsx(zt,{ref:r,className:N("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t&&"pl-8",s),...a}));Xe.displayName=zt.displayName;const Fa=x.forwardRef(({className:s,children:t,checked:a,...r},o)=>e.jsxs(Bt,{ref:o,className:N("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),checked:a,...r,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Ut,{children:e.jsx(Zs,{className:"h-4 w-4"})})}),t]}));Fa.displayName=Bt.displayName;const Ao=x.forwardRef(({className:s,children:t,...a},r)=>e.jsxs(Jt,{ref:r,className:N("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...a,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Ut,{children:e.jsx(Nr,{className:"h-2 w-2 fill-current"})})}),t]}));Ao.displayName=Jt.displayName;const Do=x.forwardRef(({className:s,inset:t,...a},r)=>e.jsx(Ht,{ref:r,className:N("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",s),...a}));Do.displayName=Ht.displayName;const Hs=x.forwardRef(({className:s,...t},a)=>e.jsx(Kt,{ref:a,className:N("-mx-1 my-1 h-px bg-muted",s),...t}));Hs.displayName=Kt.displayName;const it=x.forwardRef(({className:s,...t},a)=>e.jsx(Se,{ref:a,className:N("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",s),...t}));it.displayName=Se.displayName;const Oi=({children:s,...t})=>e.jsx(Ea,{...t,children:e.jsx(st,{className:"overflow-hidden p-0 shadow-lg",children:e.jsx(it,{className:"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5",children:s})})}),ko=x.forwardRef(({className:s,...t},a)=>e.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[e.jsx(rs,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),e.jsx(Se.Input,{ref:a,className:N("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",s),...t})]}));ko.displayName=Se.Input.displayName;const Ia=x.forwardRef(({className:s,...t},a)=>e.jsx(Se.List,{ref:a,className:N("max-h-[300px] overflow-y-auto overflow-x-hidden",s),...t}));Ia.displayName=Se.List.displayName;const $a=x.forwardRef((s,t)=>e.jsx(Se.Empty,{ref:t,className:"py-6 text-center text-sm",...s}));$a.displayName=Se.Empty.displayName;const Ma=x.forwardRef(({className:s,...t},a)=>e.jsx(Se.Group,{ref:a,className:N("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",s),...t}));Ma.displayName=Se.Group.displayName;const Oo=x.forwardRef(({className:s,...t},a)=>e.jsx(Se.Separator,{ref:a,className:N("-mx-1 h-px bg-border",s),...t}));Oo.displayName=Se.Separator.displayName;const La=x.forwardRef(({className:s,...t},a)=>e.jsx(Se.Item,{ref:a,className:N("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50",s),...t}));La.displayName=Se.Item.displayName;const qa=x.forwardRef(({...s},t)=>e.jsx("nav",{ref:t,"aria-label":"breadcrumb",...s}));qa.displayName="Breadcrumb";const Va=x.forwardRef(({className:s,...t},a)=>e.jsx("ol",{ref:a,className:N("flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5",s),...t}));Va.displayName="BreadcrumbList";const Ks=x.forwardRef(({className:s,...t},a)=>e.jsx("li",{ref:a,className:N("inline-flex items-center gap-1.5",s),...t}));Ks.displayName="BreadcrumbItem";const Gs=x.forwardRef(({asChild:s,className:t,...a},r)=>{const o=s?wr:"a";return e.jsx(o,{ref:r,className:N("transition-colors hover:text-foreground",t),...a})});Gs.displayName="BreadcrumbLink";const za=x.forwardRef(({className:s,...t},a)=>e.jsx("span",{ref:a,role:"link","aria-disabled":"true","aria-current":"page",className:N("font-normal text-foreground",s),...t}));za.displayName="BreadcrumbPage";const Ba=({children:s,className:t,...a})=>e.jsx("li",{role:"presentation","aria-hidden":"true",className:N("[&>svg]:size-3.5",t),...a,children:s??e.jsx(Lt,{})});Ba.displayName="BreadcrumbSeparator";const Ua=x.forwardRef(({className:s,children:t,...a},r)=>e.jsxs(Gt,{ref:r,className:N("relative overflow-hidden",s),...a,children:[e.jsx(Cr,{className:"h-full w-full rounded-[inherit] min-h-0",children:t}),e.jsx(Ja,{}),e.jsx(Sr,{})]}));Ua.displayName=Gt.displayName;const Ja=x.forwardRef(({className:s,orientation:t="vertical",...a},r)=>e.jsx(Qt,{ref:r,orientation:t,className:N("flex touch-none select-none transition-colors",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",s),...a,children:e.jsx(Tr,{className:"relative flex-1 rounded-full bg-border"})}));Ja.displayName=Qt.displayName;const Fo=Wt()(Er((s,t)=>({notifications:[],unreadCount:0,addNotification:a=>{const r=`notification-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,o={...a,id:r,createdAt:new Date,read:!1,duration:a.duration??5e3};return s(n=>({notifications:[o,...n.notifications],unreadCount:n.unreadCount+1})),o.duration&&setTimeout(()=>{t().removeNotification(r)},o.duration),r},removeNotification:a=>{s(r=>{const o=r.notifications.find(i=>i.id===a),n=o&&!o.read;return{notifications:r.notifications.filter(i=>i.id!==a),unreadCount:n?r.unreadCount-1:r.unreadCount}})},markAsRead:a=>{s(r=>{const o=r.notifications.map(i=>i.id===a?{...i,read:!0}:i),n=o.filter(i=>!i.read).length;return{notifications:o,unreadCount:n}})},markAllAsRead:()=>{s(a=>({notifications:a.notifications.map(r=>({...r,read:!0})),unreadCount:0}))},clearAll:()=>{s({notifications:[],unreadCount:0})},clearRead:()=>{s(a=>({notifications:a.notifications.filter(r=>!r.read),unreadCount:a.unreadCount}))}}),{name:"assistjur-notifications",partialize:s=>({notifications:s.notifications.slice(0,50)})})),Io=()=>{const{addNotification:s,...t}=Fo();return{...t,success:(a,r,o)=>s({type:"success",title:a,message:r,...o}),error:(a,r,o)=>s({type:"error",title:a,message:r,duration:void 0,...o}),warning:(a,r,o)=>s({type:"warning",title:a,message:r,...o}),info:(a,r,o)=>s({type:"info",title:a,message:r,...o}),addNotification:s}},$o=Pr,Fi=Ar,Mo=Rr,Ha=x.forwardRef(({className:s,...t},a)=>e.jsx(Zt,{className:N("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...t,ref:a}));Ha.displayName=Zt.displayName;const Ka=x.forwardRef(({className:s,...t},a)=>e.jsxs(Mo,{children:[e.jsx(Ha,{}),e.jsx(Xt,{ref:a,className:N("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...t})]}));Ka.displayName=Xt.displayName;const Ga=({className:s,...t})=>e.jsx("div",{className:N("flex flex-col space-y-2 text-center sm:text-left",s),...t});Ga.displayName="AlertDialogHeader";const Qa=({className:s,...t})=>e.jsx("div",{className:N("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t});Qa.displayName="AlertDialogFooter";const Wa=x.forwardRef(({className:s,...t},a)=>e.jsx(Yt,{ref:a,className:N("text-lg font-semibold",s),...t}));Wa.displayName=Yt.displayName;const Za=x.forwardRef(({className:s,...t},a)=>e.jsx(ea,{ref:a,className:N("text-sm text-muted-foreground",s),...t}));Za.displayName=ea.displayName;const Xa=x.forwardRef(({className:s,...t},a)=>e.jsx(sa,{ref:a,className:N(ga(),s),...t}));Xa.displayName=sa.displayName;const Ya=x.forwardRef(({className:s,...t},a)=>e.jsx(ta,{ref:a,className:N(ga({variant:"outline"}),"mt-2 sm:mt-0",s),...t}));Ya.displayName=ta.displayName;const Ge=Dr,Qe=kr,Ve=x.forwardRef(({className:s,children:t,...a},r)=>e.jsxs(aa,{ref:r,className:N("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...a,children:[t,e.jsx(Or,{asChild:!0,children:e.jsx(ns,{className:"h-4 w-4 opacity-50"})})]}));Ve.displayName=aa.displayName;const er=x.forwardRef(({className:s,...t},a)=>e.jsx(na,{ref:a,className:N("flex cursor-default items-center justify-center py-1",s),...t,children:e.jsx(ia,{className:"h-4 w-4"})}));er.displayName=na.displayName;const sr=x.forwardRef(({className:s,...t},a)=>e.jsx(la,{ref:a,className:N("flex cursor-default items-center justify-center py-1",s),...t,children:e.jsx(ns,{className:"h-4 w-4"})}));sr.displayName=la.displayName;const ze=x.forwardRef(({className:s,children:t,position:a="popper",...r},o)=>e.jsx(Fr,{children:e.jsxs(ra,{ref:o,className:N("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:a,...r,children:[e.jsx(er,{}),e.jsx(Ir,{className:N("p-1",a==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),e.jsx(sr,{})]})}));ze.displayName=ra.displayName;const Lo=x.forwardRef(({className:s,...t},a)=>e.jsx(ca,{ref:a,className:N("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...t}));Lo.displayName=ca.displayName;const pe=x.forwardRef(({className:s,children:t,...a},r)=>e.jsxs(oa,{ref:r,className:N("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...a,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx($r,{children:e.jsx(Zs,{className:"h-4 w-4"})})}),e.jsx(Mr,{children:t})]}));pe.displayName=oa.displayName;const qo=x.forwardRef(({className:s,...t},a)=>e.jsx(da,{ref:a,className:N("-mx-1 my-1 h-px bg-muted",s),...t}));qo.displayName=da.displayName;var js={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/var Vo=js.exports,vt;function zo(){return vt||(vt=1,(function(s,t){((a,r)=>{s.exports=r()})(Vo,function a(){var r=typeof self<"u"?self:typeof window<"u"?window:r!==void 0?r:{},o,n=!r.document&&!!r.postMessage,i=r.IS_PAPA_WORKER||!1,d={},u=0,m={};function v(l){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(c){var h=ee(c);h.chunkSize=parseInt(h.chunkSize),c.step||c.chunk||(h.chunkSize=null),this._handle=new p(h),(this._handle.streamer=this)._config=h}.call(this,l),this.parseChunk=function(c,h){var _=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<_){let z=this._config.newline;z||(C=this._config.quoteChar||'"',z=this._handle.guessLineEndings(c,C)),c=[...c.split(z).slice(_)].join(z)}this.isFirstChunk&&H(this._config.beforeFirstChunk)&&(C=this._config.beforeFirstChunk(c))!==void 0&&(c=C),this.isFirstChunk=!1,this._halted=!1;var _=this._partialLine+c,C=(this._partialLine="",this._handle.parse(_,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(c=C.meta.cursor,_=(this._finished||(this._partialLine=_.substring(c-this._baseIndex),this._baseIndex=c),C&&C.data&&(this._rowCount+=C.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),i)r.postMessage({results:C,workerId:m.WORKER_ID,finished:_});else if(H(this._config.chunk)&&!h){if(this._config.chunk(C,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=C=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(C.data),this._completeResults.errors=this._completeResults.errors.concat(C.errors),this._completeResults.meta=C.meta),this._completed||!_||!H(this._config.complete)||C&&C.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),_||C&&C.meta.paused||this._nextChunk(),C}this._halted=!0},this._sendError=function(c){H(this._config.error)?this._config.error(c):i&&this._config.error&&r.postMessage({workerId:m.WORKER_ID,error:c,finished:!1})}}function g(l){var c;(l=l||{}).chunkSize||(l.chunkSize=m.RemoteChunkSize),v.call(this,l),this._nextChunk=n?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(h){this._input=h,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(c=new XMLHttpRequest,this._config.withCredentials&&(c.withCredentials=this._config.withCredentials),n||(c.onload=W(this._chunkLoaded,this),c.onerror=W(this._chunkError,this)),c.open(this._config.downloadRequestBody?"POST":"GET",this._input,!n),this._config.downloadRequestHeaders){var h,_=this._config.downloadRequestHeaders;for(h in _)c.setRequestHeader(h,_[h])}var C;this._config.chunkSize&&(C=this._start+this._config.chunkSize-1,c.setRequestHeader("Range","bytes="+this._start+"-"+C));try{c.send(this._config.downloadRequestBody)}catch(z){this._chunkError(z.message)}n&&c.status===0&&this._chunkError()}},this._chunkLoaded=function(){c.readyState===4&&(c.status<200||400<=c.status?this._chunkError():(this._start+=this._config.chunkSize||c.responseText.length,this._finished=!this._config.chunkSize||this._start>=(h=>(h=h.getResponseHeader("Content-Range"))!==null?parseInt(h.substring(h.lastIndexOf("/")+1)):-1)(c),this.parseChunk(c.responseText)))},this._chunkError=function(h){h=c.statusText||h,this._sendError(new Error(h))}}function y(l){(l=l||{}).chunkSize||(l.chunkSize=m.LocalChunkSize),v.call(this,l);var c,h,_=typeof FileReader<"u";this.stream=function(C){this._input=C,h=C.slice||C.webkitSlice||C.mozSlice,_?((c=new FileReader).onload=W(this._chunkLoaded,this),c.onerror=W(this._chunkError,this)):c=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var C=this._input,z=(this._config.chunkSize&&(z=Math.min(this._start+this._config.chunkSize,this._input.size),C=h.call(C,this._start,z)),c.readAsText(C,this._config.encoding));_||this._chunkLoaded({target:{result:z}})},this._chunkLoaded=function(C){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(C.target.result)},this._chunkError=function(){this._sendError(c.error)}}function S(l){var c;v.call(this,l=l||{}),this.stream=function(h){return c=h,this._nextChunk()},this._nextChunk=function(){var h,_;if(!this._finished)return h=this._config.chunkSize,c=h?(_=c.substring(0,h),c.substring(h)):(_=c,""),this._finished=!c,this.parseChunk(_)}}function X(l){v.call(this,l=l||{});var c=[],h=!0,_=!1;this.pause=function(){v.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){v.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(C){this._input=C,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){_&&c.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),c.length?this.parseChunk(c.shift()):h=!0},this._streamData=W(function(C){try{c.push(typeof C=="string"?C:C.toString(this._config.encoding)),h&&(h=!1,this._checkIsFinished(),this.parseChunk(c.shift()))}catch(z){this._streamError(z)}},this),this._streamError=W(function(C){this._streamCleanUp(),this._sendError(C)},this),this._streamEnd=W(function(){this._streamCleanUp(),_=!0,this._streamData("")},this),this._streamCleanUp=W(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function p(l){var c,h,_,C,z=Math.pow(2,53),re=-z,ue=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,fe=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,L=this,se=0,k=0,ie=!1,I=!1,M=[],b={data:[],errors:[],meta:{}};function R(O){return l.skipEmptyLines==="greedy"?O.join("").trim()==="":O.length===1&&O[0].length===0}function j(){if(b&&_&&(U("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+m.DefaultDelimiter+"'"),_=!1),l.skipEmptyLines&&(b.data=b.data.filter(function(F){return!R(F)})),E()){let F=function(te,oe){H(l.transformHeader)&&(te=l.transformHeader(te,oe)),M.push(te)};if(b)if(Array.isArray(b.data[0])){for(var O=0;E()&&O<b.data.length;O++)b.data[O].forEach(F);b.data.splice(0,1)}else b.data.forEach(F)}function w(F,te){for(var oe=l.header?{}:[],K=0;K<F.length;K++){var Z=K,f=F[K],f=((B,P)=>(V=>(l.dynamicTypingFunction&&l.dynamicTyping[V]===void 0&&(l.dynamicTyping[V]=l.dynamicTypingFunction(V)),(l.dynamicTyping[V]||l.dynamicTyping)===!0))(B)?P==="true"||P==="TRUE"||P!=="false"&&P!=="FALSE"&&((V=>{if(ue.test(V)&&(V=parseFloat(V),re<V&&V<z))return 1})(P)?parseFloat(P):fe.test(P)?new Date(P):P===""?null:P):P)(Z=l.header?K>=M.length?"__parsed_extra":M[K]:Z,f=l.transform?l.transform(f,Z):f);Z==="__parsed_extra"?(oe[Z]=oe[Z]||[],oe[Z].push(f)):oe[Z]=f}return l.header&&(K>M.length?U("FieldMismatch","TooManyFields","Too many fields: expected "+M.length+" fields but parsed "+K,k+te):K<M.length&&U("FieldMismatch","TooFewFields","Too few fields: expected "+M.length+" fields but parsed "+K,k+te)),oe}var Y;b&&(l.header||l.dynamicTyping||l.transform)&&(Y=1,!b.data.length||Array.isArray(b.data[0])?(b.data=b.data.map(w),Y=b.data.length):b.data=w(b.data,0),l.header&&b.meta&&(b.meta.fields=M),k+=Y)}function E(){return l.header&&M.length===0}function U(O,w,Y,F){O={type:O,code:w,message:Y},F!==void 0&&(O.row=F),b.errors.push(O)}H(l.step)&&(C=l.step,l.step=function(O){b=O,E()?j():(j(),b.data.length!==0&&(se+=O.data.length,l.preview&&se>l.preview?h.abort():(b.data=b.data[0],C(b,L))))}),this.parse=function(O,w,Y){var F=l.quoteChar||'"',F=(l.newline||(l.newline=this.guessLineEndings(O,F)),_=!1,l.delimiter?H(l.delimiter)&&(l.delimiter=l.delimiter(O),b.meta.delimiter=l.delimiter):((F=((te,oe,K,Z,f)=>{var B,P,V,J;f=f||[",","	","|",";",m.RECORD_SEP,m.UNIT_SEP];for(var he=0;he<f.length;he++){for(var xe,ve=f[he],le=0,ye=0,ce=0,Ce=(V=void 0,new ae({comments:Z,delimiter:ve,newline:oe,preview:10}).parse(te)),Le=0;Le<Ce.data.length;Le++)K&&R(Ce.data[Le])?ce++:(xe=Ce.data[Le].length,ye+=xe,V===void 0?V=xe:0<xe&&(le+=Math.abs(xe-V),V=xe));0<Ce.data.length&&(ye/=Ce.data.length-ce),(P===void 0||le<=P)&&(J===void 0||J<ye)&&1.99<ye&&(P=le,B=ve,J=ye)}return{successful:!!(l.delimiter=B),bestDelimiter:B}})(O,l.newline,l.skipEmptyLines,l.comments,l.delimitersToGuess)).successful?l.delimiter=F.bestDelimiter:(_=!0,l.delimiter=m.DefaultDelimiter),b.meta.delimiter=l.delimiter),ee(l));return l.preview&&l.header&&F.preview++,c=O,h=new ae(F),b=h.parse(c,w,Y),j(),ie?{meta:{paused:!0}}:b||{meta:{paused:!1}}},this.paused=function(){return ie},this.pause=function(){ie=!0,h.abort(),c=H(l.chunk)?"":c.substring(h.getCharIndex())},this.resume=function(){L.streamer._halted?(ie=!1,L.streamer.parseChunk(c,!0)):setTimeout(L.resume,3)},this.aborted=function(){return I},this.abort=function(){I=!0,h.abort(),b.meta.aborted=!0,H(l.complete)&&l.complete(b),c=""},this.guessLineEndings=function(te,F){te=te.substring(0,1048576);var F=new RegExp(G(F)+"([^]*?)"+G(F),"gm"),Y=(te=te.replace(F,"")).split("\r"),F=te.split(`
`),te=1<F.length&&F[0].length<Y[0].length;if(Y.length===1||te)return`
`;for(var oe=0,K=0;K<Y.length;K++)Y[K][0]===`
`&&oe++;return oe>=Y.length/2?`\r
`:"\r"}}function G(l){return l.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function ae(l){var c=(l=l||{}).delimiter,h=l.newline,_=l.comments,C=l.step,z=l.preview,re=l.fastMode,ue=null,fe=!1,L=l.quoteChar==null?'"':l.quoteChar,se=L;if(l.escapeChar!==void 0&&(se=l.escapeChar),(typeof c!="string"||-1<m.BAD_DELIMITERS.indexOf(c))&&(c=","),_===c)throw new Error("Comment character same as delimiter");_===!0?_="#":(typeof _!="string"||-1<m.BAD_DELIMITERS.indexOf(_))&&(_=!1),h!==`
`&&h!=="\r"&&h!==`\r
`&&(h=`
`);var k=0,ie=!1;this.parse=function(I,M,b){if(typeof I!="string")throw new Error("Input must be a string");var R=I.length,j=c.length,E=h.length,U=_.length,O=H(C),w=[],Y=[],F=[],te=k=0;if(!I)return le();if(re||re!==!1&&I.indexOf(L)===-1){for(var oe=I.split(h),K=0;K<oe.length;K++){if(F=oe[K],k+=F.length,K!==oe.length-1)k+=h.length;else if(b)return le();if(!_||F.substring(0,U)!==_){if(O){if(w=[],J(F.split(c)),ye(),ie)return le()}else J(F.split(c));if(z&&z<=K)return w=w.slice(0,z),le(!0)}}return le()}for(var Z=I.indexOf(c,k),f=I.indexOf(h,k),B=new RegExp(G(se)+G(L),"g"),P=I.indexOf(L,k);;)if(I[k]===L)for(P=k,k++;;){if((P=I.indexOf(L,P+1))===-1)return b||Y.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:w.length,index:k}),xe();if(P===R-1)return xe(I.substring(k,P).replace(B,L));if(L===se&&I[P+1]===se)P++;else if(L===se||P===0||I[P-1]!==se){Z!==-1&&Z<P+1&&(Z=I.indexOf(c,P+1));var V=he((f=f!==-1&&f<P+1?I.indexOf(h,P+1):f)===-1?Z:Math.min(Z,f));if(I.substr(P+1+V,j)===c){F.push(I.substring(k,P).replace(B,L)),I[k=P+1+V+j]!==L&&(P=I.indexOf(L,k)),Z=I.indexOf(c,k),f=I.indexOf(h,k);break}if(V=he(f),I.substring(P+1+V,P+1+V+E)===h){if(F.push(I.substring(k,P).replace(B,L)),ve(P+1+V+E),Z=I.indexOf(c,k),P=I.indexOf(L,k),O&&(ye(),ie))return le();if(z&&w.length>=z)return le(!0);break}Y.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:w.length,index:k}),P++}}else if(_&&F.length===0&&I.substring(k,k+U)===_){if(f===-1)return le();k=f+E,f=I.indexOf(h,k),Z=I.indexOf(c,k)}else if(Z!==-1&&(Z<f||f===-1))F.push(I.substring(k,Z)),k=Z+j,Z=I.indexOf(c,k);else{if(f===-1)break;if(F.push(I.substring(k,f)),ve(f+E),O&&(ye(),ie))return le();if(z&&w.length>=z)return le(!0)}return xe();function J(ce){w.push(ce),te=k}function he(ce){var Ce=0;return Ce=ce!==-1&&(ce=I.substring(P+1,ce))&&ce.trim()===""?ce.length:Ce}function xe(ce){return b||(ce===void 0&&(ce=I.substring(k)),F.push(ce),k=R,J(F),O&&ye()),le()}function ve(ce){k=ce,J(F),F=[],f=I.indexOf(h,k)}function le(ce){if(l.header&&!M&&w.length&&!fe){var Ce=w[0],Le=Object.create(null),ks=new Set(Ce);let dt=!1;for(let ss=0;ss<Ce.length;ss++){let Ie=Ce[ss];if(Le[Ie=H(l.transformHeader)?l.transformHeader(Ie,ss):Ie]){let cs,mt=Le[Ie];for(;cs=Ie+"_"+mt,mt++,ks.has(cs););ks.add(cs),Ce[ss]=cs,Le[Ie]++,dt=!0,(ue=ue===null?{}:ue)[cs]=Ie}else Le[Ie]=1,Ce[ss]=Ie;ks.add(Ie)}dt&&console.warn("Duplicate headers found and renamed."),fe=!0}return{data:w,errors:Y,meta:{delimiter:c,linebreak:h,aborted:ie,truncated:!!ce,cursor:te+(M||0),renamedHeaders:ue}}}function ye(){C(le()),w=[],Y=[]}},this.abort=function(){ie=!0},this.getCharIndex=function(){return k}}function T(l){var c=l.data,h=d[c.workerId],_=!1;if(c.error)h.userError(c.error,c.file);else if(c.results&&c.results.data){var C={abort:function(){_=!0,Q(c.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:me,resume:me};if(H(h.userStep)){for(var z=0;z<c.results.data.length&&(h.userStep({data:c.results.data[z],errors:c.results.errors,meta:c.results.meta},C),!_);z++);delete c.results}else H(h.userChunk)&&(h.userChunk(c.results,C,c.file),delete c.results)}c.finished&&!_&&Q(c.workerId,c.results)}function Q(l,c){var h=d[l];H(h.userComplete)&&h.userComplete(c),h.terminate(),delete d[l]}function me(){throw new Error("Not implemented.")}function ee(l){if(typeof l!="object"||l===null)return l;var c,h=Array.isArray(l)?[]:{};for(c in l)h[c]=ee(l[c]);return h}function W(l,c){return function(){l.apply(c,arguments)}}function H(l){return typeof l=="function"}return m.parse=function(l,c){var h=(c=c||{}).dynamicTyping||!1;if(H(h)&&(c.dynamicTypingFunction=h,h={}),c.dynamicTyping=h,c.transform=!!H(c.transform)&&c.transform,!c.worker||!m.WORKERS_SUPPORTED)return h=null,m.NODE_STREAM_INPUT,typeof l=="string"?(l=(_=>_.charCodeAt(0)!==65279?_:_.slice(1))(l),h=new(c.download?g:S)(c)):l.readable===!0&&H(l.read)&&H(l.on)?h=new X(c):(r.File&&l instanceof File||l instanceof Object)&&(h=new y(c)),h.stream(l);(h=(()=>{var _;return!!m.WORKERS_SUPPORTED&&(_=(()=>{var C=r.URL||r.webkitURL||null,z=a.toString();return m.BLOB_URL||(m.BLOB_URL=C.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",z,")();"],{type:"text/javascript"})))})(),(_=new r.Worker(_)).onmessage=T,_.id=u++,d[_.id]=_)})()).userStep=c.step,h.userChunk=c.chunk,h.userComplete=c.complete,h.userError=c.error,c.step=H(c.step),c.chunk=H(c.chunk),c.complete=H(c.complete),c.error=H(c.error),delete c.worker,h.postMessage({input:l,config:c,workerId:h.id})},m.unparse=function(l,c){var h=!1,_=!0,C=",",z=`\r
`,re='"',ue=re+re,fe=!1,L=null,se=!1,k=((()=>{if(typeof c=="object"){if(typeof c.delimiter!="string"||m.BAD_DELIMITERS.filter(function(M){return c.delimiter.indexOf(M)!==-1}).length||(C=c.delimiter),typeof c.quotes!="boolean"&&typeof c.quotes!="function"&&!Array.isArray(c.quotes)||(h=c.quotes),typeof c.skipEmptyLines!="boolean"&&typeof c.skipEmptyLines!="string"||(fe=c.skipEmptyLines),typeof c.newline=="string"&&(z=c.newline),typeof c.quoteChar=="string"&&(re=c.quoteChar),typeof c.header=="boolean"&&(_=c.header),Array.isArray(c.columns)){if(c.columns.length===0)throw new Error("Option columns is empty");L=c.columns}c.escapeChar!==void 0&&(ue=c.escapeChar+re),c.escapeFormulae instanceof RegExp?se=c.escapeFormulae:typeof c.escapeFormulae=="boolean"&&c.escapeFormulae&&(se=/^[=+\-@\t\r].*$/)}})(),new RegExp(G(re),"g"));if(typeof l=="string"&&(l=JSON.parse(l)),Array.isArray(l)){if(!l.length||Array.isArray(l[0]))return ie(null,l,fe);if(typeof l[0]=="object")return ie(L||Object.keys(l[0]),l,fe)}else if(typeof l=="object")return typeof l.data=="string"&&(l.data=JSON.parse(l.data)),Array.isArray(l.data)&&(l.fields||(l.fields=l.meta&&l.meta.fields||L),l.fields||(l.fields=Array.isArray(l.data[0])?l.fields:typeof l.data[0]=="object"?Object.keys(l.data[0]):[]),Array.isArray(l.data[0])||typeof l.data[0]=="object"||(l.data=[l.data])),ie(l.fields||[],l.data||[],fe);throw new Error("Unable to serialize unrecognized input");function ie(M,b,R){var j="",E=(typeof M=="string"&&(M=JSON.parse(M)),typeof b=="string"&&(b=JSON.parse(b)),Array.isArray(M)&&0<M.length),U=!Array.isArray(b[0]);if(E&&_){for(var O=0;O<M.length;O++)0<O&&(j+=C),j+=I(M[O],O);0<b.length&&(j+=z)}for(var w=0;w<b.length;w++){var Y=(E?M:b[w]).length,F=!1,te=E?Object.keys(b[w]).length===0:b[w].length===0;if(R&&!E&&(F=R==="greedy"?b[w].join("").trim()==="":b[w].length===1&&b[w][0].length===0),R==="greedy"&&E){for(var oe=[],K=0;K<Y;K++){var Z=U?M[K]:K;oe.push(b[w][Z])}F=oe.join("").trim()===""}if(!F){for(var f=0;f<Y;f++){0<f&&!te&&(j+=C);var B=E&&U?M[f]:f;j+=I(b[w][B],f)}w<b.length-1&&(!R||0<Y&&!te)&&(j+=z)}}return j}function I(M,b){var R,j;return M==null?"":M.constructor===Date?JSON.stringify(M).slice(1,25):(j=!1,se&&typeof M=="string"&&se.test(M)&&(M="'"+M,j=!0),R=M.toString().replace(k,ue),(j=j||h===!0||typeof h=="function"&&h(M,b)||Array.isArray(h)&&h[b]||((E,U)=>{for(var O=0;O<U.length;O++)if(-1<E.indexOf(U[O]))return!0;return!1})(R,m.BAD_DELIMITERS)||-1<R.indexOf(C)||R.charAt(0)===" "||R.charAt(R.length-1)===" ")?re+R+re:R)}},m.RECORD_SEP="",m.UNIT_SEP="",m.BYTE_ORDER_MARK="\uFEFF",m.BAD_DELIMITERS=["\r",`
`,'"',m.BYTE_ORDER_MARK],m.WORKERS_SUPPORTED=!n&&!!r.Worker,m.NODE_STREAM_INPUT=1,m.LocalChunkSize=10485760,m.RemoteChunkSize=5242880,m.DefaultDelimiter=",",m.Parser=ae,m.ParserHandle=p,m.NetworkStreamer=g,m.FileStreamer=y,m.StringStreamer=S,m.ReadableStreamStreamer=X,r.jQuery&&((o=r.jQuery).fn.parse=function(l){var c=l.config||{},h=[];return this.each(function(z){if(!(o(this).prop("tagName").toUpperCase()==="INPUT"&&o(this).attr("type").toLowerCase()==="file"&&r.FileReader)||!this.files||this.files.length===0)return!0;for(var re=0;re<this.files.length;re++)h.push({file:this.files[re],inputElem:this,instanceConfig:o.extend({},c)})}),_(),this;function _(){if(h.length===0)H(l.complete)&&l.complete();else{var z,re,ue,fe,L=h[0];if(H(l.before)){var se=l.before(L.file,L.inputElem);if(typeof se=="object"){if(se.action==="abort")return z="AbortError",re=L.file,ue=L.inputElem,fe=se.reason,void(H(l.error)&&l.error({name:z},re,ue,fe));if(se.action==="skip")return void C();typeof se.config=="object"&&(L.instanceConfig=o.extend(L.instanceConfig,se.config))}else if(se==="skip")return void C()}var k=L.instanceConfig.complete;L.instanceConfig.complete=function(ie){H(k)&&k(ie,L.file,L.inputElem),C()},m.parse(L.file,L.instanceConfig)}}function C(){h.splice(0,1),_()}}),i&&(r.onmessage=function(l){l=l.data,m.WORKER_ID===void 0&&l&&(m.WORKER_ID=l.workerId),typeof l.input=="string"?r.postMessage({workerId:m.WORKER_ID,results:m.parse(l.input,l.config),finished:!0}):(r.File&&l.input instanceof File||l.input instanceof Object)&&(l=m.parse(l.input,l.config))&&r.postMessage({workerId:m.WORKER_ID,results:l,finished:!0})}),(g.prototype=Object.create(v.prototype)).constructor=g,(y.prototype=Object.create(v.prototype)).constructor=y,(S.prototype=Object.create(S.prototype)).constructor=S,(X.prototype=Object.create(v.prototype)).constructor=X,m})})(js)),js.exports}var Bo=zo();const tr=fo(Bo);function Uo(s){return s&&s.replace(/(\d{3})\.\d{3}\.\d{3}-(\d{2})/,"$1.***.***-$2")}function Jo(s){return s&&s.replace(/(\d{2})\.\d{3}\.\d{3}\/\d{4}-(\d{2})/,"$1.***.***/**-$2")}function Ho(s){if(!s)return s;const[t,a]=s.split("@");return t.length<=2?`${t}***@${a}`:`${t.slice(0,2)}***@${a}`}function Ko(s){return s&&s.replace(/(\d{2})\d{4,5}(\d{4})/,"$1****$2")}function Go(s){return s&&s.replace(/(\d{2,3})\d+/,"$1***")}function Qo(s){if(!s)return s;let t=s;return t=t.replace(/\d{3}\.\d{3}\.\d{3}-\d{2}/g,a=>Uo(a)),t=t.replace(/\d{2}\.\d{3}\.\d{3}\/\d{4}-\d{2}/g,a=>Jo(a)),t=t.replace(/[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}/g,a=>Ho(a)),t=t.replace(/\(\d{2}\)\s?\d{4,5}-?\d{4}/g,a=>Ko(a)),t=t.replace(/OAB[-/]?\s?\d{3,6}/gi,a=>{const r=a.match(/\d{3,6}/)?.[0]||"";return a.replace(r,Go(r))}),t}function Be(s,t){if(!t||!s)return s;if(typeof s=="string")return Qo(s);if(Array.isArray(s))return s.map(a=>Be(a,t));if(typeof s=="object"){const a={};for(const[r,o]of Object.entries(s))a[r]=Be(o,t);return a}return s}function Ye({items:s,maxVisible:t=2,isPiiMasked:a=!1}){const{toast:r}=Pe();if(!s||s.length===0)return e.jsx("span",{className:"text-muted-foreground",children:"—"});const o=Be(s,a),n=o.slice(0,t),i=s.length-t,d=async()=>{try{await navigator.clipboard.writeText(s.join(`
`)),r({title:"Copiado!",description:"Lista copiada para a área de transferência."})}catch{r({title:"Erro ao copiar",description:"Não foi possível copiar a lista.",variant:"destructive"})}};return s.length<=t?e.jsx("div",{className:"flex flex-wrap gap-1",children:n.map((u,m)=>e.jsx(q,{variant:"secondary",className:"text-xs",children:u},m))}):e.jsxs("div",{className:"flex items-center gap-1",children:[n.map((u,m)=>e.jsx(q,{variant:"secondary",className:"text-xs",children:u},m)),i>0&&e.jsxs(Na,{children:[e.jsx(_a,{asChild:!0,children:e.jsxs(D,{variant:"ghost",size:"sm",className:"h-6 px-2 text-xs",children:["+",i," ",e.jsx(ns,{className:"ml-1 h-3 w-3"})]})}),e.jsx(ya,{className:"w-80",align:"start",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h4",{className:"font-medium",children:["Lista completa (",s.length," itens)"]}),e.jsx(D,{variant:"ghost",size:"sm",onClick:d,className:"h-8 px-2",children:e.jsx(Ze,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"flex flex-wrap gap-1 max-h-48 overflow-y-auto",children:o.map((u,m)=>e.jsx(q,{variant:"outline",className:"text-xs",children:u},m))})]})})]})]})}const Wo=["⏱ Mapeando conexões de testemunhas…","🔎 Checando histórico probatório…","⚖️ Analisando padrões de triangulação…","📋 Identificando riscos processuais…","👥 Cruzando dados do polo ativo…","🎯 Gerando insights estratégicos…","📊 Compilando relatório executivo…"],A=Wt(s=>({processos:[],testemunhas:[],activeTab:"processos",selectedProcesso:null,selectedTestemunha:null,isDetailDrawerOpen:!1,isImportModalOpen:!1,isLoading:!1,isPiiMasked:!1,hasError:!1,errorMessage:"",lastUpdate:null,processoFilters:{},testemunhaFilters:{},columnVisibility:{processos:{cnj:!0,uf:!0,comarca:!0,fase:!0,status:!0,reclamante:!0,qtdDepos:!0,testemunhas:!0,classificacao:!0,acoes:!0},testemunhas:{nome:!0,qtdDepo:!0,ambosPolos:!0,jaReclamante:!0,cnjs:!0,classificacao:!0,acoes:!0}},savedViews:{},activeView:null,processosPage:1,testemunhasPage:1,pageSize:100,totalProcessos:0,totalTestemunhas:0,hasMoreProcessos:!1,hasMoreTestemunhas:!1,chatKind:"processo",chatInput:"",chatMessages:[],chatStatus:"idle",agentOnline:!0,chatResult:null,loadingHints:Wo,currentHintIndex:0,density:"comfortable",navigationHistory:[{label:"Mapa de Testemunhas",path:"/mapa-testemunhas"}],setActiveTab:t=>s(a=>a.activeTab===t?a:{activeTab:t}),setProcessos:t=>s(a=>JSON.stringify(a.processos)===JSON.stringify(t)?a:{processos:t}),setTestemunhas:t=>s(a=>JSON.stringify(a.testemunhas)===JSON.stringify(t)?a:{testemunhas:t}),setSelectedProcesso:t=>s(a=>a.selectedProcesso?.cnj===t?.cnj?a:{selectedProcesso:t}),setSelectedTestemunha:t=>s(a=>a.selectedTestemunha?.nome_testemunha===t?.nome_testemunha?a:{selectedTestemunha:t}),setIsDetailDrawerOpen:t=>s(a=>a.isDetailDrawerOpen===t?a:{isDetailDrawerOpen:t}),setIsImportModalOpen:t=>s(a=>a.isImportModalOpen===t?a:{isImportModalOpen:t}),setIsLoading:t=>s(a=>a.isLoading===t?a:{isLoading:t}),setIsPiiMasked:t=>s(a=>a.isPiiMasked===t?a:{isPiiMasked:t}),setError:(t,a="")=>s(r=>r.hasError===t&&r.errorMessage===a?r:{hasError:t,errorMessage:a}),setLastUpdate:t=>s(a=>a.lastUpdate?.getTime()===t?.getTime()?a:{lastUpdate:t}),setProcessoFilters:t=>s(a=>{const r={...a.processoFilters,...t};return Object.keys(t).forEach(o=>{t[o]===void 0&&delete r[o]}),{processoFilters:r,processosPage:1}}),setTestemunhaFilters:t=>s(a=>{const r={...a.testemunhaFilters,...t};return Object.keys(t).forEach(o=>{t[o]===void 0&&delete r[o]}),{testemunhaFilters:r,testemunhasPage:1}}),setColumnVisibility:(t,a,r)=>s(o=>({columnVisibility:{...o.columnVisibility,[t]:{...o.columnVisibility[t],[a]:r}}})),saveView:(t,a)=>s(r=>{const o={...r.savedViews,[t]:{processoFilters:r.processoFilters,testemunhaFilters:r.testemunhaFilters,columnVisibility:r.columnVisibility}};return typeof window<"u"&&typeof localStorage<"u"&&(localStorage.setItem(`mapaViews_${a}`,JSON.stringify(o)),localStorage.setItem(`mapaActiveView_${a}`,t)),{savedViews:o,activeView:t}}),loadViews:t=>{if(typeof window>"u"||typeof localStorage>"u")return;const a=localStorage.getItem(`mapaViews_${t}`),r=a?JSON.parse(a):{},o=localStorage.getItem(`mapaActiveView_${t}`);s({savedViews:r,activeView:o}),o&&r[o]&&s({processoFilters:r[o].processoFilters,testemunhaFilters:r[o].testemunhaFilters,columnVisibility:r[o].columnVisibility})},setActiveViewName:(t,a)=>s(r=>{const o=r.savedViews[t];return o?(typeof window<"u"&&typeof localStorage<"u"&&localStorage.setItem(`mapaActiveView_${a}`,t),{activeView:t,processoFilters:o.processoFilters,testemunhaFilters:o.testemunhaFilters,columnVisibility:o.columnVisibility}):{}}),setProcessosPage:t=>s({processosPage:t}),setTestemunhasPage:t=>s({testemunhasPage:t}),setTotalProcessos:t=>s({totalProcessos:t}),setTotalTestemunhas:t=>s({totalTestemunhas:t}),setHasMoreProcessos:t=>s({hasMoreProcessos:t}),setHasMoreTestemunhas:t=>s({hasMoreTestemunhas:t}),loadMoreProcessos:()=>s(t=>({processosPage:t.processosPage+1})),loadMoreTestemunhas:()=>s(t=>({testemunhasPage:t.testemunhasPage+1})),removeProcesso:t=>{let a=null;return s(r=>{const o=r.processos.findIndex(i=>i.cnj===t);if(o===-1)return{};a=r.processos[o];const n=[...r.processos];return n.splice(o,1),{processos:n,totalProcessos:r.totalProcessos-1}}),a},restoreProcesso:t=>s(a=>({processos:[t,...a.processos],totalProcessos:a.totalProcessos+1})),removeTestemunha:t=>{let a=null;return s(r=>{const o=r.testemunhas.findIndex(i=>i.nome_testemunha===t);if(o===-1)return{};a=r.testemunhas[o];const n=[...r.testemunhas];return n.splice(o,1),{testemunhas:n,totalTestemunhas:r.totalTestemunhas-1}}),a},restoreTestemunha:t=>s(a=>({testemunhas:[t,...a.testemunhas],totalTestemunhas:a.totalTestemunhas+1})),resetFilters:()=>s({processoFilters:{},testemunhaFilters:{},processosPage:1,testemunhasPage:1}),setChatKind:t=>s({chatKind:t}),setChatInput:t=>s({chatInput:t}),addChatMessage:t=>{const a={...t,id:`msg-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,timestamp:new Date};return s(r=>({chatMessages:[...r.chatMessages,a]})),a.id},updateChatMessage:(t,a)=>s(r=>({chatMessages:r.chatMessages.map(o=>o.id===t?{...o,...a}:o)})),setChatStatus:t=>s({chatStatus:t}),setAgentOnline:t=>s({agentOnline:t}),setChatResult:t=>s({chatResult:t}),resetChat:()=>s({chatInput:"",chatMessages:[],chatStatus:"idle",chatResult:null,currentHintIndex:0}),nextHint:()=>s(t=>({currentHintIndex:(t.currentHintIndex+1)%t.loadingHints.length})),setDensity:t=>s({density:t}),pushNavigation:t=>s(a=>a.navigationHistory[a.navigationHistory.length-1]?.path===t.path?{}:{navigationHistory:[...a.navigationHistory,t]}),popNavigation:t=>s(a=>({navigationHistory:a.navigationHistory.slice(0,t+1)})),clearNavigation:()=>s({navigationHistory:[{label:"Mapa de Testemunhas",path:"/mapa-testemunhas"}]})})),ar=s=>s.activeTab,Zo=s=>s.processos,Xo=s=>s.testemunhas,Yo=s=>s.isLoading,en=s=>s.isPiiMasked,sn=s=>s.hasError,tn=s=>s.errorMessage,an=s=>s.lastUpdate,rn=s=>s.processoFilters,on=s=>s.testemunhaFilters,nn=s=>s.isImportModalOpen,lt=s=>s.columnVisibility,ln=s=>s.savedViews,cn=s=>s.activeView;function rr({score:s,riscoNivel:t,className:a}){const n=t?(i=>{switch(i){case"critico":return{level:"Crítico",color:"bg-red-600 text-white border-red-700"};case"alto":return{level:"Alto",color:"bg-destructive text-destructive-foreground"};case"medio":return{level:"Médio",color:"bg-amber-500/15 text-amber-600 border-amber-500/30"};case"baixo":return{level:"Baixo",color:"bg-emerald-500/15 text-emerald-600 border-emerald-500/30"}}})(t):s!==void 0?(i=>i>=70?{level:"VALIDAR",color:"bg-destructive text-destructive-foreground",riscoNivel:"alto"}:i>=50?{level:"AVALIAR",color:"bg-warning text-warning-foreground",riscoNivel:"medio"}:i>=30?{level:"CONHECER",color:"bg-success text-success-foreground",riscoNivel:"baixo"}:{level:"DESCARTAR",color:"bg-muted text-muted-foreground",riscoNivel:"baixo"})(s):{level:"N/A",color:"bg-muted text-muted-foreground"};return e.jsxs(q,{className:N("font-semibold px-3 py-1 shadow-sm",n.color,a),children:[n.level,s!==void 0&&!t?` (${s})`:""]})}function or(s){const{toast:t}=Pe(),a=x.useRef(new Map);return{remove:({key:o,label:n,onDelete:i,onRestore:d})=>{const u=i();if(!u)return;a.current.set(o,u);const m=()=>{const v=a.current.get(o);v&&(d(v),a.current.delete(o))};t({title:`${s} removido`,description:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:n}),e.jsxs(D,{variant:"outline",size:"sm",onClick:m,className:"ml-2 h-6 px-2 text-xs",children:[e.jsx(Lr,{className:"h-3 w-3 mr-1"}),"Desfazer"]})]}),duration:5e3}),setTimeout(()=>{a.current.delete(o)},5e3)}}}function ct({open:s,title:t,description:a,confirmText:r="Confirmar",cancelText:o="Cancelar",loading:n=!1,onConfirm:i,onCancel:d}){return e.jsx($o,{open:s,onOpenChange:u=>!u&&d(),children:e.jsxs(Ka,{children:[e.jsxs(Ga,{children:[e.jsx(Wa,{children:t}),a&&e.jsx(Za,{children:a})]}),e.jsxs(Qa,{children:[e.jsx(Ya,{disabled:n,children:o}),e.jsxs(Xa,{onClick:i,disabled:n,children:[n&&e.jsx(os,{className:"mr-2 h-4 w-4 animate-spin"}),r]})]})]})})}const nr={density:{compact:{row:"py-1",cell:"px-3 py-1",text:"text-xs",badge:"text-[10px] px-1.5 py-0",button:"h-6 w-6",icon:"h-3 w-3"},comfortable:{row:"py-3",cell:"px-4 py-3",text:"text-sm",badge:"text-xs px-2 py-0.5",button:"h-8 w-8",icon:"h-4 w-4"}}};function dn({data:s}){const{setSelectedProcesso:t,setIsDetailDrawerOpen:a,isPiiMasked:r,removeProcesso:o,restoreProcesso:n,density:i}=A(),d=A(lt).processos,{remove:u}=or("Processo"),[m,v]=x.useState(null),[g,y]=x.useState(!1),S=nr.density[i],X=T=>{t(T),a(!0)},p=T=>{v(T),y(!0)},G=()=>{m&&u({key:m.cnj,label:m.cnj,onDelete:()=>o(m.cnj),onRestore:n}),y(!1),v(null)},ae=T=>{switch(T?.toLowerCase()){case"ativo":return"bg-success text-success-foreground";case"arquivado":return"bg-muted text-muted-foreground";case"suspenso":return"bg-warning text-warning-foreground";case"baixado":return"bg-secondary text-secondary-foreground";case"cancelado":return"bg-destructive text-destructive-foreground";default:return"bg-muted text-muted-foreground"}};return s.length?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"border border-border/50 rounded-2xl overflow-hidden",children:e.jsxs(wa,{children:[e.jsx(Ca,{children:e.jsxs(Ss,{className:"bg-muted/30",children:[d.cnj&&e.jsx(ge,{className:"font-semibold",children:"CNJ"}),d.uf&&e.jsx(ge,{className:"font-semibold",children:"UF"}),d.comarca&&e.jsx(ge,{className:"font-semibold",children:"Comarca"}),d.fase&&e.jsx(ge,{className:"font-semibold",children:"Fase"}),d.status&&e.jsx(ge,{className:"font-semibold",children:"Status"}),d.reclamante&&e.jsx(ge,{className:"font-semibold",children:"Reclamante"}),d.qtdDepos&&e.jsx(ge,{className:"font-semibold",children:"Qtd Depo Únicos"}),d.testemunhas&&e.jsx(ge,{className:"font-semibold",children:"Testemunhas Ativo"}),d.classificacao&&e.jsx(ge,{className:"font-semibold",children:"Classificação"}),d.acoes&&e.jsx(ge,{className:"font-semibold text-center",children:"Ações"})]})}),e.jsx(Sa,{children:s.map(T=>e.jsxs(Ss,{className:N("hover:bg-muted/20",S.row),children:[d.cnj&&e.jsx(je,{className:N("font-mono",S.cell,S.text),children:String(Be(T.cnj,r))}),d.uf&&e.jsx(je,{className:S.cell,children:e.jsx(q,{variant:"outline",className:S.badge,children:T.uf})}),d.comarca&&e.jsx(je,{className:N("max-w-[150px] truncate",S.cell,S.text),title:T.comarca||"",children:String(Be(T.comarca,r)||"—")}),d.fase&&e.jsx(je,{className:S.cell,children:e.jsx(q,{variant:"secondary",className:S.badge,children:T.fase||"—"})}),d.status&&e.jsx(je,{className:S.cell,children:e.jsx(q,{className:N(S.badge,ae(T.status)),children:T.status||"—"})}),d.reclamante&&e.jsx(je,{className:N("max-w-[180px] truncate",S.cell,S.text),title:T.reclamante_limpo||"",children:String(Be(T.reclamante_limpo,r)||"—")}),d.qtdDepos&&e.jsx(je,{className:N("text-center",S.cell),children:T.qtd_total_depos_unicos?e.jsx(rr,{score:T.qtd_total_depos_unicos}):"—"}),d.testemunhas&&e.jsx(je,{className:S.cell,children:e.jsx(Ye,{items:T.testemunhas_ativo_limpo,maxVisible:2,isPiiMasked:r})}),d.classificacao&&e.jsx(je,{className:S.cell,children:e.jsx(q,{variant:T.classificacao_final==="ALTO RISCO"?"destructive":"secondary",className:S.badge,children:T.classificacao_final||"—"})}),d.acoes&&e.jsx(je,{className:S.cell,children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(D,{variant:"ghost",size:"sm",onClick:()=>X(T),className:N("p-0",S.button),children:e.jsx(Ue,{className:S.icon})}),e.jsx(D,{variant:"ghost",size:"sm",className:N("p-0",S.button),children:e.jsx(ma,{className:S.icon})}),e.jsx(D,{variant:"ghost",size:"sm",className:N("p-0 text-destructive hover:text-destructive",S.button),onClick:()=>p(T),children:e.jsx(ua,{className:S.icon})})]})})]},T.cnj))})]})}),e.jsx(ct,{open:g,title:"Excluir processo?",description:m?`Deseja excluir o processo ${m.cnj}?`:void 0,confirmText:"Excluir",onConfirm:G,onCancel:()=>{y(!1),v(null)}})]}):e.jsx("div",{className:"border border-border/50 rounded-2xl p-12 text-center",children:e.jsxs("div",{className:"text-muted-foreground space-y-2",children:[e.jsx("p",{className:"text-lg",children:"Nenhum processo encontrado"}),e.jsx("p",{className:"text-sm",children:"Ajuste os filtros ou importe dados via Excel"})]})})}function bt({value:s,trueLabel:t="Sim",falseLabel:a="Não",size:r="md",className:o}){return s==null?e.jsx(q,{variant:"outline",className:N("font-normal text-muted-foreground",r==="sm"?"text-[10px] px-1.5":"text-xs px-2",o),children:"—"}):s===!0?e.jsx(q,{variant:"outline",className:N("bg-green-100 text-green-800 border-green-200 font-medium","dark:bg-green-950/30 dark:text-green-400 dark:border-green-900",r==="sm"?"text-[10px] px-1.5":"text-xs px-2",o),children:t}):e.jsx(q,{variant:"outline",className:N("bg-gray-100 text-gray-600 border-gray-200 font-normal","dark:bg-gray-900/30 dark:text-gray-400 dark:border-gray-800",r==="sm"?"text-[10px] px-1.5":"text-xs px-2",o),children:a})}function mn({value:s,size:t="md"}){if(!s||s==="—"||s==="PENDENTE"||s==="")return e.jsx(q,{variant:"outline",className:N("font-normal text-muted-foreground",t==="sm"?"text-[10px] px-1.5 py-0":"text-xs"),children:"Não classificada"});const a=s.toLowerCase(),r=()=>a.includes("crítica")||a.includes("alto")||a.includes("alta")?"bg-red-100 text-red-800 border-red-200 dark:bg-red-950/30 dark:text-red-400 dark:border-red-900":a.includes("relevante")||a.includes("médio")||a.includes("media")?"bg-yellow-100 text-yellow-800 border-yellow-200 dark:bg-yellow-950/30 dark:text-yellow-400 dark:border-yellow-900":a.includes("comum")||a.includes("baixo")||a.includes("baixa")?"bg-green-100 text-green-800 border-green-200 dark:bg-green-950/30 dark:text-green-400 dark:border-green-900":"bg-secondary text-secondary-foreground";return e.jsx(q,{variant:"outline",className:N("font-medium border",r(),t==="sm"?"text-[10px] px-1.5 py-0":"text-xs"),children:s})}function xs({status:s,onRetry:t,children:a}){return s==="loading"?e.jsx("div",{className:"p-8 text-center text-sm text-muted-foreground",children:"Carregando..."}):s==="error"?e.jsxs("div",{className:"p-8 text-center space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 text-destructive",children:[e.jsx(us,{className:"h-4 w-4"}),e.jsx("span",{children:"Erro ao carregar"})]}),t&&e.jsx(D,{variant:"outline",size:"sm",onClick:t,children:"Tentar novamente"})]}):s==="offline"?e.jsxs("div",{className:"p-8 text-center space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 text-destructive",children:[e.jsx(us,{className:"h-4 w-4"}),e.jsx("span",{children:"Sem conexão"})]}),t&&e.jsx(D,{variant:"outline",size:"sm",onClick:t,children:"Tentar novamente"})]}):s==="empty"?e.jsx("div",{className:"p-12 text-center text-muted-foreground",children:"Nenhum dado encontrado"}):e.jsx(e.Fragment,{children:a})}function un({data:s,status:t,onRetry:a}){const{setSelectedTestemunha:r,setIsDetailDrawerOpen:o,isPiiMasked:n,removeTestemunha:i,restoreTestemunha:d,density:u}=A(),m=A(lt).testemunhas,{remove:v}=or("Testemunha"),[g,y]=x.useState(null),[S,X]=x.useState(!1),p=nr.density[u],G=x.useCallback(Q=>{r(Q),o(!0)},[r,o]),ae=x.useCallback(Q=>{y(Q),X(!0)},[]),T=x.useCallback(()=>{g&&v({key:g.nome_testemunha,label:g.nome_testemunha,onDelete:()=>i(g.nome_testemunha),onRestore:d}),X(!1),y(null)},[g,v,i,d]);return t!=="success"?e.jsx(xs,{status:t,onRetry:a}):s.length?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"border border-border/50 rounded-2xl overflow-hidden",children:e.jsxs(wa,{children:[e.jsx(Ca,{children:e.jsxs(Ss,{className:"bg-muted/30",children:[m.nome&&e.jsx(ge,{className:"font-semibold",children:"Nome da Testemunha"}),m.qtdDepo&&e.jsx(ge,{className:"font-semibold text-center",children:"Qtd Depoimentos"}),m.ambosPolos&&e.jsx(ge,{className:"font-semibold text-center",children:"Ambos os Polos"}),m.jaReclamante&&e.jsx(ge,{className:"font-semibold text-center",children:"Já Foi Reclamante"}),m.cnjs&&e.jsx(ge,{className:"font-semibold",children:"CNJs como Testemunha"}),m.classificacao&&e.jsx(ge,{className:"font-semibold",children:"Classificação Estratégica"}),m.acoes&&e.jsx(ge,{className:"font-semibold text-center",children:"Ações"})]})}),e.jsx(Sa,{children:s.map(Q=>e.jsxs(Ss,{className:N("group hover:bg-muted/20",p.row),children:[m.nome&&e.jsx(je,{className:N("font-medium max-w-[200px] truncate",p.cell,p.text),title:Q.nome_testemunha,children:String(Be(Q.nome_testemunha,n))}),m.qtdDepo&&e.jsx(je,{className:N("text-center",p.cell),children:e.jsx(q,{variant:"secondary",className:p.badge,children:Q.qtd_depoimentos||0})}),m.ambosPolos&&e.jsx(je,{className:N("text-center",p.cell),children:e.jsx(bt,{value:Q.foi_testemunha_em_ambos_polos,size:"sm"})}),m.jaReclamante&&e.jsx(je,{className:N("text-center",p.cell),children:e.jsx(bt,{value:Q.ja_foi_reclamante,size:"sm"})}),m.cnjs&&e.jsx(je,{className:p.cell,children:e.jsx(Ye,{items:Q.cnjs_como_testemunha??null,maxVisible:2,isPiiMasked:n})}),m.classificacao&&e.jsx(je,{className:p.cell,children:e.jsx(mn,{value:Q.classificacao||Q.classificacao_estrategica,size:"sm"})}),m.acoes&&e.jsx(je,{className:p.cell,children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(D,{variant:"ghost",size:"sm",onClick:()=>G(Q),className:N("p-0 text-primary hover:bg-primary/10 hover:text-primary",p.button),title:"Visualizar detalhes",children:e.jsx(Ue,{className:p.icon,strokeWidth:2})}),e.jsx(D,{variant:"ghost",size:"sm",className:N("p-0 text-muted-foreground hover:text-foreground hover:bg-muted",p.button),title:"Editar",children:e.jsx(ma,{className:p.icon,strokeWidth:1.5})}),e.jsx(D,{variant:"ghost",size:"sm",className:N("p-0 opacity-0 group-hover:opacity-100 text-destructive hover:bg-destructive/10 hover:text-destructive transition-opacity",p.button),onClick:()=>ae(Q),title:"Excluir",children:e.jsx(ua,{className:p.icon,strokeWidth:1.5})})]})})]},Q.nome_testemunha))})]})}),e.jsx(ct,{open:S,title:"Excluir testemunha?",description:g?`Deseja excluir ${g.nome_testemunha}?`:void 0,confirmText:"Excluir",onConfirm:T,onCancel:()=>{X(!1),y(null)}})]}):e.jsx(xs,{status:"empty",onRetry:a})}const hn=["AC","AL","AP","AM","BA","CE","DF","ES","GO","MA","MT","MS","MG","PA","PB","PR","PE","PI","RJ","RN","RS","RO","RR","SC","SP","SE","TO"],xn=["Ativo","Arquivado","Suspenso","Baixado","Cancelado"],pn=["Conhecimento","Execução","Recursal","Liquidação"];function fn(){const{processoFilters:s,setProcessoFilters:t,resetFilters:a}=A(),r=(i,d)=>{if(d===""||d===void 0||d==="TODAS"||d==="TODOS"){const u={...s};delete u[i],t(u)}else t({[i]:d})},o=()=>{a()},n=Object.keys(s).length>0;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(rs,{className:"h-5 w-5"}),"Filtros - Por Processo"]}),n&&e.jsxs(D,{variant:"ghost",size:"sm",onClick:o,children:[e.jsx(We,{className:"h-4 w-4 mr-1"}),"Limpar"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(be,{htmlFor:"search",children:"Buscar"}),e.jsx(Ke,{id:"search",placeholder:"CNJ, comarca, reclamante...",value:s.search||"",onChange:i=>r("search",i.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(be,{htmlFor:"testemunha",children:"Testemunha"}),e.jsx(Ke,{id:"testemunha",placeholder:"Nome da testemunha...",value:s.testemunha||"",onChange:i=>r("testemunha",i.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(be,{htmlFor:"uf",children:"UF"}),e.jsxs(Ge,{value:s.uf||"TODAS",onValueChange:i=>r("uf",i),children:[e.jsx(Ve,{id:"uf",children:e.jsx(Qe,{placeholder:"Selecione..."})}),e.jsxs(ze,{children:[e.jsx(pe,{value:"TODAS",children:"Todas"}),hn.map(i=>e.jsx(pe,{value:i,children:i},i))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(be,{htmlFor:"status",children:"Status"}),e.jsxs(Ge,{value:s.status||"TODOS",onValueChange:i=>r("status",i),children:[e.jsx(Ve,{id:"status",children:e.jsx(Qe,{placeholder:"Selecione..."})}),e.jsxs(ze,{children:[e.jsx(pe,{value:"TODOS",children:"Todos"}),xn.map(i=>e.jsx(pe,{value:i,children:i},i))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(be,{htmlFor:"fase",children:"Fase"}),e.jsxs(Ge,{value:s.fase||"TODAS",onValueChange:i=>r("fase",i),children:[e.jsx(Ve,{id:"fase",children:e.jsx(Qe,{placeholder:"Selecione..."})}),e.jsxs(ze,{children:[e.jsx(pe,{value:"TODAS",children:"Todas"}),pn.map(i=>e.jsx(pe,{value:i,children:i},i))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(be,{htmlFor:"qtdMin",children:"Qtd Depo Únicos (Mín)"}),e.jsx(Ke,{id:"qtdMin",type:"number",placeholder:"0",value:s.qtdDeposMin||"",onChange:i=>r("qtdDeposMin",i.target.value?Number(i.target.value):void 0)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(be,{htmlFor:"qtdMax",children:"Qtd Depo Únicos (Máx)"}),e.jsx(Ke,{id:"qtdMax",type:"number",placeholder:"∞",value:s.qtdDeposMax||"",onChange:i=>r("qtdDeposMax",i.target.value?Number(i.target.value):void 0)})]})]})]})}function gn(){const{testemunhaFilters:s,setTestemunhaFilters:t,resetFilters:a}=A(),r=(i,d)=>{if(d===""||d===void 0||d==="TODOS"){const u={...s};delete u[i],t(u)}else t({[i]:d})},o=()=>{a()},n=Object.keys(s).length>0;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(rs,{className:"h-5 w-5"}),"Filtros - Por Testemunha"]}),n&&e.jsxs(D,{variant:"ghost",size:"sm",onClick:o,children:[e.jsx(We,{className:"h-4 w-4 mr-1"}),"Limpar"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(be,{htmlFor:"search",children:"Buscar"}),e.jsx(Ke,{id:"search",placeholder:"Nome da testemunha...",value:s.search||"",onChange:i=>r("search",i.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(be,{htmlFor:"ambosPolos",children:"Em Ambos os Polos"}),e.jsxs(Ge,{value:s.ambosPolos!==void 0?s.ambosPolos.toString():"TODOS",onValueChange:i=>r("ambosPolos",i==="TODOS"?void 0:i==="true"),children:[e.jsx(Ve,{id:"ambosPolos",children:e.jsx(Qe,{placeholder:"Selecione..."})}),e.jsxs(ze,{children:[e.jsx(pe,{value:"TODOS",children:"Todos"}),e.jsx(pe,{value:"true",children:"Sim"}),e.jsx(pe,{value:"false",children:"Não"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(be,{htmlFor:"jaFoiReclamante",children:"Já Foi Reclamante"}),e.jsxs(Ge,{value:s.jaFoiReclamante!==void 0?s.jaFoiReclamante.toString():"TODOS",onValueChange:i=>r("jaFoiReclamante",i==="TODOS"?void 0:i==="true"),children:[e.jsx(Ve,{id:"jaFoiReclamante",children:e.jsx(Qe,{placeholder:"Selecione..."})}),e.jsxs(ze,{children:[e.jsx(pe,{value:"TODOS",children:"Todos"}),e.jsx(pe,{value:"true",children:"Sim"}),e.jsx(pe,{value:"false",children:"Não"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(be,{htmlFor:"temTriangulacao",children:"Participou Triangulação"}),e.jsxs(Ge,{value:s.temTriangulacao!==void 0?s.temTriangulacao.toString():"TODOS",onValueChange:i=>r("temTriangulacao",i==="TODOS"?void 0:i==="true"),children:[e.jsx(Ve,{id:"temTriangulacao",children:e.jsx(Qe,{placeholder:"Selecione..."})}),e.jsxs(ze,{children:[e.jsx(pe,{value:"TODOS",children:"Todos"}),e.jsx(pe,{value:"true",children:"Sim"}),e.jsx(pe,{value:"false",children:"Não"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(be,{htmlFor:"temTroca",children:"Participou Troca"}),e.jsxs(Ge,{value:s.temTroca!==void 0?s.temTroca.toString():"TODOS",onValueChange:i=>r("temTroca",i==="TODOS"?void 0:i==="true"),children:[e.jsx(Ve,{id:"temTroca",children:e.jsx(Qe,{placeholder:"Selecione..."})}),e.jsxs(ze,{children:[e.jsx(pe,{value:"TODOS",children:"Todos"}),e.jsx(pe,{value:"true",children:"Sim"}),e.jsx(pe,{value:"false",children:"Não"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(be,{htmlFor:"qtdMin",children:"Qtd Depoimentos (Mín)"}),e.jsx(Ke,{id:"qtdMin",type:"number",placeholder:"0",value:s.qtdDeposMin||"",onChange:i=>r("qtdDeposMin",i.target.value?Number(i.target.value):void 0)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(be,{htmlFor:"qtdMax",children:"Qtd Depoimentos (Máx)"}),e.jsx(Ke,{id:"qtdMax",type:"number",placeholder:"∞",value:s.qtdDeposMax||"",onChange:i=>r("qtdDeposMax",i.target.value?Number(i.target.value):void 0)})]})]})]})}function jn({open:s,onOpenChange:t}){const a=A(n=>n.activeTab),[r,o]=x.useState(a==="processos"?"processos":"testemunhas");return x.useEffect(()=>{o(a==="processos"?"processos":"testemunhas")},[a]),e.jsx(ka,{open:s,onOpenChange:t,children:e.jsxs(at,{side:"right",className:"w-[600px] sm:w-[700px] overflow-y-auto",children:[e.jsxs(rt,{children:[e.jsx(ot,{children:"Filtros Avançados"}),e.jsx(nt,{children:"Refine sua busca com filtros específicos por processo ou testemunha"})]}),e.jsx("div",{className:"mt-6",children:e.jsxs(ja,{value:r,onValueChange:o,children:[e.jsxs(va,{className:"grid w-full grid-cols-2",children:[e.jsx(ws,{value:"processos",children:"Por Processo"}),e.jsx(ws,{value:"testemunhas",children:"Por Testemunha"})]}),e.jsx(Cs,{value:"processos",className:"mt-4",children:e.jsx(fn,{})}),e.jsx(Cs,{value:"testemunhas",className:"mt-4",children:e.jsx(gn,{})})]})})]})})}function vn(){const s=A(ar),t=A(lt),a=A(n=>n.setColumnVisibility),r=s==="processos"?[{key:"cnj",label:"CNJ"},{key:"uf",label:"UF"},{key:"comarca",label:"Comarca"},{key:"fase",label:"Fase"},{key:"status",label:"Status"},{key:"reclamante",label:"Reclamante"},{key:"qtdDepos",label:"Qtd Depo Únicos"},{key:"testemunhas",label:"Testemunhas Ativo"},{key:"classificacao",label:"Classificação"},{key:"acoes",label:"Ações"}]:[{key:"nome",label:"Nome da Testemunha"},{key:"qtdDepo",label:"Qtd Depoimentos"},{key:"ambosPolos",label:"Ambos os Polos"},{key:"jaReclamante",label:"Já Foi Reclamante"},{key:"cnjs",label:"CNJs como Testemunha"},{key:"classificacao",label:"Classificação Estratégica"},{key:"acoes",label:"Ações"}],o=t[s];return e.jsxs(ps,{children:[e.jsx(fs,{asChild:!0,children:e.jsxs(D,{variant:"outline",size:"sm",className:"flex items-center gap-2",children:[e.jsx(qr,{className:"h-4 w-4"})," Colunas"]})}),e.jsx(ls,{align:"end",children:r.map(n=>e.jsx(Fa,{checked:o[n.key],onCheckedChange:i=>a(s,n.key,i),children:n.label},n.key))})]})}function bn({userId:s}){const t=A(ln),a=A(cn),r=A(i=>i.saveView),o=A(i=>i.setActiveViewName),n=()=>{const i=window.prompt("Nome da visualização");i&&r(i,s)};return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(Ge,{value:a||"",onValueChange:i=>o(i,s),children:[e.jsx(Ve,{className:"w-[200px]",children:e.jsx(Qe,{placeholder:"Visualizações"})}),e.jsx(ze,{children:Object.keys(t).map(i=>e.jsx(pe,{value:i,children:i},i))})]}),e.jsxs(D,{variant:"outline",size:"sm",onClick:n,className:"flex items-center gap-2",children:[e.jsx(Vr,{className:"h-4 w-4"})," Salvar visão"]})]})}const ir=({shouldScaleBackground:s=!0,...t})=>e.jsx(Je.Root,{shouldScaleBackground:s,...t});ir.displayName="Drawer";const Nn=Je.Portal,lr=x.forwardRef(({className:s,...t},a)=>e.jsx(Je.Overlay,{ref:a,className:N("fixed inset-0 z-50 bg-black/80",s),...t}));lr.displayName=Je.Overlay.displayName;const cr=x.forwardRef(({className:s,children:t,...a},r)=>e.jsxs(Nn,{children:[e.jsx(lr,{}),e.jsxs(Je.Content,{ref:r,className:N("fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background",s),...a,children:[e.jsx("div",{className:"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted"}),t]})]}));cr.displayName="DrawerContent";const dr=({className:s,...t})=>e.jsx("div",{className:N("grid gap-1.5 p-4 text-center sm:text-left",s),...t});dr.displayName="DrawerHeader";const mr=x.forwardRef(({className:s,...t},a)=>e.jsx(Je.Title,{ref:a,className:N("text-lg font-semibold leading-none tracking-tight",s),...t}));mr.displayName=Je.Title.displayName;const _n=x.forwardRef(({className:s,...t},a)=>e.jsx(Je.Description,{ref:a,className:N("text-sm text-muted-foreground",s),...t}));_n.displayName=Je.Description.displayName;function yn(){const{isDetailDrawerOpen:s,setIsDetailDrawerOpen:t,selectedProcesso:a,selectedTestemunha:r,isPiiMasked:o}=A(),{toast:n}=Pe(),i=async(m,v)=>{const g=String(Be(m,o));try{await navigator.clipboard.writeText(g),n({title:"Copiado!",description:`${v} copiado para a área de transferência.`})}catch{n({title:"Erro ao copiar",description:`Não foi possível copiar ${v}.`,variant:"destructive"})}},d=({value:m,label:v})=>e.jsxs("div",{className:"flex items-center gap-2",children:[m===null?e.jsx("span",{className:"text-muted-foreground",children:"—"}):m?e.jsxs(e.Fragment,{children:[e.jsx($e,{className:"h-4 w-4 text-success"}),e.jsx("span",{children:"Sim"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Vs,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:"Não"})]}),v&&e.jsx(D,{variant:"ghost",size:"sm",onClick:()=>i(m?.toString()||"N/A",v),className:"h-6 w-6 p-0",children:e.jsx(Ze,{className:"h-3 w-3"})})]}),u=({label:m,value:v,copyable:g=!1})=>e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:m}),g&&v&&e.jsx(D,{variant:"ghost",size:"sm",onClick:()=>i(v.toString(),m),className:"h-6 w-6 p-0",children:e.jsx(Ze,{className:"h-3 w-3"})})]}),e.jsx("p",{className:"font-mono text-sm break-all",children:v?String(Be(v.toString(),o)):"—"})]});return!s||!a&&!r?null:e.jsx(ir,{open:s,onOpenChange:t,children:e.jsxs(cr,{className:"max-w-4xl mx-auto",children:[e.jsx(dr,{children:e.jsx(mr,{children:a?`Processo ${a.cnj}`:`Testemunha ${r?.nome_testemunha}`})}),e.jsxs(Ua,{className:"h-[80vh] px-6 pb-6",children:[a&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-muted/20 rounded-xl p-4",children:e.jsx(q,{variant:"outline",className:"mb-2",children:"Conteúdo assistivo. Revisão humana obrigatória."})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(u,{label:"CNJ",value:a.cnj,copyable:!0}),e.jsx(u,{label:"Status",value:a.status}),e.jsx(u,{label:"UF",value:a.uf}),e.jsx(u,{label:"Comarca",value:a.comarca,copyable:!0}),e.jsx(u,{label:"Fase",value:a.fase}),e.jsx(u,{label:"Reclamante",value:a.reclamante_limpo,copyable:!0})]}),e.jsx(He,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold",children:"Advogados Parte Ativa"}),e.jsx(Ye,{items:a.advogados_parte_ativa,maxVisible:5,isPiiMasked:o})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold",children:"Testemunhas"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Polo Ativo"}),e.jsx(Ye,{items:a.testemunhas_ativo_limpo,maxVisible:5,isPiiMasked:o})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Polo Passivo"}),e.jsx(Ye,{items:a.testemunhas_passivo_limpo,maxVisible:5,isPiiMasked:o})]})]})]}),e.jsx(He,{}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Reclamante foi Testemunha"}),e.jsx(d,{value:a.reclamante_foi_testemunha})]}),e.jsx(u,{label:"Qtd Vezes Reclamante foi Testemunha",value:a.qtd_vezes_reclamante_foi_testemunha}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Troca Direta"}),e.jsx(d,{value:a.troca_direta})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Triangulação Confirmada"}),e.jsx(d,{value:a.triangulacao_confirmada})]})]}),e.jsx(He,{}),e.jsx(u,{label:"Classificação Final",value:a.classificacao_final}),e.jsx(u,{label:"Insight Estratégico",value:a.insight_estrategico,copyable:!0})]}),r&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-muted/20 rounded-xl p-4",children:e.jsx(q,{variant:"outline",className:"mb-2",children:"Conteúdo assistivo. Revisão humana obrigatória."})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(u,{label:"Nome da Testemunha",value:r.nome_testemunha,copyable:!0}),e.jsx(u,{label:"Quantidade de Depoimentos",value:r.qtd_depoimentos})]}),e.jsx(He,{}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Já Foi Reclamante"}),e.jsx(d,{value:r.ja_foi_reclamante})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Foi Testemunha em Ambos os Polos"}),e.jsx(d,{value:r.foi_testemunha_em_ambos_polos})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Participou Troca Favor"}),e.jsx(d,{value:r.participou_troca_favor})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Participou Triangulação"}),e.jsx(d,{value:r.participou_triangulacao})]})]}),e.jsx(He,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold",children:"CNJs como Testemunha"}),e.jsx(Ye,{items:r.cnjs_como_testemunha??null,maxVisible:5,isPiiMasked:o})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold",children:"CNJs como Reclamante"}),e.jsx(Ye,{items:r.cnjs_como_reclamante??null,maxVisible:5,isPiiMasked:o})]}),e.jsx(He,{}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(u,{label:"Classificação",value:r.classificacao??null}),e.jsx(u,{label:"Classificação Estratégica",value:r.classificacao_estrategica??null})]})]})]})]})})}const wn=zr,Cn=Br,Sn=Ur;function Tn(s,t="Você tem alterações não salvas. Deseja sair?"){x.useEffect(()=>{if(!s)return;const a=r=>(r.preventDefault(),r.returnValue=t,t);return window.addEventListener("beforeunload",a),()=>{window.removeEventListener("beforeunload",a)}},[s,t])}const Qs=s=>String(s??"").replace(/\D/g,""),Nt=s=>Qs(s).length===20,_t=s=>{const t=String(s??"").trim();if(!t||t==="[]")return[];if(t.startsWith("[")&&t.endsWith("]"))try{return JSON.parse(t.replace(/'/g,'"')).map(a=>String(a).trim()).filter(Boolean)}catch{}return t.split(/[;,]/).map(a=>a.trim()).filter(Boolean)},En=["Nome_Testemunha","CNJs_Como_Testemunha"],Rn=["CNJ","Reclamante_Limpo","Reu_Nome"],yt=(s,t)=>(t.utils.sheet_to_json(s,{header:1,blankrows:!1})[0]||[]).map(r=>String(r||"").trim()),wt=(s,t)=>{const a=new Set(s.map(o=>o.toLowerCase())),r=t.filter(o=>!a.has(o.toLowerCase()));return{ok:r.length===0,missing:r}},Pn=({currentStep:s,validationResults:t,isProcessing:a})=>{const r=[{id:"upload",title:"Upload do Arquivo",icon:zs,description:"Selecione o arquivo Excel"},{id:"validation",title:"Validação",icon:bs,description:"Verificação da qualidade dos dados"},{id:"preview",title:"Prévia",icon:Ue,description:"Visualização antes da importação"},{id:"publish",title:"Importação",icon:$e,description:"Processamento final"}],o=i=>{const d=r.findIndex(m=>m.id===s),u=r.findIndex(m=>m.id===i);return a&&i===s?"processing":u<d?"completed":u===d?i==="validation"&&(t?.errors?.length??0)>0?"error":"current":"pending"},n=(i,d)=>{const u=i.icon;return d==="processing"?e.jsx(ha,{className:"h-5 w-5 animate-pulse"}):d==="completed"?e.jsx($e,{className:"h-5 w-5"}):d==="error"?e.jsx(us,{className:"h-5 w-5"}):e.jsx(u,{className:"h-5 w-5"})};return e.jsx("div",{className:"mb-8",children:e.jsx("div",{className:"flex items-center justify-between",children:r.map((i,d)=>{const u=o(i.id),m=u==="current"||u==="processing",v=u==="completed",g=u==="error";return e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:`
                  flex items-center justify-center w-12 h-12 rounded-full border-2 
                  ${v?"bg-green-100 border-green-500 text-green-700 dark:bg-green-950 dark:border-green-400 dark:text-green-300":""}
                  ${m&&!g?"bg-primary/10 border-primary text-primary":""}
                  ${g?"bg-red-100 border-red-500 text-red-700 dark:bg-red-950 dark:border-red-400 dark:text-red-300":""}
                  ${u==="pending"?"bg-muted border-muted-foreground/25 text-muted-foreground":""}
                  transition-all duration-200
                `,children:n(i,u)}),e.jsxs("div",{className:"mt-3 text-center",children:[e.jsx("span",{className:`text-sm font-medium ${m?"text-foreground":v?"text-green-700 dark:text-green-300":g?"text-red-700 dark:text-red-300":"text-muted-foreground"}`,children:i.title}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:i.description})]})]}),d<r.length-1&&e.jsx("div",{className:`
                  w-16 h-0.5 mx-4 
                  ${d<r.findIndex(y=>y.id===s)?"bg-green-500":"bg-muted-foreground/25"}
                  transition-colors duration-200
                `})]},i.id)})})})},An=({validationResults:s,fileName:t})=>{const{toast:a}=Pe();x.useState("empty"),x.useState(!1);const r=()=>{ba(async()=>{const i=[["Linha","Coluna","Tipo","Mensagem","Valor"].join(","),`"Resumo","Total: ${s.totalRows}","Válidos: ${s.validRows}","Erros: ${s.errors.length}","Avisos: ${s.warnings.length}"`,"",...s.errors.map(m=>[m.row,`"${m.column}"`,"Erro",`"${m.message}"`,`"${m.value||""}"`].join(",")),...s.warnings.map(m=>[m.row,`"${m.column}"`,"Aviso",`"${m.message}"`,`"${m.value||""}"`].join(","))].join(`
`),d=new Blob(["\uFEFF"+i],{type:"text/csv;charset=utf-8;"}),u=document.createElement("a");u.href=URL.createObjectURL(d),u.download=`relatorio-validacao-${t.replace(/\.[^/.]+$/,"")}-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(u),u.click(),document.body.removeChild(u),a({title:"Relatório CSV gerado",description:"Download iniciado com sucesso"})},"ImportModal.generateCSVReport")};return e.jsxs(ne,{children:[e.jsxs(Ne,{children:[e.jsxs(_e,{className:"flex items-center gap-2",children:[e.jsx(Me,{className:"h-5 w-5"}),"Relatório de Validação"]}),e.jsx(es,{children:"Gere relatórios detalhados dos erros e avisos encontrados"})]}),e.jsxs(de,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center p-3 bg-muted rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold",children:s.totalRows.toLocaleString()}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Total de linhas"})]}),e.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold text-green-600",children:s.validRows.toLocaleString()}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Linhas válidas"})]}),e.jsxs("div",{className:"text-center p-3 bg-red-50 rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold text-red-600",children:s.errors.length}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Erros"})]}),e.jsxs("div",{className:"text-center p-3 bg-orange-50 rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold text-orange-600",children:s.warnings.length}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Avisos"})]})]}),e.jsxs(D,{variant:"outline",onClick:r,className:"flex items-center gap-2",children:[e.jsx(Qr,{className:"h-4 w-4"}),"Exportar Relatório CSV"]})]})]})};function Dn(){const s=A(nn),t=A(b=>b.setIsImportModalOpen),{toast:a}=Pe(),[r,o]=x.useState("upload"),[n,i]=x.useState(null),[d,u]=x.useState(!1),[m,v]=x.useState(0),[g,y]=x.useState(null),[S,X]=x.useState(null),[p,G]=x.useState("empty"),[ae,T]=x.useState(!1),[Q,me]=x.useState(!1),ee=()=>{o("upload"),i(null),u(!1),v(0),y(null),X(null),G("empty"),T(!1)},W=!!n||r!=="upload";Tn(W);const H=b=>{b?t(!0):W?me(!0):(ee(),t(!1))},l=x.useCallback(b=>{const R=b[0];R&&(i(R),y(null),X(null),o("upload"),C(R))},[]),{getRootProps:c,getInputProps:h,isDragActive:_}=Jr({onDrop:l,accept:{"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"],"application/vnd.ms-excel":[".xls"]},maxFiles:1}),C=b=>{u(!0),v(0);const R=setInterval(()=>{v(j=>j>=95?(clearInterval(R),95):j+Math.random()*15)},200);ue(b)},z=b=>{const R=[];return b.forEach((j,E)=>{(!j.nome_testemunha||String(j.nome_testemunha).trim()==="")&&R.push({row:E+2,column:"Nome_Testemunha",message:"Nome_Testemunha é obrigatório",type:"error"});const U=Array.isArray(j.cnjs_como_testemunha)?j.cnjs_como_testemunha:_t(j.cnjs_como_testemunha);U.length||R.push({row:E+2,column:"CNJs_Como_Testemunha",message:"Lista de CNJs vazia",type:"error"}),U.some(Nt)||R.push({row:E+2,column:"CNJs_Como_Testemunha",message:"Nenhum CNJ com 20 dígitos na lista",type:"error"})}),R},re=b=>{const R=[];return b.forEach((j,E)=>{(!j.cnj||!Nt(j.cnj))&&R.push({row:E+2,column:"CNJ",message:"CNJ deve ter 20 dígitos (removendo máscara)",value:j.cnj,type:"error"}),(!j.reclamante_limpo||String(j.reclamante_limpo).trim()==="")&&R.push({row:E+2,column:"Reclamante_Limpo",message:"Reclamante_Limpo é obrigatório",type:"error"}),(!j.reu_nome||String(j.reu_nome).trim()==="")&&R.push({row:E+2,column:"Reu_Nome",message:"Reu_Nome é obrigatório",type:"error"})}),R},ue=async b=>{await ba(async()=>{const{porProcesso:R,porTestemunha:j,errors:E,warnings:U}=await fe(b),O=R.length+j.length,w=O-E.length;y({totalRows:O,validRows:w,errors:E,warnings:U||[],processos:R,testemunhas:j}),o("validation")},"ImportModal.processFileValidation").finally(()=>{u(!1),v(100)})},fe=async b=>{const R=await go(()=>import("./xlsx-PER9UG_v.js"),[]);return new Promise((j,E)=>{const U=new FileReader;U.onload=O=>{try{const w=new Uint8Array(O.target?.result),Y=R.read(w,{type:"array"}),F=Y.Sheets["Por Processo"],te=Y.Sheets["Por Testemunha"];if(!F&&!te)throw new Error('Arquivo deve conter ao menos uma aba: "Por Processo" ou "Por Testemunha".');const oe=[],K=[];let Z=[];if(F){const f=yt(F,R),{ok:B,missing:P}=wt(f,Rn);if(!B)throw new Error(`Modo Processo: faltam colunas: ${P.join(", ")}`);R.utils.sheet_to_json(F,{defval:""}).forEach(J=>{const he=String(J.CNJ??"").trim(),xe={cnj:he,cnj_digits:Qs(he),reclamante_limpo:String(J.Reclamante_Limpo??""),reu_nome:String(J.Reu_Nome??""),comarca:String(J.Comarca??""),fase:String(J.Fase??""),status:String(J.Status??"")};oe.push(xe)}),Z=Z.concat(re(oe))}if(te){const f=yt(te,R),{ok:B,missing:P}=wt(f,En);if(!B)throw new Error(`Modo Testemunha: faltam colunas: ${P.join(", ")}`);R.utils.sheet_to_json(te,{defval:""}).forEach(J=>{const he=_t(J.CNJs_Como_Testemunha),xe={nome_testemunha:String(J.Nome_Testemunha??""),cnjs_como_testemunha:he};K.push(xe)}),Z=Z.concat(z(K))}j({porProcesso:oe,porTestemunha:K,errors:Z})}catch(w){E(w)}},U.onerror=()=>E(new Error("Erro ao ler arquivo")),U.readAsArrayBuffer(b)})},L=async()=>{if(g){if(!navigator.onLine){G("offline"),T(!0);return}u(!0),v(0),o("publish"),G("loading");try{const b=setInterval(()=>{v(O=>O>=90?(clearInterval(b),90):O+Math.random()*10)},300),R=g.testemunhas.flatMap(O=>O.cnjs_como_testemunha.map(w=>({nome_testemunha:O.nome_testemunha,cnj:w,cnj_digits:Qs(w)}))),j={};g.processos.length&&(j.processos=g.processos),R.length&&(j.testemunhas=R);const{data:E,error:U}=await Fe.functions.invoke("import-mapa-testemunhas",{body:j});if(v(100),U)throw U;X(E),G("success"),T(!1),a({title:"Importação concluída!",description:`${E?.upserts??0} registros processados com sucesso.`})}catch(b){console.error("Import error:",b),G(navigator.onLine?"error":"offline"),T(!0);const R=b instanceof Error?b.message:"Ocorreu um erro durante a importação.";a({title:"Erro na importação",description:R,variant:"destructive"})}finally{u(!1),v(100)}}},se=()=>{t(!1),i(null),y(null),X(null),o("upload"),v(0)},k=()=>e.jsxs(ne,{children:[e.jsxs(Ne,{children:[e.jsxs(_e,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(zs,{className:"h-5 w-5"}),"Upload de Arquivo Excel"]}),e.jsxs(wn,{children:[e.jsx(Cn,{asChild:!0,children:e.jsxs(D,{variant:"ghost",size:"sm",className:"text-muted-foreground",children:[e.jsx(Hr,{className:"h-4 w-4 mr-2"}),"Precisa de ajuda?",e.jsx(ns,{className:"h-4 w-4 ml-2"})]})}),e.jsx(Sn,{className:"absolute z-10 mt-2 p-4 bg-background border rounded-lg shadow-lg max-w-md right-0",children:e.jsx("div",{className:"space-y-3",children:e.jsxs(De,{className:"border-blue-200 bg-blue-50 dark:bg-blue-950",children:[e.jsx(Ys,{className:"h-4 w-4 text-blue-600"}),e.jsxs(ke,{className:"text-blue-800 dark:text-blue-200",children:[e.jsx("strong",{children:"Formato requerido:"})," Arquivo Excel (.xlsx) com abas:",e.jsx("br",{}),"• ",e.jsx("strong",{children:"Por Processo:"})," CNJ, Reclamante_Limpo, Reu_Nome",e.jsx("br",{}),"• ",e.jsx("strong",{children:"Por Testemunha:"})," Nome_Testemunha, CNJs_Como_Testemunha"]})]})})})]})]}),e.jsx(es,{children:"Faça upload do arquivo Excel com os dados do mapa de testemunhas"})]}),e.jsxs(de,{children:[e.jsxs("div",{...c(),className:`border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors ${_?"border-primary bg-primary/5":"border-muted-foreground/25 hover:border-primary"}`,children:[e.jsx("input",{...h()}),e.jsx(zs,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),_?e.jsx("p",{className:"text-lg",children:"Solte o arquivo aqui..."}):e.jsxs("div",{children:[e.jsx("p",{className:"text-lg mb-2",children:"Arraste e solte o arquivo aqui"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"ou clique para selecionar"}),e.jsx(D,{variant:"outline",children:"Selecionar Arquivo"})]})]}),n&&e.jsxs("div",{className:"mt-4 p-4 bg-muted rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:n.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[(n.size/1024/1024).toFixed(2)," MB • Excel"]})]}),e.jsx(D,{variant:"ghost",size:"sm",onClick:()=>{i(null),y(null),o("upload")},children:e.jsx(Kr,{className:"h-4 w-4"})})]}),d&&e.jsxs("div",{className:"mt-3",children:[e.jsx(Ts,{value:m,className:"w-full"}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-1 flex items-center gap-2",children:[e.jsx(Gr,{className:"h-3 w-3 animate-pulse"}),m<95?`Enviando arquivo... ${Math.round(m)}%`:"Processando e validando dados..."]})]})]})]})]}),ie=()=>e.jsxs(ne,{children:[e.jsxs(Ne,{children:[e.jsxs(_e,{className:"flex items-center gap-2",children:[e.jsx(bs,{className:"h-5 w-5"}),"Validação e Normalização"]}),e.jsx(es,{children:"Verificando a qualidade e consistência dos dados"})]}),e.jsx(de,{children:g?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold",children:g.totalRows?.toLocaleString()}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Linhas analisadas"})]}),e.jsxs("div",{className:"text-center p-4 bg-green-50 dark:bg-green-950 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:g.validRows?.toLocaleString()}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Linhas válidas"})]}),e.jsxs("div",{className:"text-center p-4 bg-red-50 dark:bg-red-950 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:g.errors?.length||0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Erros"})]}),e.jsxs("div",{className:"text-center p-4 bg-orange-50 dark:bg-orange-950 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600 dark:text-orange-400",children:g.warnings?.length||0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Avisos"})]})]}),g.errors?.length===0&&g.validRows>0&&e.jsxs(De,{className:"border-green-200 bg-green-50 dark:bg-green-950 dark:border-green-800",children:[e.jsx($e,{className:"h-4 w-4 text-green-600"}),e.jsxs(ke,{className:"text-green-800 dark:text-green-200",children:["✅ Arquivo pronto para importação!"," ",g.validRows," registros serão processados."]})]}),g.errors?.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium",children:"Erros Encontrados:"}),g.errors.slice(0,5).map((b,R)=>e.jsxs(De,{variant:"destructive",children:[e.jsx(us,{className:"h-4 w-4"}),e.jsxs(ke,{children:[e.jsxs("strong",{children:["Linha ",b.row,":"]})," ",b.message," (",b.column,")"]})]},R)),g.errors.length>5&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["... e mais ",g.errors.length-5," erros"]})]}),(g.errors?.length>0||g.warnings?.length>0)&&e.jsx(An,{validationResults:g,fileName:n?.name||"arquivo"}),e.jsxs("div",{className:"flex gap-2 justify-between",children:[e.jsx(D,{variant:"outline",onClick:()=>o("upload"),children:"Voltar"}),e.jsx("div",{className:"flex gap-2",children:e.jsx(D,{onClick:()=>o("preview"),disabled:g.validRows===0||(g.errors?.length||0)>0,children:g.errors?.length>0?"Corrigir Erros Primeiro":"Continuar para Prévia"})})]})]}):e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Ns,{className:"h-8 w-8 animate-spin mx-auto mb-4"}),e.jsx("p",{children:"Validando arquivo..."})]})})})]}),I=()=>e.jsxs(ne,{children:[e.jsxs(Ne,{children:[e.jsxs(_e,{className:"flex items-center gap-2",children:[e.jsx(Ue,{className:"h-5 w-5"}),"Prévia dos Dados"]}),e.jsx(es,{children:"Visualização dos dados processados e normalizados"})]}),e.jsx(de,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold",children:g?.processos.length||0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Processos"})]}),e.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold",children:g?.testemunhas.length||0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Testemunhas"})]}),e.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[e.jsxs("div",{className:"text-2xl font-bold",children:[g?Math.round(g.validRows/g.totalRows*100):0,"%"]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Taxa de sucesso"})]})]}),e.jsxs(De,{className:"border-blue-200 bg-blue-50 dark:bg-blue-950 dark:border-blue-800",children:[e.jsx(Ue,{className:"h-4 w-4 text-blue-600"}),e.jsxs(ke,{className:"text-blue-800 dark:text-blue-200",children:[e.jsx("strong",{children:"Prévia da Importação:"})," ",g?.validRows||0," registros serão processados e inseridos no mapa de testemunhas."]})]}),(g?.processos?.length??0)>0&&e.jsx("div",{className:"border rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-muted",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 text-left",children:"CNJ"}),e.jsx("th",{className:"p-3 text-left",children:"Reclamante"}),e.jsx("th",{className:"p-3 text-left",children:"Réu"})]})}),e.jsx("tbody",{children:g?.processos?.slice(0,3).map((b,R)=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"p-3 font-mono text-sm",children:b.cnj}),e.jsx("td",{className:"p-3",children:b.reclamante_limpo}),e.jsx("td",{className:"p-3",children:b.reu_nome})]},R))})]})}),e.jsxs("div",{className:"flex gap-2 justify-between",children:[e.jsx(D,{variant:"outline",onClick:()=>o("validation"),children:"Voltar para Validação"}),e.jsx(D,{onClick:L,className:"bg-green-600 hover:bg-green-700",disabled:(g?.errors?.length||0)>0,children:"Confirmar Importação"})]})]})})]}),M=()=>e.jsxs(ne,{children:[e.jsxs(Ne,{children:[e.jsxs(_e,{className:"flex items-center gap-2",children:[e.jsx($e,{className:"h-5 w-5"}),"Importação"]}),e.jsx(es,{children:"Processamento dos dados no sistema"})]}),e.jsx(de,{children:e.jsx("div",{className:"space-y-4",children:S?e.jsxs("div",{className:"space-y-4",children:[e.jsxs(De,{className:"border-green-200 bg-green-50 dark:bg-green-950",children:[e.jsx($e,{className:"h-4 w-4 text-green-600"}),e.jsxs(ke,{className:"text-green-800 dark:text-green-200",children:[e.jsx("strong",{children:"Importação concluída com sucesso!"}),e.jsx("br",{}),"• Registros processados: ",S.upserts,S.errors?.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),"• Erros: ",S.errors.length]})]})]}),e.jsx(D,{className:"w-full",onClick:se,children:"Fechar"})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ns,{className:"h-8 w-8 animate-spin mx-auto mb-4"}),e.jsx("p",{className:"font-medium",children:"Importando dados..."}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Processando e inserindo registros no mapa de testemunhas."}),e.jsxs("div",{className:"mt-4",children:[e.jsx(Ts,{value:m,className:"w-full"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:m<100?"Processando...":"Finalizando..."})]})]})})})]});return e.jsxs(e.Fragment,{children:[e.jsx(Ea,{open:s,onOpenChange:H,children:e.jsxs(st,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(Pa,{children:[e.jsxs(Aa,{className:"flex items-center gap-2",children:[e.jsx(Xs,{className:"h-5 w-5"}),"Importar Mapa de Testemunhas"]}),e.jsx(Da,{children:'Importe dados do Excel com as abas "Por Processo" e/ou "Por Testemunha"'})]}),ae&&e.jsx(De,{variant:"destructive",className:"mb-4",children:e.jsx(ke,{children:"Integração CNJ indisponível"})}),p!=="empty"&&p!=="success"&&e.jsx(xs,{status:p,onRetry:L}),e.jsx(Pn,{currentStep:r,validationResults:g??void 0,isProcessing:d}),e.jsxs("div",{className:"space-y-6",children:[r==="upload"&&k(),r==="validation"&&ie(),r==="preview"&&I(),r==="publish"&&M()]})]})}),e.jsx(ct,{open:Q,title:"Descartar alterações?",description:"Você possui alterações não salvas. Deseja realmente sair?",confirmText:"Sair",onConfirm:()=>{me(!1),ee(),t(!1)},onCancel:()=>me(!1)})]})}const kn=()=>{const s=A(a=>a.isPiiMasked),t=A(a=>a.setIsPiiMasked);return e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Oe,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(tt,{id:"mask-pii",checked:s,onCheckedChange:t}),e.jsx(be,{htmlFor:"mask-pii",className:"text-sm font-medium cursor-pointer flex items-center gap-1",children:s?e.jsxs(e.Fragment,{children:[e.jsx(Bs,{className:"h-3 w-3"}),"Mascarar PII"]}):e.jsxs(e.Fragment,{children:[e.jsx(Ue,{className:"h-3 w-3"}),"Mostrar PII"]})})]})]})};function On(s){if(s.length!==18)throw new Error("CNJ without check digits must have exactly 18 digits");const t=[2,3,4,5,6,7,8,9,2,3,4,5,6,7,8,9,2,3];let a=0;const r=s.split("").map(Number);for(let i=0;i<r.length;i++)a+=r[i]*t[i];return(98-a%97).toString().padStart(2,"0")}function Fn(s){const t=s?.year||2018+Math.floor(Math.random()*8),a=s?.sequential||String(Math.floor(Math.random()*9999999)+1).padStart(7,"0"),r=s?.justice,o=s?.tribunal,n=s?.origin||String(Math.floor(Math.random()*9999)+1).padStart(4,"0"),i=a+t+r+o+n,d=On(i);return`${a}-${d}.${t}.${r}.${o}.${n}`}function In(s,t=2024){const a=[];for(let o=0;o<s;o++){const n=String(1e6+o).padStart(7,"0");a.push(Fn({sequential:n,year:t,justice:"5",tribunal:"02",origin:String(1e3+o).padStart(4,"0")}))}return a}const Ae=In(12,2024),Ii=[{Aba:"Por Processo",Campo:"CNJ",Tipo:"texto",Obrigatorio:"Sim",Regra:"String com 20 dígitos (preserva formato original). Validação interna remove pontuação.",Exemplo:Ae[0]},{Aba:"Por Processo",Campo:"reclamante_nome",Tipo:"texto",Obrigatorio:"Sim (legado)",Regra:"Nome principal do reclamante (campo de compatibilidade)",Exemplo:"Ana Lima"},{Aba:"Por Processo",Campo:"reu_nome",Tipo:"texto",Obrigatorio:"Sim (legado)",Regra:"Nome do réu/empresa (campo de compatibilidade)",Exemplo:"Empresa XYZ Ltda"},{Aba:"Por Processo",Campo:"Status",Tipo:"texto",Obrigatorio:"Não",Regra:"Status atual do processo",Exemplo:"Em andamento"},{Aba:"Por Processo",Campo:"Fase",Tipo:"texto",Obrigatorio:"Não",Regra:"Fase processual atual",Exemplo:"Instrução"},{Aba:"Por Processo",Campo:"UF",Tipo:"texto",Obrigatorio:"Sim",Regra:"Sigla de 2 letras do estado",Exemplo:"SP"},{Aba:"Por Processo",Campo:"Comarca",Tipo:"texto",Obrigatorio:"Sim",Regra:"Nome da comarca",Exemplo:"São Paulo"},{Aba:"Por Processo",Campo:"Reclamantes",Tipo:"lista",Obrigatorio:"Sim",Regra:"Lista separada por ; (ponto e vírgula). Não usar []",Exemplo:"Ana Lima; Pedro Santos"},{Aba:"Por Processo",Campo:"Advogados_Ativo",Tipo:"lista",Obrigatorio:"Sim",Regra:"Lista separada por ; (primeiro é principal na UI)",Exemplo:"Dr. Xavier Silva; Dra. Yasmim Oliveira"},{Aba:"Por Processo",Campo:"Testemunhas_Ativo",Tipo:"lista",Obrigatorio:"Não",Regra:"Lista separada por ; ou — se vazio",Exemplo:"João Pereira; Carlos Costa"},{Aba:"Por Processo",Campo:"Testemunhas_Passivo",Tipo:"lista",Obrigatorio:"Não",Regra:"Lista separada por ; ou — se vazio",Exemplo:"Ana Silva"},{Aba:"Por Processo",Campo:"Todas_Testemunhas",Tipo:"lista",Obrigatorio:"Sim",Regra:"União de todas as testemunhas, separadas por ;",Exemplo:"João Pereira; Beatriz Nunes; Carlos Costa"},{Aba:"Por Processo",Campo:"Reclamante_Foi_Testemunha",Tipo:"boolean",Obrigatorio:"Não",Regra:"true/false",Exemplo:"true"},{Aba:"Por Processo",Campo:"Qtd_Reclamante_Testemunha",Tipo:"número",Obrigatorio:"Não",Regra:"Quantidade de vezes que reclamante foi testemunha",Exemplo:"1"},{Aba:"Por Processo",Campo:"CNJs_Reclamante_Testemunha",Tipo:"lista",Obrigatorio:"Não",Regra:"Lista de CNJs separados por ; ou — se vazio",Exemplo:`${Ae[9]}`},{Aba:"Por Processo",Campo:"Reclamante_Testemunha_Polo_Passivo",Tipo:"boolean",Obrigatorio:"Não",Regra:"true/false",Exemplo:"false"},{Aba:"Por Processo",Campo:"CNJs_Passivo",Tipo:"lista",Obrigatorio:"Não",Regra:"CNJs onde reclamante foi testemunha do polo passivo",Exemplo:"—"},{Aba:"Por Processo",Campo:"Triangulacao_Confirmada",Tipo:"boolean",Obrigatorio:"Não",Regra:"true/false",Exemplo:"true"},{Aba:"Por Processo",Campo:"Desenho_Triangulacao",Tipo:"texto",Obrigatorio:"Não",Regra:"Padrão da triangulação (A→B→C→A) ou — se não houver",Exemplo:"A→B→C→A"},{Aba:"Por Processo",Campo:"CNJs_Triangulacao",Tipo:"lista",Obrigatorio:"Não",Regra:"CNJs envolvidos na triangulação, separados por ;",Exemplo:`${Ae[1]}; ${Ae[2]}; ${Ae[3]}`},{Aba:"Por Processo",Campo:"Contem_Prova_Emprestada",Tipo:"boolean",Obrigatorio:"Não",Regra:"true/false",Exemplo:"true"},{Aba:"Por Processo",Campo:"Testemunhas_Prova_Emprestada",Tipo:"lista",Obrigatorio:"Não",Regra:"Nomes das testemunhas de prova emprestada, separados por ;",Exemplo:"João Pereira"},{Aba:"Por Processo",Campo:"Classificacao_Final",Tipo:"texto",Obrigatorio:"Não",Regra:"Classificação de risco (Risco Alto, Risco Médio, Risco Baixo)",Exemplo:"Risco Alto"},{Aba:"Por Processo",Campo:"Insight_Estrategico",Tipo:"texto",Obrigatorio:"Não",Regra:"Resumo dos principais achados",Exemplo:"Triangulação + prova emprestada"},{Aba:"Por Testemunha",Campo:"Nome_Testemunha",Tipo:"texto",Obrigatorio:"Sim",Regra:"Nome completo da testemunha",Exemplo:"João Pereira"},{Aba:"Por Testemunha",Campo:"Qtd_Depoimentos",Tipo:"número",Obrigatorio:"Sim",Regra:"Quantidade total de depoimentos",Exemplo:"12"},{Aba:"Por Testemunha",Campo:"CNJs_Como_Testemunha",Tipo:"lista",Obrigatorio:"Sim",Regra:"Lista de CNJs separados por ;",Exemplo:`${Ae[0]}; ${Ae[9]}`},{Aba:"Por Testemunha",Campo:"Ja_Foi_Reclamante",Tipo:"boolean",Obrigatorio:"Não",Regra:"true/false",Exemplo:"false"},{Aba:"Por Testemunha",Campo:"CNJs_Como_Reclamante",Tipo:"lista",Obrigatorio:"Não",Regra:"CNJs onde foi reclamante, separados por ; ou — se vazio",Exemplo:"—"},{Aba:"Por Testemunha",Campo:"Foi_Testemunha_Ativo",Tipo:"boolean",Obrigatorio:"Não",Regra:"true/false",Exemplo:"true"},{Aba:"Por Testemunha",Campo:"Foi_Testemunha_Passivo",Tipo:"boolean",Obrigatorio:"Não",Regra:"true/false",Exemplo:"false"},{Aba:"Por Testemunha",Campo:"CNJs_Passivo",Tipo:"lista",Obrigatorio:"Não",Regra:"CNJs onde foi testemunha do polo passivo",Exemplo:"—"},{Aba:"Por Testemunha",Campo:"Foi_Ambos_Polos",Tipo:"boolean",Obrigatorio:"Não",Regra:"true/false",Exemplo:"false"},{Aba:"Por Testemunha",Campo:"Participou_Troca_Favor",Tipo:"boolean",Obrigatorio:"Não",Regra:"true/false",Exemplo:"true"},{Aba:"Por Testemunha",Campo:"CNJs_Troca_Favor",Tipo:"lista",Obrigatorio:"Não",Regra:"Padrão CNJ_A↔CNJ_B ou lista separada por ;",Exemplo:`${Ae[4]}↔${Ae[5]}`},{Aba:"Por Testemunha",Campo:"Participou_Triangulacao",Tipo:"boolean",Obrigatorio:"Não",Regra:"true/false",Exemplo:"true"},{Aba:"Por Testemunha",Campo:"CNJs_Triangulacao",Tipo:"lista",Obrigatorio:"Não",Regra:"CNJs da triangulação, separados por ;",Exemplo:`${Ae[1]}; ${Ae[2]}; ${Ae[3]}`},{Aba:"Por Testemunha",Campo:"E_Prova_Emprestada",Tipo:"boolean",Obrigatorio:"Não",Regra:"true/false",Exemplo:"true"},{Aba:"Por Testemunha",Campo:"Classificacao",Tipo:"texto",Obrigatorio:"Não",Regra:"ALTA, MÉDIA, BAIXA",Exemplo:"ALTA"},{Aba:"Por Testemunha",Campo:"Classificacao_Estrategica",Tipo:"texto",Obrigatorio:"Não",Regra:"CRÍTICO, ATENÇÃO, NORMAL",Exemplo:"CRÍTICO"}];function Te(s){if(!s||s.length===0)return"—";const t=s.map(a=>String(a).trim()).filter(a=>a.length>0);return t.length>0?t.join("; "):"—"}const $n=s=>({CNJ:s.cnj||"—",Status:s.status||"—",Fase:s.fase||"—",UF:s.uf||"—",Comarca:s.comarca||"—",Reclamantes:s.reclamante_limpo||"—",Advogados_Ativo:Te(s.advogados_parte_ativa||[]),Testemunhas_Ativo:Te(s.testemunhas_ativo_limpo||[]),Testemunhas_Passivo:Te(s.testemunhas_passivo_limpo||[]),Todas_Testemunhas:Te(s.todas_testemunhas||[]),Reclamante_Foi_Testemunha:s.reclamante_foi_testemunha||!1,Qtd_Reclamante_Testemunha:s.qtd_vezes_reclamante_foi_testemunha||0,CNJs_Reclamante_Testemunha:Te(s.cnjs_em_que_reclamante_foi_testemunha||[]),Reclamante_Testemunha_Polo_Passivo:s.reclamante_testemunha_polo_passivo||!1,CNJs_Passivo:Te(s.cnjs_passivo||[]),Triangulacao_Confirmada:s.triangulacao_confirmada||!1,Desenho_Triangulacao:s.desenho_triangulacao||"—",CNJs_Triangulacao:Te(s.cnjs_triangulacao||[]),Contem_Prova_Emprestada:s.contem_prova_emprestada||!1,Testemunhas_Prova_Emprestada:Te(s.testemunhas_prova_emprestada||[]),Classificacao_Final:s.classificacao_final||"—",Insight_Estrategico:s.insight_estrategico||"—"}),Mn=s=>({Nome_Testemunha:s.nome_testemunha,Qtd_Depoimentos:s.qtd_depoimentos||0,CNJs_Como_Testemunha:Te(s.cnjs_como_testemunha||[]),Ja_Foi_Reclamante:s.ja_foi_reclamante||!1,CNJs_Como_Reclamante:Te(s.cnjs_como_reclamante||[]),Foi_Testemunha_Ativo:s.foi_testemunha_ativo||!1,Foi_Testemunha_Passivo:s.foi_testemunha_passivo||!1,CNJs_Passivo:Te(s.cnjs_passivo||[]),Foi_Ambos_Polos:s.foi_testemunha_em_ambos_polos||!1,Participou_Troca_Favor:s.participou_troca_favor||!1,CNJs_Troca_Favor:Te(s.cnjs_troca_favor||[]),Participou_Triangulacao:s.participou_triangulacao||!1,CNJs_Triangulacao:Te(s.cnjs_triangulacao||[]),E_Prova_Emprestada:s.e_prova_emprestada||!1,Classificacao:s.classificacao||"—",Classificacao_Estrategica:s.classificacao_estrategica||"—"}),Ln=s=>{if(!s)return"";const t=s.replace(/\D/g,"");return t.length===11?t.replace(/(\d{3})\d{6}(\d{2})/,"$1******$2"):t.length>=3?t.substring(0,2)+"*".repeat(Math.max(1,t.length-4))+t.slice(-2):"*".repeat(s.length)},qn=s=>{if(!s)return"";const t=s.replace(/\D/g,"");return t.length===14?t.replace(/(\d{2})\d{9}(\d{4})/,"$1*********$2"):t.length>=6?t.substring(0,2)+"*".repeat(Math.max(1,t.length-6))+t.slice(-4):"*".repeat(s.length)},Vn=s=>{if(!s)return"";const[t,a]=s.split("@");if(!t||!a)return s;const r=Math.min(2,t.length);return`${t.substring(0,r)+"*".repeat(Math.max(1,t.length-r))}@${a}`},zn=s=>{if(!s)return"";const t=s.replace(/\D/g,"");return t.length>=8?t.length===11?t.replace(/(\d{2})(\d{1})\d{4}(\d{2})/,"($1) $2****-**$3"):t.length===10?t.replace(/(\d{2})\d{4}(\d{2})/,"($1) ****-**$2"):t.substring(0,2)+"*".repeat(t.length-4)+t.slice(-2):"*".repeat(s.length)},Bn=s=>{if(!s)return"";const t=s.replace(/\D/g,"");return t.length>=4?s.replace(/\d/g,(a,r,o)=>{const n=o.substring(0,r+1).replace(/\D/g,"").length-1;return n===0||n===t.length-1?a:"*"}):s.replace(/\d/g,"*")},as=s=>{if(!s)return"";let t=s;return t=t.replace(/\b\d{3}\.?\d{3}\.?\d{3}-?\d{2}\b/g,a=>Ln(a)),t=t.replace(/\b\d{2}\.?\d{3}\.?\d{3}\/?\d{4}-?\d{2}\b/g,a=>qn(a)),t=t.replace(/\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b/g,a=>Vn(a)),t=t.replace(/\(\d{2}\)?\s*\d{4,5}-?\d{4}\b/g,a=>zn(a)),t=t.replace(/\bOAB\/?\w{2}\s*\d+/gi,a=>Bn(a)),t},Un=(s,t={})=>{const{filename:a=`processos-${new Date().toISOString().split("T")[0]}.csv`,maskPII:r=!1,selectedOnly:o=!1,selectedIds:n=[]}=t;let i=s;o&&n.length>0&&(i=s.filter(y=>n.includes(y.cnj)));const d=i.map(y=>{const S=$n(y);return r?{...S,Reclamantes:as(S.Reclamantes),Todas_Testemunhas:as(S.Todas_Testemunhas),Insight_Estrategico:as(S.Insight_Estrategico)}:S}),m="\uFEFF"+tr.unparse(d,{delimiter:",",header:!0}),v=new Blob([m],{type:"text/csv;charset=utf-8;"}),g=document.createElement("a");if(g.download!==void 0){const y=URL.createObjectURL(v);g.setAttribute("href",y),g.setAttribute("download",a),g.style.visibility="hidden",document.body.appendChild(g),g.click(),document.body.removeChild(g)}return d.length},Jn=(s,t={})=>{const{filename:a=`testemunhas-${new Date().toISOString().split("T")[0]}.csv`,maskPII:r=!1,selectedOnly:o=!1,selectedIds:n=[]}=t;let i=s;o&&n.length>0&&(i=s.filter(y=>n.includes(y.nome_testemunha)));const d=i.map(y=>{const S=Mn(y);return r?{...S,Nome_Testemunha:as(S.Nome_Testemunha),CNJs_Como_Testemunha:as(S.CNJs_Como_Testemunha),CNJs_Como_Reclamante:as(S.CNJs_Como_Reclamante)}:S}),m="\uFEFF"+tr.unparse(d,{delimiter:",",header:!0}),v=new Blob([m],{type:"text/csv;charset=utf-8;"}),g=document.createElement("a");if(g.download!==void 0){const y=URL.createObjectURL(v);g.setAttribute("href",y),g.setAttribute("download",a),g.style.visibility="hidden",document.body.appendChild(g),g.click(),document.body.removeChild(g)}return d.length},Hn=(s,t=!0)=>{const r=s*(t?500:350);return r<1024?`${r} bytes`:r<1024*1024?`${(r/1024).toFixed(1)} KB`:`${(r/(1024*1024)).toFixed(1)} MB`},Kn=(s,t=!1)=>s===0?{isValid:!1,message:t?"Nenhum registro selecionado para exportação.":"Nenhum registro encontrado para exportação.",maxRecords:5e3}:s>5e3?{isValid:!1,message:`Limite de exportação excedido. Máximo permitido: ${5e3.toLocaleString()} registros. ${t?"Selecione menos registros":"Aplique filtros para reduzir o resultado"}.`,maxRecords:5e3}:{isValid:!0,maxRecords:5e3},Gn=({data:s,fileName:t,disabled:a=!1})=>{const[r,o]=x.useState(!1),n=A(en),i=v=>v.length>0&&"cnj"in v[0]&&"reclamante_limpo"in v[0],d=async()=>{o(!0);try{const v=s.length,g=Kn(v,!1);if(!g.isValid){Os.error("Erro na exportação",{description:g.message});return}let y=0;const S=i(s)?"processos.csv":"testemunhas.csv";if(i(s)){const X=s.map(p=>({cnj:p.cnj,status:p.status||null,uf:p.uf||null,comarca:p.comarca||null,fase:p.fase||null,reclamante_limpo:p.reclamante_limpo||null,advogados_parte_ativa:p.advogados_parte_ativa||null,testemunhas_ativo_limpo:p.testemunhas_ativo_limpo||null,testemunhas_passivo_limpo:p.testemunhas_passivo_limpo||null,todas_testemunhas:p.todas_testemunhas||null,reclamante_foi_testemunha:p.reclamante_foi_testemunha||null,qtd_vezes_reclamante_foi_testemunha:p.qtd_vezes_reclamante_foi_testemunha||null,cnjs_em_que_reclamante_foi_testemunha:p.cnjs_em_que_reclamante_foi_testemunha||null,reclamante_testemunha_polo_passivo:p.reclamante_testemunha_polo_passivo||null,cnjs_passivo:p.cnjs_passivo||null,troca_direta:p.troca_direta||null,desenho_troca_direta:p.desenho_troca_direta||null,cnjs_troca_direta:p.cnjs_troca_direta||null,triangulacao_confirmada:p.triangulacao_confirmada||null,desenho_triangulacao:p.desenho_triangulacao||null,cnjs_triangulacao:p.cnjs_triangulacao||null,testemunha_do_reclamante_ja_foi_testemunha_antes:p.testemunha_do_reclamante_ja_foi_testemunha_antes||null,qtd_total_depos_unicos:p.qtd_total_depos_unicos||null,cnjs_depos_unicos:p.cnjs_depos_unicos||null,contem_prova_emprestada:p.contem_prova_emprestada||null,testemunhas_prova_emprestada:p.testemunhas_prova_emprestada||null,classificacao_final:p.classificacao_final||null,insight_estrategico:p.insight_estrategico||null,org_id:p.org_id||null,created_at:p.created_at||new Date().toISOString(),updated_at:p.updated_at||new Date().toISOString()}));y=Un(X,{filename:t||S,maskPII:n,selectedOnly:!1,selectedIds:[]})}else{const X=s.map(p=>({nome_testemunha:p.nome_testemunha??"",qtd_depoimentos:p.qtd_depoimentos??0,foi_testemunha_em_ambos_polos:p.foi_testemunha_em_ambos_polos??!1,ja_foi_reclamante:p.ja_foi_reclamante??!1,participou_triangulacao:p.participou_triangulacao??!1,participou_troca_favor:p.participou_troca_favor??!1,classificacao:p.classificacao??null,classificacao_estrategica:p.classificacao_estrategica??null,cnjs_como_testemunha:p.cnjs_como_testemunha??null,cnjs_como_reclamante:p.cnjs_como_reclamante??null,foi_testemunha_ativo:p.foi_testemunha_ativo??null,cnjs_ativo:p.cnjs_ativo??null,foi_testemunha_passivo:p.foi_testemunha_passivo??null,cnjs_passivo:p.cnjs_passivo??null,cnjs_troca_favor:p.cnjs_troca_favor??null,cnjs_triangulacao:p.cnjs_triangulacao??null,e_prova_emprestada:p.e_prova_emprestada??null,org_id:p.org_id??null,created_at:p.created_at??new Date().toISOString(),updated_at:p.updated_at??new Date().toISOString()}));y=Jn(X,{filename:t||S,maskPII:n,selectedOnly:!1,selectedIds:[]})}Os.success("Exportação concluída!",{description:`${y} registros exportados com sucesso.`})}catch(v){console.error("Export error:",v),Os.error("Erro na exportação",{description:"Não foi possível exportar os dados. Tente novamente."})}finally{o(!1)}},m=(()=>{const v=Math.min(s.length,5e3),g=i(s);return{count:v,size:Hn(v,g)}})();return e.jsxs(ps,{children:[e.jsx(fs,{asChild:!0,children:e.jsxs(D,{variant:"outline",disabled:a||r||s.length===0,className:"gap-2","aria-label":"Exportar dados como CSV",children:[r?e.jsx(os,{className:"h-4 w-4 animate-spin","aria-hidden":"true"}):e.jsx(xa,{className:"h-4 w-4","aria-hidden":"true"}),"Exportar CSV"]})}),e.jsxs(ls,{align:"end",className:"w-56",children:[e.jsx("div",{className:"px-3 py-2 text-xs text-muted-foreground",children:e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsx(Xs,{className:"h-3 w-3","aria-hidden":"true"}),"Exportar como CSV"]})}),e.jsx(Hs,{}),e.jsx(Xe,{onClick:d,disabled:r,children:e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Todos os registros"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:m.count.toLocaleString()})]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:m.size})]})}),s.length>5e3&&e.jsxs(e.Fragment,{children:[e.jsx(Hs,{}),e.jsx("div",{className:"px-3 py-2 text-xs text-warning",children:"⚠️ Máximo de 5.000 registros por exportação"})]})]})]})};function Ws(s,t){const[a,r]=x.useState(s);return x.useEffect(()=>{const o=setTimeout(()=>{r(s)},t);return()=>{clearTimeout(o)}},[s,t]),a}const Es=s=>{if(!/^\d{4}-\d{2}-\d{2}$/.test(s))return!1;const t=new Date(s);return!isNaN(t.valueOf())},Is="mapa-testemunhas-processos",$s="mapa-testemunhas-testemunhas",ur=is({page:Re.number().int().min(1).default(1),limit:Re.number().int().min(1).max(1e3).default(20)}),Qn=is({search:Ee().trim().optional(),data_inicio:Ee().trim().optional().refine(s=>!s||Es(s),{message:"data inválida"}),data_fim:Ee().trim().optional().refine(s=>!s||Es(s),{message:"data inválida"}),uf:Ee().trim().optional(),status:Ee().trim().optional(),fase:Ee().trim().optional(),testemunha:Ee().trim().optional(),qtd_depoimentos_min:Re.number().int().optional(),qtd_depoimentos_max:Re.number().int().optional(),tem_triangulacao:Re.boolean().optional(),tem_troca:Re.boolean().optional(),tem_prova_emprestada:Re.boolean().optional()}).superRefine((s,t)=>{s.data_inicio&&s.data_fim&&new Date(s.data_inicio)>new Date(s.data_fim)&&t.addIssue({code:ys.custom,message:"data_inicio deve ser menor ou igual a data_fim",path:["data_inicio"]}),s.qtd_depoimentos_min!==void 0&&s.qtd_depoimentos_max!==void 0&&s.qtd_depoimentos_min>s.qtd_depoimentos_max&&t.addIssue({code:ys.custom,message:"qtd_depoimentos_min deve ser menor ou igual a qtd_depoimentos_max",path:["qtd_depoimentos_min"]})}).default({}),Wn=is({paginacao:ur.default({page:1,limit:20}),filtros:Qn}).default(()=>({paginacao:{page:1,limit:20},filtros:{}})),Zn=is({nome:Ee().trim().optional(),documento:Ee().trim().optional(),search:Ee().trim().optional(),data_inicio:Ee().trim().optional().refine(s=>!s||Es(s),{message:"data inválida"}),data_fim:Ee().trim().optional().refine(s=>!s||Es(s),{message:"data inválida"}),ambos_polos:Re.boolean().optional(),ja_foi_reclamante:Re.boolean().optional(),qtd_depoimentos_min:Re.number().int().optional(),qtd_depoimentos_max:Re.number().int().optional(),tem_triangulacao:Re.boolean().optional(),tem_troca:Re.boolean().optional()}).superRefine((s,t)=>{s.data_inicio&&s.data_fim&&new Date(s.data_inicio)>new Date(s.data_fim)&&t.addIssue({code:ys.custom,message:"data_inicio deve ser menor ou igual a data_fim",path:["data_inicio"]}),s.qtd_depoimentos_min!==void 0&&s.qtd_depoimentos_max!==void 0&&s.qtd_depoimentos_min>s.qtd_depoimentos_max&&t.addIssue({code:ys.custom,message:"qtd_depoimentos_min deve ser menor ou igual a qtd_depoimentos_max",path:["qtd_depoimentos_min"]})}).default({}),Xn=is({paginacao:ur.default({page:1,limit:20}),filtros:Zn}).default(()=>({paginacao:{page:1,limit:20},filtros:{}}));is({items:vo(bo()),page:Fs().int().min(1),limit:Fs().int().min(1).max(1e3),total:Fs().int().nonnegative(),next_cursor:jo().default(null),requestId:Ee()});const Ms="assistjur_debug_mode",$={isEnabled(){return typeof window>"u"?!1:typeof localStorage<"u"&&localStorage.getItem(Ms)==="true"},enable(){typeof window>"u"||typeof localStorage>"u"||(localStorage.setItem(Ms,"true"),console.log("🐛 Debug mode ATIVADO"))},disable(){typeof window>"u"||typeof localStorage>"u"||(localStorage.setItem(Ms,"false"),console.log("🐛 Debug mode DESATIVADO"))},toggle(){const s=!this.isEnabled();return s?this.enable():this.disable(),s},log(s,...t){this.isEnabled()&&console.log(`[DEBUG] ${s}`,...t)},warn(s,...t){this.isEnabled()&&console.warn(`[DEBUG] ${s}`,...t)},error(s,...t){this.isEnabled()?console.error(`[DEBUG] ${s}`,...t):console.error(s,...t)}};function hr(s){const t={temTriangulacao:"tem_triangulacao",temTroca:"tem_troca",temProvaEmprestada:"tem_prova_emprestada",qtdDeposMin:"qtd_depoimentos_min",qtdDeposMax:"qtd_depoimentos_max",ambosPolos:"ambos_polos",jaFoiReclamante:"ja_foi_reclamante"};return Object.fromEntries(Object.entries(s??{}).filter(([a,r])=>!(r==null||typeof r=="string"&&r.trim()==="")).map(([a,r])=>[t[a]??a,r]))}async function xr(s,t=3,a=1e3){let r=null;for(let o=0;o<t;o++)try{return await s()}catch(n){if(r=n,o<t-1){const i=a*Math.pow(2,o);console.warn(`Tentativa ${o+1} falhou, aguardando ${i}ms...`),await new Promise(d=>setTimeout(d,i))}}throw r}function Ct(s,t){console.warn("⚠️ MODO FALLBACK: Usando dados mock para testemunhas (API não disponível)"),$.isEnabled()&&console.table({mode:"FALLBACK",type:"TESTEMUNHAS",page:s,limit:t});const a=[{nome_testemunha:"Maria Silva Santos",qtd_depoimentos:8,foi_testemunha_em_ambos_polos:!0,ja_foi_reclamante:!0,participou_triangulacao:!0,participou_troca_favor:!0,classificacao:"ALTO_RISCO"},{nome_testemunha:"João Paulo Oliveira",qtd_depoimentos:5,foi_testemunha_em_ambos_polos:!1,ja_foi_reclamante:!1,participou_triangulacao:!0,participou_troca_favor:!1,classificacao:"MEDIO_RISCO"},{nome_testemunha:"Ana Costa Ferreira",qtd_depoimentos:12,foi_testemunha_em_ambos_polos:!0,ja_foi_reclamante:!0,participou_triangulacao:!1,participou_troca_favor:!0,classificacao:"ALTO_RISCO"}],r=(s-1)*t,o=r+t;return{data:a.slice(r,o),total:a.length}}async function Yn(s){const t=Math.random().toString(36).substring(7),a=s.filters?.search;$.log(`🔍 [${t}] fetchTestemunhas iniciado`,{page:s.page,limit:s.limit,filters:s.filters,searchTerm:a,timestamp:new Date().toISOString()});try{const{data:r}=await Fe.auth.getSession();if(!r?.session?.access_token)return $.error(`❌ [${t}] Usuário não autenticado`),Ct(s.page||1,s.limit||20);$.log(`✅ [${t}] Sessão válida`,{userId:r.session.user?.id,hasToken:!!r.session.access_token});const o=hr(s.filters??{}),n={paginacao:{page:s.page||1,limit:s.limit||20},filtros:o};a&&console.log(`🎯 [${t}] SEARCH DETECTADO:`,{searchTerm:a,filtrosEnviados:n.filtros,hasSearchInFiltros:"search"in n.filtros||"nome"in n.filtros}),$.log(`📦 [${t}] Payload preparado`,n),Xn.parse(n);const i=await xr(async()=>{$.log(`🚀 [${t}] ===== CHAMANDO EDGE FUNCTION =====`),$.log(`🚀 [${t}] Function: ${$s}`),$.log(`🚀 [${t}] URL: <<MANTER>>/functions/v1/${$s}`),$.log(`🚀 [${t}] Body:`,n),$.log(`🚀 [${t}] Auth Token presente: ${!!r.session.access_token}`);const d=performance.now(),{data:u,error:m}=await Fe.functions.invoke($s,{body:n}),v=performance.now()-d;if($.log(`⏱️ [${t}] Tempo de resposta: ${v.toFixed(2)}ms`),m)throw $.error(`❌ [${t}] ===== ERRO NA EDGE FUNCTION =====`),$.error(`❌ [${t}] Error object:`,m),$.error(`❌ [${t}] Error message:`,m.message),$.error(`❌ [${t}] Error context:`,m.context),new Error(`Erro ao buscar testemunhas: ${m.message}`);if(!u||!u.items)return $.log(`✅ [${t}] ===== DATASET VAZIO (VÁLIDO) =====`),$.log(`✅ [${t}] Empty dataset (0 records) - this is valid, not an error`),{data:[],total:0};$.log(`✅ [${t}] ===== RESPOSTA RECEBIDA COM SUCESSO =====`),$.log(`✅ [${t}] Data structure:`,{hasData:!!u,dataKeys:u?Object.keys(u):[],itemsCount:u.items?.length||0,total:u.total,hasNextCursor:!!u.next_cursor});const g=u.items.map(y=>({nome_testemunha:y.nome_testemunha||"",qtd_depoimentos:Number(y.qtd_depoimentos)||0,foi_testemunha_em_ambos_polos:!!y.foi_testemunha_em_ambos_polos,ja_foi_reclamante:!!y.ja_foi_reclamante,participou_triangulacao:!!y.participou_triangulacao,participou_troca_favor:!!y.participou_troca_favor,classificacao:y.classificacao||null,classificacao_estrategica:y.classificacao_estrategica||null,cnjs_como_testemunha:y.cnjs_como_testemunha||null,cnjs_como_reclamante:y.cnjs_como_reclamante||null,foi_testemunha_ativo:!!y.foi_testemunha_ativo,cnjs_ativo:y.cnjs_ativo||null,foi_testemunha_passivo:!!y.foi_testemunha_passivo,cnjs_passivo:y.cnjs_passivo||null,cnjs_troca_favor:y.cnjs_troca_favor||null,cnjs_triangulacao:y.cnjs_triangulacao||null,e_prova_emprestada:!!y.e_prova_emprestada,org_id:y.org_id||null,created_at:y.created_at,updated_at:y.updated_at}));return $.log(`✅ [${t}] Transformed ${g.length} items`),g.length>0&&$.log(`✅ [${t}] Sample item:`,g[0]),{data:g,total:u.total||0}});return $.log(`🎉 [${t}] fetchTestemunhas concluído com sucesso`),i}catch(r){return $.error(`💥 [${t}] Erro fatal ao buscar testemunhas:`,r),{...Ct(s.page||1,s.limit||20),error:r instanceof Error?r.message:"Erro desconhecido ao buscar testemunhas"}}}function St(s,t){console.warn("⚠️ MODO FALLBACK: Usando dados mock para processos (API não disponível)"),$.isEnabled()&&console.table({mode:"FALLBACK",type:"PROCESSOS",page:s,limit:t});const a=[{cnj:"0001234-56.2024.5.02.0001",reclamante:"EMPRESA XYZ LTDA",reclamada:"FORNECEDOR ABC S.A.",testemunhas_ativo:["Maria Silva Santos","João Paulo Oliveira"],testemunhas_passivo:["Ana Costa Ferreira"],tem_triangulacao:!0,tem_troca:!0,tem_prova_emprestada:!1,comarca:"São Paulo",vara:"1ª Vara do Trabalho"},{cnj:"0007890-12.2024.5.02.0002",reclamante:"TECH SOLUTIONS LTDA",reclamada:"CLIENTE SERVIÇOS S.A.",testemunhas_ativo:["Ana Costa Ferreira"],testemunhas_passivo:["Maria Silva Santos","João Paulo Oliveira"],tem_triangulacao:!1,tem_troca:!0,tem_prova_emprestada:!0,comarca:"Rio de Janeiro",vara:"3ª Vara do Trabalho"}],r=(s-1)*t,o=r+t;return{data:a.slice(r,o),total:a.length}}async function ei(s){const t=Math.random().toString(36).substring(7);$.log(`🔍 [${t}] fetchProcessos iniciado`,{page:s.page,limit:s.limit,filters:s.filters,timestamp:new Date().toISOString()});try{const{data:a}=await Fe.auth.getSession();if(!a?.session?.access_token)return $.error(`❌ [${t}] Usuário não autenticado`),St(s.page||1,s.limit||20);$.log(`✅ [${t}] Sessão válida`,{userId:a.session.user?.id,hasToken:!!a.session.access_token});const r=hr(s.filters),o={paginacao:{page:s.page||1,limit:s.limit||20},filtros:r};$.log(`📦 [${t}] Payload preparado`,o),Wn.parse(o);const n=await xr(async()=>{$.log(`🚀 [${t}] ===== CHAMANDO EDGE FUNCTION =====`),$.log(`🚀 [${t}] Function: ${Is}`),$.log(`🚀 [${t}] URL: <<MANTER>>/functions/v1/${Is}`),$.log(`🚀 [${t}] Body:`,o),$.log(`🚀 [${t}] Auth Token presente: ${!!a.session.access_token}`);const i=performance.now(),{data:d,error:u}=await Fe.functions.invoke(Is,{body:o}),m=performance.now()-i;if($.log(`⏱️ [${t}] Tempo de resposta: ${m.toFixed(2)}ms`),u)throw $.error(`❌ [${t}] ===== ERRO NA EDGE FUNCTION =====`),$.error(`❌ [${t}] Error object:`,u),$.error(`❌ [${t}] Error message:`,u.message),$.error(`❌ [${t}] Error context:`,u.context),new Error(`Erro ao buscar processos: ${u.message}`);if(!d||!d.items)return $.log(`✅ [${t}] ===== DATASET VAZIO (VÁLIDO) =====`),$.log(`✅ [${t}] Empty dataset (0 records) - this is valid, not an error`),{data:[],total:0};$.log(`✅ [${t}] ===== RESPOSTA RECEBIDA COM SUCESSO =====`),$.log(`✅ [${t}] Data structure:`,{hasData:!!d,dataKeys:d?Object.keys(d):[],itemsCount:d.items?.length||0,total:d.total,hasNextCursor:!!d.next_cursor});const v=Array.isArray(d.items)?d.items:[],g=isFinite(d.total)?d.total:v.length;return{data:v,total:g}});return $.log(`🎉 [${t}] fetchProcessos concluído com sucesso`),n}catch(a){return $.error(`💥 [${t}] Erro fatal ao buscar processos:`,a),{...St(s.page||1,s.limit||20),error:a instanceof Error?a.message:"Erro desconhecido ao buscar processos"}}}function Ls(s,t){if(!s||typeof s!="object")return 0;const r=t.filter(d=>{const u=s[d];return u!=null&&u!==""&&u!=="nan"}).length/t.length;let o=0;return o=["cnj","reclamante","status","classificacao"].filter(d=>t.includes(d)&&s[d]).length*.05,Math.min(1,r+o)}function si(s){return!s||s==="null"||s==="undefined"?"Em andamento":s}function ti(s){return!s||s==="null"||s==="undefined"?"Normal":s}function ai(s){if(s.situacao)return{status:s.situacao,inferido:!1};if(s.categoria)return{status:s.categoria,inferido:!1};const t=(s.classificacao_final||"").toLowerCase();if(t.includes("descartar"))return{status:"Arquivado",inferido:!0};if(t.includes("conhecer"))return{status:"Aguardando movimentação",inferido:!0};const a=s.quantidade_movimentos||0,r=s.quantidade_documentos||0;return a===0&&r===0?{status:"Aguardando distribuição",inferido:!0}:a>10?{status:"Em fase instrutória",inferido:!0}:{status:"Em andamento",inferido:!0}}function Tt(s){if(!s)return"Normal";const t=String(s).replace(/[\[\]]/g,"").trim().toLowerCase();return t.charAt(0).toUpperCase()+t.slice(1)}function qs(s,t,a){if(t!=null)return t>=85?"critico":t>=70?"alto":t>=50?"medio":"baixo";if(a){const o=a.toLowerCase();if(o.includes("triangulação")||o.includes("troca de favor"))return"critico";if(o.includes("já foi testemunha")||o.includes("ambos polos"))return"alto";if(o.includes("prova emprestada"))return"medio"}const r=ti(s).toLowerCase();return r.includes("crítico")||r.includes("alto")?"alto":r.includes("médio")||r.includes("medio")?"medio":"baixo"}const ri=s=>typeof s=="object"&&s!==null&&("status"in s||"message"in s);function oi(){const{toast:s}=Pe(),{error:t}=Io(),{chatStatus:a,chatResult:r,agentOnline:o,selectedProcesso:n,selectedTestemunha:i,setChatStatus:d,setChatResult:u,addChatMessage:m,updateChatMessage:v,setAgentOnline:g}=A(),y=x.useCallback(p=>{switch(p){case"processo":return"process_analysis";case"testemunha":return"witness_analysis";case"reclamante":return"claimant_analysis";default:return"risk_analysis"}},[]),S=x.useCallback((p,G)=>[{type:"executive",title:"📌 Resumo Executivo",icon:"Sparkles",data:{cnj:G.match(/\d{7}-\d{2}\.\d{4}\.\d{1}\.\d{2}\.\d{4}/)?G:"1000000-09.2024.5.02.1000",reclamante:p==="reclamante"?G:"Maria Silva Santos",reu:"Empresa ABC Ltda",status:"Em andamento",observacoes:"Processo com potencial risco de triangulação detectado.",riscoNivel:"alto",confianca:.85,alerta:"Testemunhas conectadas em múltiplos processos"},meta:{status:"Em andamento",observacoes:"Processo com potencial risco de triangulação detectado.",riscoNivel:"alto",confidence:.85},citations:[{source:"por_processo",ref:"1000000-09.2024.5.02.1000"},{source:"por_testemunha",ref:"João Santos"}]},{type:"details",title:"📋 Análise Detalhada",icon:"FileText",data:{secoes:[{titulo:"Vínculos Identificados",conteudo:"Foram identificadas 3 testemunhas que aparecem em processos similares.",evidencias:["João Santos: 5 processos","Maria Oliveira: 3 processos"]},{titulo:"Padrões Temporais",conteudo:"Concentração de depoimentos entre Jan-Mar 2024.",evidencias:["Janeiro: 8 depoimentos","Fevereiro: 12 depoimentos"]}],textoOriginal:G}},{type:"alerts",title:"⚠️ Alertas Estratégicos",icon:"AlertTriangle",data:{suspiciousPatterns:["Triangulação detectada entre 3 testemunhas","Depoimentos com narrativas similares","Mesmo advogado em processos conexos"]}},{type:"strategies",title:"🎯 Polo Ativo & Estratégias",icon:"Target",data:{estrategias:[{texto:"Questionar vínculos entre testemunhas",prioridade:"ALTA"},{texto:"Investigar histórico de depoimentos",prioridade:"MÉDIA"}],proximosPassos:["Solicitar certidões de processos anteriores","Preparar questionário específico para audiência"]}}],[]);return{runAnalysis:x.useCallback(async(p,G)=>{if(!p.trim()){s({title:"Campo obrigatório",description:"Digite uma consulta para executar a análise.",variant:"destructive"});return}if(!o){s({title:"Agente indisponível",description:"O assistente está temporariamente em manutenção.",variant:"destructive"});return}d("loading"),s({title:"Análise iniciada",description:"Processando sua consulta..."});const ae=m({role:"assistant",content:"",blocks:[]});try{const T={message:p,queryType:y(G)};if(n&&(G==="processo"||p.match(/\d{7}-\d{2}\.\d{4}\.\d\.\d{2}\.\d{4}/))){const l=ai(n),c=Tt(n.classificacao_final),h=qs(n.classificacao_final,n.score_risco,n.insight_estrategico),_=Ls(n,["cnj","reclamante_nome","reu_nome","status","classificacao_final"]);T.context={type:"processo",data:{cnj:n.cnj||n.numero_cnj,reclamante:n.reclamante_nome,reu:n.reu_nome,status:l.status,statusInferido:l.inferido,fase:n.fase,uf:n.uf,comarca:n.comarca,testemunhas_ativo:n.testemunhas_ativo,testemunhas_passivo:n.testemunhas_passivo,classificacao:c,classificacao_final:n.classificacao_final,score_risco:n.score_risco,insight_estrategico:n.insight_estrategico,riscoNivel:h},meta:{status:l.status,statusInferido:l.inferido,classificacao:c,riscoNivel:h,confidence:_}}}else if(i&&G==="testemunha"){const l=Tt(i.classificacao_final),c=qs(i.classificacao_final,i.score_risco,null),h=Ls(i,["nome_testemunha","qtd_depoimentos","classificacao_final"]);T.context={type:"testemunha",data:{nome:i.nome_testemunha,qtd_depoimentos:i.qtd_depoimentos,processos_cnj:i.processos_cnj,foi_testemunha_em_ambos_polos:i.foi_testemunha_em_ambos_polos,ja_foi_reclamante:i.ja_foi_reclamante,classificacao_final:l,score_risco:i.score_risco},meta:{status:i.foi_testemunha_em_ambos_polos?"Ativo em ambos polos":"Normal",statusInferido:!1,classificacao:l,riscoNivel:c,confidence:h}}}console.log("🚀 [PAYLOAD] Enviando para chat-legal:",{message:T.message,queryType:T.queryType,hasContext:!!T.context,contextType:T.context?.type,hasMeta:!!T.context?.meta,meta:T.context?.meta,dataKeys:T.context?.data?Object.keys(T.context.data):[]});const{data:Q,error:me}=await Fe.functions.invoke("chat-legal",{body:T});if(me){if(ri(me)&&(me.status===402||me.message?.includes("Workspace out of credits"))){const l=`https://${No()}.functions.supabase.co/chat-legal`;console.warn(`Lovable API ${me.status} at ${l}`),t("Limite de créditos atingido","As funções de chat/assistente estão temporariamente indisponíveis. Tente novamente mais tarde.",{duration:void 0}),g(!1),v(ae,{content:"Créditos esgotados. Função indisponível."}),d("error");return}throw me}const ee=Q?.data||Q?.content||"";console.log("🔍 [FRONTEND] Raw AI Response type:",typeof ee),console.log("🔍 [FRONTEND] Response length:",ee.length),console.log("🔍 [FRONTEND] First 300 chars:",ee.substring(0,300));let W=[];try{const l=JSON.parse(ee);console.log("✅ [FRONTEND] Parsed JSON, type:",typeof l),l.blocks&&Array.isArray(l.blocks)?(W=l.blocks,console.log("✅ [FRONTEND] Extracted blocks array with",W.length,"items")):Array.isArray(l)&&l.length>0?(W=l,console.log("✅ [FRONTEND] Direct array with",W.length,"blocks")):l.type?(W=[l],console.log("✅ [FRONTEND] Single block object")):console.warn("⚠️ [FRONTEND] Parsed JSON but unexpected structure:",Object.keys(l))}catch(l){console.error("❌ [FRONTEND] JSON parse failed:",l);try{const c=ee.match(/\{[\s\S]*"blocks"[\s\S]*\}/);c&&(W=JSON.parse(c[0]).blocks||[],console.log("✅ [FRONTEND] Extracted blocks from text:",W.length))}catch(c){console.error("❌ [FRONTEND] Extraction failed:",c)}}(!W||W.length===0)&&(console.log("🔧 [FRONTEND] Gerando fallback blocks para input:",p),W=[{type:"executive",title:"📊 Resumo Executivo",icon:"FileText",data:{cnj:p.match(/\d{7}-\d{2}\.\d{4}\.\d\.\d{2}\.\d{4}/)?p:"0000000-00.0000.0.00.0000",reclamante:n?.reclamante_nome||"Aguardando dados...",reu:n?.reu_nome||"Aguardando dados...",status:si(n?.status),observacoes:n?.observacoes||`Análise iniciada para: ${p.substring(0,100)}${p.length>100?"...":""}`,riscoNivel:qs(n?.classificacao_final,n?.score_risco),confianca:n?Ls(n,["cnj","reclamante_nome","reu_nome","status"]):.5,alerta:void 0,citacoes:[]}},{type:"details",title:"🔍 Análise Detalhada",icon:"Search",data:{secoes:[{titulo:"Informações Disponíveis",conteudo:`Consulta realizada: ${p}`,evidencias:[]},{titulo:"Análise",conteudo:"Aguardando processamento completo pelo sistema. Por favor, tente novamente em alguns instantes.",evidencias:[]},{titulo:"Recomendações",conteudo:"Ações sugeridas:",evidencias:["Verificar se os dados estão disponíveis no sistema","Confirmar formato da consulta (CNJ, nome, etc)","Aguardar alguns instantes e tentar novamente"]}]}}],console.log("✅ [FRONTEND] Fallback blocks gerados:",W.length));const H=W.map(l=>({...l,context:T.context,meta:T.context?.meta}));v(ae,{content:H.length>0?"Análise concluída":ee,blocks:H}),u(H),d("success"),s({title:"Análise concluída",description:`Análise ${G==="processo"?"por processo":G==="testemunha"?"por testemunha":"por reclamante"} executada com sucesso.`})}catch(T){console.error("Error in analysis:",T),v(ae,{content:"Erro ao executar análise. Tente novamente."}),d("error"),s({title:"Erro na análise",description:T instanceof Error?T.message:"Erro desconhecido ao executar análise.",variant:"destructive"})}},[o,y,S,d,u,m,v,s,t,g]),chatStatus:a,chatResult:r,agentOnline:o}}function ni(s,t="all",a=!0){const r=Ws(s,250);return Wr({queryKey:["unified-search",r,t],queryFn:async()=>{if(!r||r.length<2)return{query:r,parsed:r,filters:{},scope:t,results:[],total:0};const{data:o,error:n}=await Fe.functions.invoke("search",{body:{q:r,scope:t,limit:20}});if(n)throw n;return o},enabled:a&&r.length>=2,staleTime:3e4})}const Et={process:"Processo",witness:"Testemunha",claimant:"Reclamante",lawyer:"Advogado",comarca:"Comarca"},ii={process:"bg-blue-500/10 text-blue-700 dark:text-blue-300",witness:"bg-purple-500/10 text-purple-700 dark:text-purple-300",claimant:"bg-green-500/10 text-green-700 dark:text-green-300",lawyer:"bg-orange-500/10 text-orange-700 dark:text-orange-300",comarca:"bg-gray-500/10 text-gray-700 dark:text-gray-300"},li=[{scope:"all",label:"Tudo",icon:rs},{scope:"process",label:"Processos",icon:Me},{scope:"witness",label:"Testemunhas",icon:hs},{scope:"claimant",label:"Reclamantes",icon:_s}],ci={process:Me,witness:hs,claimant:_s,lawyer:_s,comarca:Xr};function di(){const s=x.useRef(null),[t,a]=x.useState(!1),[r,o]=x.useState("all"),[n,i]=x.useState(""),[d,u]=x.useState(!1),[m,v]=x.useState(0),g=et(),{toast:y}=Pe(),{chatKind:S,chatStatus:X,agentOnline:p,selectedProcesso:G,selectedTestemunha:ae,setChatInput:T,setChatKind:Q,setSelectedProcesso:me,setSelectedTestemunha:ee,processos:W,testemunhas:H}=A(),{runAnalysis:l}=oi(),c=n,{data:h,isLoading:_}=ni(c,r,t&&c.length>=2),C=["Digite um nome... Ex: João Silva","Busque por CNJ... Ex: 0001234-56.2024.5.02.0001","Use operadores... Ex: risco:alto uf:RS","Filtros avançados... Ex: depoimentos:>3 comarca:POA"];x.useEffect(()=>{const j=setInterval(()=>{v(E=>(E+1)%C.length)},3e3);return()=>clearInterval(j)},[]);const z=C[m];x.useEffect(()=>{/\d{7}-\d{2}\.\d{4}\.\d{1}\.\d{2}\.\d{4}/.test(n)&&(o("process"),Q("processo"))},[n,Q]),x.useEffect(()=>{n.length>=2?a(!0):a(!1)},[n]),x.useEffect(()=>{const j=E=>{E.key==="k"&&E.ctrlKey&&(E.preventDefault(),s.current?.focus())};return document.addEventListener("keydown",j),()=>document.removeEventListener("keydown",j)},[]);const re=j=>{switch(a(!1),i(j.title),T(j.title),j.type){case"process":{const E=W.find(U=>U.cnj===j.title||U.numero_cnj===j.title);E&&(me(E),y({title:"Processo selecionado",description:E.cnj||E.numero_cnj})),Q("processo"),g(`/mapa-testemunhas?tab=processos&cnj=${encodeURIComponent(j.title)}`);break}case"witness":{const E=H.find(U=>U.nome_testemunha?.toLowerCase()===j.title.toLowerCase());E&&(ee(E),y({title:"Testemunha selecionada",description:E.nome_testemunha})),Q("testemunha"),g(`/mapa-testemunhas?tab=testemunhas&nome=${encodeURIComponent(j.title)}`);break}case"claimant":{Q("reclamante"),g(`/mapa-testemunhas?tab=processos&reclamante=${encodeURIComponent(j.title)}`);break}}},ue=(j,E)=>{E.stopPropagation(),navigator.clipboard.writeText(j),y({title:"CNJ copiado",description:j})},fe=()=>{me(null),ee(null),T(""),i("")},L=G||ae,se=G?`Processo: ${G.cnj||G.numero_cnj}`:ae?`Testemunha: ${ae.nome_testemunha}`:null,k=async()=>{if(!n.trim()||b||!p)return;a(!1),T(n);const j=S||(r==="process"?"processo":r==="witness"?"testemunha":"reclamante");Q(j),await l(n.trim(),j)},ie=j=>{j.key==="Enter"&&(j.ctrlKey||j.metaKey)&&(j.preventDefault(),k())},I=h&&h.results.length>0,M=h?.isAmbiguous||!1,b=M&&n.length>=2,R=n.trim().length>0&&!b&&p;return e.jsxs("div",{className:"w-full mx-auto max-w-7xl p-6 space-y-6",children:[!d&&e.jsxs(De,{className:"border-yellow-200 bg-yellow-50 dark:bg-yellow-950/20",children:[e.jsx(qe,{className:"h-4 w-4 text-yellow-600 dark:text-yellow-500"}),e.jsxs(ke,{className:"flex items-center justify-between gap-4",children:[e.jsxs("span",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:[e.jsx("strong",{className:"font-semibold",children:"Conteúdo assistivo."})," ","Revisão humana obrigatória. Dados tratados conforme LGPD."," ",e.jsx("a",{href:"/privacy",className:"underline hover:no-underline",children:"Política de Privacidade"})]}),e.jsx(D,{variant:"ghost",size:"sm",onClick:()=>u(!0),className:"shrink-0 hover:bg-yellow-100 dark:hover:bg-yellow-900/30",children:e.jsx(We,{className:"h-4 w-4"})})]})]}),M&&h?.suggestions&&e.jsxs(De,{className:"border-blue-200 bg-blue-50 dark:bg-blue-950/20 animate-in fade-in slide-in-from-top-2 duration-300",children:[e.jsx(Ys,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"}),e.jsx(ke,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-blue-900 dark:text-blue-100",children:h.suggestions.message}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(h.suggestions.counts).map(([j,E])=>e.jsxs(q,{variant:"secondary",className:"text-xs",children:[j,": ",E]},j))})]})})]}),L&&se&&e.jsxs("div",{className:"flex items-center gap-2 bg-primary/10 border border-primary/20 rounded-lg px-4 py-3 animate-in fade-in slide-in-from-top-2 duration-300",children:[e.jsxs(q,{variant:"default",className:"gap-1.5 text-xs",children:[G&&e.jsx(Me,{className:"h-3 w-3"}),ae&&e.jsx(hs,{className:"h-3 w-3"}),"Contexto Selecionado"]}),e.jsx("span",{className:"text-sm font-medium text-foreground flex-1",children:se}),e.jsxs(D,{variant:"ghost",size:"sm",onClick:fe,className:"h-7 px-2 hover:bg-destructive/10 gap-1.5",children:[e.jsx(We,{className:"h-3 w-3"}),e.jsx("span",{className:"text-xs",children:"Limpar"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:e.jsx(rs,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Busca Inteligente Unificada"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Pesquise por processo, testemunha ou reclamante em um único lugar"})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:p?e.jsxs(e.Fragment,{children:[e.jsx($e,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Online"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Zr,{className:"h-4 w-4 text-orange-500"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Manutenção"})]})})]}),e.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:li.map(j=>{const E=j.icon;return e.jsxs(D,{variant:r===j.scope?"default":"outline",size:"sm",onClick:()=>o(j.scope),className:"gap-2 h-8 transition-all hover:scale-105",children:[e.jsx(E,{className:"h-3.5 w-3.5",strokeWidth:1.5}),j.label]},j.scope)})})]}),e.jsx("div",{className:"relative",children:e.jsxs(Na,{open:t,onOpenChange:a,children:[e.jsx(_a,{asChild:!0,children:e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-primary/20 to-primary/10 rounded-lg blur-sm group-hover:blur-md transition-all opacity-0 group-hover:opacity-100"}),e.jsxs("div",{className:"relative",children:[e.jsx(rs,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground pointer-events-none z-10"}),e.jsx(Ke,{ref:s,value:n,onChange:j=>i(j.target.value),onKeyDown:ie,placeholder:z,className:"pl-12 pr-12 h-14 text-base border-2 focus:border-primary/50 transition-all shadow-sm hover:shadow-md"}),n&&e.jsx(D,{variant:"ghost",size:"sm",onClick:()=>i(""),className:"absolute right-2 top-1/2 -translate-y-1/2 h-9 w-9 p-0 rounded-full hover:bg-destructive/10",children:e.jsx(We,{className:"h-4 w-4"})})]})]})}),e.jsx(ya,{className:"w-[--radix-popover-trigger-width] p-0",align:"start",onOpenAutoFocus:j=>j.preventDefault(),children:e.jsx(it,{children:e.jsxs(Ia,{children:[_&&e.jsx("div",{className:"flex items-center justify-center py-6",children:e.jsx(os,{className:"h-5 w-5 animate-spin text-muted-foreground"})}),!_&&I&&e.jsxs(e.Fragment,{children:[M&&h?.suggestions&&e.jsx("div",{className:"px-3 py-2 border-b bg-muted/50",children:e.jsx("p",{className:"text-xs font-medium text-foreground",children:h.suggestions.message})}),["process","witness","claimant"].map(j=>{const E=h.results.filter(w=>w.type===j);if(E.length===0)return null;const U=ci[j],O=Et[j];return e.jsx(Ma,{heading:e.jsxs("div",{className:"flex items-center justify-between w-full pr-2",children:[e.jsx("span",{children:O}),e.jsx(q,{variant:"secondary",className:"text-[10px] px-1.5 py-0",children:E.length})]}),children:E.map(w=>e.jsxs(La,{onSelect:()=>re(w),className:N("flex items-start gap-3 py-3 cursor-pointer transition-colors",M&&"hover:bg-blue-50 dark:hover:bg-blue-950/30"),children:[e.jsx("div",{className:"mt-0.5",children:e.jsx(U,{className:"h-4 w-4 text-muted-foreground"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-medium truncate",children:w.title}),e.jsx(q,{variant:"secondary",className:`text-[10px] px-1.5 py-0 ${ii[w.type]}`,children:Et[w.type]})]}),w.subtitle&&e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:w.subtitle}),w.type==="process"&&w.meta&&e.jsxs("div",{className:"flex items-center gap-2 mt-1 text-[10px] text-muted-foreground",children:[w.meta.status&&e.jsxs("span",{children:["Status: ",w.meta.status]}),w.meta.comarca&&e.jsxs("span",{children:["· ",w.meta.comarca]}),w.meta.classificacao&&e.jsx(q,{variant:"outline",className:"text-[9px] px-1 py-0",children:w.meta.classificacao})]}),w.type==="witness"&&w.meta&&e.jsxs("div",{className:"flex items-center gap-2 mt-1 text-[10px]",children:[e.jsxs("span",{className:"text-muted-foreground",children:[w.meta.depoimentos," depoimentos"]}),w.meta.ambosPoles&&e.jsx(q,{variant:"destructive",className:"text-[9px] px-1 py-0",children:"⚠ Ambos polos"}),w.meta.classificacao&&e.jsx(q,{variant:"outline",className:"text-[9px] px-1 py-0",children:w.meta.classificacao})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[w.type==="process"&&e.jsx(D,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 hover:bg-muted",onClick:Y=>ue(w.title,Y),title:"Copiar CNJ",children:e.jsx(Ze,{className:"h-3 w-3"})}),e.jsx(D,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 hover:bg-muted",title:"Abrir detalhes",children:e.jsx(Us,{className:"h-3 w-3"})})]})]},w.id))},j)})]}),!_&&!I&&n.length>=2&&e.jsx($a,{children:e.jsxs("div",{className:"text-center py-6",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Nenhum resultado encontrado."}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Tente operadores:"," ",e.jsx("code",{className:"bg-muted px-1 rounded",children:"p:"})," ",e.jsx("code",{className:"bg-muted px-1 rounded",children:"w:"})," ",e.jsx("code",{className:"bg-muted px-1 rounded",children:"uf:RS"})]})]})})]})})})]})}),e.jsxs("div",{className:"flex items-center justify-between gap-4 pt-2",children:[e.jsxs("div",{className:"flex-1 flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground bg-muted/50 px-3 py-1.5 rounded-lg",children:[e.jsx(Yr,{className:"h-3.5 w-3.5"}),e.jsxs("span",{children:[e.jsx("kbd",{className:"px-1.5 py-0.5 text-xs rounded bg-background shadow-sm",children:"Ctrl"}),e.jsx("span",{className:"mx-1",children:"+"}),e.jsx("kbd",{className:"px-1.5 py-0.5 text-xs rounded bg-background shadow-sm",children:"K"})]})]}),n.length>0&&e.jsxs("div",{className:"text-xs text-muted-foreground flex items-center gap-1.5 animate-in fade-in slide-in-from-left-2 duration-300",children:[e.jsx("div",{className:"h-1.5 w-1.5 rounded-full bg-green-500 animate-pulse"}),c.length>=2?`${h?.total||0} resultados`:"Digite para buscar"]})]}),e.jsx(D,{onClick:k,disabled:!R||X==="loading",size:"lg",className:N("gap-2 min-w-[180px] shadow-md hover:shadow-lg transition-all hover:scale-105 font-semibold",L&&"bg-primary/90 hover:bg-primary ring-2 ring-primary/20"),children:X==="loading"?e.jsxs(e.Fragment,{children:[e.jsx(os,{className:"h-5 w-5 animate-spin",strokeWidth:2}),e.jsx("span",{children:"Analisando dados..."})]}):b?e.jsxs(e.Fragment,{children:[e.jsx(us,{className:"h-5 w-5",strokeWidth:2}),e.jsx("span",{children:"Refinar busca"})]}):L?e.jsxs(e.Fragment,{children:[e.jsx(Js,{className:"h-5 w-5",strokeWidth:2}),e.jsx("span",{children:"⚡ Análise Contextual"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Js,{className:"h-5 w-5",strokeWidth:2}),e.jsx("span",{children:"⚡ Executar Análise"})]})})]})]})}function gs({label:s,value:t,type:a="default"}){const r=()=>{switch(a){case"reclamante":return"text-blue-700 font-medium";case"reu":return"text-red-700 font-medium";case"status":return"text-green-700";case"observacoes":return"text-muted-foreground text-sm";default:return"text-foreground"}},o=()=>{switch(a){case"status":return t.toLowerCase().includes("ativo")?"default":"secondary";default:return"outline"}};return e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wide",children:s}),e.jsx("div",{className:N("font-medium",r()),children:a==="status"&&t!=="Não informado"?e.jsx(q,{variant:o(),className:"text-xs",children:t}):e.jsx("span",{children:t})})]})}function mi({cnj:s,reclamante:t,reu:a,status:r="Não informado",observacoes:o="Sem observações registradas",riscoNivel:n,confianca:i,alerta:d,citacoes:u}){console.log("📊 [ExecutiveSummaryCard] Props recebidas:",{cnj:s,status:r,observacoes:o,riscoNivel:n,confianca:typeof i=="number"?`${i}%`:i,hasObservacoes:!!o&&o!=="Sem observações registradas",hasStatus:!!r&&r!=="Não informado",isDefaultData:r==="Não informado"&&o==="Sem observações registradas"});const{toast:m}=Pe(),[v,g]=x.useState(!1),y=typeof i=="number"&&!isNaN(i)&&isFinite(i)?Math.max(0,Math.min(1,i)):0,S=Math.round(y*100),X=3,p=u.length>X,G=v?u:u.slice(0,X),ae=u.length-X,T=async()=>{const ee=`Resumo Executivo - ${s}

Reclamante: ${t}
Réu: ${a}
Status: ${r}
Observações: ${o}

Risco: ${n.toUpperCase()}
Confiança: ${S}%
${d?`Alerta: ${d}`:""}

Citações:
${u.map(W=>`• ${W.label}`).join(`
`)}`;try{await navigator.clipboard.writeText(ee),m({title:"Copiado!",description:"Resumo executivo copiado para a área de transferência."})}catch{m({title:"Erro ao copiar",description:"Não foi possível copiar o conteúdo.",variant:"destructive"})}},Q=()=>{window.print(),m({title:"PDF",description:"Abrindo diálogo de impressão..."})},me=()=>{const ee={cnj:s,reclamante:t,reu:a,status:r,observacoes:o,riscoNivel:n,confianca:i,alerta:d,citacoes:u},W=new Blob([JSON.stringify(ee,null,2)],{type:"application/json"}),H=URL.createObjectURL(W),l=document.createElement("a");l.href=H,l.download=`resumo-executivo-${s.replace(/[^\w]/g,"-")}.json`,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(H),m({title:"JSON exportado",description:"Arquivo JSON baixado com sucesso."})};return e.jsxs(ne,{className:"rounded-2xl border-border/50 transition-shadow hover:shadow-sm","aria-labelledby":"executive-summary",children:[e.jsx(Ne,{className:"pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(_e,{id:"executive-summary",className:"text-base font-semibold flex items-center gap-2",children:[e.jsx(Js,{className:"h-4 w-4 text-violet-600","aria-hidden":"true"}),"Resumo Executivo"]}),e.jsxs(ps,{children:[e.jsx(fs,{asChild:!0,children:e.jsx(D,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0","aria-label":"Ações do resumo",children:e.jsx(eo,{className:"h-4 w-4"})})}),e.jsxs(ls,{align:"end",children:[e.jsxs(Xe,{onClick:T,children:[e.jsx(Ze,{className:"h-4 w-4 mr-2"}),"Copiar resumo"]}),e.jsxs(Xe,{onClick:Q,children:[e.jsx(so,{className:"h-4 w-4 mr-2"}),"Exportar PDF"]}),e.jsxs(Xe,{onClick:me,children:[e.jsx(to,{className:"h-4 w-4 mr-2"}),"Exportar JSON"]})]})]})]})}),e.jsxs(de,{className:"pt-0 space-y-5",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(gs,{label:"Reclamante",value:t,type:"reclamante"}),e.jsx(gs,{label:"Réu",value:a,type:"reu"}),e.jsx(gs,{label:"Status",value:r,type:"status"}),e.jsx(gs,{label:"Observações",value:o,type:"observacoes"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Nível de Risco"}),e.jsx(rr,{riscoNivel:n})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Confiança"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ts,{value:S,className:"w-16 h-2"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[S,"%"]})]})]})]}),d&&e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-muted/50 rounded-lg","aria-live":"polite",children:[e.jsx(pa,{className:"h-4 w-4 text-violet-600","aria-hidden":"true"}),e.jsx("span",{className:"text-sm font-medium",children:d})]})]}),u.length>0&&e.jsxs("div",{className:"pt-3 border-t",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ut,{className:"h-3 w-3 text-muted-foreground","aria-hidden":"true"}),e.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Citações:"})]}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[G.map((ee,W)=>e.jsxs(q,{variant:"secondary",className:N("text-xs flex items-center gap-1 cursor-pointer hover:bg-secondary/80",ee.href&&"underline"),onClick:ee.onClick||(()=>ee.href&&window.open(ee.href,"_blank")),children:[e.jsx(ut,{className:"h-3 w-3","aria-hidden":"true"}),ee.label]},W)),p&&e.jsx(D,{variant:"ghost",size:"sm",onClick:()=>g(!v),className:"h-6 px-2 text-xs text-muted-foreground hover:text-foreground",children:v?e.jsxs(e.Fragment,{children:[e.jsx(ia,{className:"h-3 w-3 mr-1"}),"Menos"]}):e.jsxs(e.Fragment,{children:[e.jsx(ns,{className:"h-3 w-3 mr-1"}),"+",ae]})})]})]})]})]})}function ui({secoes:s,textoOriginal:t}){const a=o=>{switch(o){case"alta":return e.jsx(q,{variant:"destructive",className:"text-xs",children:"Alta"});case"media":return e.jsx(q,{variant:"secondary",className:"text-xs",children:"Média"});case"baixa":return e.jsx(q,{variant:"outline",className:"text-xs",children:"Baixa"});default:return null}},r=Array.isArray(s)?s:[];return e.jsx("div",{className:"space-y-4",children:e.jsxs(_o,{type:"multiple",className:"w-full",children:[r.map((o,n)=>e.jsxs(ft,{value:`secao-${n}`,children:[e.jsx(gt,{className:"text-left",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:o.titulo}),o.evidencias&&o.evidencias.length>0&&e.jsxs(q,{variant:"outline",className:"text-xs",children:[o.evidencias.length," evidência",o.evidencias.length>1?"s":""]})]})}),e.jsx(jt,{children:e.jsxs("div",{className:"space-y-4 pt-2",children:[e.jsx("div",{className:"prose prose-sm max-w-none",children:e.jsx("p",{className:"text-sm text-muted-foreground leading-relaxed",children:o.conteudo})}),o.evidencias&&o.evidencias.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h5",{className:"text-xs font-semibold text-muted-foreground uppercase tracking-wide",children:"Evidências"}),e.jsx("div",{className:"grid gap-2",children:o.evidencias.map((i,d)=>typeof i=="string"?e.jsx(ne,{className:"p-3 bg-muted/30",children:e.jsx("p",{className:"text-sm",children:i})},d):e.jsx(ne,{className:"p-3 bg-muted/30",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1",children:[i.tipo&&e.jsx("div",{className:"text-xs text-muted-foreground font-medium mb-1",children:i.tipo}),e.jsx("p",{className:"text-sm",children:i.descricao})]}),i.relevancia&&a(i.relevancia)]})},d))})]}),o.metadados&&e.jsx("div",{className:"pt-2 border-t border-muted",children:e.jsxs("div",{className:"flex flex-wrap gap-4 text-xs text-muted-foreground",children:[o.metadados.fonte&&e.jsxs("span",{children:[e.jsx("strong",{children:"Fonte:"})," ",o.metadados.fonte]}),o.metadados.confiabilidade&&e.jsxs("span",{children:[e.jsx("strong",{children:"Confiabilidade:"})," ",Math.round(o.metadados.confiabilidade*100),"%"]}),o.metadados.timestamp&&e.jsxs("span",{children:[e.jsx("strong",{children:"Processado:"})," ",new Date(o.metadados.timestamp).toLocaleString("pt-BR")]})]})})]})})]},n)),t&&e.jsxs(ft,{value:"texto-original",children:[e.jsx(gt,{className:"text-left",children:e.jsx("span",{className:"font-medium",children:"Consulta Original"})}),e.jsx(jt,{children:e.jsx(ne,{className:"p-4 bg-muted/30",children:e.jsx("pre",{className:"text-sm whitespace-pre-wrap font-mono text-muted-foreground",children:t})})})]})]})})}function vs({citations:s}){if(!s.length)return null;const t=r=>{switch(r){case"por_processo":return e.jsx(Me,{className:"h-3 w-3"});case"por_testemunha":return e.jsx(_s,{className:"h-3 w-3"});default:return e.jsx(Us,{className:"h-3 w-3"})}},a=r=>{switch(r){case"por_processo":return"default";case"por_testemunha":return"secondary";default:return"outline"}};return e.jsxs("div",{className:"pt-3 border-t",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Us,{className:"h-3 w-3 text-muted-foreground"}),e.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Citações:"})]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:s.map((r,o)=>e.jsxs(q,{variant:a(r.source),className:"text-xs flex items-center gap-1",children:[t(r.source),r.ref]},o))})]})}function hi({onToggle:s,isAnonymized:t,variant:a="default",className:r=""}){const[o,n]=x.useState(!1),i=async()=>{n(!0);try{await new Promise(d=>setTimeout(d,300)),s(!t)}finally{n(!1)}};return a==="minimal"?e.jsx(D,{variant:t?"default":"outline",size:"sm",onClick:i,disabled:o,className:r,children:t?e.jsxs(e.Fragment,{children:[e.jsx(Bs,{className:"h-4 w-4 mr-2"}),"Dados Anonimizados"]}):e.jsxs(e.Fragment,{children:[e.jsx(Ue,{className:"h-4 w-4 mr-2"}),"Dados Completos"]})}):e.jsxs(ps,{children:[e.jsx(fs,{asChild:!0,children:e.jsxs(D,{variant:"outline",className:r,children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),"Privacidade",e.jsx(ns,{className:"h-4 w-4 ml-2"})]})}),e.jsxs(ls,{align:"end",className:"w-56",children:[e.jsx(Xe,{onClick:i,disabled:o,children:t?e.jsxs(e.Fragment,{children:[e.jsx(Ue,{className:"h-4 w-4 mr-2"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Mostrar Dados Completos"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Revelar CPFs e nomes reais"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(Bs,{className:"h-4 w-4 mr-2"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Anonimizar Dados"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Mascarar informações sensíveis"})]})]})}),e.jsxs(Xe,{disabled:!0,className:"border-t mt-1 pt-2",children:[e.jsx(Oe,{className:"h-4 w-4 mr-2 text-muted-foreground"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Conforme Art. 6º, VII da LGPD"})]})]})]})}function xi({variant:s="compact",showDetails:t=!1,className:a=""}){return s==="badge"?e.jsx(Ta,{children:e.jsxs(ds,{children:[e.jsx(ms,{asChild:!0,children:e.jsxs(q,{variant:"secondary",className:`bg-success/10 text-success border-success/20 ${a}`,children:[e.jsx(Oe,{className:"h-3 w-3 mr-1"}),"LGPD Ready"]})}),e.jsx(ts,{children:e.jsx("p",{children:"Documento em conformidade com a LGPD"})})]})}):s==="compact"?e.jsxs("div",{className:`inline-flex items-center gap-2 px-3 py-2 bg-success/10 border border-success/20 rounded-lg ${a}`,children:[e.jsx(Oe,{className:"h-4 w-4 text-success"}),e.jsx("span",{className:"text-sm font-medium text-success",children:"LGPD Compliant"}),e.jsx($e,{className:"h-3 w-3 text-success"})]}):e.jsxs("div",{className:`border border-success/20 rounded-lg p-4 bg-success/5 ${a}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"flex items-center justify-center w-10 h-10 bg-success/10 rounded-full",children:e.jsx(Oe,{className:"h-5 w-5 text-success"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-success",children:"Documento LGPD-Ready"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Conforme Lei 13.709/2018"})]}),e.jsx($e,{className:"h-5 w-5 text-success ml-auto"})]}),t&&e.jsxs("div",{className:"space-y-2 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(ao,{className:"h-3 w-3"}),e.jsx("span",{children:"Dados criptografados em trânsito e repouso"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(Ue,{className:"h-3 w-3"}),e.jsx("span",{children:"Informações sensíveis anonimizadas por padrão"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(Me,{className:"h-3 w-3"}),e.jsx("span",{children:"Base legal: Execução regular de direitos (Art. 7º, VI)"})]})]}),e.jsx("div",{className:"mt-3 pt-3 border-t border-success/20",children:e.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.jsx("strong",{children:"Aviso:"})," Este documento contém análise assistida por IA. Validação jurídica humana é obrigatória antes do uso processual."]})})]})}function pi({onExport:s,showPrint:t=!0,disabled:a=!1,showAnonymizeOption:r=!0,isAnonymized:o=!1,onAnonymizeToggle:n,className:i=""}){const{toast:d}=Pe(),u=()=>{window.print(),d({title:"Imprimindo",description:"Preparando documento para impressão..."})},m=v=>{s(v,o);const g=o?" (dados anonimizados)":" (dados completos)";d({title:"Exportando",description:`Gerando arquivo ${v.toUpperCase()}${g}... Será registrado no log de auditoria.`})};return e.jsxs("div",{className:`space-y-3 ${i}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(xi,{variant:"badge"}),r&&n&&e.jsx(hi,{isAnonymized:o,onToggle:n,variant:"minimal"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[t&&e.jsxs(D,{variant:"outline",size:"sm",onClick:u,disabled:a,className:"gap-2",children:[e.jsx(ro,{className:"h-4 w-4"}),"Imprimir",o&&e.jsx(Oe,{className:"h-3 w-3 text-success"})]}),e.jsxs(D,{variant:"outline",size:"sm",onClick:()=>m("pdf"),disabled:a,className:"gap-2",children:[e.jsx(Me,{className:"h-4 w-4"}),"PDF",o&&e.jsx(Oe,{className:"h-3 w-3 text-success"})]}),e.jsxs(D,{variant:"outline",size:"sm",onClick:()=>m("csv"),disabled:a,className:"gap-2",children:[e.jsx(Xs,{className:"h-4 w-4"}),"CSV",o&&e.jsx(Oe,{className:"h-3 w-3 text-success"})]}),e.jsxs(D,{variant:"outline",size:"sm",onClick:()=>m("docx"),disabled:a,className:"gap-2",children:[e.jsx(Me,{className:"h-4 w-4"}),"DOCX",o&&e.jsx(Oe,{className:"h-3 w-3 text-success"})]}),e.jsxs(D,{variant:"outline",size:"sm",onClick:()=>m("json"),disabled:a,className:"gap-2",children:[e.jsx(xa,{className:"h-4 w-4"}),"JSON",o&&e.jsx(Oe,{className:"h-3 w-3 text-success"})]})]})]})}function fi({blocks:s}){const{toast:t}=Pe(),a=()=>{window.print(),t({title:"PDF",description:"Abrindo diálogo de impressão..."})},r=()=>{const i=["Tipo,Conteudo",...s.map(v=>({Tipo:v.title,Conteudo:JSON.stringify(v.data)})).map(v=>`"${v.Tipo}","${v.Conteudo}"`)].join(`
`),d=new Blob([i],{type:"text/csv;charset=utf-8;"}),u=document.createElement("a"),m=URL.createObjectURL(d);u.setAttribute("href",m),u.setAttribute("download",`analise-${Date.now()}.csv`),document.body.appendChild(u),u.click(),document.body.removeChild(u),t({title:"CSV exportado",description:"Arquivo CSV baixado com sucesso."})},o=()=>{const n={timestamp:new Date().toISOString(),blocks:s},i=new Blob([JSON.stringify(n,null,2)],{type:"application/json"}),d=URL.createObjectURL(i),u=document.createElement("a");u.href=d,u.download=`analise-completa-${Date.now()}.json`,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(d),t({title:"JSON exportado",description:"Arquivo JSON baixado com sucesso."})};return!s||s.length===0?null:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-brand-ink",children:"Resultado da Análise"}),e.jsx(pi,{onExport:n=>{switch(n){case"pdf":a();break;case"csv":r();break;case"json":o();break}},showPrint:!0})]}),e.jsx("div",{className:"space-y-4",children:s.map((n,i)=>{switch(n.type){case"executive":return e.jsx(mi,{cnj:n.data?.cnj||n.data?.processo||(n.context?.type==="testemunha","N/A"),reclamante:n.data?.reclamante||n.context?.data?.nome||n.data?.reclamada||"Não informado",reu:n.data?.reu||n.data?.reclamada||(n.context?.type==="testemunha"?"N/A":"Não informado"),status:n.data?.status||n.meta?.status||n.context?.meta?.status||"Não informado",observacoes:n.data?.observacoes||n.meta?.observacoes||"Análise contextual em progresso",riscoNivel:n.data?.riscoNivel||n.meta?.riscoNivel||n.context?.meta?.riscoNivel||"baixo",confianca:typeof n.data?.confianca=="number"?n.data.confianca:typeof n.meta?.confidence=="number"?Math.round(n.meta.confidence*100):typeof n.context?.meta?.confidence=="number"?Math.round(n.context.meta.confidence*100):typeof n.data?.score=="number"?n.data.score:0,alerta:n.data?.alerta,citacoes:n.citations?.map(d=>({label:d.ref,onClick:()=>{console.log("Citation clicked:",d)}}))||[]},i);case"details":return e.jsxs(ne,{className:"rounded-2xl border-border/50",children:[e.jsx(Ne,{children:e.jsxs(_e,{className:"text-base font-semibold flex items-center gap-2",children:[e.jsx(Me,{className:"h-4 w-4 text-primary"}),n.title]})}),e.jsxs(de,{children:[e.jsx(ui,{secoes:n.data.secoes,textoOriginal:n.data.textoOriginal}),n.citations&&e.jsx(vs,{citations:n.citations})]})]},i);case"alerts":return e.jsxs(ne,{className:"rounded-2xl border-status-critical/30 bg-status-critical/5",children:[e.jsx(Ne,{children:e.jsxs(_e,{className:"text-base font-semibold flex items-center gap-2",children:[e.jsx(qe,{className:"h-4 w-4 text-destructive"}),n.title]})}),e.jsxs(de,{className:"space-y-3",children:[e.jsxs(De,{className:"border-destructive/30 bg-destructive/10",children:[e.jsx(qe,{className:"h-4 w-4 text-destructive"}),e.jsxs(ke,{className:"text-destructive-foreground",children:[e.jsx("strong",{children:"Triangulação Detectada"})," - Padrões suspeitos identificados entre testemunhas"]})]}),e.jsxs(De,{className:"border-status-warning/30 bg-status-warning/10",children:[e.jsx(qe,{className:"h-4 w-4 text-status-warning"}),e.jsxs(ke,{className:"text-status-warning",children:[e.jsx("strong",{children:"Depoimentos Repetidos"})," - Narrativas similares encontradas"]})]}),n.data.suspiciousPatterns?.map((d,u)=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-destructive/10 rounded-lg",children:[e.jsx(qe,{className:"h-3 w-3 text-destructive"}),e.jsx("span",{className:"text-sm text-destructive-foreground",children:d})]},u)),e.jsx("div",{className:"mt-4 p-3 bg-muted/50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:["⚠️ ",e.jsx("strong",{children:"Atenção:"})," Possível coordenação entre depoimentos de testemunhas. Recomenda-se investigação detalhada dos vínculos identificados."]})}),n.citations&&e.jsx(vs,{citations:n.citations})]})]},i);case"strategies":return e.jsx(gi,{block:n},i);default:return e.jsxs(ne,{className:"rounded-2xl border-border/50",children:[e.jsx(Ne,{children:e.jsx(_e,{className:"text-base font-semibold",children:n.title})}),e.jsxs(de,{children:[e.jsx("pre",{className:"text-sm text-muted-foreground whitespace-pre-wrap",children:JSON.stringify(n.data,null,2)}),n.citations&&e.jsx(vs,{citations:n.citations})]})]},i)}})}),e.jsxs("div",{className:"text-xs text-muted-foreground text-center pt-4 border-t",children:["Relatório gerado às ",new Date().toLocaleTimeString("pt-BR")," • Dados sujeitos à verificação manual conforme LGPD"]})]})}function gi({block:s}){const{toast:t}=Pe(),a=async o=>{try{await navigator.clipboard.writeText(o),t({title:"Copiado!",description:"Recomendação copiada para a área de transferência."})}catch{t({title:"Erro ao copiar",description:"Não foi possível copiar o conteúdo.",variant:"destructive"})}},r=o=>{switch(o?.toUpperCase()){case"ALTA":return"bg-status-critical/15 text-status-critical border-status-critical/30";case"MÉDIA":return"bg-status-warning/15 text-status-warning border-status-warning/30";case"BAIXA":return"bg-status-success/15 text-status-success border-status-success/30";default:return"bg-muted text-muted-foreground border-border"}};return e.jsxs(ne,{className:"rounded-2xl border-status-success/30 bg-status-success/10",children:[e.jsx(Ne,{children:e.jsxs(_e,{className:"text-base font-semibold flex items-center gap-2",children:[e.jsx(ht,{className:"h-4 w-4 text-emerald-600"}),s.title]})}),e.jsxs(de,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-medium text-emerald-800",children:"Estratégias Ativas"}),e.jsx(q,{variant:"secondary",className:"text-xs",children:"Polo Ativo"})]}),s.data.estrategias?.map((o,n)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white/70 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(q,{className:N("text-xs",r(o.prioridade)),children:o.prioridade}),e.jsx("span",{className:"text-sm",children:o.texto})]}),e.jsx(D,{variant:"ghost",size:"sm",onClick:()=>a(o.texto),className:"h-8 w-8 p-0 shrink-0",children:e.jsx(Ze,{className:"h-3 w-3"})})]},n))]}),s.data.acoesDefensivas&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-emerald-800",children:"Ações Defensivas"}),s.data.acoesDefensivas.map((o,n)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white/70 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(q,{className:N("text-xs",r(o.prioridade)),children:o.prioridade}),e.jsx("span",{className:"text-sm",children:o.texto})]}),e.jsx(D,{variant:"ghost",size:"sm",onClick:()=>a(o.texto),className:"h-8 w-8 p-0 shrink-0",children:e.jsx(Ze,{className:"h-3 w-3"})})]},n))]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ht,{className:"h-4 w-4 text-emerald-600"}),e.jsx("h4",{className:"font-medium text-emerald-800",children:"Próximos Passos"})]}),s.data.proximosPassos?.map((o,n)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white/70 rounded-lg border",children:[e.jsx("span",{className:"text-sm",children:o}),e.jsx(D,{variant:"ghost",size:"sm",onClick:()=>a(o),className:"h-8 w-8 p-0 shrink-0",children:e.jsx(Ze,{className:"h-3 w-3"})})]},n))]}),s.citations&&e.jsx(vs,{citations:s.citations})]})]})}function ji(){const{loadingHints:s,currentHintIndex:t,nextHint:a}=A(),r=x.useRef(null);return x.useEffect(()=>(r.current&&clearInterval(r.current),r.current=setInterval(()=>{a()},800),()=>{r.current&&clearInterval(r.current)}),[a]),e.jsxs("div",{className:"flex gap-4 animate-fade-in",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx(oo,{className:"h-4 w-4 text-primary animate-pulse"})}),e.jsx("div",{className:"flex-1 max-w-4xl",children:e.jsx(ne,{className:"bg-card border-primary/20 shadow-sm",children:e.jsxs(de,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(os,{className:"h-4 w-4 animate-spin text-primary"}),e.jsx("span",{className:"text-sm text-foreground font-medium transition-opacity duration-200",children:s[t]||"Carregando..."},t)]}),e.jsx("div",{className:"mt-3 flex gap-1",children:Array.from({length:3}).map((o,n)=>e.jsx("div",{className:"h-1 w-8 rounded-full bg-primary/20 animate-pulse",style:{animationDelay:`${n*.2}s`,animationDuration:"1s"}},n))})]})})})]})}const Rt=({isLoading:s,hasError:t,errorMessage:a,isConnected:r,dataCount:o,dataType:n})=>s?e.jsx(ne,{className:"mb-4 border-blue-200 bg-blue-50/50",children:e.jsx(de,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(os,{className:"h-5 w-5 text-blue-600 animate-spin"}),e.jsx("span",{className:"text-sm text-blue-800",children:"Conectando com servidor..."})]})})}):t&&!r?e.jsx(ne,{className:"mb-4 border-orange-200 bg-orange-50/50",children:e.jsx(de,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(no,{className:"h-5 w-5 text-orange-600"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm text-orange-800",children:"Servidor indisponível - Exibindo dados simulados"}),a&&e.jsx("p",{className:"text-xs text-orange-700 mt-1",children:a})]}),e.jsx(q,{variant:"outline",className:"text-orange-700 border-orange-300",children:"Mock"})]})})}):t&&r?e.jsx(ne,{className:"mb-4 border-red-200 bg-red-50/50",children:e.jsx(de,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(qe,{className:"h-5 w-5 text-red-600"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm text-red-800",children:"Erro de validação nos filtros"}),a&&e.jsx("p",{className:"text-xs text-red-700 mt-1",children:a})]}),e.jsx(q,{variant:"destructive",className:"text-xs",children:"Erro"})]})})}):r&&o>0?e.jsx(ne,{className:"mb-4 border-green-200 bg-green-50/50",children:e.jsx(de,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx($e,{className:"h-5 w-5 text-green-600"}),e.jsxs("span",{className:"text-sm text-green-800",children:[o," ",n," carregados do servidor"]}),e.jsx(q,{variant:"outline",className:"text-green-700 border-green-300",children:"Online"})]})})}):null;class vi extends x.Component{state={hasError:!1,error:null,errorInfo:null,errorCount:0};static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,a){const r=this.state.errorCount+1;we.error("🔴 [MapaErrorBoundary] Erro capturado",{error:t.message,stack:t.stack,componentStack:a.componentStack,errorCount:r,timestamp:new Date().toISOString(),userAgent:navigator.userAgent,online:navigator.onLine}),this.setState({error:t,errorInfo:a,errorCount:r}),r>3&&we.error("⛔ [MapaErrorBoundary] Loop de erros detectado",{errorCount:r,lastError:t.message})}handleReset=()=>{we.info("🔄 [MapaErrorBoundary] Resetando estado de erro"),this.setState({hasError:!1,error:null,errorInfo:null,errorCount:0})};handleGoHome=()=>{we.info("🏠 [MapaErrorBoundary] Navegando para home"),typeof window<"u"&&(window.location.href="/")};render(){if(this.state.hasError){const{error:t,errorInfo:a,errorCount:r}=this.state;return e.jsx("div",{className:"flex items-center justify-center min-h-screen p-4 bg-background",children:e.jsxs(ne,{className:"max-w-2xl w-full",children:[e.jsx(Ne,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(qe,{className:"h-8 w-8 text-destructive"}),e.jsxs("div",{children:[e.jsx(_e,{className:"text-2xl",children:"Erro no Mapa de Testemunhas"}),e.jsx(es,{children:r>1?`Ocorreram ${r} erros consecutivos`:"Ocorreu um erro inesperado"})]})]})}),e.jsxs(de,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"font-semibold text-sm text-muted-foreground",children:"Mensagem de Erro"}),e.jsx("div",{className:"p-3 bg-destructive/10 border border-destructive/20 rounded-md",children:e.jsx("p",{className:"text-sm text-destructive font-mono",children:t?.message||"Erro desconhecido"})})]}),typeof process<"u"&&!1,e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"font-semibold text-sm text-muted-foreground",children:"Possíveis Causas"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm text-muted-foreground",children:[e.jsx("li",{children:"Problemas de conexão com o servidor"}),e.jsx("li",{children:"Dados inconsistentes ou mal formatados"}),e.jsx("li",{children:"Erro na Edge Function do backend"}),e.jsx("li",{children:"Sessão expirada ou inválida"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[r<=3&&e.jsxs(D,{onClick:this.handleReset,className:"flex-1",children:[e.jsx(Ns,{className:"mr-2 h-4 w-4"}),"Tentar Novamente"]}),e.jsxs(D,{onClick:this.handleGoHome,variant:"outline",className:"flex-1",children:[e.jsx(fa,{className:"mr-2 h-4 w-4"}),"Voltar ao Início"]})]}),r>3&&e.jsx("div",{className:"p-3 bg-yellow-500/10 border border-yellow-500/20 rounded-md",children:e.jsx("p",{className:"text-sm text-yellow-600 dark:text-yellow-400",children:"⚠️ Múltiplas tentativas falharam. Por favor, entre em contato com o suporte."})})]})]})})}return this.props.children}}const bi=()=>{const[s,t]=x.useState($.isEnabled()),{toast:a}=Pe();x.useEffect(()=>{t($.isEnabled())},[]);const r=()=>{const o=$.toggle();t(o),a({title:o?"🐛 Debug Mode Ativado":"Debug Mode Desativado",description:o?"Logs detalhados estão sendo exibidos no console":"Logs de debug foram desativados",duration:2e3})};return e.jsxs("div",{className:"flex items-center space-x-2 bg-muted/50 px-3 py-2 rounded-md border border-border/40",children:[e.jsx(io,{className:"h-4 w-4 text-muted-foreground"}),e.jsx(be,{htmlFor:"debug-mode",className:"text-sm cursor-pointer",children:"Debug Mode"}),e.jsx(tt,{id:"debug-mode",checked:s,onCheckedChange:r,className:"data-[state=checked]:bg-primary"})]})};async function Ni(s){const t={functionName:s,isReachable:!1,hasAuth:!1};try{const{data:{session:a},error:r}=await Fe.auth.getSession();if(r)return t.authError=r.message,we.error(`[EdgeDiagnostics] Erro de sessão para ${s}`,{error:r}),t;if(!a)return t.authError="Nenhuma sessão ativa",we.warn(`[EdgeDiagnostics] Nenhuma sessão ativa para ${s}`),t;t.hasAuth=!0,we.info(`[EdgeDiagnostics] Testando ${s}...`);const{data:o,error:n}=await Fe.functions.invoke(s,{body:{paginacao:{page:1,limit:1},filtros:{}}});return n?(t.testResult="error",t.errorDetails={message:n.message,context:n.context,status:n.status},we.error(`[EdgeDiagnostics] Erro ao testar ${s}`,{error:n,errorDetails:t.errorDetails})):(t.isReachable=!0,t.testResult="success",we.info(`[EdgeDiagnostics] ${s} respondeu com sucesso`,{hasData:!!o,dataKeys:o?Object.keys(o):[]})),t}catch(a){return t.testResult="error",t.errorDetails=a,we.error(`[EdgeDiagnostics] Exceção ao testar ${s}`,{error:a}),t}}async function _i(){we.info("🔍 [EdgeDiagnostics] ===== INICIANDO DIAGNÓSTICO COMPLETO =====");const s=["mapa-testemunhas-processos","mapa-testemunhas-testemunhas"],t={};for(const r of s)we.info(`🔍 [EdgeDiagnostics] Testando função: ${r}`),t[r]=await Ni(r);we.info("✅ [EdgeDiagnostics] ===== DIAGNÓSTICO CONCLUÍDO =====",{results:t});const a=Object.entries(t).map(([r,o])=>({function:r,reachable:o.isReachable,authenticated:o.hasAuth,testResult:o.testResult,error:o.errorDetails?.message||o.authError||"none"}));return console.table(a),t}function yi(){we.info("🔍 [EdgeDiagnostics] ===== CONFIGURAÇÃO SUPABASE =====");const s={hasSupabaseClient:!!Fe,functionsUrl:"<<MANTER>>/functions/v1",hasAuth:!!Fe?.auth};return we.info("🔍 [EdgeDiagnostics] Config:",s),console.table(s),s}function wi(){const[s,t]=x.useState(null),[a,r]=x.useState(!1),o=async()=>{r(!0),yi();const n=await _i();t(n),r(!1)};return e.jsxs(ne,{className:"border-dashed border-yellow-500/50 bg-yellow-50/5",children:[e.jsxs(Ne,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(lo,{className:"h-4 w-4 text-yellow-600"}),e.jsx(_e,{className:"text-sm",children:"Diagnóstico de Edge Functions"})]}),e.jsx(q,{variant:"outline",className:"text-yellow-600 border-yellow-600",children:"DEV ONLY"})]}),e.jsx(es,{className:"text-xs",children:"Teste a conectividade e configuração das Edge Functions"})]}),e.jsxs(de,{className:"space-y-3",children:[e.jsxs(D,{onClick:o,disabled:a,size:"sm",variant:"outline",className:"w-full",children:[a&&e.jsx(Ns,{className:"mr-2 h-3 w-3 animate-spin"}),a?"Executando diagnóstico...":"Executar Diagnóstico"]}),s&&e.jsx("div",{className:"space-y-2",children:Object.entries(s).map(([n,i])=>e.jsx("div",{className:"flex items-start justify-between gap-2 rounded-lg border border-border/50 bg-card/50 p-2 text-xs",children:e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsx("div",{className:"font-mono font-medium",children:n}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[i.hasAuth?e.jsxs(q,{variant:"outline",className:"text-green-600 border-green-600 text-[10px]",children:[e.jsx(bs,{className:"mr-1 h-2 w-2"}),"Autenticado"]}):e.jsxs(q,{variant:"outline",className:"text-red-600 border-red-600 text-[10px]",children:[e.jsx(Vs,{className:"mr-1 h-2 w-2"}),"Sem Auth"]}),i.isReachable?e.jsxs(q,{variant:"outline",className:"text-green-600 border-green-600 text-[10px]",children:[e.jsx(bs,{className:"mr-1 h-2 w-2"}),"Alcançável"]}):e.jsxs(q,{variant:"outline",className:"text-red-600 border-red-600 text-[10px]",children:[e.jsx(Vs,{className:"mr-1 h-2 w-2"}),"Não Alcançável"]})]}),(i.authError||i.errorDetails)&&e.jsx("div",{className:"text-[10px] text-destructive/80",children:i.authError||i.errorDetails?.message||"Erro desconhecido"})]})},n))})]})]})}function Ci(){const s=A(r=>r.density),t=A(r=>r.setDensity),a=[{value:"compact",label:"Compacto",description:"Espaçamento mínimo"},{value:"comfortable",label:"Confortável",description:"Espaçamento amplo"}];return e.jsxs(ps,{children:[e.jsx(fs,{asChild:!0,children:e.jsxs(D,{variant:"outline",size:"sm",className:"gap-2",children:[e.jsx(co,{className:"h-4 w-4"}),"Densidade"]})}),e.jsx(ls,{align:"end",className:"w-[200px]",children:a.map(r=>e.jsxs(Xe,{onClick:()=>t(r.value),className:"flex items-center justify-between cursor-pointer",children:[e.jsxs("div",{className:"flex flex-col gap-0.5",children:[e.jsx("span",{className:"text-sm font-medium",children:r.label}),e.jsx("span",{className:"text-xs text-muted-foreground",children:r.description})]}),s===r.value&&e.jsx(Zs,{className:"h-4 w-4 text-primary"})]},r.value))})]})}function Si(){const s=et(),t=A(o=>o.navigationHistory),a=A(o=>o.popNavigation),r=o=>{const n=t[o];n?.path&&(s(n.path),a(o))};return t.length<=1?null:e.jsx(qa,{className:"mb-4",children:e.jsxs(Va,{children:[e.jsx(Ks,{children:e.jsxs(Gs,{onClick:()=>r(0),className:"flex items-center gap-1 cursor-pointer",children:[e.jsx(fa,{className:"h-3.5 w-3.5"}),e.jsx("span",{children:"Início"})]})}),t.slice(1).map((o,n)=>{const i=n===t.length-2,d=n+1;return e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ba,{}),e.jsx(Ks,{children:i?e.jsx(za,{className:"font-medium",children:o.label}):e.jsx(Gs,{onClick:()=>r(d),className:"cursor-pointer hover:text-foreground",children:o.label})})]},d)})]})})}const Ti=()=>{const s=et(),[t,a]=mo(),{user:r,loading:o}=yo(),{toast:n}=Pe(),i=A(ar),d=A(Zo),u=A(Xo),m=A(Yo),v=A(sn),g=A(tn),y=A(an),S=A(rn),X=A(on),p=x.useRef(null),G=x.useRef(null),ae=x.useRef(!1),T=x.useRef(!0),Q=x.useRef(!1),[me,ee]=x.useState(!1),[W,H]=x.useState(!1),l=A(f=>f.chatResult),c=A(f=>f.chatStatus),h=A(f=>f.setActiveTab),_=A(f=>f.setProcessos),C=A(f=>f.setTestemunhas),z=A(f=>f.setIsLoading),re=A(f=>f.setLastUpdate),ue=A(f=>f.setError),fe=A(f=>f.setIsImportModalOpen),L=A(f=>f.loadViews),se=A(f=>f.setProcessoFilters),k=A(f=>f.setTestemunhaFilters),ie=A(f=>f.setSelectedProcesso),I=A(f=>f.setSelectedTestemunha),[M,b]=x.useState(0),[R,j]=x.useState(0),E=f=>f.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),U=x.useMemo(()=>{const f=Array.isArray(d)?d:[],B=Array.isArray(u)?u:[],P=f.filter(ve=>ve?.classificacao_final==="Risco Alto"||ve?.classificacao_final==="Alto").length,V=B.filter(ve=>ve?.foi_testemunha_em_ambos_polos===!0).length,J=(ve,le)=>{if(!isFinite(ve)||!isFinite(le)||le<=0)return 0;const ye=Math.round(ve/le*100);return isFinite(ye)?ye:0},he=isFinite(M)&&M>0?M:f.length,xe=isFinite(R)&&R>0?R:B.length;return{totalProcessos:he,totalTestemunhas:xe,processosAltoRisco:P,testemunhasAmbosPolos:V,pctProcAlto:J(P,he),pctAmbos:J(V,xe)}},[d,u,M,R]),O=f=>m?"loading":v?navigator.onLine?"error":"offline":f.length?"success":"empty",w=O(d),Y=O(u);x.useEffect(()=>{if(!o&&!r){s("/login");return}},[r,o,s]),x.useEffect(()=>{r&&L(r.id)},[r,L]),x.useEffect(()=>{if(Q.current)return;const f=t.get("tab"),B=t.get("nome"),P=t.get("cnj"),V=t.get("reclamante");if(f&&(f==="processos"||f==="testemunhas")&&f!==i&&h(f),B&&k({search:decodeURIComponent(B)}),P&&se({search:decodeURIComponent(P)}),V&&se({search:decodeURIComponent(V)}),B||P||V){Q.current=!0;const J=new URLSearchParams(t);J.delete("nome"),J.delete("cnj"),J.delete("reclamante"),a(J,{replace:!0})}},[]),x.useEffect(()=>{if(!(!Q.current||ae.current)&&!(d.length===0&&u.length===0)){if(X.search&&u.length>0){const f=u.find(B=>B.nome_testemunha?.toLowerCase()===X.search?.toLowerCase());f&&!A.getState().selectedTestemunha&&(I(f),n({title:"Testemunha selecionada",description:f.nome_testemunha}))}if(S.search&&d.length>0){const f=d.find(B=>B.cnj===S.search||B.numero_cnj===S.search);f&&!A.getState().selectedProcesso&&(ie(f),n({title:"Processo selecionado",description:f.cnj||f.numero_cnj}))}}},[d.length,u.length]);const F=f=>{const B=f;h(B),a({tab:B},{replace:!0}),ie(null),I(null)},te=Ws(S,300),oe=Ws(X,300),K=x.useCallback(async()=>{if(!r||ae.current)return;p.current?.abort(),G.current?.abort();const f=new AbortController,B=new AbortController;p.current=f,G.current=B,ae.current=!0,z(!0),ue(!1);try{const P=A.getState().processoFilters,V=A.getState().testemunhaFilters,[J,he]=await Promise.all([ei({page:1,limit:100,filters:P}),Yn({page:1,limit:100,filters:V})]);if(f.signal.aborted||B.signal.aborted)return;const xe=Array.isArray(J.data)?J.data:[],ve=Array.isArray(he.data)?he.data:[];_(xe),C(ve);const le=isFinite(J.total)?J.total:xe.length,ye=isFinite(he.total)?he.total:ve.length;b(le),j(ye);const ce=J.error||he.error;ce?(ue(!0,`Erro ao conectar: ${ce}`),n({title:"Falha ao conectar",description:ce,variant:"destructive"})):T.current&&(re(new Date),T.current=!1)}catch(P){if(P?.name==="AbortError")return;const V=P instanceof Error?P.message:"Erro ao carregar dados";ue(!0,V),n({title:"Falha na conexão",description:V,variant:"destructive"})}finally{!f.signal.aborted&&!B.signal.aborted&&(ae.current=!1,z(!1))}},[r]);x.useEffect(()=>(r&&K(),()=>{p.current?.abort(),G.current?.abort()}),[r,K]),x.useEffect(()=>{!T.current&&r&&K()},[te,oe,K]),x.useEffect(()=>{const f=B=>{(B.ctrlKey||B.metaKey)&&B.key==="f"&&(B.preventDefault(),ee(!0))};return window.addEventListener("keydown",f),()=>window.removeEventListener("keydown",f)},[]);const Z=()=>{const B=Object.entries(i==="processos"?S:X);if(B.length===0)return null;const P=V=>{if(i==="processos"){const J={...S};delete J[V],se(J)}else{const J={...X};delete J[V],k(J)}};return e.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Filtros ativos:"}),B.map(([V,J])=>e.jsxs(q,{variant:"secondary",className:"gap-1",children:[e.jsxs("span",{className:"text-xs",children:[V,": ",String(J)]}),e.jsx("button",{onClick:()=>P(V),className:"ml-1 hover:bg-secondary-foreground/10 rounded-full p-0.5","aria-label":`Remover filtro ${V}`,children:e.jsx(We,{className:"h-3 w-3"})})]},V))]})};return o?e.jsx("div",{className:"min-h-screen flex items-center justify-center","aria-live":"polite",children:e.jsx("div",{className:"animate-pulse text-muted-foreground",children:"Verificando autenticação..."})}):r?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("div",{className:"border-b border-border/50 bg-card",children:e.jsxs("div",{className:"container mx-auto px-6 py-6",children:[e.jsx(Si,{}),e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold flex items-center gap-3",children:[e.jsx(uo,{className:"h-8 w-8 text-primary","aria-hidden":"true"}),"Mapa de Testemunhas",v&&e.jsx(q,{variant:"destructive",className:"text-xs",children:"Modo Fallback"})]}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Análise estratégica de testemunhas e processos judiciais"}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ho,{className:"h-4 w-4","aria-hidden":"true"}),e.jsxs("span",{children:["Última atualização:"," ",y?E(y):"—"]})]}),e.jsx(He,{orientation:"vertical",className:"h-4"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ha,{className:"h-4 w-4","aria-hidden":"true"}),e.jsx("span",{children:v?"Dados mock":"Dados em tempo real"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ci,{}),e.jsxs(D,{variant:"outline",onClick:()=>fe(!0),className:"gap-2","aria-label":"Importar dados via Excel",children:[e.jsx(Me,{className:"h-4 w-4","aria-hidden":"true"}),"Importar Dados"]}),$.isEnabled()&&e.jsxs(ka,{open:W,onOpenChange:H,children:[e.jsx(So,{asChild:!0,children:e.jsxs(D,{variant:"outline",size:"sm",className:"gap-2",children:[e.jsx(xo,{className:"h-4 w-4"}),"Diagnóstico"]})}),e.jsxs(at,{side:"right",className:"w-[400px]",children:[e.jsxs(rt,{children:[e.jsx(ot,{children:"Diagnóstico do Sistema"}),e.jsx(nt,{children:"Ferramentas de desenvolvimento e diagnóstico"})]}),e.jsx("div",{className:"mt-6",children:e.jsx(wi,{})})]})]}),e.jsx(bi,{}),e.jsx(kn,{}),e.jsx(Gn,{data:i==="processos"?d:u,fileName:i==="processos"?"por_processo.csv":"por_testemunha.csv"})]})]})]})}),e.jsxs("div",{className:"container mx-auto px-6 py-6",children:[v&&e.jsx(ne,{className:"rounded-2xl border-destructive/50 bg-destructive/5 mb-6",children:e.jsx(de,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2 text-destructive",children:[e.jsx(qe,{className:"h-4 w-4","aria-hidden":"true"}),e.jsx("span",{className:"font-medium",children:"Erro:"}),e.jsx("span",{className:"text-sm",children:g})]})})}),e.jsx(Ta,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsxs(ds,{children:[e.jsx(ms,{asChild:!0,children:e.jsxs(ne,{className:"rounded-2xl border-border/50 hover:shadow-md transition-shadow cursor-help",children:[e.jsx(Ne,{className:"pb-3",children:e.jsxs(_e,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(xt,{className:"h-4 w-4 text-primary","aria-hidden":"true"}),"Total de Processos"]})}),e.jsxs(de,{children:[e.jsx("div",{className:"text-3xl font-bold text-primary",children:U.totalProcessos.toLocaleString("pt-BR")}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Processos cadastrados"," ",d.length<U.totalProcessos&&`(exibindo ${d.length})`]})]})]})}),e.jsx(ts,{children:e.jsx("p",{children:"Total de processos jurídicos cadastrados no sistema"})})]}),e.jsxs(ds,{children:[e.jsx(ms,{asChild:!0,children:e.jsxs(ne,{className:"rounded-2xl border-border/50 hover:shadow-md transition-shadow cursor-help",children:[e.jsx(Ne,{className:"pb-3",children:e.jsxs(_e,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(hs,{className:"h-4 w-4 text-emerald-600","aria-hidden":"true"}),"Total de Testemunhas"]})}),e.jsxs(de,{children:[e.jsx("div",{className:"text-3xl font-bold text-emerald-600",children:U.totalTestemunhas.toLocaleString("pt-BR")}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Testemunhas identificadas"," ",u.length<U.totalTestemunhas&&`(exibindo ${u.length})`]})]})]})}),e.jsx(ts,{children:e.jsx("p",{children:"Total de testemunhas únicas identificadas em todos os processos"})})]}),e.jsxs(ds,{children:[e.jsx(ms,{asChild:!0,children:e.jsxs(ne,{className:"rounded-2xl border-border/50 hover:shadow-md transition-shadow cursor-help",children:[e.jsx(Ne,{className:"pb-3",children:e.jsxs(_e,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(qe,{className:"h-4 w-4 text-destructive","aria-hidden":"true"}),"Processos de Alto Risco"]})}),e.jsxs(de,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-3xl font-bold text-destructive",children:U.processosAltoRisco}),e.jsxs(q,{variant:"destructive",className:"text-xs",children:[U.pctProcAlto,"%"]})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Requerem atenção especial"})]})]})}),e.jsx(ts,{children:e.jsx("p",{children:"Processos classificados como alto risco que necessitam atenção imediata"})})]}),e.jsxs(ds,{children:[e.jsx(ms,{asChild:!0,children:e.jsxs(ne,{className:"rounded-2xl border-border/50 hover:shadow-md transition-shadow cursor-help",children:[e.jsx(Ne,{className:"pb-3",children:e.jsxs(_e,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(pa,{className:"h-4 w-4 text-orange-500","aria-hidden":"true"}),"Atua nos Dois Polos"]})}),e.jsxs(de,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-3xl font-bold text-orange-600",children:U.testemunhasAmbosPolos}),e.jsxs(q,{variant:"secondary",className:"text-xs",children:[U.pctAmbos,"%"]})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Testemunhas em ambos os polos"})]})]})}),e.jsx(ts,{children:e.jsx("p",{children:"Testemunhas que participaram tanto como testemunha da reclamante quanto da ré"})})]})]})}),e.jsxs("div",{id:"chat-assistant-section",className:"mb-8 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Assistente de Análise"}),e.jsxs(De,{className:"inline-flex items-center gap-2 py-2 px-3 w-auto border-violet-200 bg-violet-50",children:[e.jsx(Ys,{className:"h-4 w-4 text-violet-600"}),e.jsxs(ke,{className:"text-xs text-violet-900",children:["IA Assistiva LGPD Compliant."," ",e.jsx("a",{href:"/privacidade",className:"underline font-medium hover:text-violet-700",children:"Saiba mais"})]})]})]}),e.jsx(di,{}),l&&e.jsx("div",{className:"mt-6",children:e.jsx(fi,{blocks:l})}),c==="loading"&&e.jsx("div",{className:"mt-6",children:e.jsx(ji,{})})]}),e.jsx("div",{className:"mt-8",children:e.jsxs(ja,{value:i,onValueChange:F,children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4 mb-6",children:[e.jsxs(va,{className:"grid w-full lg:w-auto grid-cols-2",children:[e.jsxs(ws,{value:"processos",className:"flex items-center gap-2",children:[e.jsx(xt,{className:"h-4 w-4","aria-hidden":"true"}),"Por Processo"]}),e.jsxs(ws,{value:"testemunhas",className:"flex items-center gap-2",children:[e.jsx(hs,{className:"h-4 w-4","aria-hidden":"true"}),"Por Testemunha"]})]}),e.jsxs("div",{className:"flex gap-2",children:[r&&e.jsx(bn,{userId:r.id}),e.jsx(vn,{})]})]}),e.jsxs(Cs,{value:"processos",className:"space-y-6",children:[e.jsx(Rt,{isLoading:m,hasError:v,errorMessage:g,isConnected:!v||d.length>3,dataCount:d.length,dataType:"processos"}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs(D,{variant:"outline",onClick:()=>ee(!0),className:"w-full sm:w-auto gap-2",children:[e.jsx(pt,{className:"h-4 w-4"}),"Filtros Avançados",e.jsxs("kbd",{className:"ml-auto hidden sm:inline-flex h-5 select-none items-center gap-1 rounded border bg-muted px-1.5 font-mono text-[10px] font-medium opacity-100",children:[e.jsx("span",{className:"text-xs",children:"⌘"}),"F"]})]}),Z()]}),w!=="success"?e.jsx(xs,{status:w,onRetry:K}):e.jsx(dn,{data:d})]}),e.jsxs(Cs,{value:"testemunhas",className:"space-y-6",children:[e.jsx(Rt,{isLoading:m,hasError:v,errorMessage:g,isConnected:!v||u.length>3,dataCount:u.length,dataType:"testemunhas"}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs(D,{variant:"outline",onClick:()=>ee(!0),className:"w-full sm:w-auto gap-2",children:[e.jsx(pt,{className:"h-4 w-4"}),"Filtros Avançados",e.jsxs("kbd",{className:"ml-auto hidden sm:inline-flex h-5 select-none items-center gap-1 rounded border bg-muted px-1.5 font-mono text-[10px] font-medium opacity-100",children:[e.jsx("span",{className:"text-xs",children:"⌘"}),"F"]})]}),Z()]}),Y!=="success"?e.jsx(xs,{status:Y,onRetry:K}):e.jsx(un,{data:u,status:Y,onRetry:K})]})]})}),e.jsx(yn,{}),e.jsx(Dn,{}),e.jsx(jn,{open:me,onOpenChange:ee})]})]}):null},Ei=()=>e.jsx(vi,{children:e.jsx(Ti,{})}),$i=Object.freeze(Object.defineProperty({__proto__:null,default:Ei},Symbol.toStringTag,{value:"Module"}));export{ki as $,$o as A,La as B,Oi as C,Ea as D,ps as E,fs as F,ls as G,Xe as H,Hs as I,Io as J,Ua as K,qa as L,Va as M,Ks as N,za as O,Gs as P,Ba as Q,pi as R,Ge as S,Ta as T,Ts as U,xs as V,Ii as W,In as X,Co as Y,tr as Z,Da as _,Ve as a,Be as a0,Ye as a1,Do as a2,$i as a3,Qe as b,ze as c,pe as d,tt as e,Fi as f,Ka as g,Ga as h,Wa as i,Za as j,Qa as k,Ya as l,Xa as m,st as n,Pa as o,Aa as p,ka as q,at as r,He as s,ds as t,ms as u,ts as v,ko as w,Ia as x,$a as y,Ma as z};
