import{_ as d}from"./page-About-Cbjp06Sg.js";import{i as _}from"./page-admin-BuSUzCMI.js";import"./vendor-BxqCFMEq.js";import"./page-Login-DNDHFDxr.js";import"./page-MapaPage-nKVcDvgy.js";import"./page-DemoMapaTestemunhas-BBtJmD6b.js";import"./page-Profile-BXlEY1ZK.js";import"./page-PortalTitular-DYwONV4c.js";import"./page-ReportDemo-Cny1mYiW.js";async function O(e,t,a){const s=`Aba,Linha,Coluna,Severidade,Regra,Valor,Auto-preenchido
`,o=e.issues.map(r=>`"${r.sheet}",${r.row},"${r.column}","${r.severity}","${r.rule}","${String(r.value).replace(/"/g,'""')}",${r.autofilled||!1}`).join(`
`),n=s+o,c=new Blob([n],{type:"text/csv"}),l=URL.createObjectURL(c),i={arquivo:t,dataHora:new Date().toISOString(),resumo:e.summary,issues:e.issues,correcoes:a?Object.fromEntries(a):{}},p=new Blob([JSON.stringify(i,null,2)],{type:"application/json"}),m=URL.createObjectURL(p);return{fixedXlsx:await f(e.normalizedData,a,t),reportCsv:l,reportJson:m}}async function f(e,t,a){const s=await d(()=>import("./xlsx-PER9UG_v.js"),[]),o=s.utils.book_new();console.log("游늵 Generating corrected XLSX with data:",{processos:e.processos?.length||0,testemunhas:e.testemunhas?.length||0,corrections:t?.size||0});const n=e.processos?.length>0?e.processos:[{cnj:"",reclamante_nome:"",reu_nome:"",comarca:"",tribunal:"",vara:"",fase:"",status:"",observacoes:"Nenhum processo v치lido encontrado - utilize este template para adicionar dados"}],c=s.utils.json_to_sheet(n);t&&e.processos?.length>0&&h(c,t),s.utils.book_append_sheet(o,c,"Por Processo");const l=e.testemunhas?.length>0?e.testemunhas:[{cnj:"",nome_testemunha:"",reclamante_nome:"",reu_nome:"",observacoes:"Nenhuma testemunha v치lida encontrada - utilize este template para adicionar dados"}],i=s.utils.json_to_sheet(l);t&&e.testemunhas?.length>0&&h(i,t),s.utils.book_append_sheet(o,i,"Por Testemunha");const p=[{Arquivo_Original:a||"Desconhecido",Data_Processamento:new Date().toISOString(),Processos_V치lidos:e.processos?.length||0,Testemunhas_V치lidas:e.testemunhas?.length||0,Corre칞칫es_Aplicadas:t?.size||0,Status:e.processos?.length>0||e.testemunhas?.length>0?"Dados v치lidos encontrados":"Apenas estrutura template - adicione dados v치lidos"}],m=s.utils.json_to_sheet(p);s.utils.book_append_sheet(o,m,"Resumo");const u=s.write(o,{type:"buffer",bookType:"xlsx",compression:!0}),r=new Blob([u],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});return URL.createObjectURL(r)}function h(e,t,a){e["!cols"]||(e["!cols"]=[]),e["!comments"]||(e["!comments"]=[]),t.forEach((s,o)=>{const n=o.includes("!")?o.split("!")[1]:o;_(n)&&e[n]&&(e["!comments"].push({ref:n,a:"Sistema",t:`Corrigido automaticamente: ${s.reason}
Original: ${s.original}
Novo: ${s.corrected}`}),e[n].s||(e[n].s={}),e[n].s.fill={fgColor:{rgb:"FFFACD"},patternType:"solid"})})}export{O as generateReports};
