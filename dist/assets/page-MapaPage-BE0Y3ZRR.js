import{r as x,j as e,ah as Dt,ai as gr,aj as jr,ak as vr,al as ks,am as kt,an as Os,ao as Ot,ap as Xe,aq as Fs,ar as Is,as as Ft,at as It,au as Mt,av as br,aw as $t,ax as Nr,ay as Lt,az as qt,aA as zt,aB as Vt,aC as _r,aD as Bt,aE as Ut,aF as Jt,aG as Ht,a7 as st,aH as Kt,aI as yr,aJ as Gt,aK as Qt,aL as wr,aM as Cr,aN as Se,J as ls,S as Sr,aO as Wt,aP as Tr,aQ as Er,aR as Zt,aS as Pr,$ as Xt,aT as Rr,aU as Yt,aV as Ar,aW as ea,aX as sa,aY as ta,aZ as aa,a_ as ra,a$ as Dr,b0 as kr,b1 as Or,b2 as Fr,b3 as oa,b4 as Ir,C as ds,b5 as Mr,b6 as na,b7 as $r,b8 as ia,b9 as Lr,ba as qr,bb as la,l as ca,bc as da,bd as ma,be as ua,bf as Ye,bg as zr,L as cs,t as He,bh as ha,bi as xa,ae as fs,bj as Vr,bk as Br,bl as Ke,v as $e,bm as Js,bn as Ur,bo as Jr,bp as Hr,bq as Kr,br as tt,bs as Hs,o as ws,V as Gr,x as at,bt as Qr,Z as Wr,ab as Cs,O as pa,bu as Le,bv as Zr,i as Fe,ac as Ks,D as fa,a0 as $s,bw as Xr,u as rt,af as Ve,U as gs,bx as Yr,by as Ss,bz as eo,E as Gs,bA as so,P as Qs,bB as to,bC as ao,bD as ro,e as ga,bE as xt,p as oo,bF as no,k as pt,bG as io,bH as lo,bI as ja,bJ as co,bK as mo,bL as uo,ag as ho,F as xo,d as po,bM as fo,aa as ft,bN as gt}from"./vendor-DOQZV8zk.js";import{k as N,m as go,y as va,z as jo,D as Ae,a as q,B as A,o as ke,q as Oe,s as Ie,C as ie,b as _e,c as ye,n as as,d as ue,_ as vo,u as ms,E as Re,w as Pe,Z as Ts,F as bo,G as Ls,H as No,I as _o,J as yo,A as wo,f as jt,g as vt,h as bt}from"./page-About-DNVyxqcM.js";import{L as Ne,I as Qe,T as ba,a as Na,b as Es,c as Ps,w as _a,l as Ce,u as Co}from"./page-Login-mefI8pv3.js";import{P as ya,a as wa,b as Ca,T as Sa,c as Ta,d as Rs,e as ve,f as Ea,g as be}from"./page-DemoMapaTestemunhas-BoqnYTib.js";const Pa=gr,xs=jr,ps=vr,ns=x.forwardRef(({className:s,sideOffset:t=4,...a},r)=>e.jsx(Dt,{ref:r,sideOffset:t,className:N("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...a}));ns.displayName=Dt.displayName;const Ra=Ft,Fi=It,So=kt,Aa=x.forwardRef(({className:s,...t},a)=>e.jsx(ks,{ref:a,className:N("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...t}));Aa.displayName=ks.displayName;const ot=x.forwardRef(({className:s,children:t,...a},r)=>e.jsxs(So,{children:[e.jsx(Aa,{}),e.jsxs(Os,{ref:r,className:N("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...a,children:[t,e.jsxs(Ot,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(Xe,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));ot.displayName=Os.displayName;const Da=({className:s,...t})=>e.jsx("div",{className:N("flex flex-col space-y-1.5 text-center sm:text-left",s),...t});Da.displayName="DialogHeader";const To=({className:s,...t})=>e.jsx("div",{className:N("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t});To.displayName="DialogFooter";const ka=x.forwardRef(({className:s,...t},a)=>e.jsx(Fs,{ref:a,className:N("text-lg font-semibold leading-none tracking-tight",s),...t}));ka.displayName=Fs.displayName;const Oa=x.forwardRef(({className:s,...t},a)=>e.jsx(Is,{ref:a,className:N("text-sm text-muted-foreground",s),...t}));Oa.displayName=Is.displayName;const nt=x.forwardRef(({className:s,...t},a)=>e.jsx(Mt,{className:N("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",s),...t,ref:a,children:e.jsx(br,{className:N("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));nt.displayName=Mt.displayName;const As=x.forwardRef(({className:s,value:t,...a},r)=>e.jsx($t,{ref:r,className:N("relative h-2 w-full overflow-hidden rounded-full bg-secondary",s),...a,children:e.jsx(Nr,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));As.displayName=$t.displayName;const Ge=x.forwardRef(({className:s,orientation:t="horizontal",decorative:a=!0,...r},o)=>e.jsx(Lt,{ref:o,decorative:a,orientation:t,className:N("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",s),...r}));Ge.displayName=Lt.displayName;const Fa=Ft,Eo=It,Po=kt,Ia=x.forwardRef(({className:s,...t},a)=>e.jsx(ks,{className:N("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...t,ref:a}));Ia.displayName=ks.displayName;const Ro=go("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),it=x.forwardRef(({side:s="right",className:t,children:a,...r},o)=>e.jsxs(Po,{children:[e.jsx(Ia,{}),e.jsxs(Os,{ref:o,className:N(Ro({side:s}),t),...r,children:[a,e.jsxs(Ot,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[e.jsx(Xe,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));it.displayName=Os.displayName;const lt=({className:s,...t})=>e.jsx("div",{className:N("flex flex-col space-y-2 text-center sm:text-left",s),...t});lt.displayName="SheetHeader";const ct=x.forwardRef(({className:s,...t},a)=>e.jsx(Fs,{ref:a,className:N("text-lg font-semibold text-foreground",s),...t}));ct.displayName=Fs.displayName;const dt=x.forwardRef(({className:s,...t},a)=>e.jsx(Is,{ref:a,className:N("text-sm text-muted-foreground",s),...t}));dt.displayName=Is.displayName;const vs=wr,bs=Cr,Ao=x.forwardRef(({className:s,inset:t,children:a,...r},o)=>e.jsxs(qt,{ref:o,className:N("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",t&&"pl-8",s),...r,children:[a,e.jsx(zt,{className:"ml-auto h-4 w-4"})]}));Ao.displayName=qt.displayName;const Do=x.forwardRef(({className:s,...t},a)=>e.jsx(Vt,{ref:a,className:N("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...t}));Do.displayName=Vt.displayName;const us=x.forwardRef(({className:s,sideOffset:t=4,...a},r)=>e.jsx(_r,{children:e.jsx(Bt,{ref:r,sideOffset:t,className:N("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...a})}));us.displayName=Bt.displayName;const es=x.forwardRef(({className:s,inset:t,...a},r)=>e.jsx(Ut,{ref:r,className:N("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t&&"pl-8",s),...a}));es.displayName=Ut.displayName;const Ma=x.forwardRef(({className:s,children:t,checked:a,...r},o)=>e.jsxs(Jt,{ref:o,className:N("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),checked:a,...r,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Ht,{children:e.jsx(st,{className:"h-4 w-4"})})}),t]}));Ma.displayName=Jt.displayName;const ko=x.forwardRef(({className:s,children:t,...a},r)=>e.jsxs(Kt,{ref:r,className:N("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...a,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Ht,{children:e.jsx(yr,{className:"h-2 w-2 fill-current"})})}),t]}));ko.displayName=Kt.displayName;const Oo=x.forwardRef(({className:s,inset:t,...a},r)=>e.jsx(Gt,{ref:r,className:N("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",s),...a}));Oo.displayName=Gt.displayName;const Ws=x.forwardRef(({className:s,...t},a)=>e.jsx(Qt,{ref:a,className:N("-mx-1 my-1 h-px bg-muted",s),...t}));Ws.displayName=Qt.displayName;const mt=x.forwardRef(({className:s,...t},a)=>e.jsx(Se,{ref:a,className:N("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",s),...t}));mt.displayName=Se.displayName;const Ii=({children:s,...t})=>e.jsx(Ra,{...t,children:e.jsx(ot,{className:"overflow-hidden p-0 shadow-lg",children:e.jsx(mt,{className:"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5",children:s})})}),Fo=x.forwardRef(({className:s,...t},a)=>e.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[e.jsx(ls,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),e.jsx(Se.Input,{ref:a,className:N("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",s),...t})]}));Fo.displayName=Se.Input.displayName;const $a=x.forwardRef(({className:s,...t},a)=>e.jsx(Se.List,{ref:a,className:N("max-h-[300px] overflow-y-auto overflow-x-hidden",s),...t}));$a.displayName=Se.List.displayName;const La=x.forwardRef((s,t)=>e.jsx(Se.Empty,{ref:t,className:"py-6 text-center text-sm",...s}));La.displayName=Se.Empty.displayName;const qa=x.forwardRef(({className:s,...t},a)=>e.jsx(Se.Group,{ref:a,className:N("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",s),...t}));qa.displayName=Se.Group.displayName;const Io=x.forwardRef(({className:s,...t},a)=>e.jsx(Se.Separator,{ref:a,className:N("-mx-1 h-px bg-border",s),...t}));Io.displayName=Se.Separator.displayName;const za=x.forwardRef(({className:s,...t},a)=>e.jsx(Se.Item,{ref:a,className:N("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50",s),...t}));za.displayName=Se.Item.displayName;const Va=x.forwardRef(({...s},t)=>e.jsx("nav",{ref:t,"aria-label":"breadcrumb",...s}));Va.displayName="Breadcrumb";const Ba=x.forwardRef(({className:s,...t},a)=>e.jsx("ol",{ref:a,className:N("flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5",s),...t}));Ba.displayName="BreadcrumbList";const Zs=x.forwardRef(({className:s,...t},a)=>e.jsx("li",{ref:a,className:N("inline-flex items-center gap-1.5",s),...t}));Zs.displayName="BreadcrumbItem";const Xs=x.forwardRef(({asChild:s,className:t,...a},r)=>{const o=s?Sr:"a";return e.jsx(o,{ref:r,className:N("transition-colors hover:text-foreground",t),...a})});Xs.displayName="BreadcrumbLink";const Ua=x.forwardRef(({className:s,...t},a)=>e.jsx("span",{ref:a,role:"link","aria-disabled":"true","aria-current":"page",className:N("font-normal text-foreground",s),...t}));Ua.displayName="BreadcrumbPage";const Ja=({children:s,className:t,...a})=>e.jsx("li",{role:"presentation","aria-hidden":"true",className:N("[&>svg]:size-3.5",t),...a,children:s??e.jsx(zt,{})});Ja.displayName="BreadcrumbSeparator";const Ha=x.forwardRef(({className:s,children:t,...a},r)=>e.jsxs(Wt,{ref:r,className:N("relative overflow-hidden",s),...a,children:[e.jsx(Tr,{className:"h-full w-full rounded-[inherit] min-h-0",children:t}),e.jsx(Ka,{}),e.jsx(Er,{})]}));Ha.displayName=Wt.displayName;const Ka=x.forwardRef(({className:s,orientation:t="vertical",...a},r)=>e.jsx(Zt,{ref:r,orientation:t,className:N("flex touch-none select-none transition-colors",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",s),...a,children:e.jsx(Pr,{className:"relative flex-1 rounded-full bg-border"})}));Ka.displayName=Zt.displayName;const Mo=Xt()(Rr((s,t)=>({notifications:[],unreadCount:0,addNotification:a=>{const r=`notification-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,o={...a,id:r,createdAt:new Date,read:!1,duration:a.duration??5e3};return s(n=>({notifications:[o,...n.notifications],unreadCount:n.unreadCount+1})),o.duration&&setTimeout(()=>{t().removeNotification(r)},o.duration),r},removeNotification:a=>{s(r=>{const o=r.notifications.find(i=>i.id===a),n=o&&!o.read;return{notifications:r.notifications.filter(i=>i.id!==a),unreadCount:n?r.unreadCount-1:r.unreadCount}})},markAsRead:a=>{s(r=>{const o=r.notifications.map(i=>i.id===a?{...i,read:!0}:i),n=o.filter(i=>!i.read).length;return{notifications:o,unreadCount:n}})},markAllAsRead:()=>{s(a=>({notifications:a.notifications.map(r=>({...r,read:!0})),unreadCount:0}))},clearAll:()=>{s({notifications:[],unreadCount:0})},clearRead:()=>{s(a=>({notifications:a.notifications.filter(r=>!r.read),unreadCount:a.unreadCount}))}}),{name:"assistjur-notifications",partialize:s=>({notifications:s.notifications.slice(0,50)})})),$o=()=>{const{addNotification:s,...t}=Mo();return{...t,success:(a,r,o)=>s({type:"success",title:a,message:r,...o}),error:(a,r,o)=>s({type:"error",title:a,message:r,duration:void 0,...o}),warning:(a,r,o)=>s({type:"warning",title:a,message:r,...o}),info:(a,r,o)=>s({type:"info",title:a,message:r,...o}),addNotification:s}},Lo=Dr,Mi=kr,qo=Ar,Ga=x.forwardRef(({className:s,...t},a)=>e.jsx(Yt,{className:N("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...t,ref:a}));Ga.displayName=Yt.displayName;const Qa=x.forwardRef(({className:s,...t},a)=>e.jsxs(qo,{children:[e.jsx(Ga,{}),e.jsx(ea,{ref:a,className:N("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...t})]}));Qa.displayName=ea.displayName;const Wa=({className:s,...t})=>e.jsx("div",{className:N("flex flex-col space-y-2 text-center sm:text-left",s),...t});Wa.displayName="AlertDialogHeader";const Za=({className:s,...t})=>e.jsx("div",{className:N("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t});Za.displayName="AlertDialogFooter";const Xa=x.forwardRef(({className:s,...t},a)=>e.jsx(sa,{ref:a,className:N("text-lg font-semibold",s),...t}));Xa.displayName=sa.displayName;const Ya=x.forwardRef(({className:s,...t},a)=>e.jsx(ta,{ref:a,className:N("text-sm text-muted-foreground",s),...t}));Ya.displayName=ta.displayName;const er=x.forwardRef(({className:s,...t},a)=>e.jsx(aa,{ref:a,className:N(va(),s),...t}));er.displayName=aa.displayName;const sr=x.forwardRef(({className:s,...t},a)=>e.jsx(ra,{ref:a,className:N(va({variant:"outline"}),"mt-2 sm:mt-0",s),...t}));sr.displayName=ra.displayName;const We=Or,Ze=Fr,Be=x.forwardRef(({className:s,children:t,...a},r)=>e.jsxs(oa,{ref:r,className:N("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...a,children:[t,e.jsx(Ir,{asChild:!0,children:e.jsx(ds,{className:"h-4 w-4 opacity-50"})})]}));Be.displayName=oa.displayName;const tr=x.forwardRef(({className:s,...t},a)=>e.jsx(la,{ref:a,className:N("flex cursor-default items-center justify-center py-1",s),...t,children:e.jsx(ca,{className:"h-4 w-4"})}));tr.displayName=la.displayName;const ar=x.forwardRef(({className:s,...t},a)=>e.jsx(da,{ref:a,className:N("flex cursor-default items-center justify-center py-1",s),...t,children:e.jsx(ds,{className:"h-4 w-4"})}));ar.displayName=da.displayName;const Ue=x.forwardRef(({className:s,children:t,position:a="popper",...r},o)=>e.jsx(Mr,{children:e.jsxs(na,{ref:o,className:N("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:a,...r,children:[e.jsx(tr,{}),e.jsx($r,{className:N("p-1",a==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),e.jsx(ar,{})]})}));Ue.displayName=na.displayName;const zo=x.forwardRef(({className:s,...t},a)=>e.jsx(ma,{ref:a,className:N("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...t}));zo.displayName=ma.displayName;const fe=x.forwardRef(({className:s,children:t,...a},r)=>e.jsxs(ia,{ref:r,className:N("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...a,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Lr,{children:e.jsx(st,{className:"h-4 w-4"})})}),e.jsx(qr,{children:t})]}));fe.displayName=ia.displayName;const Vo=x.forwardRef(({className:s,...t},a)=>e.jsx(ua,{ref:a,className:N("-mx-1 my-1 h-px bg-muted",s),...t}));Vo.displayName=ua.displayName;var _s={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/var Bo=_s.exports,Nt;function Uo(){return Nt||(Nt=1,(function(s,t){((a,r)=>{s.exports=r()})(Bo,function a(){var r=typeof self<"u"?self:typeof window<"u"?window:r!==void 0?r:{},o,n=!r.document&&!!r.postMessage,i=r.IS_PAPA_WORKER||!1,d={},u=0,m={};function v(l){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(c){var h=Y(c);h.chunkSize=parseInt(h.chunkSize),c.step||c.chunk||(h.chunkSize=null),this._handle=new f(h),(this._handle.streamer=this)._config=h}.call(this,l),this.parseChunk=function(c,h){var y=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<y){let z=this._config.newline;z||(C=this._config.quoteChar||'"',z=this._handle.guessLineEndings(c,C)),c=[...c.split(z).slice(y)].join(z)}this.isFirstChunk&&B(this._config.beforeFirstChunk)&&(C=this._config.beforeFirstChunk(c))!==void 0&&(c=C),this.isFirstChunk=!1,this._halted=!1;var y=this._partialLine+c,C=(this._partialLine="",this._handle.parse(y,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(c=C.meta.cursor,y=(this._finished||(this._partialLine=y.substring(c-this._baseIndex),this._baseIndex=c),C&&C.data&&(this._rowCount+=C.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),i)r.postMessage({results:C,workerId:m.WORKER_ID,finished:y});else if(B(this._config.chunk)&&!h){if(this._config.chunk(C,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=C=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(C.data),this._completeResults.errors=this._completeResults.errors.concat(C.errors),this._completeResults.meta=C.meta),this._completed||!y||!B(this._config.complete)||C&&C.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),y||C&&C.meta.paused||this._nextChunk(),C}this._halted=!0},this._sendError=function(c){B(this._config.error)?this._config.error(c):i&&this._config.error&&r.postMessage({workerId:m.WORKER_ID,error:c,finished:!1})}}function g(l){var c;(l=l||{}).chunkSize||(l.chunkSize=m.RemoteChunkSize),v.call(this,l),this._nextChunk=n?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(h){this._input=h,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(c=new XMLHttpRequest,this._config.withCredentials&&(c.withCredentials=this._config.withCredentials),n||(c.onload=H(this._chunkLoaded,this),c.onerror=H(this._chunkError,this)),c.open(this._config.downloadRequestBody?"POST":"GET",this._input,!n),this._config.downloadRequestHeaders){var h,y=this._config.downloadRequestHeaders;for(h in y)c.setRequestHeader(h,y[h])}var C;this._config.chunkSize&&(C=this._start+this._config.chunkSize-1,c.setRequestHeader("Range","bytes="+this._start+"-"+C));try{c.send(this._config.downloadRequestBody)}catch(z){this._chunkError(z.message)}n&&c.status===0&&this._chunkError()}},this._chunkLoaded=function(){c.readyState===4&&(c.status<200||400<=c.status?this._chunkError():(this._start+=this._config.chunkSize||c.responseText.length,this._finished=!this._config.chunkSize||this._start>=(h=>(h=h.getResponseHeader("Content-Range"))!==null?parseInt(h.substring(h.lastIndexOf("/")+1)):-1)(c),this.parseChunk(c.responseText)))},this._chunkError=function(h){h=c.statusText||h,this._sendError(new Error(h))}}function w(l){(l=l||{}).chunkSize||(l.chunkSize=m.LocalChunkSize),v.call(this,l);var c,h,y=typeof FileReader<"u";this.stream=function(C){this._input=C,h=C.slice||C.webkitSlice||C.mozSlice,y?((c=new FileReader).onload=H(this._chunkLoaded,this),c.onerror=H(this._chunkError,this)):c=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var C=this._input,z=(this._config.chunkSize&&(z=Math.min(this._start+this._config.chunkSize,this._input.size),C=h.call(C,this._start,z)),c.readAsText(C,this._config.encoding));y||this._chunkLoaded({target:{result:z}})},this._chunkLoaded=function(C){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(C.target.result)},this._chunkError=function(){this._sendError(c.error)}}function T(l){var c;v.call(this,l=l||{}),this.stream=function(h){return c=h,this._nextChunk()},this._nextChunk=function(){var h,y;if(!this._finished)return h=this._config.chunkSize,c=h?(y=c.substring(0,h),c.substring(h)):(y=c,""),this._finished=!c,this.parseChunk(y)}}function G(l){v.call(this,l=l||{});var c=[],h=!0,y=!1;this.pause=function(){v.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){v.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(C){this._input=C,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){y&&c.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),c.length?this.parseChunk(c.shift()):h=!0},this._streamData=H(function(C){try{c.push(typeof C=="string"?C:C.toString(this._config.encoding)),h&&(h=!1,this._checkIsFinished(),this.parseChunk(c.shift()))}catch(z){this._streamError(z)}},this),this._streamError=H(function(C){this._streamCleanUp(),this._sendError(C)},this),this._streamEnd=H(function(){this._streamCleanUp(),y=!0,this._streamData("")},this),this._streamCleanUp=H(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function f(l){var c,h,y,C,z=Math.pow(2,53),oe=-z,xe=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,ge=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,L=this,ee=0,D=0,ce=!1,M=!1,V=[],b={data:[],errors:[],meta:{}};function R(F){return l.skipEmptyLines==="greedy"?F.join("").trim()==="":F.length===1&&F[0].length===0}function j(){if(b&&y&&(Q("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+m.DefaultDelimiter+"'"),y=!1),l.skipEmptyLines&&(b.data=b.data.filter(function(k){return!R(k)})),E()){let k=function(te,ne){B(l.transformHeader)&&(te=l.transformHeader(te,ne)),V.push(te)};if(b)if(Array.isArray(b.data[0])){for(var F=0;E()&&F<b.data.length;F++)b.data[F].forEach(k);b.data.splice(0,1)}else b.data.forEach(k)}function _(k,te){for(var ne=l.header?{}:[],W=0;W<k.length;W++){var K=W,I=k[W],I=((je,p)=>(O=>(l.dynamicTypingFunction&&l.dynamicTyping[O]===void 0&&(l.dynamicTyping[O]=l.dynamicTypingFunction(O)),(l.dynamicTyping[O]||l.dynamicTyping)===!0))(je)?p==="true"||p==="TRUE"||p!=="false"&&p!=="FALSE"&&((O=>{if(xe.test(O)&&(O=parseFloat(O),oe<O&&O<z))return 1})(p)?parseFloat(p):ge.test(p)?new Date(p):p===""?null:p):p)(K=l.header?W>=V.length?"__parsed_extra":V[W]:K,I=l.transform?l.transform(I,K):I);K==="__parsed_extra"?(ne[K]=ne[K]||[],ne[K].push(I)):ne[K]=I}return l.header&&(W>V.length?Q("FieldMismatch","TooManyFields","Too many fields: expected "+V.length+" fields but parsed "+W,D+te):W<V.length&&Q("FieldMismatch","TooFewFields","Too few fields: expected "+V.length+" fields but parsed "+W,D+te)),ne}var se;b&&(l.header||l.dynamicTyping||l.transform)&&(se=1,!b.data.length||Array.isArray(b.data[0])?(b.data=b.data.map(_),se=b.data.length):b.data=_(b.data,0),l.header&&b.meta&&(b.meta.fields=V),D+=se)}function E(){return l.header&&V.length===0}function Q(F,_,se,k){F={type:F,code:_,message:se},k!==void 0&&(F.row=k),b.errors.push(F)}B(l.step)&&(C=l.step,l.step=function(F){b=F,E()?j():(j(),b.data.length!==0&&(ee+=F.data.length,l.preview&&ee>l.preview?h.abort():(b.data=b.data[0],C(b,L))))}),this.parse=function(F,_,se){var k=l.quoteChar||'"',k=(l.newline||(l.newline=this.guessLineEndings(F,k)),y=!1,l.delimiter?B(l.delimiter)&&(l.delimiter=l.delimiter(F),b.meta.delimiter=l.delimiter):((k=((te,ne,W,K,I)=>{var je,p,O,Z;I=I||[",","	","|",";",m.RECORD_SEP,m.UNIT_SEP];for(var ae=0;ae<I.length;ae++){for(var X,Me=I[ae],me=0,pe=0,le=0,de=(O=void 0,new re({comments:K,delimiter:Me,newline:ne,preview:10}).parse(te)),we=0;we<de.data.length;we++)W&&R(de.data[we])?le++:(X=de.data[we].length,pe+=X,O===void 0?O=X:0<X&&(me+=Math.abs(X-O),O=X));0<de.data.length&&(pe/=de.data.length-le),(p===void 0||me<=p)&&(Z===void 0||Z<pe)&&1.99<pe&&(p=me,je=Me,Z=pe)}return{successful:!!(l.delimiter=je),bestDelimiter:je}})(F,l.newline,l.skipEmptyLines,l.comments,l.delimitersToGuess)).successful?l.delimiter=k.bestDelimiter:(y=!0,l.delimiter=m.DefaultDelimiter),b.meta.delimiter=l.delimiter),Y(l));return l.preview&&l.header&&k.preview++,c=F,h=new re(k),b=h.parse(c,_,se),j(),ce?{meta:{paused:!0}}:b||{meta:{paused:!1}}},this.paused=function(){return ce},this.pause=function(){ce=!0,h.abort(),c=B(l.chunk)?"":c.substring(h.getCharIndex())},this.resume=function(){L.streamer._halted?(ce=!1,L.streamer.parseChunk(c,!0)):setTimeout(L.resume,3)},this.aborted=function(){return M},this.abort=function(){M=!0,h.abort(),b.meta.aborted=!0,B(l.complete)&&l.complete(b),c=""},this.guessLineEndings=function(te,k){te=te.substring(0,1048576);var k=new RegExp(U(k)+"([^]*?)"+U(k),"gm"),se=(te=te.replace(k,"")).split("\r"),k=te.split(`
`),te=1<k.length&&k[0].length<se[0].length;if(se.length===1||te)return`
`;for(var ne=0,W=0;W<se.length;W++)se[W][0]===`
`&&ne++;return ne>=se.length/2?`\r
`:"\r"}}function U(l){return l.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function re(l){var c=(l=l||{}).delimiter,h=l.newline,y=l.comments,C=l.step,z=l.preview,oe=l.fastMode,xe=null,ge=!1,L=l.quoteChar==null?'"':l.quoteChar,ee=L;if(l.escapeChar!==void 0&&(ee=l.escapeChar),(typeof c!="string"||-1<m.BAD_DELIMITERS.indexOf(c))&&(c=","),y===c)throw new Error("Comment character same as delimiter");y===!0?y="#":(typeof y!="string"||-1<m.BAD_DELIMITERS.indexOf(y))&&(y=!1),h!==`
`&&h!=="\r"&&h!==`\r
`&&(h=`
`);var D=0,ce=!1;this.parse=function(M,V,b){if(typeof M!="string")throw new Error("Input must be a string");var R=M.length,j=c.length,E=h.length,Q=y.length,F=B(C),_=[],se=[],k=[],te=D=0;if(!M)return me();if(oe||oe!==!1&&M.indexOf(L)===-1){for(var ne=M.split(h),W=0;W<ne.length;W++){if(k=ne[W],D+=k.length,W!==ne.length-1)D+=h.length;else if(b)return me();if(!y||k.substring(0,Q)!==y){if(F){if(_=[],Z(k.split(c)),pe(),ce)return me()}else Z(k.split(c));if(z&&z<=W)return _=_.slice(0,z),me(!0)}}return me()}for(var K=M.indexOf(c,D),I=M.indexOf(h,D),je=new RegExp(U(ee)+U(L),"g"),p=M.indexOf(L,D);;)if(M[D]===L)for(p=D,D++;;){if((p=M.indexOf(L,p+1))===-1)return b||se.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:_.length,index:D}),X();if(p===R-1)return X(M.substring(D,p).replace(je,L));if(L===ee&&M[p+1]===ee)p++;else if(L===ee||p===0||M[p-1]!==ee){K!==-1&&K<p+1&&(K=M.indexOf(c,p+1));var O=ae((I=I!==-1&&I<p+1?M.indexOf(h,p+1):I)===-1?K:Math.min(K,I));if(M.substr(p+1+O,j)===c){k.push(M.substring(D,p).replace(je,L)),M[D=p+1+O+j]!==L&&(p=M.indexOf(L,D)),K=M.indexOf(c,D),I=M.indexOf(h,D);break}if(O=ae(I),M.substring(p+1+O,p+1+O+E)===h){if(k.push(M.substring(D,p).replace(je,L)),Me(p+1+O+E),K=M.indexOf(c,D),p=M.indexOf(L,D),F&&(pe(),ce))return me();if(z&&_.length>=z)return me(!0);break}se.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:_.length,index:D}),p++}}else if(y&&k.length===0&&M.substring(D,D+Q)===y){if(I===-1)return me();D=I+E,I=M.indexOf(h,D),K=M.indexOf(c,D)}else if(K!==-1&&(K<I||I===-1))k.push(M.substring(D,K)),D=K+j,K=M.indexOf(c,D);else{if(I===-1)break;if(k.push(M.substring(D,I)),Me(I+E),F&&(pe(),ce))return me();if(z&&_.length>=z)return me(!0)}return X();function Z(le){_.push(le),te=D}function ae(le){var de=0;return de=le!==-1&&(le=M.substring(p+1,le))&&le.trim()===""?le.length:de}function X(le){return b||(le===void 0&&(le=M.substring(D)),k.push(le),D=R,Z(k),F&&pe()),me()}function Me(le){D=le,Z(k),k=[],I=M.indexOf(h,D)}function me(le){if(l.header&&!V&&_.length&&!ge){var de=_[0],we=Object.create(null),ss=new Set(de);let rs=!1;for(let qe=0;qe<de.length;qe++){let Te=de[qe];if(we[Te=B(l.transformHeader)?l.transformHeader(Te,qe):Te]){let ze,os=we[Te];for(;ze=Te+"_"+os,os++,ss.has(ze););ss.add(ze),de[qe]=ze,we[Te]++,rs=!0,(xe=xe===null?{}:xe)[ze]=Te}else we[Te]=1,de[qe]=Te;ss.add(Te)}rs&&console.warn("Duplicate headers found and renamed."),ge=!0}return{data:_,errors:se,meta:{delimiter:c,linebreak:h,aborted:ce,truncated:!!le,cursor:te+(V||0),renamedHeaders:xe}}}function pe(){C(me()),_=[],se=[]}},this.abort=function(){ce=!0},this.getCharIndex=function(){return D}}function P(l){var c=l.data,h=d[c.workerId],y=!1;if(c.error)h.userError(c.error,c.file);else if(c.results&&c.results.data){var C={abort:function(){y=!0,J(c.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:he,resume:he};if(B(h.userStep)){for(var z=0;z<c.results.data.length&&(h.userStep({data:c.results.data[z],errors:c.results.errors,meta:c.results.meta},C),!y);z++);delete c.results}else B(h.userChunk)&&(h.userChunk(c.results,C,c.file),delete c.results)}c.finished&&!y&&J(c.workerId,c.results)}function J(l,c){var h=d[l];B(h.userComplete)&&h.userComplete(c),h.terminate(),delete d[l]}function he(){throw new Error("Not implemented.")}function Y(l){if(typeof l!="object"||l===null)return l;var c,h=Array.isArray(l)?[]:{};for(c in l)h[c]=Y(l[c]);return h}function H(l,c){return function(){l.apply(c,arguments)}}function B(l){return typeof l=="function"}return m.parse=function(l,c){var h=(c=c||{}).dynamicTyping||!1;if(B(h)&&(c.dynamicTypingFunction=h,h={}),c.dynamicTyping=h,c.transform=!!B(c.transform)&&c.transform,!c.worker||!m.WORKERS_SUPPORTED)return h=null,m.NODE_STREAM_INPUT,typeof l=="string"?(l=(y=>y.charCodeAt(0)!==65279?y:y.slice(1))(l),h=new(c.download?g:T)(c)):l.readable===!0&&B(l.read)&&B(l.on)?h=new G(c):(r.File&&l instanceof File||l instanceof Object)&&(h=new w(c)),h.stream(l);(h=(()=>{var y;return!!m.WORKERS_SUPPORTED&&(y=(()=>{var C=r.URL||r.webkitURL||null,z=a.toString();return m.BLOB_URL||(m.BLOB_URL=C.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",z,")();"],{type:"text/javascript"})))})(),(y=new r.Worker(y)).onmessage=P,y.id=u++,d[y.id]=y)})()).userStep=c.step,h.userChunk=c.chunk,h.userComplete=c.complete,h.userError=c.error,c.step=B(c.step),c.chunk=B(c.chunk),c.complete=B(c.complete),c.error=B(c.error),delete c.worker,h.postMessage({input:l,config:c,workerId:h.id})},m.unparse=function(l,c){var h=!1,y=!0,C=",",z=`\r
`,oe='"',xe=oe+oe,ge=!1,L=null,ee=!1,D=((()=>{if(typeof c=="object"){if(typeof c.delimiter!="string"||m.BAD_DELIMITERS.filter(function(V){return c.delimiter.indexOf(V)!==-1}).length||(C=c.delimiter),typeof c.quotes!="boolean"&&typeof c.quotes!="function"&&!Array.isArray(c.quotes)||(h=c.quotes),typeof c.skipEmptyLines!="boolean"&&typeof c.skipEmptyLines!="string"||(ge=c.skipEmptyLines),typeof c.newline=="string"&&(z=c.newline),typeof c.quoteChar=="string"&&(oe=c.quoteChar),typeof c.header=="boolean"&&(y=c.header),Array.isArray(c.columns)){if(c.columns.length===0)throw new Error("Option columns is empty");L=c.columns}c.escapeChar!==void 0&&(xe=c.escapeChar+oe),c.escapeFormulae instanceof RegExp?ee=c.escapeFormulae:typeof c.escapeFormulae=="boolean"&&c.escapeFormulae&&(ee=/^[=+\-@\t\r].*$/)}})(),new RegExp(U(oe),"g"));if(typeof l=="string"&&(l=JSON.parse(l)),Array.isArray(l)){if(!l.length||Array.isArray(l[0]))return ce(null,l,ge);if(typeof l[0]=="object")return ce(L||Object.keys(l[0]),l,ge)}else if(typeof l=="object")return typeof l.data=="string"&&(l.data=JSON.parse(l.data)),Array.isArray(l.data)&&(l.fields||(l.fields=l.meta&&l.meta.fields||L),l.fields||(l.fields=Array.isArray(l.data[0])?l.fields:typeof l.data[0]=="object"?Object.keys(l.data[0]):[]),Array.isArray(l.data[0])||typeof l.data[0]=="object"||(l.data=[l.data])),ce(l.fields||[],l.data||[],ge);throw new Error("Unable to serialize unrecognized input");function ce(V,b,R){var j="",E=(typeof V=="string"&&(V=JSON.parse(V)),typeof b=="string"&&(b=JSON.parse(b)),Array.isArray(V)&&0<V.length),Q=!Array.isArray(b[0]);if(E&&y){for(var F=0;F<V.length;F++)0<F&&(j+=C),j+=M(V[F],F);0<b.length&&(j+=z)}for(var _=0;_<b.length;_++){var se=(E?V:b[_]).length,k=!1,te=E?Object.keys(b[_]).length===0:b[_].length===0;if(R&&!E&&(k=R==="greedy"?b[_].join("").trim()==="":b[_].length===1&&b[_][0].length===0),R==="greedy"&&E){for(var ne=[],W=0;W<se;W++){var K=Q?V[W]:W;ne.push(b[_][K])}k=ne.join("").trim()===""}if(!k){for(var I=0;I<se;I++){0<I&&!te&&(j+=C);var je=E&&Q?V[I]:I;j+=M(b[_][je],I)}_<b.length-1&&(!R||0<se&&!te)&&(j+=z)}}return j}function M(V,b){var R,j;return V==null?"":V.constructor===Date?JSON.stringify(V).slice(1,25):(j=!1,ee&&typeof V=="string"&&ee.test(V)&&(V="'"+V,j=!0),R=V.toString().replace(D,xe),(j=j||h===!0||typeof h=="function"&&h(V,b)||Array.isArray(h)&&h[b]||((E,Q)=>{for(var F=0;F<Q.length;F++)if(-1<E.indexOf(Q[F]))return!0;return!1})(R,m.BAD_DELIMITERS)||-1<R.indexOf(C)||R.charAt(0)===" "||R.charAt(R.length-1)===" ")?oe+R+oe:R)}},m.RECORD_SEP="",m.UNIT_SEP="",m.BYTE_ORDER_MARK="\uFEFF",m.BAD_DELIMITERS=["\r",`
`,'"',m.BYTE_ORDER_MARK],m.WORKERS_SUPPORTED=!n&&!!r.Worker,m.NODE_STREAM_INPUT=1,m.LocalChunkSize=10485760,m.RemoteChunkSize=5242880,m.DefaultDelimiter=",",m.Parser=re,m.ParserHandle=f,m.NetworkStreamer=g,m.FileStreamer=w,m.StringStreamer=T,m.ReadableStreamStreamer=G,r.jQuery&&((o=r.jQuery).fn.parse=function(l){var c=l.config||{},h=[];return this.each(function(z){if(!(o(this).prop("tagName").toUpperCase()==="INPUT"&&o(this).attr("type").toLowerCase()==="file"&&r.FileReader)||!this.files||this.files.length===0)return!0;for(var oe=0;oe<this.files.length;oe++)h.push({file:this.files[oe],inputElem:this,instanceConfig:o.extend({},c)})}),y(),this;function y(){if(h.length===0)B(l.complete)&&l.complete();else{var z,oe,xe,ge,L=h[0];if(B(l.before)){var ee=l.before(L.file,L.inputElem);if(typeof ee=="object"){if(ee.action==="abort")return z="AbortError",oe=L.file,xe=L.inputElem,ge=ee.reason,void(B(l.error)&&l.error({name:z},oe,xe,ge));if(ee.action==="skip")return void C();typeof ee.config=="object"&&(L.instanceConfig=o.extend(L.instanceConfig,ee.config))}else if(ee==="skip")return void C()}var D=L.instanceConfig.complete;L.instanceConfig.complete=function(ce){B(D)&&D(ce,L.file,L.inputElem),C()},m.parse(L.file,L.instanceConfig)}}function C(){h.splice(0,1),y()}}),i&&(r.onmessage=function(l){l=l.data,m.WORKER_ID===void 0&&l&&(m.WORKER_ID=l.workerId),typeof l.input=="string"?r.postMessage({workerId:m.WORKER_ID,results:m.parse(l.input,l.config),finished:!0}):(r.File&&l.input instanceof File||l.input instanceof Object)&&(l=m.parse(l.input,l.config))&&r.postMessage({workerId:m.WORKER_ID,results:l,finished:!0})}),(g.prototype=Object.create(v.prototype)).constructor=g,(w.prototype=Object.create(v.prototype)).constructor=w,(T.prototype=Object.create(T.prototype)).constructor=T,(G.prototype=Object.create(v.prototype)).constructor=G,m})})(_s)),_s.exports}var Jo=Uo();const rr=jo(Jo);function Ho(s){return s&&s.replace(/(\d{3})\.\d{3}\.\d{3}-(\d{2})/,"$1.***.***-$2")}function Ko(s){return s&&s.replace(/(\d{2})\.\d{3}\.\d{3}\/\d{4}-(\d{2})/,"$1.***.***/**-$2")}function Go(s){if(!s)return s;const[t,a]=s.split("@");return t.length<=2?`${t}***@${a}`:`${t.slice(0,2)}***@${a}`}function Qo(s){return s&&s.replace(/(\d{2})\d{4,5}(\d{4})/,"$1****$2")}function Wo(s){return s&&s.replace(/(\d{2,3})\d+/,"$1***")}function Zo(s){if(!s)return s;let t=s;return t=t.replace(/\d{3}\.\d{3}\.\d{3}-\d{2}/g,a=>Ho(a)),t=t.replace(/\d{2}\.\d{3}\.\d{3}\/\d{4}-\d{2}/g,a=>Ko(a)),t=t.replace(/[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}/g,a=>Go(a)),t=t.replace(/\(\d{2}\)\s?\d{4,5}-?\d{4}/g,a=>Qo(a)),t=t.replace(/OAB[-/]?\s?\d{3,6}/gi,a=>{const r=a.match(/\d{3,6}/)?.[0]||"";return a.replace(r,Wo(r))}),t}function Je(s,t){if(!t||!s)return s;if(typeof s=="string")return Zo(s);if(Array.isArray(s))return s.map(a=>Je(a,t));if(typeof s=="object"){const a={};for(const[r,o]of Object.entries(s))a[r]=Je(o,t);return a}return s}function ts({items:s,maxVisible:t=2,isPiiMasked:a=!1}){const{toast:r}=Ae();if(!s||s.length===0)return e.jsx("span",{className:"text-muted-foreground",children:"—"});const o=Je(s,a),n=o.slice(0,t),i=s.length-t,d=async()=>{try{await navigator.clipboard.writeText(s.join(`
`)),r({title:"Copiado!",description:"Lista copiada para a área de transferência."})}catch{r({title:"Erro ao copiar",description:"Não foi possível copiar a lista.",variant:"destructive"})}};return s.length<=t?e.jsx("div",{className:"flex flex-wrap gap-1",children:n.map((u,m)=>e.jsx(q,{variant:"secondary",className:"text-xs",children:u},m))}):e.jsxs("div",{className:"flex items-center gap-1",children:[n.map((u,m)=>e.jsx(q,{variant:"secondary",className:"text-xs",children:u},m)),i>0&&e.jsxs(ya,{children:[e.jsx(wa,{asChild:!0,children:e.jsxs(A,{variant:"ghost",size:"sm",className:"h-6 px-2 text-xs",children:["+",i," ",e.jsx(ds,{className:"ml-1 h-3 w-3"})]})}),e.jsx(Ca,{className:"w-80",align:"start",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h4",{className:"font-medium",children:["Lista completa (",s.length," itens)"]}),e.jsx(A,{variant:"ghost",size:"sm",onClick:d,className:"h-8 px-2",children:e.jsx(Ye,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"flex flex-wrap gap-1 max-h-48 overflow-y-auto",children:o.map((u,m)=>e.jsx(q,{variant:"outline",className:"text-xs",children:u},m))})]})})]})]})}const Xo=["⏱ Mapeando conexões de testemunhas…","🔎 Checando histórico probatório…","⚖️ Analisando padrões de triangulação…","📋 Identificando riscos processuais…","👥 Cruzando dados do polo ativo…","🎯 Gerando insights estratégicos…","📊 Compilando relatório executivo…"],S=Xt(s=>({processos:[],testemunhas:[],activeTab:"processos",selectedProcesso:null,selectedTestemunha:null,isDetailDrawerOpen:!1,isImportModalOpen:!1,isLoading:!1,isPiiMasked:!1,hasError:!1,errorMessage:"",lastUpdate:null,processoFilters:{},testemunhaFilters:{},columnVisibility:{processos:{cnj:!0,uf:!0,comarca:!0,fase:!0,status:!0,reclamante:!0,qtdDepos:!0,testemunhas:!0,classificacao:!0,acoes:!0},testemunhas:{nome:!0,qtdDepo:!0,ambosPolos:!0,jaReclamante:!0,cnjs:!0,classificacao:!0,acoes:!0}},savedViews:{},activeView:null,processosPage:1,testemunhasPage:1,pageSize:100,totalProcessos:0,totalTestemunhas:0,hasMoreProcessos:!1,hasMoreTestemunhas:!1,chatKind:"processo",chatInput:"",chatMessages:[],chatStatus:"idle",agentOnline:!0,chatResult:null,loadingHints:Xo,currentHintIndex:0,density:"comfortable",navigationHistory:[{label:"Mapa de Testemunhas",path:"/mapa-testemunhas"}],setActiveTab:t=>s(a=>a.activeTab===t?a:{activeTab:t}),setProcessos:t=>s(a=>JSON.stringify(a.processos)===JSON.stringify(t)?a:{processos:t}),setTestemunhas:t=>s(a=>JSON.stringify(a.testemunhas)===JSON.stringify(t)?a:{testemunhas:t}),setSelectedProcesso:t=>s(a=>a.selectedProcesso?.cnj===t?.cnj?a:{selectedProcesso:t}),setSelectedTestemunha:t=>s(a=>a.selectedTestemunha?.nome_testemunha===t?.nome_testemunha?a:{selectedTestemunha:t}),setIsDetailDrawerOpen:t=>s(a=>a.isDetailDrawerOpen===t?a:{isDetailDrawerOpen:t}),setIsImportModalOpen:t=>s(a=>a.isImportModalOpen===t?a:{isImportModalOpen:t}),setIsLoading:t=>s(a=>a.isLoading===t?a:{isLoading:t}),setIsPiiMasked:t=>s(a=>a.isPiiMasked===t?a:{isPiiMasked:t}),setError:(t,a="")=>s(r=>r.hasError===t&&r.errorMessage===a?r:{hasError:t,errorMessage:a}),setLastUpdate:t=>s(a=>a.lastUpdate?.getTime()===t?.getTime()?a:{lastUpdate:t}),setProcessoFilters:t=>s(a=>{const r={...a.processoFilters,...t};return Object.keys(t).forEach(o=>{t[o]===void 0&&delete r[o]}),{processoFilters:r,processosPage:1}}),setTestemunhaFilters:t=>s(a=>{const r={...a.testemunhaFilters,...t};return Object.keys(t).forEach(o=>{t[o]===void 0&&delete r[o]}),{testemunhaFilters:r,testemunhasPage:1}}),setColumnVisibility:(t,a,r)=>s(o=>({columnVisibility:{...o.columnVisibility,[t]:{...o.columnVisibility[t],[a]:r}}})),saveView:(t,a)=>s(r=>{const o={...r.savedViews,[t]:{processoFilters:r.processoFilters,testemunhaFilters:r.testemunhaFilters,columnVisibility:r.columnVisibility}};return typeof window<"u"&&typeof localStorage<"u"&&(localStorage.setItem(`mapaViews_${a}`,JSON.stringify(o)),localStorage.setItem(`mapaActiveView_${a}`,t)),{savedViews:o,activeView:t}}),loadViews:t=>{if(typeof window>"u"||typeof localStorage>"u")return;const a=localStorage.getItem(`mapaViews_${t}`),r=a?JSON.parse(a):{},o=localStorage.getItem(`mapaActiveView_${t}`);s({savedViews:r,activeView:o}),o&&r[o]&&s({processoFilters:r[o].processoFilters,testemunhaFilters:r[o].testemunhaFilters,columnVisibility:r[o].columnVisibility})},setActiveViewName:(t,a)=>s(r=>{const o=r.savedViews[t];return o?(typeof window<"u"&&typeof localStorage<"u"&&localStorage.setItem(`mapaActiveView_${a}`,t),{activeView:t,processoFilters:o.processoFilters,testemunhaFilters:o.testemunhaFilters,columnVisibility:o.columnVisibility}):{}}),setProcessosPage:t=>s({processosPage:t}),setTestemunhasPage:t=>s({testemunhasPage:t}),setTotalProcessos:t=>s({totalProcessos:t}),setTotalTestemunhas:t=>s({totalTestemunhas:t}),setHasMoreProcessos:t=>s({hasMoreProcessos:t}),setHasMoreTestemunhas:t=>s({hasMoreTestemunhas:t}),loadMoreProcessos:()=>s(t=>({processosPage:t.processosPage+1})),loadMoreTestemunhas:()=>s(t=>({testemunhasPage:t.testemunhasPage+1})),removeProcesso:t=>{let a=null;return s(r=>{const o=r.processos.findIndex(i=>i.cnj===t);if(o===-1)return{};a=r.processos[o];const n=[...r.processos];return n.splice(o,1),{processos:n,totalProcessos:r.totalProcessos-1}}),a},restoreProcesso:t=>s(a=>({processos:[t,...a.processos],totalProcessos:a.totalProcessos+1})),removeTestemunha:t=>{let a=null;return s(r=>{const o=r.testemunhas.findIndex(i=>i.nome_testemunha===t);if(o===-1)return{};a=r.testemunhas[o];const n=[...r.testemunhas];return n.splice(o,1),{testemunhas:n,totalTestemunhas:r.totalTestemunhas-1}}),a},restoreTestemunha:t=>s(a=>({testemunhas:[t,...a.testemunhas],totalTestemunhas:a.totalTestemunhas+1})),resetFilters:()=>s({processoFilters:{},testemunhaFilters:{},processosPage:1,testemunhasPage:1}),setChatKind:t=>s({chatKind:t}),setChatInput:t=>s({chatInput:t}),addChatMessage:t=>{const a={...t,id:`msg-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,timestamp:new Date};return s(r=>({chatMessages:[...r.chatMessages,a]})),a.id},updateChatMessage:(t,a)=>s(r=>({chatMessages:r.chatMessages.map(o=>o.id===t?{...o,...a}:o)})),setChatStatus:t=>s({chatStatus:t}),setAgentOnline:t=>s({agentOnline:t}),setChatResult:t=>s({chatResult:t}),resetChat:()=>s({chatInput:"",chatMessages:[],chatStatus:"idle",chatResult:null,currentHintIndex:0}),nextHint:()=>s(t=>({currentHintIndex:(t.currentHintIndex+1)%t.loadingHints.length})),setDensity:t=>s({density:t}),pushNavigation:t=>s(a=>a.navigationHistory[a.navigationHistory.length-1]?.path===t.path?{}:{navigationHistory:[...a.navigationHistory,t]}),popNavigation:t=>s(a=>({navigationHistory:a.navigationHistory.slice(0,t+1)})),clearNavigation:()=>s({navigationHistory:[{label:"Mapa de Testemunhas",path:"/mapa-testemunhas"}]})})),or=s=>s.activeTab,Yo=s=>s.processos,en=s=>s.testemunhas,sn=s=>s.isLoading,tn=s=>s.isPiiMasked,an=s=>s.hasError,rn=s=>s.errorMessage,on=s=>s.lastUpdate,nn=s=>s.processoFilters,ln=s=>s.testemunhaFilters,cn=s=>s.isImportModalOpen,ut=s=>s.columnVisibility,dn=s=>s.savedViews,mn=s=>s.activeView;function nr({score:s,riscoNivel:t,className:a}){const n=t?(i=>{switch(i){case"critico":return{level:"Crítico",color:"bg-red-600 text-white border-red-700"};case"alto":return{level:"Alto",color:"bg-destructive text-destructive-foreground"};case"medio":return{level:"Médio",color:"bg-amber-500/15 text-amber-600 border-amber-500/30"};case"baixo":return{level:"Baixo",color:"bg-emerald-500/15 text-emerald-600 border-emerald-500/30"}}})(t):s!==void 0?(i=>i>=70?{level:"VALIDAR",color:"bg-destructive text-destructive-foreground",riscoNivel:"alto"}:i>=50?{level:"AVALIAR",color:"bg-warning text-warning-foreground",riscoNivel:"medio"}:i>=30?{level:"CONHECER",color:"bg-success text-success-foreground",riscoNivel:"baixo"}:{level:"DESCARTAR",color:"bg-muted text-muted-foreground",riscoNivel:"baixo"})(s):{level:"N/A",color:"bg-muted text-muted-foreground"};return e.jsxs(q,{className:N("font-semibold px-3 py-1 shadow-sm",n.color,a),children:[n.level,s!==void 0&&!t?` (${s})`:""]})}function ir(s){const{toast:t}=Ae(),a=x.useRef(new Map);return{remove:({key:o,label:n,onDelete:i,onRestore:d})=>{const u=i();if(!u)return;a.current.set(o,u);const m=()=>{const v=a.current.get(o);v&&(d(v),a.current.delete(o))};t({title:`${s} removido`,description:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:n}),e.jsxs(A,{variant:"outline",size:"sm",onClick:m,className:"ml-2 h-6 px-2 text-xs",children:[e.jsx(zr,{className:"h-3 w-3 mr-1"}),"Desfazer"]})]}),duration:5e3}),setTimeout(()=>{a.current.delete(o)},5e3)}}}function ht({open:s,title:t,description:a,confirmText:r="Confirmar",cancelText:o="Cancelar",loading:n=!1,onConfirm:i,onCancel:d}){return e.jsx(Lo,{open:s,onOpenChange:u=>!u&&d(),children:e.jsxs(Qa,{children:[e.jsxs(Wa,{children:[e.jsx(Xa,{children:t}),a&&e.jsx(Ya,{children:a})]}),e.jsxs(Za,{children:[e.jsx(sr,{disabled:n,children:o}),e.jsxs(er,{onClick:i,disabled:n,children:[n&&e.jsx(cs,{className:"mr-2 h-4 w-4 animate-spin"}),r]})]})]})})}const lr={density:{compact:{row:"py-1",cell:"px-3 py-1",text:"text-xs",badge:"text-[10px] px-1.5 py-0",button:"h-6 w-6",icon:"h-3 w-3"},comfortable:{row:"py-3",cell:"px-4 py-3",text:"text-sm",badge:"text-xs px-2 py-0.5",button:"h-8 w-8",icon:"h-4 w-4"}}};function un({data:s}){const{setSelectedProcesso:t,setIsDetailDrawerOpen:a,isPiiMasked:r,removeProcesso:o,restoreProcesso:n,density:i}=S(),d=S(ut).processos,{remove:u}=ir("Processo"),[m,v]=x.useState(null),[g,w]=x.useState(!1),T=lr.density[i],G=P=>{t(P),a(!0)},f=P=>{v(P),w(!0)},U=()=>{m&&u({key:m.cnj,label:m.cnj,onDelete:()=>o(m.cnj),onRestore:n}),w(!1),v(null)},re=P=>{switch(P?.toLowerCase()){case"ativo":return"bg-success text-success-foreground";case"arquivado":return"bg-muted text-muted-foreground";case"suspenso":return"bg-warning text-warning-foreground";case"baixado":return"bg-secondary text-secondary-foreground";case"cancelado":return"bg-destructive text-destructive-foreground";default:return"bg-muted text-muted-foreground"}};return s.length?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"border border-border/50 rounded-2xl overflow-hidden",children:e.jsxs(Sa,{children:[e.jsx(Ta,{children:e.jsxs(Rs,{className:"bg-muted/30",children:[d.cnj&&e.jsx(ve,{className:"font-semibold",children:"CNJ"}),d.uf&&e.jsx(ve,{className:"font-semibold",children:"UF"}),d.comarca&&e.jsx(ve,{className:"font-semibold",children:"Comarca"}),d.fase&&e.jsx(ve,{className:"font-semibold",children:"Fase"}),d.status&&e.jsx(ve,{className:"font-semibold",children:"Status"}),d.reclamante&&e.jsx(ve,{className:"font-semibold",children:"Reclamante"}),d.qtdDepos&&e.jsx(ve,{className:"font-semibold",children:"Qtd Depo Únicos"}),d.testemunhas&&e.jsx(ve,{className:"font-semibold",children:"Testemunhas Ativo"}),d.classificacao&&e.jsx(ve,{className:"font-semibold",children:"Classificação"}),d.acoes&&e.jsx(ve,{className:"font-semibold text-center",children:"Ações"})]})}),e.jsx(Ea,{children:s.map(P=>e.jsxs(Rs,{className:N("hover:bg-muted/20",T.row),children:[d.cnj&&e.jsx(be,{className:N("font-mono",T.cell,T.text),children:String(Je(P.cnj,r))}),d.uf&&e.jsx(be,{className:T.cell,children:e.jsx(q,{variant:"outline",className:T.badge,children:P.uf})}),d.comarca&&e.jsx(be,{className:N("max-w-[150px] truncate",T.cell,T.text),title:P.comarca||"",children:String(Je(P.comarca,r)||"—")}),d.fase&&e.jsx(be,{className:T.cell,children:e.jsx(q,{variant:"secondary",className:T.badge,children:P.fase||"—"})}),d.status&&e.jsx(be,{className:T.cell,children:e.jsx(q,{className:N(T.badge,re(P.status)),children:P.status||"—"})}),d.reclamante&&e.jsx(be,{className:N("max-w-[180px] truncate",T.cell,T.text),title:P.reclamante_limpo||"",children:String(Je(P.reclamante_limpo,r)||"—")}),d.qtdDepos&&e.jsx(be,{className:N("text-center",T.cell),children:P.qtd_total_depos_unicos?e.jsx(nr,{score:P.qtd_total_depos_unicos}):"—"}),d.testemunhas&&e.jsx(be,{className:T.cell,children:e.jsx(ts,{items:P.testemunhas_ativo_limpo,maxVisible:2,isPiiMasked:r})}),d.classificacao&&e.jsx(be,{className:T.cell,children:e.jsx(q,{variant:P.classificacao_final==="ALTO RISCO"?"destructive":"secondary",className:T.badge,children:P.classificacao_final||"—"})}),d.acoes&&e.jsx(be,{className:T.cell,children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(A,{variant:"ghost",size:"sm",onClick:()=>G(P),className:N("p-0",T.button),children:e.jsx(He,{className:T.icon})}),e.jsx(A,{variant:"ghost",size:"sm",className:N("p-0",T.button),children:e.jsx(ha,{className:T.icon})}),e.jsx(A,{variant:"ghost",size:"sm",className:N("p-0 text-destructive hover:text-destructive",T.button),onClick:()=>f(P),children:e.jsx(xa,{className:T.icon})})]})})]},P.cnj))})]})}),e.jsx(ht,{open:g,title:"Excluir processo?",description:m?`Deseja excluir o processo ${m.cnj}?`:void 0,confirmText:"Excluir",onConfirm:U,onCancel:()=>{w(!1),v(null)}})]}):e.jsx("div",{className:"border border-border/50 rounded-2xl p-12 text-center",children:e.jsxs("div",{className:"text-muted-foreground space-y-2",children:[e.jsx("p",{className:"text-lg",children:"Nenhum processo encontrado"}),e.jsx("p",{className:"text-sm",children:"Ajuste os filtros ou importe dados via Excel"})]})})}function _t({value:s,trueLabel:t="Sim",falseLabel:a="Não",size:r="md",className:o}){return s==null?e.jsx(q,{variant:"outline",className:N("font-normal text-muted-foreground",r==="sm"?"text-[10px] px-1.5":"text-xs px-2",o),children:"—"}):s===!0?e.jsx(q,{variant:"outline",className:N("bg-green-100 text-green-800 border-green-200 font-medium","dark:bg-green-950/30 dark:text-green-400 dark:border-green-900",r==="sm"?"text-[10px] px-1.5":"text-xs px-2",o),children:t}):e.jsx(q,{variant:"outline",className:N("bg-gray-100 text-gray-600 border-gray-200 font-normal","dark:bg-gray-900/30 dark:text-gray-400 dark:border-gray-800",r==="sm"?"text-[10px] px-1.5":"text-xs px-2",o),children:a})}function hn({value:s,size:t="md"}){if(!s||s==="—"||s==="PENDENTE"||s==="")return e.jsx(q,{variant:"outline",className:N("font-normal text-muted-foreground",t==="sm"?"text-[10px] px-1.5 py-0":"text-xs"),children:"Não classificada"});const a=s.toLowerCase(),r=()=>a.includes("crítica")||a.includes("alto")||a.includes("alta")?"bg-red-100 text-red-800 border-red-200 dark:bg-red-950/30 dark:text-red-400 dark:border-red-900":a.includes("relevante")||a.includes("médio")||a.includes("media")?"bg-yellow-100 text-yellow-800 border-yellow-200 dark:bg-yellow-950/30 dark:text-yellow-400 dark:border-yellow-900":a.includes("comum")||a.includes("baixo")||a.includes("baixa")?"bg-green-100 text-green-800 border-green-200 dark:bg-green-950/30 dark:text-green-400 dark:border-green-900":"bg-secondary text-secondary-foreground";return e.jsx(q,{variant:"outline",className:N("font-medium border",r(),t==="sm"?"text-[10px] px-1.5 py-0":"text-xs"),children:s})}function js({status:s,onRetry:t,children:a}){return s==="loading"?e.jsx("div",{className:"p-8 text-center text-sm text-muted-foreground",children:"Carregando..."}):s==="error"?e.jsxs("div",{className:"p-8 text-center space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 text-destructive",children:[e.jsx(fs,{className:"h-4 w-4"}),e.jsx("span",{children:"Erro ao carregar"})]}),t&&e.jsx(A,{variant:"outline",size:"sm",onClick:t,children:"Tentar novamente"})]}):s==="offline"?e.jsxs("div",{className:"p-8 text-center space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 text-destructive",children:[e.jsx(fs,{className:"h-4 w-4"}),e.jsx("span",{children:"Sem conexão"})]}),t&&e.jsx(A,{variant:"outline",size:"sm",onClick:t,children:"Tentar novamente"})]}):s==="empty"?e.jsx("div",{className:"p-12 text-center text-muted-foreground",children:"Nenhum dado encontrado"}):e.jsx(e.Fragment,{children:a})}function xn({data:s,status:t,onRetry:a}){const{setSelectedTestemunha:r,setIsDetailDrawerOpen:o,isPiiMasked:n,removeTestemunha:i,restoreTestemunha:d,density:u}=S(),m=S(ut).testemunhas,{remove:v}=ir("Testemunha"),[g,w]=x.useState(null),[T,G]=x.useState(!1),f=lr.density[u],U=x.useCallback(J=>{r(J),o(!0)},[r,o]),re=x.useCallback(J=>{w(J),G(!0)},[]),P=x.useCallback(()=>{g&&v({key:g.nome_testemunha,label:g.nome_testemunha,onDelete:()=>i(g.nome_testemunha),onRestore:d}),G(!1),w(null)},[g,v,i,d]);return t!=="success"?e.jsx(js,{status:t,onRetry:a}):s.length?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"border border-border/50 rounded-2xl overflow-hidden",children:e.jsxs(Sa,{children:[e.jsx(Ta,{children:e.jsxs(Rs,{className:"bg-muted/30",children:[m.nome&&e.jsx(ve,{className:"font-semibold",children:"Nome da Testemunha"}),m.qtdDepo&&e.jsx(ve,{className:"font-semibold text-center",children:"Qtd Depoimentos"}),m.ambosPolos&&e.jsx(ve,{className:"font-semibold text-center",children:"Ambos os Polos"}),m.jaReclamante&&e.jsx(ve,{className:"font-semibold text-center",children:"Já Foi Reclamante"}),m.cnjs&&e.jsx(ve,{className:"font-semibold",children:"CNJs como Testemunha"}),m.classificacao&&e.jsx(ve,{className:"font-semibold",children:"Classificação Estratégica"}),m.acoes&&e.jsx(ve,{className:"font-semibold text-center",children:"Ações"})]})}),e.jsx(Ea,{children:s.map(J=>e.jsxs(Rs,{className:N("group hover:bg-muted/20",f.row),children:[m.nome&&e.jsx(be,{className:N("font-medium max-w-[200px] truncate",f.cell,f.text),title:J.nome_testemunha,children:String(Je(J.nome_testemunha,n))}),m.qtdDepo&&e.jsx(be,{className:N("text-center",f.cell),children:e.jsx(q,{variant:"secondary",className:f.badge,children:J.qtd_depoimentos||0})}),m.ambosPolos&&e.jsx(be,{className:N("text-center",f.cell),children:e.jsx(_t,{value:J.foi_testemunha_em_ambos_polos,size:"sm"})}),m.jaReclamante&&e.jsx(be,{className:N("text-center",f.cell),children:e.jsx(_t,{value:J.ja_foi_reclamante,size:"sm"})}),m.cnjs&&e.jsx(be,{className:f.cell,children:e.jsx(ts,{items:J.cnjs_como_testemunha??null,maxVisible:2,isPiiMasked:n})}),m.classificacao&&e.jsx(be,{className:f.cell,children:e.jsx(hn,{value:J.classificacao||J.classificacao_estrategica,size:"sm"})}),m.acoes&&e.jsx(be,{className:f.cell,children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(A,{variant:"ghost",size:"sm",onClick:()=>U(J),className:N("p-0 text-primary hover:bg-primary/10 hover:text-primary",f.button),title:"Visualizar detalhes",children:e.jsx(He,{className:f.icon,strokeWidth:2})}),e.jsx(A,{variant:"ghost",size:"sm",className:N("p-0 text-muted-foreground hover:text-foreground hover:bg-muted",f.button),title:"Editar",children:e.jsx(ha,{className:f.icon,strokeWidth:1.5})}),e.jsx(A,{variant:"ghost",size:"sm",className:N("p-0 opacity-0 group-hover:opacity-100 text-destructive hover:bg-destructive/10 hover:text-destructive transition-opacity",f.button),onClick:()=>re(J),title:"Excluir",children:e.jsx(xa,{className:f.icon,strokeWidth:1.5})})]})})]},J.nome_testemunha))})]})}),e.jsx(ht,{open:T,title:"Excluir testemunha?",description:g?`Deseja excluir ${g.nome_testemunha}?`:void 0,confirmText:"Excluir",onConfirm:P,onCancel:()=>{G(!1),w(null)}})]}):e.jsx(js,{status:"empty",onRetry:a})}const pn=["AC","AL","AP","AM","BA","CE","DF","ES","GO","MA","MT","MS","MG","PA","PB","PR","PE","PI","RJ","RN","RS","RO","RR","SC","SP","SE","TO"],fn=["Ativo","Arquivado","Suspenso","Baixado","Cancelado"],gn=["Conhecimento","Execução","Recursal","Liquidação"];function jn(){const{processoFilters:s,setProcessoFilters:t,resetFilters:a}=S(),r=(i,d)=>{if(d===""||d===void 0||d==="TODAS"||d==="TODOS"){const u={...s};delete u[i],t(u)}else t({[i]:d})},o=()=>{a()},n=Object.keys(s).length>0;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(ls,{className:"h-5 w-5"}),"Filtros - Por Processo"]}),n&&e.jsxs(A,{variant:"ghost",size:"sm",onClick:o,children:[e.jsx(Xe,{className:"h-4 w-4 mr-1"}),"Limpar"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ne,{htmlFor:"search",children:"Buscar"}),e.jsx(Qe,{id:"search",placeholder:"CNJ, comarca, reclamante...",value:s.search||"",onChange:i=>r("search",i.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ne,{htmlFor:"testemunha",children:"Testemunha"}),e.jsx(Qe,{id:"testemunha",placeholder:"Nome da testemunha...",value:s.testemunha||"",onChange:i=>r("testemunha",i.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ne,{htmlFor:"uf",children:"UF"}),e.jsxs(We,{value:s.uf||"TODAS",onValueChange:i=>r("uf",i),children:[e.jsx(Be,{id:"uf",children:e.jsx(Ze,{placeholder:"Selecione..."})}),e.jsxs(Ue,{children:[e.jsx(fe,{value:"TODAS",children:"Todas"}),pn.map(i=>e.jsx(fe,{value:i,children:i},i))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ne,{htmlFor:"status",children:"Status"}),e.jsxs(We,{value:s.status||"TODOS",onValueChange:i=>r("status",i),children:[e.jsx(Be,{id:"status",children:e.jsx(Ze,{placeholder:"Selecione..."})}),e.jsxs(Ue,{children:[e.jsx(fe,{value:"TODOS",children:"Todos"}),fn.map(i=>e.jsx(fe,{value:i,children:i},i))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ne,{htmlFor:"fase",children:"Fase"}),e.jsxs(We,{value:s.fase||"TODAS",onValueChange:i=>r("fase",i),children:[e.jsx(Be,{id:"fase",children:e.jsx(Ze,{placeholder:"Selecione..."})}),e.jsxs(Ue,{children:[e.jsx(fe,{value:"TODAS",children:"Todas"}),gn.map(i=>e.jsx(fe,{value:i,children:i},i))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ne,{htmlFor:"qtdMin",children:"Qtd Depo Únicos (Mín)"}),e.jsx(Qe,{id:"qtdMin",type:"number",placeholder:"0",value:s.qtdDeposMin||"",onChange:i=>r("qtdDeposMin",i.target.value?Number(i.target.value):void 0)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ne,{htmlFor:"qtdMax",children:"Qtd Depo Únicos (Máx)"}),e.jsx(Qe,{id:"qtdMax",type:"number",placeholder:"∞",value:s.qtdDeposMax||"",onChange:i=>r("qtdDeposMax",i.target.value?Number(i.target.value):void 0)})]})]})]})}function vn(){const{testemunhaFilters:s,setTestemunhaFilters:t,resetFilters:a}=S(),r=(i,d)=>{if(d===""||d===void 0||d==="TODOS"){const u={...s};delete u[i],t(u)}else t({[i]:d})},o=()=>{a()},n=Object.keys(s).length>0;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(ls,{className:"h-5 w-5"}),"Filtros - Por Testemunha"]}),n&&e.jsxs(A,{variant:"ghost",size:"sm",onClick:o,children:[e.jsx(Xe,{className:"h-4 w-4 mr-1"}),"Limpar"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ne,{htmlFor:"search",children:"Buscar"}),e.jsx(Qe,{id:"search",placeholder:"Nome da testemunha...",value:s.search||"",onChange:i=>r("search",i.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ne,{htmlFor:"ambosPolos",children:"Em Ambos os Polos"}),e.jsxs(We,{value:s.ambosPolos!==void 0?s.ambosPolos.toString():"TODOS",onValueChange:i=>r("ambosPolos",i==="TODOS"?void 0:i==="true"),children:[e.jsx(Be,{id:"ambosPolos",children:e.jsx(Ze,{placeholder:"Selecione..."})}),e.jsxs(Ue,{children:[e.jsx(fe,{value:"TODOS",children:"Todos"}),e.jsx(fe,{value:"true",children:"Sim"}),e.jsx(fe,{value:"false",children:"Não"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ne,{htmlFor:"jaFoiReclamante",children:"Já Foi Reclamante"}),e.jsxs(We,{value:s.jaFoiReclamante!==void 0?s.jaFoiReclamante.toString():"TODOS",onValueChange:i=>r("jaFoiReclamante",i==="TODOS"?void 0:i==="true"),children:[e.jsx(Be,{id:"jaFoiReclamante",children:e.jsx(Ze,{placeholder:"Selecione..."})}),e.jsxs(Ue,{children:[e.jsx(fe,{value:"TODOS",children:"Todos"}),e.jsx(fe,{value:"true",children:"Sim"}),e.jsx(fe,{value:"false",children:"Não"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ne,{htmlFor:"temTriangulacao",children:"Participou Triangulação"}),e.jsxs(We,{value:s.temTriangulacao!==void 0?s.temTriangulacao.toString():"TODOS",onValueChange:i=>r("temTriangulacao",i==="TODOS"?void 0:i==="true"),children:[e.jsx(Be,{id:"temTriangulacao",children:e.jsx(Ze,{placeholder:"Selecione..."})}),e.jsxs(Ue,{children:[e.jsx(fe,{value:"TODOS",children:"Todos"}),e.jsx(fe,{value:"true",children:"Sim"}),e.jsx(fe,{value:"false",children:"Não"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ne,{htmlFor:"temTroca",children:"Participou Troca"}),e.jsxs(We,{value:s.temTroca!==void 0?s.temTroca.toString():"TODOS",onValueChange:i=>r("temTroca",i==="TODOS"?void 0:i==="true"),children:[e.jsx(Be,{id:"temTroca",children:e.jsx(Ze,{placeholder:"Selecione..."})}),e.jsxs(Ue,{children:[e.jsx(fe,{value:"TODOS",children:"Todos"}),e.jsx(fe,{value:"true",children:"Sim"}),e.jsx(fe,{value:"false",children:"Não"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ne,{htmlFor:"qtdMin",children:"Qtd Depoimentos (Mín)"}),e.jsx(Qe,{id:"qtdMin",type:"number",placeholder:"0",value:s.qtdDeposMin||"",onChange:i=>r("qtdDeposMin",i.target.value?Number(i.target.value):void 0)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ne,{htmlFor:"qtdMax",children:"Qtd Depoimentos (Máx)"}),e.jsx(Qe,{id:"qtdMax",type:"number",placeholder:"∞",value:s.qtdDeposMax||"",onChange:i=>r("qtdDeposMax",i.target.value?Number(i.target.value):void 0)})]})]})]})}function bn({open:s,onOpenChange:t}){const a=S(n=>n.activeTab),[r,o]=x.useState(a==="processos"?"processos":"testemunhas");return x.useEffect(()=>{o(a==="processos"?"processos":"testemunhas")},[a]),e.jsx(Fa,{open:s,onOpenChange:t,children:e.jsxs(it,{side:"right",className:"w-[600px] sm:w-[700px] overflow-y-auto",children:[e.jsxs(lt,{children:[e.jsx(ct,{children:"Filtros Avançados"}),e.jsx(dt,{children:"Refine sua busca com filtros específicos por processo ou testemunha"})]}),e.jsx("div",{className:"mt-6",children:e.jsxs(ba,{value:r,onValueChange:o,children:[e.jsxs(Na,{className:"grid w-full grid-cols-2",children:[e.jsx(Es,{value:"processos",children:"Por Processo"}),e.jsx(Es,{value:"testemunhas",children:"Por Testemunha"})]}),e.jsx(Ps,{value:"processos",className:"mt-4",children:e.jsx(jn,{})}),e.jsx(Ps,{value:"testemunhas",className:"mt-4",children:e.jsx(vn,{})})]})})]})})}function Nn(){const s=S(or),t=S(ut),a=S(n=>n.setColumnVisibility),r=s==="processos"?[{key:"cnj",label:"CNJ"},{key:"uf",label:"UF"},{key:"comarca",label:"Comarca"},{key:"fase",label:"Fase"},{key:"status",label:"Status"},{key:"reclamante",label:"Reclamante"},{key:"qtdDepos",label:"Qtd Depo Únicos"},{key:"testemunhas",label:"Testemunhas Ativo"},{key:"classificacao",label:"Classificação"},{key:"acoes",label:"Ações"}]:[{key:"nome",label:"Nome da Testemunha"},{key:"qtdDepo",label:"Qtd Depoimentos"},{key:"ambosPolos",label:"Ambos os Polos"},{key:"jaReclamante",label:"Já Foi Reclamante"},{key:"cnjs",label:"CNJs como Testemunha"},{key:"classificacao",label:"Classificação Estratégica"},{key:"acoes",label:"Ações"}],o=t[s];return e.jsxs(vs,{children:[e.jsx(bs,{asChild:!0,children:e.jsxs(A,{variant:"outline",size:"sm",className:"flex items-center gap-2",children:[e.jsx(Vr,{className:"h-4 w-4"})," Colunas"]})}),e.jsx(us,{align:"end",children:r.map(n=>e.jsx(Ma,{checked:o[n.key],onCheckedChange:i=>a(s,n.key,i),children:n.label},n.key))})]})}function _n({userId:s}){const t=S(dn),a=S(mn),r=S(i=>i.saveView),o=S(i=>i.setActiveViewName),n=()=>{const i=window.prompt("Nome da visualização");i&&r(i,s)};return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(We,{value:a||"",onValueChange:i=>o(i,s),children:[e.jsx(Be,{className:"w-[200px]",children:e.jsx(Ze,{placeholder:"Visualizações"})}),e.jsx(Ue,{children:Object.keys(t).map(i=>e.jsx(fe,{value:i,children:i},i))})]}),e.jsxs(A,{variant:"outline",size:"sm",onClick:n,className:"flex items-center gap-2",children:[e.jsx(Br,{className:"h-4 w-4"})," Salvar visão"]})]})}const cr=({shouldScaleBackground:s=!0,...t})=>e.jsx(Ke.Root,{shouldScaleBackground:s,...t});cr.displayName="Drawer";const yn=Ke.Portal,dr=x.forwardRef(({className:s,...t},a)=>e.jsx(Ke.Overlay,{ref:a,className:N("fixed inset-0 z-50 bg-black/80",s),...t}));dr.displayName=Ke.Overlay.displayName;const mr=x.forwardRef(({className:s,children:t,...a},r)=>e.jsxs(yn,{children:[e.jsx(dr,{}),e.jsxs(Ke.Content,{ref:r,className:N("fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background",s),...a,children:[e.jsx("div",{className:"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted"}),t]})]}));mr.displayName="DrawerContent";const ur=({className:s,...t})=>e.jsx("div",{className:N("grid gap-1.5 p-4 text-center sm:text-left",s),...t});ur.displayName="DrawerHeader";const hr=x.forwardRef(({className:s,...t},a)=>e.jsx(Ke.Title,{ref:a,className:N("text-lg font-semibold leading-none tracking-tight",s),...t}));hr.displayName=Ke.Title.displayName;const wn=x.forwardRef(({className:s,...t},a)=>e.jsx(Ke.Description,{ref:a,className:N("text-sm text-muted-foreground",s),...t}));wn.displayName=Ke.Description.displayName;function Cn(){const{isDetailDrawerOpen:s,setIsDetailDrawerOpen:t,selectedProcesso:a,selectedTestemunha:r,isPiiMasked:o}=S(),{toast:n}=Ae(),i=async(m,v)=>{const g=String(Je(m,o));try{await navigator.clipboard.writeText(g),n({title:"Copiado!",description:`${v} copiado para a área de transferência.`})}catch{n({title:"Erro ao copiar",description:`Não foi possível copiar ${v}.`,variant:"destructive"})}},d=({value:m,label:v})=>e.jsxs("div",{className:"flex items-center gap-2",children:[m===null?e.jsx("span",{className:"text-muted-foreground",children:"—"}):m?e.jsxs(e.Fragment,{children:[e.jsx($e,{className:"h-4 w-4 text-success"}),e.jsx("span",{children:"Sim"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Js,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:"Não"})]}),v&&e.jsx(A,{variant:"ghost",size:"sm",onClick:()=>i(m?.toString()||"N/A",v),className:"h-6 w-6 p-0",children:e.jsx(Ye,{className:"h-3 w-3"})})]}),u=({label:m,value:v,copyable:g=!1})=>e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:m}),g&&v&&e.jsx(A,{variant:"ghost",size:"sm",onClick:()=>i(v.toString(),m),className:"h-6 w-6 p-0",children:e.jsx(Ye,{className:"h-3 w-3"})})]}),e.jsx("p",{className:"font-mono text-sm break-all",children:v?String(Je(v.toString(),o)):"—"})]});return!s||!a&&!r?null:e.jsx(cr,{open:s,onOpenChange:t,children:e.jsxs(mr,{className:"max-w-4xl mx-auto",children:[e.jsx(ur,{children:e.jsx(hr,{children:a?`Processo ${a.cnj}`:`Testemunha ${r?.nome_testemunha}`})}),e.jsxs(Ha,{className:"h-[80vh] px-6 pb-6",children:[a&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-muted/20 rounded-xl p-4",children:e.jsx(q,{variant:"outline",className:"mb-2",children:"Conteúdo assistivo. Revisão humana obrigatória."})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(u,{label:"CNJ",value:a.cnj,copyable:!0}),e.jsx(u,{label:"Status",value:a.status}),e.jsx(u,{label:"UF",value:a.uf}),e.jsx(u,{label:"Comarca",value:a.comarca,copyable:!0}),e.jsx(u,{label:"Fase",value:a.fase}),e.jsx(u,{label:"Reclamante",value:a.reclamante_limpo,copyable:!0})]}),e.jsx(Ge,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold",children:"Advogados Parte Ativa"}),e.jsx(ts,{items:a.advogados_parte_ativa,maxVisible:5,isPiiMasked:o})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold",children:"Testemunhas"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Polo Ativo"}),e.jsx(ts,{items:a.testemunhas_ativo_limpo,maxVisible:5,isPiiMasked:o})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Polo Passivo"}),e.jsx(ts,{items:a.testemunhas_passivo_limpo,maxVisible:5,isPiiMasked:o})]})]})]}),e.jsx(Ge,{}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Reclamante foi Testemunha"}),e.jsx(d,{value:a.reclamante_foi_testemunha})]}),e.jsx(u,{label:"Qtd Vezes Reclamante foi Testemunha",value:a.qtd_vezes_reclamante_foi_testemunha}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Troca Direta"}),e.jsx(d,{value:a.troca_direta})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Triangulação Confirmada"}),e.jsx(d,{value:a.triangulacao_confirmada})]})]}),e.jsx(Ge,{}),e.jsx(u,{label:"Classificação Final",value:a.classificacao_final}),e.jsx(u,{label:"Insight Estratégico",value:a.insight_estrategico,copyable:!0})]}),r&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-muted/20 rounded-xl p-4",children:e.jsx(q,{variant:"outline",className:"mb-2",children:"Conteúdo assistivo. Revisão humana obrigatória."})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(u,{label:"Nome da Testemunha",value:r.nome_testemunha,copyable:!0}),e.jsx(u,{label:"Quantidade de Depoimentos",value:r.qtd_depoimentos})]}),e.jsx(Ge,{}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Já Foi Reclamante"}),e.jsx(d,{value:r.ja_foi_reclamante})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Foi Testemunha em Ambos os Polos"}),e.jsx(d,{value:r.foi_testemunha_em_ambos_polos})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Participou Troca Favor"}),e.jsx(d,{value:r.participou_troca_favor})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Participou Triangulação"}),e.jsx(d,{value:r.participou_triangulacao})]})]}),e.jsx(Ge,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold",children:"CNJs como Testemunha"}),e.jsx(ts,{items:r.cnjs_como_testemunha??null,maxVisible:5,isPiiMasked:o})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold",children:"CNJs como Reclamante"}),e.jsx(ts,{items:r.cnjs_como_reclamante??null,maxVisible:5,isPiiMasked:o})]}),e.jsx(Ge,{}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(u,{label:"Classificação",value:r.classificacao??null}),e.jsx(u,{label:"Classificação Estratégica",value:r.classificacao_estrategica??null})]})]})]})]})})}const Sn=Ur,Tn=Jr,En=Hr;function Pn(s,t="Você tem alterações não salvas. Deseja sair?"){x.useEffect(()=>{if(!s)return;const a=r=>(r.preventDefault(),r.returnValue=t,t);return window.addEventListener("beforeunload",a),()=>{window.removeEventListener("beforeunload",a)}},[s,t])}const Ys=s=>String(s??"").replace(/\D/g,""),yt=s=>Ys(s).length===20,wt=s=>{const t=String(s??"").trim();if(!t||t==="[]")return[];if(t.startsWith("[")&&t.endsWith("]"))try{return JSON.parse(t.replace(/'/g,'"')).map(a=>String(a).trim()).filter(Boolean)}catch{}return t.split(/[;,]/).map(a=>a.trim()).filter(Boolean)},Rn=["Nome_Testemunha","CNJs_Como_Testemunha"],An=["CNJ","Reclamante_Limpo","Reu_Nome"],Ct=(s,t)=>(t.utils.sheet_to_json(s,{header:1,blankrows:!1})[0]||[]).map(r=>String(r||"").trim()),St=(s,t)=>{const a=new Set(s.map(o=>o.toLowerCase())),r=t.filter(o=>!a.has(o.toLowerCase()));return{ok:r.length===0,missing:r}},Dn=({currentStep:s,validationResults:t,isProcessing:a})=>{const r=[{id:"upload",title:"Upload do Arquivo",icon:Hs,description:"Selecione o arquivo Excel"},{id:"validation",title:"Validação",icon:ws,description:"Verificação da qualidade dos dados"},{id:"preview",title:"Prévia",icon:He,description:"Visualização antes da importação"},{id:"publish",title:"Importação",icon:$e,description:"Processamento final"}],o=i=>{const d=r.findIndex(m=>m.id===s),u=r.findIndex(m=>m.id===i);return a&&i===s?"processing":u<d?"completed":u===d?i==="validation"&&(t?.errors?.length??0)>0?"error":"current":"pending"},n=(i,d)=>{const u=i.icon;return d==="processing"?e.jsx(pa,{className:"h-5 w-5 animate-pulse"}):d==="completed"?e.jsx($e,{className:"h-5 w-5"}):d==="error"?e.jsx(fs,{className:"h-5 w-5"}):e.jsx(u,{className:"h-5 w-5"})};return e.jsx("div",{className:"mb-8",children:e.jsx("div",{className:"flex items-center justify-between",children:r.map((i,d)=>{const u=o(i.id),m=u==="current"||u==="processing",v=u==="completed",g=u==="error";return e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:`
                  flex items-center justify-center w-12 h-12 rounded-full border-2 
                  ${v?"bg-green-100 border-green-500 text-green-700 dark:bg-green-950 dark:border-green-400 dark:text-green-300":""}
                  ${m&&!g?"bg-primary/10 border-primary text-primary":""}
                  ${g?"bg-red-100 border-red-500 text-red-700 dark:bg-red-950 dark:border-red-400 dark:text-red-300":""}
                  ${u==="pending"?"bg-muted border-muted-foreground/25 text-muted-foreground":""}
                  transition-all duration-200
                `,children:n(i,u)}),e.jsxs("div",{className:"mt-3 text-center",children:[e.jsx("span",{className:`text-sm font-medium ${m?"text-foreground":v?"text-green-700 dark:text-green-300":g?"text-red-700 dark:text-red-300":"text-muted-foreground"}`,children:i.title}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:i.description})]})]}),d<r.length-1&&e.jsx("div",{className:`
                  w-16 h-0.5 mx-4 
                  ${d<r.findIndex(w=>w.id===s)?"bg-green-500":"bg-muted-foreground/25"}
                  transition-colors duration-200
                `})]},i.id)})})})},kn=({validationResults:s,fileName:t})=>{const{toast:a}=Ae();x.useState("empty"),x.useState(!1);const r=()=>{_a(async()=>{const i=[["Linha","Coluna","Tipo","Mensagem","Valor"].join(","),`"Resumo","Total: ${s.totalRows}","Válidos: ${s.validRows}","Erros: ${s.errors.length}","Avisos: ${s.warnings.length}"`,"",...s.errors.map(m=>[m.row,`"${m.column}"`,"Erro",`"${m.message}"`,`"${m.value||""}"`].join(",")),...s.warnings.map(m=>[m.row,`"${m.column}"`,"Aviso",`"${m.message}"`,`"${m.value||""}"`].join(","))].join(`
`),d=new Blob(["\uFEFF"+i],{type:"text/csv;charset=utf-8;"}),u=document.createElement("a");u.href=URL.createObjectURL(d),u.download=`relatorio-validacao-${t.replace(/\.[^/.]+$/,"")}-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(u),u.click(),document.body.removeChild(u),a({title:"Relatório CSV gerado",description:"Download iniciado com sucesso"})},"ImportModal.generateCSVReport")};return e.jsxs(ie,{children:[e.jsxs(_e,{children:[e.jsxs(ye,{className:"flex items-center gap-2",children:[e.jsx(Le,{className:"h-5 w-5"}),"Relatório de Validação"]}),e.jsx(as,{children:"Gere relatórios detalhados dos erros e avisos encontrados"})]}),e.jsxs(ue,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center p-3 bg-muted rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold",children:s.totalRows.toLocaleString()}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Total de linhas"})]}),e.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold text-green-600",children:s.validRows.toLocaleString()}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Linhas válidas"})]}),e.jsxs("div",{className:"text-center p-3 bg-red-50 rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold text-red-600",children:s.errors.length}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Erros"})]}),e.jsxs("div",{className:"text-center p-3 bg-orange-50 rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold text-orange-600",children:s.warnings.length}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Avisos"})]})]}),e.jsxs(A,{variant:"outline",onClick:r,className:"flex items-center gap-2",children:[e.jsx(Zr,{className:"h-4 w-4"}),"Exportar Relatório CSV"]})]})]})};function On(){const s=S(cn),t=S(b=>b.setIsImportModalOpen),{toast:a}=Ae(),[r,o]=x.useState("upload"),[n,i]=x.useState(null),[d,u]=x.useState(!1),[m,v]=x.useState(0),[g,w]=x.useState(null),[T,G]=x.useState(null),[f,U]=x.useState("empty"),[re,P]=x.useState(!1),[J,he]=x.useState(!1),Y=()=>{o("upload"),i(null),u(!1),v(0),w(null),G(null),U("empty"),P(!1)},H=!!n||r!=="upload";Pn(H);const B=b=>{b?t(!0):H?he(!0):(Y(),t(!1))},l=x.useCallback(b=>{const R=b[0];R&&(i(R),w(null),G(null),o("upload"),C(R))},[]),{getRootProps:c,getInputProps:h,isDragActive:y}=Kr({onDrop:l,accept:{"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"],"application/vnd.ms-excel":[".xls"]},maxFiles:1}),C=b=>{u(!0),v(0);const R=setInterval(()=>{v(j=>j>=95?(clearInterval(R),95):j+Math.random()*15)},200);xe(b)},z=b=>{const R=[];return b.forEach((j,E)=>{(!j.nome_testemunha||String(j.nome_testemunha).trim()==="")&&R.push({row:E+2,column:"Nome_Testemunha",message:"Nome_Testemunha é obrigatório",type:"error"});const Q=Array.isArray(j.cnjs_como_testemunha)?j.cnjs_como_testemunha:wt(j.cnjs_como_testemunha);Q.length||R.push({row:E+2,column:"CNJs_Como_Testemunha",message:"Lista de CNJs vazia",type:"error"}),Q.some(yt)||R.push({row:E+2,column:"CNJs_Como_Testemunha",message:"Nenhum CNJ com 20 dígitos na lista",type:"error"})}),R},oe=b=>{const R=[];return b.forEach((j,E)=>{(!j.cnj||!yt(j.cnj))&&R.push({row:E+2,column:"CNJ",message:"CNJ deve ter 20 dígitos (removendo máscara)",value:j.cnj,type:"error"}),(!j.reclamante_limpo||String(j.reclamante_limpo).trim()==="")&&R.push({row:E+2,column:"Reclamante_Limpo",message:"Reclamante_Limpo é obrigatório",type:"error"}),(!j.reu_nome||String(j.reu_nome).trim()==="")&&R.push({row:E+2,column:"Reu_Nome",message:"Reu_Nome é obrigatório",type:"error"})}),R},xe=async b=>{await _a(async()=>{const{porProcesso:R,porTestemunha:j,errors:E,warnings:Q}=await ge(b),F=R.length+j.length,_=F-E.length;w({totalRows:F,validRows:_,errors:E,warnings:Q||[],processos:R,testemunhas:j}),o("validation")},"ImportModal.processFileValidation").finally(()=>{u(!1),v(100)})},ge=async b=>{const R=await vo(()=>import("./xlsx-PER9UG_v.js"),[]);return new Promise((j,E)=>{const Q=new FileReader;Q.onload=F=>{try{const _=new Uint8Array(F.target?.result),se=R.read(_,{type:"array"}),k=se.Sheets["Por Processo"],te=se.Sheets["Por Testemunha"];if(!k&&!te)throw new Error('Arquivo deve conter ao menos uma aba: "Por Processo" ou "Por Testemunha".');const ne=[],W=[];let K=[];if(k){const I=Ct(k,R),{ok:je,missing:p}=St(I,An);if(!je)throw new Error(`Modo Processo: faltam colunas: ${p.join(", ")}`);R.utils.sheet_to_json(k,{defval:""}).forEach(Z=>{const ae=String(Z.CNJ??"").trim(),X={cnj:ae,cnj_digits:Ys(ae),reclamante_limpo:String(Z.Reclamante_Limpo??""),reu_nome:String(Z.Reu_Nome??""),comarca:String(Z.Comarca??""),fase:String(Z.Fase??""),status:String(Z.Status??"")};ne.push(X)}),K=K.concat(oe(ne))}if(te){const I=Ct(te,R),{ok:je,missing:p}=St(I,Rn);if(!je)throw new Error(`Modo Testemunha: faltam colunas: ${p.join(", ")}`);R.utils.sheet_to_json(te,{defval:""}).forEach(Z=>{const ae=wt(Z.CNJs_Como_Testemunha),X={nome_testemunha:String(Z.Nome_Testemunha??""),cnjs_como_testemunha:ae};W.push(X)}),K=K.concat(z(W))}j({porProcesso:ne,porTestemunha:W,errors:K})}catch(_){E(_)}},Q.onerror=()=>E(new Error("Erro ao ler arquivo")),Q.readAsArrayBuffer(b)})},L=async()=>{if(g){if(!navigator.onLine){U("offline"),P(!0);return}u(!0),v(0),o("publish"),U("loading");try{const b=setInterval(()=>{v(F=>F>=90?(clearInterval(b),90):F+Math.random()*10)},300),R=g.testemunhas.flatMap(F=>F.cnjs_como_testemunha.map(_=>({nome_testemunha:F.nome_testemunha,cnj:_,cnj_digits:Ys(_)}))),j={};g.processos.length&&(j.processos=g.processos),R.length&&(j.testemunhas=R);const{data:E,error:Q}=await Ie.functions.invoke("import-mapa-testemunhas",{body:j});if(v(100),Q)throw Q;G(E),U("success"),P(!1),a({title:"Importação concluída!",description:`${E?.upserts??0} registros processados com sucesso.`})}catch(b){console.error("Import error:",b),U(navigator.onLine?"error":"offline"),P(!0);const R=b instanceof Error?b.message:"Ocorreu um erro durante a importação.";a({title:"Erro na importação",description:R,variant:"destructive"})}finally{u(!1),v(100)}}},ee=()=>{t(!1),i(null),w(null),G(null),o("upload"),v(0)},D=()=>e.jsxs(ie,{children:[e.jsxs(_e,{children:[e.jsxs(ye,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Hs,{className:"h-5 w-5"}),"Upload de Arquivo Excel"]}),e.jsxs(Sn,{children:[e.jsx(Tn,{asChild:!0,children:e.jsxs(A,{variant:"ghost",size:"sm",className:"text-muted-foreground",children:[e.jsx(Gr,{className:"h-4 w-4 mr-2"}),"Precisa de ajuda?",e.jsx(ds,{className:"h-4 w-4 ml-2"})]})}),e.jsx(En,{className:"absolute z-10 mt-2 p-4 bg-background border rounded-lg shadow-lg max-w-md right-0",children:e.jsx("div",{className:"space-y-3",children:e.jsxs(ke,{className:"border-blue-200 bg-blue-50 dark:bg-blue-950",children:[e.jsx(at,{className:"h-4 w-4 text-blue-600"}),e.jsxs(Oe,{className:"text-blue-800 dark:text-blue-200",children:[e.jsx("strong",{children:"Formato requerido:"})," Arquivo Excel (.xlsx) com abas:",e.jsx("br",{}),"• ",e.jsx("strong",{children:"Por Processo:"})," CNJ, Reclamante_Limpo, Reu_Nome",e.jsx("br",{}),"• ",e.jsx("strong",{children:"Por Testemunha:"})," Nome_Testemunha, CNJs_Como_Testemunha"]})]})})})]})]}),e.jsx(as,{children:"Faça upload do arquivo Excel com os dados do mapa de testemunhas"})]}),e.jsxs(ue,{children:[e.jsxs("div",{...c(),className:`border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors ${y?"border-primary bg-primary/5":"border-muted-foreground/25 hover:border-primary"}`,children:[e.jsx("input",{...h()}),e.jsx(Hs,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),y?e.jsx("p",{className:"text-lg",children:"Solte o arquivo aqui..."}):e.jsxs("div",{children:[e.jsx("p",{className:"text-lg mb-2",children:"Arraste e solte o arquivo aqui"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"ou clique para selecionar"}),e.jsx(A,{variant:"outline",children:"Selecionar Arquivo"})]})]}),n&&e.jsxs("div",{className:"mt-4 p-4 bg-muted rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:n.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[(n.size/1024/1024).toFixed(2)," MB • Excel"]})]}),e.jsx(A,{variant:"ghost",size:"sm",onClick:()=>{i(null),w(null),o("upload")},children:e.jsx(Qr,{className:"h-4 w-4"})})]}),d&&e.jsxs("div",{className:"mt-3",children:[e.jsx(As,{value:m,className:"w-full"}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-1 flex items-center gap-2",children:[e.jsx(Wr,{className:"h-3 w-3 animate-pulse"}),m<95?`Enviando arquivo... ${Math.round(m)}%`:"Processando e validando dados..."]})]})]})]})]}),ce=()=>e.jsxs(ie,{children:[e.jsxs(_e,{children:[e.jsxs(ye,{className:"flex items-center gap-2",children:[e.jsx(ws,{className:"h-5 w-5"}),"Validação e Normalização"]}),e.jsx(as,{children:"Verificando a qualidade e consistência dos dados"})]}),e.jsx(ue,{children:g?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold",children:g.totalRows?.toLocaleString()}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Linhas analisadas"})]}),e.jsxs("div",{className:"text-center p-4 bg-green-50 dark:bg-green-950 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:g.validRows?.toLocaleString()}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Linhas válidas"})]}),e.jsxs("div",{className:"text-center p-4 bg-red-50 dark:bg-red-950 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:g.errors?.length||0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Erros"})]}),e.jsxs("div",{className:"text-center p-4 bg-orange-50 dark:bg-orange-950 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600 dark:text-orange-400",children:g.warnings?.length||0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Avisos"})]})]}),g.errors?.length===0&&g.validRows>0&&e.jsxs(ke,{className:"border-green-200 bg-green-50 dark:bg-green-950 dark:border-green-800",children:[e.jsx($e,{className:"h-4 w-4 text-green-600"}),e.jsxs(Oe,{className:"text-green-800 dark:text-green-200",children:["✅ Arquivo pronto para importação!"," ",g.validRows," registros serão processados."]})]}),g.errors?.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium",children:"Erros Encontrados:"}),g.errors.slice(0,5).map((b,R)=>e.jsxs(ke,{variant:"destructive",children:[e.jsx(fs,{className:"h-4 w-4"}),e.jsxs(Oe,{children:[e.jsxs("strong",{children:["Linha ",b.row,":"]})," ",b.message," (",b.column,")"]})]},R)),g.errors.length>5&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["... e mais ",g.errors.length-5," erros"]})]}),(g.errors?.length>0||g.warnings?.length>0)&&e.jsx(kn,{validationResults:g,fileName:n?.name||"arquivo"}),e.jsxs("div",{className:"flex gap-2 justify-between",children:[e.jsx(A,{variant:"outline",onClick:()=>o("upload"),children:"Voltar"}),e.jsx("div",{className:"flex gap-2",children:e.jsx(A,{onClick:()=>o("preview"),disabled:g.validRows===0||(g.errors?.length||0)>0,children:g.errors?.length>0?"Corrigir Erros Primeiro":"Continuar para Prévia"})})]})]}):e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Cs,{className:"h-8 w-8 animate-spin mx-auto mb-4"}),e.jsx("p",{children:"Validando arquivo..."})]})})})]}),M=()=>e.jsxs(ie,{children:[e.jsxs(_e,{children:[e.jsxs(ye,{className:"flex items-center gap-2",children:[e.jsx(He,{className:"h-5 w-5"}),"Prévia dos Dados"]}),e.jsx(as,{children:"Visualização dos dados processados e normalizados"})]}),e.jsx(ue,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold",children:g?.processos.length||0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Processos"})]}),e.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold",children:g?.testemunhas.length||0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Testemunhas"})]}),e.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[e.jsxs("div",{className:"text-2xl font-bold",children:[g?Math.round(g.validRows/g.totalRows*100):0,"%"]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Taxa de sucesso"})]})]}),e.jsxs(ke,{className:"border-blue-200 bg-blue-50 dark:bg-blue-950 dark:border-blue-800",children:[e.jsx(He,{className:"h-4 w-4 text-blue-600"}),e.jsxs(Oe,{className:"text-blue-800 dark:text-blue-200",children:[e.jsx("strong",{children:"Prévia da Importação:"})," ",g?.validRows||0," registros serão processados e inseridos no mapa de testemunhas."]})]}),(g?.processos?.length??0)>0&&e.jsx("div",{className:"border rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-muted",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 text-left",children:"CNJ"}),e.jsx("th",{className:"p-3 text-left",children:"Reclamante"}),e.jsx("th",{className:"p-3 text-left",children:"Réu"})]})}),e.jsx("tbody",{children:g?.processos?.slice(0,3).map((b,R)=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"p-3 font-mono text-sm",children:b.cnj}),e.jsx("td",{className:"p-3",children:b.reclamante_limpo}),e.jsx("td",{className:"p-3",children:b.reu_nome})]},R))})]})}),e.jsxs("div",{className:"flex gap-2 justify-between",children:[e.jsx(A,{variant:"outline",onClick:()=>o("validation"),children:"Voltar para Validação"}),e.jsx(A,{onClick:L,className:"bg-green-600 hover:bg-green-700",disabled:(g?.errors?.length||0)>0,children:"Confirmar Importação"})]})]})})]}),V=()=>e.jsxs(ie,{children:[e.jsxs(_e,{children:[e.jsxs(ye,{className:"flex items-center gap-2",children:[e.jsx($e,{className:"h-5 w-5"}),"Importação"]}),e.jsx(as,{children:"Processamento dos dados no sistema"})]}),e.jsx(ue,{children:e.jsx("div",{className:"space-y-4",children:T?e.jsxs("div",{className:"space-y-4",children:[e.jsxs(ke,{className:"border-green-200 bg-green-50 dark:bg-green-950",children:[e.jsx($e,{className:"h-4 w-4 text-green-600"}),e.jsxs(Oe,{className:"text-green-800 dark:text-green-200",children:[e.jsx("strong",{children:"Importação concluída com sucesso!"}),e.jsx("br",{}),"• Registros processados: ",T.upserts,T.errors?.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),"• Erros: ",T.errors.length]})]})]}),e.jsx(A,{className:"w-full",onClick:ee,children:"Fechar"})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Cs,{className:"h-8 w-8 animate-spin mx-auto mb-4"}),e.jsx("p",{className:"font-medium",children:"Importando dados..."}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Processando e inserindo registros no mapa de testemunhas."}),e.jsxs("div",{className:"mt-4",children:[e.jsx(As,{value:m,className:"w-full"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:m<100?"Processando...":"Finalizando..."})]})]})})})]});return e.jsxs(e.Fragment,{children:[e.jsx(Ra,{open:s,onOpenChange:B,children:e.jsxs(ot,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(Da,{children:[e.jsxs(ka,{className:"flex items-center gap-2",children:[e.jsx(tt,{className:"h-5 w-5"}),"Importar Mapa de Testemunhas"]}),e.jsx(Oa,{children:'Importe dados do Excel com as abas "Por Processo" e/ou "Por Testemunha"'})]}),re&&e.jsx(ke,{variant:"destructive",className:"mb-4",children:e.jsx(Oe,{children:"Integração CNJ indisponível"})}),f!=="empty"&&f!=="success"&&e.jsx(js,{status:f,onRetry:L}),e.jsx(Dn,{currentStep:r,validationResults:g??void 0,isProcessing:d}),e.jsxs("div",{className:"space-y-6",children:[r==="upload"&&D(),r==="validation"&&ce(),r==="preview"&&M(),r==="publish"&&V()]})]})}),e.jsx(ht,{open:J,title:"Descartar alterações?",description:"Você possui alterações não salvas. Deseja realmente sair?",confirmText:"Sair",onConfirm:()=>{he(!1),Y(),t(!1)},onCancel:()=>he(!1)})]})}const Fn=()=>{const s=S(a=>a.isPiiMasked),t=S(a=>a.setIsPiiMasked);return e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Fe,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(nt,{id:"mask-pii",checked:s,onCheckedChange:t}),e.jsx(Ne,{htmlFor:"mask-pii",className:"text-sm font-medium cursor-pointer flex items-center gap-1",children:s?e.jsxs(e.Fragment,{children:[e.jsx(Ks,{className:"h-3 w-3"}),"Mascarar PII"]}):e.jsxs(e.Fragment,{children:[e.jsx(He,{className:"h-3 w-3"}),"Mostrar PII"]})})]})]})};function In(s){if(s.length!==18)throw new Error("CNJ without check digits must have exactly 18 digits");const t=[2,3,4,5,6,7,8,9,2,3,4,5,6,7,8,9,2,3];let a=0;const r=s.split("").map(Number);for(let i=0;i<r.length;i++)a+=r[i]*t[i];return(98-a%97).toString().padStart(2,"0")}function Mn(s){const t=s?.year||2018+Math.floor(Math.random()*8),a=s?.sequential||String(Math.floor(Math.random()*9999999)+1).padStart(7,"0"),r=s?.justice,o=s?.tribunal,n=s?.origin||String(Math.floor(Math.random()*9999)+1).padStart(4,"0"),i=a+t+r+o+n,d=In(i);return`${a}-${d}.${t}.${r}.${o}.${n}`}function $n(s,t=2024){const a=[];for(let o=0;o<s;o++){const n=String(1e6+o).padStart(7,"0");a.push(Mn({sequential:n,year:t,justice:"5",tribunal:"02",origin:String(1e3+o).padStart(4,"0")}))}return a}const De=$n(12,2024),$i=[{Aba:"Por Processo",Campo:"CNJ",Tipo:"texto",Obrigatorio:"Sim",Regra:"String com 20 dígitos (preserva formato original). Validação interna remove pontuação.",Exemplo:De[0]},{Aba:"Por Processo",Campo:"reclamante_nome",Tipo:"texto",Obrigatorio:"Sim (legado)",Regra:"Nome principal do reclamante (campo de compatibilidade)",Exemplo:"Ana Lima"},{Aba:"Por Processo",Campo:"reu_nome",Tipo:"texto",Obrigatorio:"Sim (legado)",Regra:"Nome do réu/empresa (campo de compatibilidade)",Exemplo:"Empresa XYZ Ltda"},{Aba:"Por Processo",Campo:"Status",Tipo:"texto",Obrigatorio:"Não",Regra:"Status atual do processo",Exemplo:"Em andamento"},{Aba:"Por Processo",Campo:"Fase",Tipo:"texto",Obrigatorio:"Não",Regra:"Fase processual atual",Exemplo:"Instrução"},{Aba:"Por Processo",Campo:"UF",Tipo:"texto",Obrigatorio:"Sim",Regra:"Sigla de 2 letras do estado",Exemplo:"SP"},{Aba:"Por Processo",Campo:"Comarca",Tipo:"texto",Obrigatorio:"Sim",Regra:"Nome da comarca",Exemplo:"São Paulo"},{Aba:"Por Processo",Campo:"Reclamantes",Tipo:"lista",Obrigatorio:"Sim",Regra:"Lista separada por ; (ponto e vírgula). Não usar []",Exemplo:"Ana Lima; Pedro Santos"},{Aba:"Por Processo",Campo:"Advogados_Ativo",Tipo:"lista",Obrigatorio:"Sim",Regra:"Lista separada por ; (primeiro é principal na UI)",Exemplo:"Dr. Xavier Silva; Dra. Yasmim Oliveira"},{Aba:"Por Processo",Campo:"Testemunhas_Ativo",Tipo:"lista",Obrigatorio:"Não",Regra:"Lista separada por ; ou — se vazio",Exemplo:"João Pereira; Carlos Costa"},{Aba:"Por Processo",Campo:"Testemunhas_Passivo",Tipo:"lista",Obrigatorio:"Não",Regra:"Lista separada por ; ou — se vazio",Exemplo:"Ana Silva"},{Aba:"Por Processo",Campo:"Todas_Testemunhas",Tipo:"lista",Obrigatorio:"Sim",Regra:"União de todas as testemunhas, separadas por ;",Exemplo:"João Pereira; Beatriz Nunes; Carlos Costa"},{Aba:"Por Processo",Campo:"Reclamante_Foi_Testemunha",Tipo:"boolean",Obrigatorio:"Não",Regra:"true/false",Exemplo:"true"},{Aba:"Por Processo",Campo:"Qtd_Reclamante_Testemunha",Tipo:"número",Obrigatorio:"Não",Regra:"Quantidade de vezes que reclamante foi testemunha",Exemplo:"1"},{Aba:"Por Processo",Campo:"CNJs_Reclamante_Testemunha",Tipo:"lista",Obrigatorio:"Não",Regra:"Lista de CNJs separados por ; ou — se vazio",Exemplo:`${De[9]}`},{Aba:"Por Processo",Campo:"Reclamante_Testemunha_Polo_Passivo",Tipo:"boolean",Obrigatorio:"Não",Regra:"true/false",Exemplo:"false"},{Aba:"Por Processo",Campo:"CNJs_Passivo",Tipo:"lista",Obrigatorio:"Não",Regra:"CNJs onde reclamante foi testemunha do polo passivo",Exemplo:"—"},{Aba:"Por Processo",Campo:"Triangulacao_Confirmada",Tipo:"boolean",Obrigatorio:"Não",Regra:"true/false",Exemplo:"true"},{Aba:"Por Processo",Campo:"Desenho_Triangulacao",Tipo:"texto",Obrigatorio:"Não",Regra:"Padrão da triangulação (A→B→C→A) ou — se não houver",Exemplo:"A→B→C→A"},{Aba:"Por Processo",Campo:"CNJs_Triangulacao",Tipo:"lista",Obrigatorio:"Não",Regra:"CNJs envolvidos na triangulação, separados por ;",Exemplo:`${De[1]}; ${De[2]}; ${De[3]}`},{Aba:"Por Processo",Campo:"Contem_Prova_Emprestada",Tipo:"boolean",Obrigatorio:"Não",Regra:"true/false",Exemplo:"true"},{Aba:"Por Processo",Campo:"Testemunhas_Prova_Emprestada",Tipo:"lista",Obrigatorio:"Não",Regra:"Nomes das testemunhas de prova emprestada, separados por ;",Exemplo:"João Pereira"},{Aba:"Por Processo",Campo:"Classificacao_Final",Tipo:"texto",Obrigatorio:"Não",Regra:"Classificação de risco (Risco Alto, Risco Médio, Risco Baixo)",Exemplo:"Risco Alto"},{Aba:"Por Processo",Campo:"Insight_Estrategico",Tipo:"texto",Obrigatorio:"Não",Regra:"Resumo dos principais achados",Exemplo:"Triangulação + prova emprestada"},{Aba:"Por Testemunha",Campo:"Nome_Testemunha",Tipo:"texto",Obrigatorio:"Sim",Regra:"Nome completo da testemunha",Exemplo:"João Pereira"},{Aba:"Por Testemunha",Campo:"Qtd_Depoimentos",Tipo:"número",Obrigatorio:"Sim",Regra:"Quantidade total de depoimentos",Exemplo:"12"},{Aba:"Por Testemunha",Campo:"CNJs_Como_Testemunha",Tipo:"lista",Obrigatorio:"Sim",Regra:"Lista de CNJs separados por ;",Exemplo:`${De[0]}; ${De[9]}`},{Aba:"Por Testemunha",Campo:"Ja_Foi_Reclamante",Tipo:"boolean",Obrigatorio:"Não",Regra:"true/false",Exemplo:"false"},{Aba:"Por Testemunha",Campo:"CNJs_Como_Reclamante",Tipo:"lista",Obrigatorio:"Não",Regra:"CNJs onde foi reclamante, separados por ; ou — se vazio",Exemplo:"—"},{Aba:"Por Testemunha",Campo:"Foi_Testemunha_Ativo",Tipo:"boolean",Obrigatorio:"Não",Regra:"true/false",Exemplo:"true"},{Aba:"Por Testemunha",Campo:"Foi_Testemunha_Passivo",Tipo:"boolean",Obrigatorio:"Não",Regra:"true/false",Exemplo:"false"},{Aba:"Por Testemunha",Campo:"CNJs_Passivo",Tipo:"lista",Obrigatorio:"Não",Regra:"CNJs onde foi testemunha do polo passivo",Exemplo:"—"},{Aba:"Por Testemunha",Campo:"Foi_Ambos_Polos",Tipo:"boolean",Obrigatorio:"Não",Regra:"true/false",Exemplo:"false"},{Aba:"Por Testemunha",Campo:"Participou_Troca_Favor",Tipo:"boolean",Obrigatorio:"Não",Regra:"true/false",Exemplo:"true"},{Aba:"Por Testemunha",Campo:"CNJs_Troca_Favor",Tipo:"lista",Obrigatorio:"Não",Regra:"Padrão CNJ_A↔CNJ_B ou lista separada por ;",Exemplo:`${De[4]}↔${De[5]}`},{Aba:"Por Testemunha",Campo:"Participou_Triangulacao",Tipo:"boolean",Obrigatorio:"Não",Regra:"true/false",Exemplo:"true"},{Aba:"Por Testemunha",Campo:"CNJs_Triangulacao",Tipo:"lista",Obrigatorio:"Não",Regra:"CNJs da triangulação, separados por ;",Exemplo:`${De[1]}; ${De[2]}; ${De[3]}`},{Aba:"Por Testemunha",Campo:"E_Prova_Emprestada",Tipo:"boolean",Obrigatorio:"Não",Regra:"true/false",Exemplo:"true"},{Aba:"Por Testemunha",Campo:"Classificacao",Tipo:"texto",Obrigatorio:"Não",Regra:"ALTA, MÉDIA, BAIXA",Exemplo:"ALTA"},{Aba:"Por Testemunha",Campo:"Classificacao_Estrategica",Tipo:"texto",Obrigatorio:"Não",Regra:"CRÍTICO, ATENÇÃO, NORMAL",Exemplo:"CRÍTICO"}];function Ee(s){if(!s||s.length===0)return"—";const t=s.map(a=>String(a).trim()).filter(a=>a.length>0);return t.length>0?t.join("; "):"—"}const Ln=s=>({CNJ:s.cnj||"—",Status:s.status||"—",Fase:s.fase||"—",UF:s.uf||"—",Comarca:s.comarca||"—",Reclamantes:s.reclamante_limpo||"—",Advogados_Ativo:Ee(s.advogados_parte_ativa||[]),Testemunhas_Ativo:Ee(s.testemunhas_ativo_limpo||[]),Testemunhas_Passivo:Ee(s.testemunhas_passivo_limpo||[]),Todas_Testemunhas:Ee(s.todas_testemunhas||[]),Reclamante_Foi_Testemunha:s.reclamante_foi_testemunha||!1,Qtd_Reclamante_Testemunha:s.qtd_vezes_reclamante_foi_testemunha||0,CNJs_Reclamante_Testemunha:Ee(s.cnjs_em_que_reclamante_foi_testemunha||[]),Reclamante_Testemunha_Polo_Passivo:s.reclamante_testemunha_polo_passivo||!1,CNJs_Passivo:Ee(s.cnjs_passivo||[]),Triangulacao_Confirmada:s.triangulacao_confirmada||!1,Desenho_Triangulacao:s.desenho_triangulacao||"—",CNJs_Triangulacao:Ee(s.cnjs_triangulacao||[]),Contem_Prova_Emprestada:s.contem_prova_emprestada||!1,Testemunhas_Prova_Emprestada:Ee(s.testemunhas_prova_emprestada||[]),Classificacao_Final:s.classificacao_final||"—",Insight_Estrategico:s.insight_estrategico||"—"}),qn=s=>({Nome_Testemunha:s.nome_testemunha,Qtd_Depoimentos:s.qtd_depoimentos||0,CNJs_Como_Testemunha:Ee(s.cnjs_como_testemunha||[]),Ja_Foi_Reclamante:s.ja_foi_reclamante||!1,CNJs_Como_Reclamante:Ee(s.cnjs_como_reclamante||[]),Foi_Testemunha_Ativo:s.foi_testemunha_ativo||!1,Foi_Testemunha_Passivo:s.foi_testemunha_passivo||!1,CNJs_Passivo:Ee(s.cnjs_passivo||[]),Foi_Ambos_Polos:s.foi_testemunha_em_ambos_polos||!1,Participou_Troca_Favor:s.participou_troca_favor||!1,CNJs_Troca_Favor:Ee(s.cnjs_troca_favor||[]),Participou_Triangulacao:s.participou_triangulacao||!1,CNJs_Triangulacao:Ee(s.cnjs_triangulacao||[]),E_Prova_Emprestada:s.e_prova_emprestada||!1,Classificacao:s.classificacao||"—",Classificacao_Estrategica:s.classificacao_estrategica||"—"}),zn=s=>{if(!s)return"";const t=s.replace(/\D/g,"");return t.length===11?t.replace(/(\d{3})\d{6}(\d{2})/,"$1******$2"):t.length>=3?t.substring(0,2)+"*".repeat(Math.max(1,t.length-4))+t.slice(-2):"*".repeat(s.length)},Vn=s=>{if(!s)return"";const t=s.replace(/\D/g,"");return t.length===14?t.replace(/(\d{2})\d{9}(\d{4})/,"$1*********$2"):t.length>=6?t.substring(0,2)+"*".repeat(Math.max(1,t.length-6))+t.slice(-4):"*".repeat(s.length)},Bn=s=>{if(!s)return"";const[t,a]=s.split("@");if(!t||!a)return s;const r=Math.min(2,t.length);return`${t.substring(0,r)+"*".repeat(Math.max(1,t.length-r))}@${a}`},Un=s=>{if(!s)return"";const t=s.replace(/\D/g,"");return t.length>=8?t.length===11?t.replace(/(\d{2})(\d{1})\d{4}(\d{2})/,"($1) $2****-**$3"):t.length===10?t.replace(/(\d{2})\d{4}(\d{2})/,"($1) ****-**$2"):t.substring(0,2)+"*".repeat(t.length-4)+t.slice(-2):"*".repeat(s.length)},Jn=s=>{if(!s)return"";const t=s.replace(/\D/g,"");return t.length>=4?s.replace(/\d/g,(a,r,o)=>{const n=o.substring(0,r+1).replace(/\D/g,"").length-1;return n===0||n===t.length-1?a:"*"}):s.replace(/\d/g,"*")},is=s=>{if(!s)return"";let t=s;return t=t.replace(/\b\d{3}\.?\d{3}\.?\d{3}-?\d{2}\b/g,a=>zn(a)),t=t.replace(/\b\d{2}\.?\d{3}\.?\d{3}\/?\d{4}-?\d{2}\b/g,a=>Vn(a)),t=t.replace(/\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b/g,a=>Bn(a)),t=t.replace(/\(\d{2}\)?\s*\d{4,5}-?\d{4}\b/g,a=>Un(a)),t=t.replace(/\bOAB\/?\w{2}\s*\d+/gi,a=>Jn(a)),t},Hn=(s,t={})=>{const{filename:a=`processos-${new Date().toISOString().split("T")[0]}.csv`,maskPII:r=!1,selectedOnly:o=!1,selectedIds:n=[]}=t;let i=s;o&&n.length>0&&(i=s.filter(w=>n.includes(w.cnj)));const d=i.map(w=>{const T=Ln(w);return r?{...T,Reclamantes:is(T.Reclamantes),Todas_Testemunhas:is(T.Todas_Testemunhas),Insight_Estrategico:is(T.Insight_Estrategico)}:T}),m="\uFEFF"+rr.unparse(d,{delimiter:",",header:!0}),v=new Blob([m],{type:"text/csv;charset=utf-8;"}),g=document.createElement("a");if(g.download!==void 0){const w=URL.createObjectURL(v);g.setAttribute("href",w),g.setAttribute("download",a),g.style.visibility="hidden",document.body.appendChild(g),g.click(),document.body.removeChild(g)}return d.length},Kn=(s,t={})=>{const{filename:a=`testemunhas-${new Date().toISOString().split("T")[0]}.csv`,maskPII:r=!1,selectedOnly:o=!1,selectedIds:n=[]}=t;let i=s;o&&n.length>0&&(i=s.filter(w=>n.includes(w.nome_testemunha)));const d=i.map(w=>{const T=qn(w);return r?{...T,Nome_Testemunha:is(T.Nome_Testemunha),CNJs_Como_Testemunha:is(T.CNJs_Como_Testemunha),CNJs_Como_Reclamante:is(T.CNJs_Como_Reclamante)}:T}),m="\uFEFF"+rr.unparse(d,{delimiter:",",header:!0}),v=new Blob([m],{type:"text/csv;charset=utf-8;"}),g=document.createElement("a");if(g.download!==void 0){const w=URL.createObjectURL(v);g.setAttribute("href",w),g.setAttribute("download",a),g.style.visibility="hidden",document.body.appendChild(g),g.click(),document.body.removeChild(g)}return d.length},Gn=(s,t=!0)=>{const r=s*(t?500:350);return r<1024?`${r} bytes`:r<1024*1024?`${(r/1024).toFixed(1)} KB`:`${(r/(1024*1024)).toFixed(1)} MB`},Qn=(s,t=!1)=>s===0?{isValid:!1,message:t?"Nenhum registro selecionado para exportação.":"Nenhum registro encontrado para exportação.",maxRecords:5e3}:s>5e3?{isValid:!1,message:`Limite de exportação excedido. Máximo permitido: ${5e3.toLocaleString()} registros. ${t?"Selecione menos registros":"Aplique filtros para reduzir o resultado"}.`,maxRecords:5e3}:{isValid:!0,maxRecords:5e3},Wn=({data:s,fileName:t,disabled:a=!1})=>{const[r,o]=x.useState(!1),n=S(tn),i=v=>v.length>0&&"cnj"in v[0]&&"reclamante_limpo"in v[0],d=async()=>{o(!0);try{const v=s.length,g=Qn(v,!1);if(!g.isValid){$s.error("Erro na exportação",{description:g.message});return}let w=0;const T=i(s)?"processos.csv":"testemunhas.csv";if(i(s)){const G=s.map(f=>({cnj:f.cnj,status:f.status||null,uf:f.uf||null,comarca:f.comarca||null,fase:f.fase||null,reclamante_limpo:f.reclamante_limpo||null,advogados_parte_ativa:f.advogados_parte_ativa||null,testemunhas_ativo_limpo:f.testemunhas_ativo_limpo||null,testemunhas_passivo_limpo:f.testemunhas_passivo_limpo||null,todas_testemunhas:f.todas_testemunhas||null,reclamante_foi_testemunha:f.reclamante_foi_testemunha||null,qtd_vezes_reclamante_foi_testemunha:f.qtd_vezes_reclamante_foi_testemunha||null,cnjs_em_que_reclamante_foi_testemunha:f.cnjs_em_que_reclamante_foi_testemunha||null,reclamante_testemunha_polo_passivo:f.reclamante_testemunha_polo_passivo||null,cnjs_passivo:f.cnjs_passivo||null,troca_direta:f.troca_direta||null,desenho_troca_direta:f.desenho_troca_direta||null,cnjs_troca_direta:f.cnjs_troca_direta||null,triangulacao_confirmada:f.triangulacao_confirmada||null,desenho_triangulacao:f.desenho_triangulacao||null,cnjs_triangulacao:f.cnjs_triangulacao||null,testemunha_do_reclamante_ja_foi_testemunha_antes:f.testemunha_do_reclamante_ja_foi_testemunha_antes||null,qtd_total_depos_unicos:f.qtd_total_depos_unicos||null,cnjs_depos_unicos:f.cnjs_depos_unicos||null,contem_prova_emprestada:f.contem_prova_emprestada||null,testemunhas_prova_emprestada:f.testemunhas_prova_emprestada||null,classificacao_final:f.classificacao_final||null,insight_estrategico:f.insight_estrategico||null,org_id:f.org_id||null,created_at:f.created_at||new Date().toISOString(),updated_at:f.updated_at||new Date().toISOString()}));w=Hn(G,{filename:t||T,maskPII:n,selectedOnly:!1,selectedIds:[]})}else{const G=s.map(f=>({nome_testemunha:f.nome_testemunha??"",qtd_depoimentos:f.qtd_depoimentos??0,foi_testemunha_em_ambos_polos:f.foi_testemunha_em_ambos_polos??!1,ja_foi_reclamante:f.ja_foi_reclamante??!1,participou_triangulacao:f.participou_triangulacao??!1,participou_troca_favor:f.participou_troca_favor??!1,classificacao:f.classificacao??null,classificacao_estrategica:f.classificacao_estrategica??null,cnjs_como_testemunha:f.cnjs_como_testemunha??null,cnjs_como_reclamante:f.cnjs_como_reclamante??null,foi_testemunha_ativo:f.foi_testemunha_ativo??null,cnjs_ativo:f.cnjs_ativo??null,foi_testemunha_passivo:f.foi_testemunha_passivo??null,cnjs_passivo:f.cnjs_passivo??null,cnjs_troca_favor:f.cnjs_troca_favor??null,cnjs_triangulacao:f.cnjs_triangulacao??null,e_prova_emprestada:f.e_prova_emprestada??null,org_id:f.org_id??null,created_at:f.created_at??new Date().toISOString(),updated_at:f.updated_at??new Date().toISOString()}));w=Kn(G,{filename:t||T,maskPII:n,selectedOnly:!1,selectedIds:[]})}$s.success("Exportação concluída!",{description:`${w} registros exportados com sucesso.`})}catch(v){console.error("Export error:",v),$s.error("Erro na exportação",{description:"Não foi possível exportar os dados. Tente novamente."})}finally{o(!1)}},m=(()=>{const v=Math.min(s.length,5e3),g=i(s);return{count:v,size:Gn(v,g)}})();return e.jsxs(vs,{children:[e.jsx(bs,{asChild:!0,children:e.jsxs(A,{variant:"outline",disabled:a||r||s.length===0,className:"gap-2","aria-label":"Exportar dados como CSV",children:[r?e.jsx(cs,{className:"h-4 w-4 animate-spin","aria-hidden":"true"}):e.jsx(fa,{className:"h-4 w-4","aria-hidden":"true"}),"Exportar CSV"]})}),e.jsxs(us,{align:"end",className:"w-56",children:[e.jsx("div",{className:"px-3 py-2 text-xs text-muted-foreground",children:e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsx(tt,{className:"h-3 w-3","aria-hidden":"true"}),"Exportar como CSV"]})}),e.jsx(Ws,{}),e.jsx(es,{onClick:d,disabled:r,children:e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Todos os registros"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:m.count.toLocaleString()})]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:m.size})]})}),s.length>5e3&&e.jsxs(e.Fragment,{children:[e.jsx(Ws,{}),e.jsx("div",{className:"px-3 py-2 text-xs text-warning",children:"⚠️ Máximo de 5.000 registros por exportação"})]})]})]})};function et(s,t){const[a,r]=x.useState(s);return x.useEffect(()=>{const o=setTimeout(()=>{r(s)},t);return()=>{clearTimeout(o)}},[s,t]),a}const Ds=s=>{if(!/^\d{4}-\d{2}-\d{2}$/.test(s))return!1;const t=new Date(s);return!isNaN(t.valueOf())},qs="mapa-testemunhas-processos",zs="mapa-testemunhas-testemunhas",xr=ms({page:Re.number().int().min(1).default(1),limit:Re.number().int().min(1).max(1e3).default(20)}),Zn=ms({search:Pe().trim().optional(),data_inicio:Pe().trim().optional().refine(s=>!s||Ds(s),{message:"data inválida"}),data_fim:Pe().trim().optional().refine(s=>!s||Ds(s),{message:"data inválida"}),uf:Pe().trim().optional(),status:Pe().trim().optional(),fase:Pe().trim().optional(),testemunha:Pe().trim().optional(),qtd_depoimentos_min:Re.number().int().optional(),qtd_depoimentos_max:Re.number().int().optional(),tem_triangulacao:Re.boolean().optional(),tem_troca:Re.boolean().optional(),tem_prova_emprestada:Re.boolean().optional()}).superRefine((s,t)=>{s.data_inicio&&s.data_fim&&new Date(s.data_inicio)>new Date(s.data_fim)&&t.addIssue({code:Ts.custom,message:"data_inicio deve ser menor ou igual a data_fim",path:["data_inicio"]}),s.qtd_depoimentos_min!==void 0&&s.qtd_depoimentos_max!==void 0&&s.qtd_depoimentos_min>s.qtd_depoimentos_max&&t.addIssue({code:Ts.custom,message:"qtd_depoimentos_min deve ser menor ou igual a qtd_depoimentos_max",path:["qtd_depoimentos_min"]})}).default({}),Xn=ms({paginacao:xr.default({page:1,limit:20}),filtros:Zn}).default(()=>({paginacao:{page:1,limit:20},filtros:{}})),Yn=ms({nome:Pe().trim().optional(),documento:Pe().trim().optional(),search:Pe().trim().optional(),data_inicio:Pe().trim().optional().refine(s=>!s||Ds(s),{message:"data inválida"}),data_fim:Pe().trim().optional().refine(s=>!s||Ds(s),{message:"data inválida"}),ambos_polos:Re.boolean().optional(),ja_foi_reclamante:Re.boolean().optional(),qtd_depoimentos_min:Re.number().int().optional(),qtd_depoimentos_max:Re.number().int().optional(),tem_triangulacao:Re.boolean().optional(),tem_troca:Re.boolean().optional()}).superRefine((s,t)=>{s.data_inicio&&s.data_fim&&new Date(s.data_inicio)>new Date(s.data_fim)&&t.addIssue({code:Ts.custom,message:"data_inicio deve ser menor ou igual a data_fim",path:["data_inicio"]}),s.qtd_depoimentos_min!==void 0&&s.qtd_depoimentos_max!==void 0&&s.qtd_depoimentos_min>s.qtd_depoimentos_max&&t.addIssue({code:Ts.custom,message:"qtd_depoimentos_min deve ser menor ou igual a qtd_depoimentos_max",path:["qtd_depoimentos_min"]})}).default({}),ei=ms({paginacao:xr.default({page:1,limit:20}),filtros:Yn}).default(()=>({paginacao:{page:1,limit:20},filtros:{}}));ms({items:No(_o()),page:Ls().int().min(1),limit:Ls().int().min(1).max(1e3),total:Ls().int().nonnegative(),next_cursor:bo().default(null),requestId:Pe()});const Vs="assistjur_debug_mode",$={isEnabled(){return typeof window>"u"?!1:typeof localStorage<"u"&&localStorage.getItem(Vs)==="true"},enable(){typeof window>"u"||typeof localStorage>"u"||(localStorage.setItem(Vs,"true"),console.log("🐛 Debug mode ATIVADO"))},disable(){typeof window>"u"||typeof localStorage>"u"||(localStorage.setItem(Vs,"false"),console.log("🐛 Debug mode DESATIVADO"))},toggle(){const s=!this.isEnabled();return s?this.enable():this.disable(),s},log(s,...t){this.isEnabled()&&console.log(`[DEBUG] ${s}`,...t)},warn(s,...t){this.isEnabled()&&console.warn(`[DEBUG] ${s}`,...t)},error(s,...t){this.isEnabled()?console.error(`[DEBUG] ${s}`,...t):console.error(s,...t)}};function pr(s){const t={temTriangulacao:"tem_triangulacao",temTroca:"tem_troca",temProvaEmprestada:"tem_prova_emprestada",qtdDeposMin:"qtd_depoimentos_min",qtdDeposMax:"qtd_depoimentos_max",ambosPolos:"ambos_polos",jaFoiReclamante:"ja_foi_reclamante"};return Object.fromEntries(Object.entries(s??{}).filter(([a,r])=>!(r==null||typeof r=="string"&&r.trim()==="")).map(([a,r])=>[t[a]??a,r]))}async function fr(s,t=3,a=1e3){let r=null;for(let o=0;o<t;o++)try{return await s()}catch(n){if(r=n,o<t-1){const i=a*Math.pow(2,o);console.warn(`Tentativa ${o+1} falhou, aguardando ${i}ms...`),await new Promise(d=>setTimeout(d,i))}}throw r}function Tt(s,t){console.warn("⚠️ MODO FALLBACK: Usando dados mock para testemunhas (API não disponível)"),$.isEnabled()&&console.table({mode:"FALLBACK",type:"TESTEMUNHAS",page:s,limit:t});const a=[{nome_testemunha:"Maria Silva Santos",qtd_depoimentos:8,foi_testemunha_em_ambos_polos:!0,ja_foi_reclamante:!0,participou_triangulacao:!0,participou_troca_favor:!0,classificacao:"ALTO_RISCO"},{nome_testemunha:"João Paulo Oliveira",qtd_depoimentos:5,foi_testemunha_em_ambos_polos:!1,ja_foi_reclamante:!1,participou_triangulacao:!0,participou_troca_favor:!1,classificacao:"MEDIO_RISCO"},{nome_testemunha:"Ana Costa Ferreira",qtd_depoimentos:12,foi_testemunha_em_ambos_polos:!0,ja_foi_reclamante:!0,participou_triangulacao:!1,participou_troca_favor:!0,classificacao:"ALTO_RISCO"}],r=(s-1)*t,o=r+t;return{data:a.slice(r,o),total:a.length}}async function si(s){const t=Math.random().toString(36).substring(7),a=s.filters?.search;$.log(`🔍 [${t}] fetchTestemunhas iniciado`,{page:s.page,limit:s.limit,filters:s.filters,searchTerm:a,timestamp:new Date().toISOString()});try{const{data:r}=await Ie.auth.getSession();if(!r?.session?.access_token)return $.error(`❌ [${t}] Usuário não autenticado`),Tt(s.page||1,s.limit||20);$.log(`✅ [${t}] Sessão válida`,{userId:r.session.user?.id,hasToken:!!r.session.access_token});const o=pr(s.filters??{}),n={paginacao:{page:s.page||1,limit:s.limit||50},filtros:o};a&&console.log(`🎯 [${t}] SEARCH DETECTADO:`,{searchTerm:a,filtrosEnviados:n.filtros,hasSearchInFiltros:"search"in n.filtros||"nome"in n.filtros}),$.log(`📦 [${t}] Payload preparado`,n),ei.parse(n);const i=await fr(async()=>{$.log(`🚀 [${t}] ===== CHAMANDO EDGE FUNCTION =====`),$.log(`🚀 [${t}] Function: ${zs}`),$.log(`🚀 [${t}] URL: <<MANTER>>/functions/v1/${zs}`),$.log(`🚀 [${t}] Body:`,n),$.log(`🚀 [${t}] Auth Token presente: ${!!r.session.access_token}`);const d=performance.now(),{data:u,error:m}=await Ie.functions.invoke(zs,{body:n}),v=performance.now()-d;if($.log(`⏱️ [${t}] Tempo de resposta: ${v.toFixed(2)}ms`),m)throw $.error(`❌ [${t}] ===== ERRO NA EDGE FUNCTION =====`),$.error(`❌ [${t}] Error object:`,m),$.error(`❌ [${t}] Error message:`,m.message),$.error(`❌ [${t}] Error context:`,m.context),new Error(`Erro ao buscar testemunhas: ${m.message}`);if(!u||!u.items)return $.log(`✅ [${t}] ===== DATASET VAZIO (VÁLIDO) =====`),$.log(`✅ [${t}] Empty dataset (0 records) - this is valid, not an error`),{data:[],total:0};$.log(`✅ [${t}] ===== RESPOSTA RECEBIDA COM SUCESSO =====`),$.log(`✅ [${t}] Data structure:`,{hasData:!!u,dataKeys:u?Object.keys(u):[],itemsCount:u.items?.length||0,total:u.total,hasNextCursor:!!u.next_cursor});const g=u.items.map(w=>({nome_testemunha:w.nome_testemunha||"",qtd_depoimentos:Number(w.qtd_depoimentos)||0,foi_testemunha_em_ambos_polos:!!w.foi_testemunha_em_ambos_polos,ja_foi_reclamante:!!w.ja_foi_reclamante,participou_triangulacao:!!w.participou_triangulacao,participou_troca_favor:!!w.participou_troca_favor,classificacao:w.classificacao||null,classificacao_estrategica:w.classificacao_estrategica||null,cnjs_como_testemunha:w.cnjs_como_testemunha||null,cnjs_como_reclamante:w.cnjs_como_reclamante||null,foi_testemunha_ativo:!!w.foi_testemunha_ativo,cnjs_ativo:w.cnjs_ativo||null,foi_testemunha_passivo:!!w.foi_testemunha_passivo,cnjs_passivo:w.cnjs_passivo||null,cnjs_troca_favor:w.cnjs_troca_favor||null,cnjs_triangulacao:w.cnjs_triangulacao||null,e_prova_emprestada:!!w.e_prova_emprestada,org_id:w.org_id||null,created_at:w.created_at,updated_at:w.updated_at}));return $.log(`✅ [${t}] Transformed ${g.length} items`),g.length>0&&$.log(`✅ [${t}] Sample item:`,g[0]),{data:g,total:u.total||0}});return $.log(`🎉 [${t}] fetchTestemunhas concluído com sucesso`),i}catch(r){return $.error(`💥 [${t}] Erro fatal ao buscar testemunhas:`,r),{...Tt(s.page||1,s.limit||20),error:r instanceof Error?r.message:"Erro desconhecido ao buscar testemunhas"}}}function Et(s,t){console.warn("⚠️ MODO FALLBACK: Usando dados mock para processos (API não disponível)"),$.isEnabled()&&console.table({mode:"FALLBACK",type:"PROCESSOS",page:s,limit:t});const a=[{cnj:"0001234-56.2024.5.02.0001",reclamante:"EMPRESA XYZ LTDA",reclamada:"FORNECEDOR ABC S.A.",testemunhas_ativo:["Maria Silva Santos","João Paulo Oliveira"],testemunhas_passivo:["Ana Costa Ferreira"],tem_triangulacao:!0,tem_troca:!0,tem_prova_emprestada:!1,comarca:"São Paulo",vara:"1ª Vara do Trabalho"},{cnj:"0007890-12.2024.5.02.0002",reclamante:"TECH SOLUTIONS LTDA",reclamada:"CLIENTE SERVIÇOS S.A.",testemunhas_ativo:["Ana Costa Ferreira"],testemunhas_passivo:["Maria Silva Santos","João Paulo Oliveira"],tem_triangulacao:!1,tem_troca:!0,tem_prova_emprestada:!0,comarca:"Rio de Janeiro",vara:"3ª Vara do Trabalho"}],r=(s-1)*t,o=r+t;return{data:a.slice(r,o),total:a.length}}async function ti(s){const t=Math.random().toString(36).substring(7);$.log(`🔍 [${t}] fetchProcessos iniciado`,{page:s.page,limit:s.limit,filters:s.filters,timestamp:new Date().toISOString()});try{const{data:a}=await Ie.auth.getSession();if(!a?.session?.access_token)return $.error(`❌ [${t}] Usuário não autenticado`),Et(s.page||1,s.limit||20);$.log(`✅ [${t}] Sessão válida`,{userId:a.session.user?.id,hasToken:!!a.session.access_token});const r=pr(s.filters),o={paginacao:{page:s.page||1,limit:s.limit||50},filtros:r};$.log(`📦 [${t}] Payload preparado`,o),Xn.parse(o);const n=await fr(async()=>{$.log(`🚀 [${t}] ===== CHAMANDO EDGE FUNCTION =====`),$.log(`🚀 [${t}] Function: ${qs}`),$.log(`🚀 [${t}] URL: <<MANTER>>/functions/v1/${qs}`),$.log(`🚀 [${t}] Body:`,o),$.log(`🚀 [${t}] Auth Token presente: ${!!a.session.access_token}`);const i=performance.now(),{data:d,error:u}=await Ie.functions.invoke(qs,{body:o}),m=performance.now()-i;if($.log(`⏱️ [${t}] Tempo de resposta: ${m.toFixed(2)}ms`),u)throw $.error(`❌ [${t}] ===== ERRO NA EDGE FUNCTION =====`),$.error(`❌ [${t}] Error object:`,u),$.error(`❌ [${t}] Error message:`,u.message),$.error(`❌ [${t}] Error context:`,u.context),new Error(`Erro ao buscar processos: ${u.message}`);if(!d||!d.items)return $.log(`✅ [${t}] ===== DATASET VAZIO (VÁLIDO) =====`),$.log(`✅ [${t}] Empty dataset (0 records) - this is valid, not an error`),{data:[],total:0};$.log(`✅ [${t}] ===== RESPOSTA RECEBIDA COM SUCESSO =====`),$.log(`✅ [${t}] Data structure:`,{hasData:!!d,dataKeys:d?Object.keys(d):[],itemsCount:d.items?.length||0,total:d.total,hasNextCursor:!!d.next_cursor});const v=Array.isArray(d.items)?d.items:[],g=isFinite(d.total)?d.total:v.length;return{data:v,total:g}});return $.log(`🎉 [${t}] fetchProcessos concluído com sucesso`),n}catch(a){return $.error(`💥 [${t}] Erro fatal ao buscar processos:`,a),{...Et(s.page||1,s.limit||20),error:a instanceof Error?a.message:"Erro desconhecido ao buscar processos"}}}function Bs(s,t){if(!s||typeof s!="object")return 0;const r=t.filter(d=>{const u=s[d];return u!=null&&u!==""&&u!=="nan"}).length/t.length;let o=0;return o=["cnj","reclamante","status","classificacao"].filter(d=>t.includes(d)&&s[d]).length*.05,Math.min(1,r+o)}function ai(s){return!s||s==="null"||s==="undefined"?"Em andamento":s}function ri(s){return!s||s==="null"||s==="undefined"?"Normal":s}function oi(s){if(s.situacao)return{status:s.situacao,inferido:!1};if(s.categoria)return{status:s.categoria,inferido:!1};const t=(s.classificacao_final||"").toLowerCase();if(t.includes("descartar"))return{status:"Arquivado",inferido:!0};if(t.includes("conhecer"))return{status:"Aguardando movimentação",inferido:!0};const a=s.quantidade_movimentos||0,r=s.quantidade_documentos||0;return a===0&&r===0?{status:"Aguardando distribuição",inferido:!0}:a>10?{status:"Em fase instrutória",inferido:!0}:{status:"Em andamento",inferido:!0}}function Pt(s){if(!s)return"Normal";const t=String(s).replace(/[\[\]]/g,"").trim().toLowerCase();return t.charAt(0).toUpperCase()+t.slice(1)}function Us(s,t,a){if(t!=null)return t>=85?"critico":t>=70?"alto":t>=50?"medio":"baixo";if(a){const o=a.toLowerCase();if(o.includes("triangulação")||o.includes("troca de favor"))return"critico";if(o.includes("já foi testemunha")||o.includes("ambos polos"))return"alto";if(o.includes("prova emprestada"))return"medio"}const r=ri(s).toLowerCase();return r.includes("crítico")||r.includes("alto")?"alto":r.includes("médio")||r.includes("medio")?"medio":"baixo"}const ni=s=>typeof s=="object"&&s!==null&&("status"in s||"message"in s);function ii(){const{toast:s}=Ae(),{error:t}=$o(),{chatStatus:a,chatResult:r,agentOnline:o,selectedProcesso:n,selectedTestemunha:i,setChatStatus:d,setChatResult:u,addChatMessage:m,updateChatMessage:v,setAgentOnline:g}=S(),w=x.useCallback(f=>{switch(f){case"processo":return"process_analysis";case"testemunha":return"witness_analysis";case"reclamante":return"claimant_analysis";default:return"risk_analysis"}},[]),T=x.useCallback((f,U)=>[{type:"executive",title:"📌 Resumo Executivo",icon:"Sparkles",data:{cnj:U.match(/\d{7}-\d{2}\.\d{4}\.\d{1}\.\d{2}\.\d{4}/)?U:"1000000-09.2024.5.02.1000",reclamante:f==="reclamante"?U:"Maria Silva Santos",reu:"Empresa ABC Ltda",status:"Em andamento",observacoes:"Processo com potencial risco de triangulação detectado.",riscoNivel:"alto",confianca:.85,alerta:"Testemunhas conectadas em múltiplos processos"},meta:{status:"Em andamento",observacoes:"Processo com potencial risco de triangulação detectado.",riscoNivel:"alto",confidence:.85},citations:[{source:"por_processo",ref:"1000000-09.2024.5.02.1000"},{source:"por_testemunha",ref:"João Santos"}]},{type:"details",title:"📋 Análise Detalhada",icon:"FileText",data:{secoes:[{titulo:"Vínculos Identificados",conteudo:"Foram identificadas 3 testemunhas que aparecem em processos similares.",evidencias:["João Santos: 5 processos","Maria Oliveira: 3 processos"]},{titulo:"Padrões Temporais",conteudo:"Concentração de depoimentos entre Jan-Mar 2024.",evidencias:["Janeiro: 8 depoimentos","Fevereiro: 12 depoimentos"]}],textoOriginal:U}},{type:"alerts",title:"⚠️ Alertas Estratégicos",icon:"AlertTriangle",data:{suspiciousPatterns:["Triangulação detectada entre 3 testemunhas","Depoimentos com narrativas similares","Mesmo advogado em processos conexos"]}},{type:"strategies",title:"🎯 Polo Ativo & Estratégias",icon:"Target",data:{estrategias:[{texto:"Questionar vínculos entre testemunhas",prioridade:"ALTA"},{texto:"Investigar histórico de depoimentos",prioridade:"MÉDIA"}],proximosPassos:["Solicitar certidões de processos anteriores","Preparar questionário específico para audiência"]}}],[]);return{runAnalysis:x.useCallback(async(f,U)=>{if(!f.trim()){s({title:"Campo obrigatório",description:"Digite uma consulta para executar a análise.",variant:"destructive"});return}if(!o){s({title:"Agente indisponível",description:"O assistente está temporariamente em manutenção.",variant:"destructive"});return}d("loading"),s({title:"Análise iniciada",description:"Processando sua consulta..."});const re=m({role:"assistant",content:"",blocks:[]});try{const P={message:f,queryType:w(U)};if(n&&(U==="processo"||f.match(/\d{7}-\d{2}\.\d{4}\.\d\.\d{2}\.\d{4}/))){const l=oi(n),c=Pt(n.classificacao_final),h=Us(n.classificacao_final,n.score_risco,n.insight_estrategico),y=Bs(n,["cnj","reclamante_nome","reu_nome","status","classificacao_final"]);P.context={type:"processo",data:{cnj:n.cnj||n.numero_cnj,reclamante:n.reclamante_nome,reu:n.reu_nome,status:l.status,statusInferido:l.inferido,fase:n.fase,uf:n.uf,comarca:n.comarca,testemunhas_ativo:n.testemunhas_ativo,testemunhas_passivo:n.testemunhas_passivo,classificacao:c,classificacao_final:n.classificacao_final,score_risco:n.score_risco,insight_estrategico:n.insight_estrategico,riscoNivel:h},meta:{status:l.status,statusInferido:l.inferido,classificacao:c,riscoNivel:h,confidence:y}}}else if(i&&U==="testemunha"){const l=Pt(i.classificacao_final),c=Us(i.classificacao_final,i.score_risco,null),h=Bs(i,["nome_testemunha","qtd_depoimentos","classificacao_final"]);P.context={type:"testemunha",data:{nome:i.nome_testemunha,qtd_depoimentos:i.qtd_depoimentos,processos_cnj:i.processos_cnj,foi_testemunha_em_ambos_polos:i.foi_testemunha_em_ambos_polos,ja_foi_reclamante:i.ja_foi_reclamante,classificacao_final:l,score_risco:i.score_risco},meta:{status:i.foi_testemunha_em_ambos_polos?"Ativo em ambos polos":"Normal",statusInferido:!1,classificacao:l,riscoNivel:c,confidence:h}}}console.log("🚀 [PAYLOAD] Enviando para chat-legal:",{message:P.message,queryType:P.queryType,hasContext:!!P.context,contextType:P.context?.type,hasMeta:!!P.context?.meta,meta:P.context?.meta,dataKeys:P.context?.data?Object.keys(P.context.data):[]});const{data:J,error:he}=await Ie.functions.invoke("chat-legal",{body:P});if(he){if(ni(he)&&(he.status===402||he.message?.includes("Workspace out of credits"))){const l=`https://${yo()}.functions.supabase.co/chat-legal`;console.warn(`Lovable API ${he.status} at ${l}`),t("Limite de créditos atingido","As funções de chat/assistente estão temporariamente indisponíveis. Tente novamente mais tarde.",{duration:void 0}),g(!1),v(re,{content:"Créditos esgotados. Função indisponível."}),d("error");return}throw he}const Y=J?.data||J?.content||"";console.log("🔍 [FRONTEND] Raw AI Response type:",typeof Y),console.log("🔍 [FRONTEND] Response length:",Y.length),console.log("🔍 [FRONTEND] First 300 chars:",Y.substring(0,300));let H=[];try{const l=JSON.parse(Y);console.log("✅ [FRONTEND] Parsed JSON, type:",typeof l),l.blocks&&Array.isArray(l.blocks)?(H=l.blocks,console.log("✅ [FRONTEND] Extracted blocks array with",H.length,"items")):Array.isArray(l)&&l.length>0?(H=l,console.log("✅ [FRONTEND] Direct array with",H.length,"blocks")):l.type?(H=[l],console.log("✅ [FRONTEND] Single block object")):console.warn("⚠️ [FRONTEND] Parsed JSON but unexpected structure:",Object.keys(l))}catch(l){console.error("❌ [FRONTEND] JSON parse failed:",l);try{const c=Y.match(/\{[\s\S]*"blocks"[\s\S]*\}/);c&&(H=JSON.parse(c[0]).blocks||[],console.log("✅ [FRONTEND] Extracted blocks from text:",H.length))}catch(c){console.error("❌ [FRONTEND] Extraction failed:",c)}}(!H||H.length===0)&&(console.log("🔧 [FRONTEND] Gerando fallback blocks para input:",f),H=[{type:"executive",title:"📊 Resumo Executivo",icon:"FileText",data:{cnj:f.match(/\d{7}-\d{2}\.\d{4}\.\d\.\d{2}\.\d{4}/)?f:"0000000-00.0000.0.00.0000",reclamante:n?.reclamante_nome||"Aguardando dados...",reu:n?.reu_nome||"Aguardando dados...",status:ai(n?.status),observacoes:n?.observacoes||`Análise iniciada para: ${f.substring(0,100)}${f.length>100?"...":""}`,riscoNivel:Us(n?.classificacao_final,n?.score_risco),confianca:n?Bs(n,["cnj","reclamante_nome","reu_nome","status"]):.5,alerta:void 0,citacoes:[]}},{type:"details",title:"🔍 Análise Detalhada",icon:"Search",data:{secoes:[{titulo:"Informações Disponíveis",conteudo:`Consulta realizada: ${f}`,evidencias:[]},{titulo:"Análise",conteudo:"Aguardando processamento completo pelo sistema. Por favor, tente novamente em alguns instantes.",evidencias:[]},{titulo:"Recomendações",conteudo:"Ações sugeridas:",evidencias:["Verificar se os dados estão disponíveis no sistema","Confirmar formato da consulta (CNJ, nome, etc)","Aguardar alguns instantes e tentar novamente"]}]}}],console.log("✅ [FRONTEND] Fallback blocks gerados:",H.length));const B=H.map(l=>({...l,context:P.context,meta:P.context?.meta}));v(re,{content:B.length>0?"Análise concluída":Y,blocks:B}),u(B),d("success"),s({title:"Análise concluída",description:`Análise ${U==="processo"?"por processo":U==="testemunha"?"por testemunha":"por reclamante"} executada com sucesso.`})}catch(P){console.error("Error in analysis:",P),v(re,{content:"Erro ao executar análise. Tente novamente."}),d("error"),s({title:"Erro na análise",description:P instanceof Error?P.message:"Erro desconhecido ao executar análise.",variant:"destructive"})}},[o,w,T,d,u,m,v,s,t,g]),chatStatus:a,chatResult:r,agentOnline:o}}function li(s,t="all",a=!0){const r=et(s,250);return Xr({queryKey:["unified-search",r,t],queryFn:async()=>{if(!r||r.length<2)return{query:r,parsed:r,filters:{},scope:t,results:[],total:0};const{data:o,error:n}=await Ie.functions.invoke("search",{body:{q:r,scope:t,limit:20}});if(n)throw n;return o},enabled:a&&r.length>=2,staleTime:3e4})}const Rt={process:"Processo",witness:"Testemunha",claimant:"Reclamante",lawyer:"Advogado",comarca:"Comarca"},ci={process:"bg-blue-500/10 text-blue-700 dark:text-blue-300",witness:"bg-purple-500/10 text-purple-700 dark:text-purple-300",claimant:"bg-green-500/10 text-green-700 dark:text-green-300",lawyer:"bg-orange-500/10 text-orange-700 dark:text-orange-300",comarca:"bg-gray-500/10 text-gray-700 dark:text-gray-300"},di=[{scope:"all",label:"Tudo",icon:ls},{scope:"process",label:"Processos",icon:Le},{scope:"witness",label:"Testemunhas",icon:gs},{scope:"claimant",label:"Reclamantes",icon:Ss}],mi={process:Le,witness:gs,claimant:Ss,lawyer:Ss,comarca:eo};function ui(){const s=x.useRef(null),[t,a]=x.useState(!1),[r,o]=x.useState("all"),[n,i]=x.useState(""),[d,u]=x.useState(!1),[m,v]=x.useState(0),g=rt(),{toast:w}=Ae(),{chatKind:T,chatStatus:G,agentOnline:f,selectedProcesso:U,selectedTestemunha:re,setChatInput:P,setChatKind:J,setSelectedProcesso:he,setSelectedTestemunha:Y,processos:H,testemunhas:B}=S(),{runAnalysis:l}=ii(),c=n,{data:h,isLoading:y}=li(c,r,t&&c.length>=2),C=["Digite um nome... Ex: João Silva","Busque por CNJ... Ex: 0001234-56.2024.5.02.0001","Use operadores... Ex: risco:alto uf:RS","Filtros avançados... Ex: depoimentos:>3 comarca:POA"];x.useEffect(()=>{const j=setInterval(()=>{v(E=>(E+1)%C.length)},3e3);return()=>clearInterval(j)},[]);const z=C[m];x.useEffect(()=>{/\d{7}-\d{2}\.\d{4}\.\d{1}\.\d{2}\.\d{4}/.test(n)&&(o("process"),J("processo"))},[n,J]),x.useEffect(()=>{n.length>=2?a(!0):a(!1)},[n]),x.useEffect(()=>{const j=E=>{E.key==="k"&&E.ctrlKey&&(E.preventDefault(),s.current?.focus())};return document.addEventListener("keydown",j),()=>document.removeEventListener("keydown",j)},[]);const oe=j=>{switch(a(!1),i(j.title),P(j.title),j.type){case"process":{const E=H.find(Q=>Q.cnj===j.title||Q.numero_cnj===j.title);E&&(he(E),w({title:"Processo selecionado",description:E.cnj||E.numero_cnj})),J("processo"),g(`/mapa-testemunhas?tab=processos&cnj=${encodeURIComponent(j.title)}`);break}case"witness":{const E=B.find(Q=>Q.nome_testemunha?.toLowerCase()===j.title.toLowerCase());E&&(Y(E),w({title:"Testemunha selecionada",description:E.nome_testemunha})),J("testemunha"),g(`/mapa-testemunhas?tab=testemunhas&nome=${encodeURIComponent(j.title)}`);break}case"claimant":{J("reclamante"),g(`/mapa-testemunhas?tab=processos&reclamante=${encodeURIComponent(j.title)}`);break}}},xe=(j,E)=>{E.stopPropagation(),navigator.clipboard.writeText(j),w({title:"CNJ copiado",description:j})},ge=()=>{he(null),Y(null),P(""),i("")},L=U||re,ee=U?`Processo: ${U.cnj||U.numero_cnj}`:re?`Testemunha: ${re.nome_testemunha}`:null,D=async()=>{if(!n.trim()||b||!f)return;a(!1),P(n);const j=T||(r==="process"?"processo":r==="witness"?"testemunha":"reclamante");J(j),await l(n.trim(),j)},ce=j=>{j.key==="Enter"&&(j.ctrlKey||j.metaKey)&&(j.preventDefault(),D())},M=h&&h.results.length>0,V=h?.isAmbiguous||!1,b=V&&n.length>=2,R=n.trim().length>0&&!b&&f;return e.jsxs("div",{className:"w-full mx-auto max-w-7xl p-6 space-y-6",children:[!d&&e.jsxs(ke,{className:"border-yellow-200 bg-yellow-50 dark:bg-yellow-950/20",children:[e.jsx(Ve,{className:"h-4 w-4 text-yellow-600 dark:text-yellow-500"}),e.jsxs(Oe,{className:"flex items-center justify-between gap-4",children:[e.jsxs("span",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:[e.jsx("strong",{className:"font-semibold",children:"Conteúdo assistivo."})," ","Revisão humana obrigatória. Dados tratados conforme LGPD."," ",e.jsx("a",{href:"/privacy",className:"underline hover:no-underline",children:"Política de Privacidade"})]}),e.jsx(A,{variant:"ghost",size:"sm",onClick:()=>u(!0),className:"shrink-0 hover:bg-yellow-100 dark:hover:bg-yellow-900/30",children:e.jsx(Xe,{className:"h-4 w-4"})})]})]}),V&&h?.suggestions&&e.jsxs(ke,{className:"border-blue-200 bg-blue-50 dark:bg-blue-950/20 animate-in fade-in slide-in-from-top-2 duration-300",children:[e.jsx(at,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"}),e.jsx(Oe,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-blue-900 dark:text-blue-100",children:h.suggestions.message}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(h.suggestions.counts).map(([j,E])=>e.jsxs(q,{variant:"secondary",className:"text-xs",children:[j,": ",E]},j))})]})})]}),L&&ee&&e.jsxs("div",{className:"flex items-center gap-2 bg-primary/10 border border-primary/20 rounded-lg px-4 py-3 animate-in fade-in slide-in-from-top-2 duration-300",children:[e.jsxs(q,{variant:"default",className:"gap-1.5 text-xs",children:[U&&e.jsx(Le,{className:"h-3 w-3"}),re&&e.jsx(gs,{className:"h-3 w-3"}),"Contexto Selecionado"]}),e.jsx("span",{className:"text-sm font-medium text-foreground flex-1",children:ee}),e.jsxs(A,{variant:"ghost",size:"sm",onClick:ge,className:"h-7 px-2 hover:bg-destructive/10 gap-1.5",children:[e.jsx(Xe,{className:"h-3 w-3"}),e.jsx("span",{className:"text-xs",children:"Limpar"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:e.jsx(ls,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Busca Inteligente Unificada"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Pesquise por processo, testemunha ou reclamante em um único lugar"})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:f?e.jsxs(e.Fragment,{children:[e.jsx($e,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Online"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Yr,{className:"h-4 w-4 text-orange-500"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Manutenção"})]})})]}),e.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:di.map(j=>{const E=j.icon;return e.jsxs(A,{variant:r===j.scope?"default":"outline",size:"sm",onClick:()=>o(j.scope),className:"gap-2 h-8 transition-all hover:scale-105",children:[e.jsx(E,{className:"h-3.5 w-3.5",strokeWidth:1.5}),j.label]},j.scope)})})]}),e.jsx("div",{className:"relative",children:e.jsxs(ya,{open:t,onOpenChange:a,children:[e.jsx(wa,{asChild:!0,children:e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-primary/20 to-primary/10 rounded-lg blur-sm group-hover:blur-md transition-all opacity-0 group-hover:opacity-100"}),e.jsxs("div",{className:"relative",children:[e.jsx(ls,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground pointer-events-none z-10"}),e.jsx(Qe,{ref:s,value:n,onChange:j=>i(j.target.value),onKeyDown:ce,placeholder:z,className:"pl-12 pr-12 h-14 text-base border-2 focus:border-primary/50 transition-all shadow-sm hover:shadow-md"}),n&&e.jsx(A,{variant:"ghost",size:"sm",onClick:()=>i(""),className:"absolute right-2 top-1/2 -translate-y-1/2 h-9 w-9 p-0 rounded-full hover:bg-destructive/10",children:e.jsx(Xe,{className:"h-4 w-4"})})]})]})}),e.jsx(Ca,{className:"w-[--radix-popover-trigger-width] p-0",align:"start",onOpenAutoFocus:j=>j.preventDefault(),children:e.jsx(mt,{children:e.jsxs($a,{children:[y&&e.jsx("div",{className:"flex items-center justify-center py-6",children:e.jsx(cs,{className:"h-5 w-5 animate-spin text-muted-foreground"})}),!y&&M&&e.jsxs(e.Fragment,{children:[V&&h?.suggestions&&e.jsx("div",{className:"px-3 py-2 border-b bg-muted/50",children:e.jsx("p",{className:"text-xs font-medium text-foreground",children:h.suggestions.message})}),["process","witness","claimant"].map(j=>{const E=h.results.filter(_=>_.type===j);if(E.length===0)return null;const Q=mi[j],F=Rt[j];return e.jsx(qa,{heading:e.jsxs("div",{className:"flex items-center justify-between w-full pr-2",children:[e.jsx("span",{children:F}),e.jsx(q,{variant:"secondary",className:"text-[10px] px-1.5 py-0",children:E.length})]}),children:E.map(_=>e.jsxs(za,{onSelect:()=>oe(_),className:N("flex items-start gap-3 py-3 cursor-pointer transition-colors",V&&"hover:bg-blue-50 dark:hover:bg-blue-950/30"),children:[e.jsx("div",{className:"mt-0.5",children:e.jsx(Q,{className:"h-4 w-4 text-muted-foreground"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-medium truncate",children:_.title}),e.jsx(q,{variant:"secondary",className:`text-[10px] px-1.5 py-0 ${ci[_.type]}`,children:Rt[_.type]})]}),_.subtitle&&e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:_.subtitle}),_.type==="process"&&_.meta&&e.jsxs("div",{className:"flex items-center gap-2 mt-1 text-[10px] text-muted-foreground",children:[_.meta.status&&e.jsxs("span",{children:["Status: ",_.meta.status]}),_.meta.comarca&&e.jsxs("span",{children:["· ",_.meta.comarca]}),_.meta.classificacao&&e.jsx(q,{variant:"outline",className:"text-[9px] px-1 py-0",children:_.meta.classificacao})]}),_.type==="witness"&&_.meta&&e.jsxs("div",{className:"flex items-center gap-2 mt-1 text-[10px]",children:[e.jsxs("span",{className:"text-muted-foreground",children:[_.meta.depoimentos," depoimentos"]}),_.meta.ambosPoles&&e.jsx(q,{variant:"destructive",className:"text-[9px] px-1 py-0",children:"⚠ Ambos polos"}),_.meta.classificacao&&e.jsx(q,{variant:"outline",className:"text-[9px] px-1 py-0",children:_.meta.classificacao})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[_.type==="process"&&e.jsx(A,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 hover:bg-muted",onClick:se=>xe(_.title,se),title:"Copiar CNJ",children:e.jsx(Ye,{className:"h-3 w-3"})}),e.jsx(A,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 hover:bg-muted",title:"Abrir detalhes",children:e.jsx(Gs,{className:"h-3 w-3"})})]})]},_.id))},j)})]}),!y&&!M&&n.length>=2&&e.jsx(La,{children:e.jsxs("div",{className:"text-center py-6",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Nenhum resultado encontrado."}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Tente operadores:"," ",e.jsx("code",{className:"bg-muted px-1 rounded",children:"p:"})," ",e.jsx("code",{className:"bg-muted px-1 rounded",children:"w:"})," ",e.jsx("code",{className:"bg-muted px-1 rounded",children:"uf:RS"})]})]})})]})})})]})}),e.jsxs("div",{className:"flex items-center justify-between gap-4 pt-2",children:[e.jsxs("div",{className:"flex-1 flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground bg-muted/50 px-3 py-1.5 rounded-lg",children:[e.jsx(so,{className:"h-3.5 w-3.5"}),e.jsxs("span",{children:[e.jsx("kbd",{className:"px-1.5 py-0.5 text-xs rounded bg-background shadow-sm",children:"Ctrl"}),e.jsx("span",{className:"mx-1",children:"+"}),e.jsx("kbd",{className:"px-1.5 py-0.5 text-xs rounded bg-background shadow-sm",children:"K"})]})]}),n.length>0&&e.jsxs("div",{className:"text-xs text-muted-foreground flex items-center gap-1.5 animate-in fade-in slide-in-from-left-2 duration-300",children:[e.jsx("div",{className:"h-1.5 w-1.5 rounded-full bg-green-500 animate-pulse"}),c.length>=2?`${h?.total||0} resultados`:"Digite para buscar"]})]}),e.jsx(A,{onClick:D,disabled:!R||G==="loading",size:"lg",className:N("gap-2 min-w-[180px] shadow-md hover:shadow-lg transition-all hover:scale-105 font-semibold",L&&"bg-primary/90 hover:bg-primary ring-2 ring-primary/20"),children:G==="loading"?e.jsxs(e.Fragment,{children:[e.jsx(cs,{className:"h-5 w-5 animate-spin",strokeWidth:2}),e.jsx("span",{children:"Analisando dados..."})]}):b?e.jsxs(e.Fragment,{children:[e.jsx(fs,{className:"h-5 w-5",strokeWidth:2}),e.jsx("span",{children:"Refinar busca"})]}):L?e.jsxs(e.Fragment,{children:[e.jsx(Qs,{className:"h-5 w-5",strokeWidth:2}),e.jsx("span",{children:"⚡ Análise Contextual"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Qs,{className:"h-5 w-5",strokeWidth:2}),e.jsx("span",{children:"⚡ Executar Análise"})]})})]})]})}function Ns({label:s,value:t,type:a="default"}){const r=()=>{switch(a){case"reclamante":return"text-blue-700 font-medium";case"reu":return"text-red-700 font-medium";case"status":return"text-green-700";case"observacoes":return"text-muted-foreground text-sm";default:return"text-foreground"}},o=()=>{switch(a){case"status":return t.toLowerCase().includes("ativo")?"default":"secondary";default:return"outline"}};return e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wide",children:s}),e.jsx("div",{className:N("font-medium",r()),children:a==="status"&&t!=="Não informado"?e.jsx(q,{variant:o(),className:"text-xs",children:t}):e.jsx("span",{children:t})})]})}function hi({cnj:s,reclamante:t,reu:a,status:r="Não informado",observacoes:o="Sem observações registradas",riscoNivel:n,confianca:i,alerta:d,citacoes:u}){console.log("📊 [ExecutiveSummaryCard] Props recebidas:",{cnj:s,status:r,observacoes:o,riscoNivel:n,confianca:typeof i=="number"?`${i}%`:i,hasObservacoes:!!o&&o!=="Sem observações registradas",hasStatus:!!r&&r!=="Não informado",isDefaultData:r==="Não informado"&&o==="Sem observações registradas"});const{toast:m}=Ae(),[v,g]=x.useState(!1),w=typeof i=="number"&&!isNaN(i)&&isFinite(i)?Math.max(0,Math.min(1,i)):0,T=Math.round(w*100),G=3,f=u.length>G,U=v?u:u.slice(0,G),re=u.length-G,P=async()=>{const Y=`Resumo Executivo - ${s}

Reclamante: ${t}
Réu: ${a}
Status: ${r}
Observações: ${o}

Risco: ${n.toUpperCase()}
Confiança: ${T}%
${d?`Alerta: ${d}`:""}

Citações:
${u.map(H=>`• ${H.label}`).join(`
`)}`;try{await navigator.clipboard.writeText(Y),m({title:"Copiado!",description:"Resumo executivo copiado para a área de transferência."})}catch{m({title:"Erro ao copiar",description:"Não foi possível copiar o conteúdo.",variant:"destructive"})}},J=()=>{window.print(),m({title:"PDF",description:"Abrindo diálogo de impressão..."})},he=()=>{const Y={cnj:s,reclamante:t,reu:a,status:r,observacoes:o,riscoNivel:n,confianca:i,alerta:d,citacoes:u},H=new Blob([JSON.stringify(Y,null,2)],{type:"application/json"}),B=URL.createObjectURL(H),l=document.createElement("a");l.href=B,l.download=`resumo-executivo-${s.replace(/[^\w]/g,"-")}.json`,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(B),m({title:"JSON exportado",description:"Arquivo JSON baixado com sucesso."})};return e.jsxs(ie,{className:"rounded-2xl border-border/50 transition-shadow hover:shadow-sm","aria-labelledby":"executive-summary",children:[e.jsx(_e,{className:"pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(ye,{id:"executive-summary",className:"text-base font-semibold flex items-center gap-2",children:[e.jsx(Qs,{className:"h-4 w-4 text-violet-600","aria-hidden":"true"}),"Resumo Executivo"]}),e.jsxs(vs,{children:[e.jsx(bs,{asChild:!0,children:e.jsx(A,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0","aria-label":"Ações do resumo",children:e.jsx(to,{className:"h-4 w-4"})})}),e.jsxs(us,{align:"end",children:[e.jsxs(es,{onClick:P,children:[e.jsx(Ye,{className:"h-4 w-4 mr-2"}),"Copiar resumo"]}),e.jsxs(es,{onClick:J,children:[e.jsx(ao,{className:"h-4 w-4 mr-2"}),"Exportar PDF"]}),e.jsxs(es,{onClick:he,children:[e.jsx(ro,{className:"h-4 w-4 mr-2"}),"Exportar JSON"]})]})]})]})}),e.jsxs(ue,{className:"pt-0 space-y-5",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(Ns,{label:"Reclamante",value:t,type:"reclamante"}),e.jsx(Ns,{label:"Réu",value:a,type:"reu"}),e.jsx(Ns,{label:"Status",value:r,type:"status"}),e.jsx(Ns,{label:"Observações",value:o,type:"observacoes"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Nível de Risco"}),e.jsx(nr,{riscoNivel:n})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Confiança"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(As,{value:T,className:"w-16 h-2"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[T,"%"]})]})]})]}),d&&e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-muted/50 rounded-lg","aria-live":"polite",children:[e.jsx(ga,{className:"h-4 w-4 text-violet-600","aria-hidden":"true"}),e.jsx("span",{className:"text-sm font-medium",children:d})]})]}),u.length>0&&e.jsxs("div",{className:"pt-3 border-t",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(xt,{className:"h-3 w-3 text-muted-foreground","aria-hidden":"true"}),e.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Citações:"})]}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[U.map((Y,H)=>e.jsxs(q,{variant:"secondary",className:N("text-xs flex items-center gap-1 cursor-pointer hover:bg-secondary/80",Y.href&&"underline"),onClick:Y.onClick||(()=>Y.href&&window.open(Y.href,"_blank")),children:[e.jsx(xt,{className:"h-3 w-3","aria-hidden":"true"}),Y.label]},H)),f&&e.jsx(A,{variant:"ghost",size:"sm",onClick:()=>g(!v),className:"h-6 px-2 text-xs text-muted-foreground hover:text-foreground",children:v?e.jsxs(e.Fragment,{children:[e.jsx(ca,{className:"h-3 w-3 mr-1"}),"Menos"]}):e.jsxs(e.Fragment,{children:[e.jsx(ds,{className:"h-3 w-3 mr-1"}),"+",re]})})]})]})]})]})}function xi({secoes:s,textoOriginal:t}){const a=o=>{switch(o){case"alta":return e.jsx(q,{variant:"destructive",className:"text-xs",children:"Alta"});case"media":return e.jsx(q,{variant:"secondary",className:"text-xs",children:"Média"});case"baixa":return e.jsx(q,{variant:"outline",className:"text-xs",children:"Baixa"});default:return null}},r=Array.isArray(s)?s:[];return e.jsx("div",{className:"space-y-4",children:e.jsxs(wo,{type:"multiple",className:"w-full",children:[r.map((o,n)=>e.jsxs(jt,{value:`secao-${n}`,children:[e.jsx(vt,{className:"text-left",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:o.titulo}),o.evidencias&&o.evidencias.length>0&&e.jsxs(q,{variant:"outline",className:"text-xs",children:[o.evidencias.length," evidência",o.evidencias.length>1?"s":""]})]})}),e.jsx(bt,{children:e.jsxs("div",{className:"space-y-4 pt-2",children:[e.jsx("div",{className:"prose prose-sm max-w-none",children:e.jsx("p",{className:"text-sm text-muted-foreground leading-relaxed",children:o.conteudo})}),o.evidencias&&o.evidencias.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h5",{className:"text-xs font-semibold text-muted-foreground uppercase tracking-wide",children:"Evidências"}),e.jsx("div",{className:"grid gap-2",children:o.evidencias.map((i,d)=>typeof i=="string"?e.jsx(ie,{className:"p-3 bg-muted/30",children:e.jsx("p",{className:"text-sm",children:i})},d):e.jsx(ie,{className:"p-3 bg-muted/30",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1",children:[i.tipo&&e.jsx("div",{className:"text-xs text-muted-foreground font-medium mb-1",children:i.tipo}),e.jsx("p",{className:"text-sm",children:i.descricao})]}),i.relevancia&&a(i.relevancia)]})},d))})]}),o.metadados&&e.jsx("div",{className:"pt-2 border-t border-muted",children:e.jsxs("div",{className:"flex flex-wrap gap-4 text-xs text-muted-foreground",children:[o.metadados.fonte&&e.jsxs("span",{children:[e.jsx("strong",{children:"Fonte:"})," ",o.metadados.fonte]}),o.metadados.confiabilidade&&e.jsxs("span",{children:[e.jsx("strong",{children:"Confiabilidade:"})," ",Math.round(o.metadados.confiabilidade*100),"%"]}),o.metadados.timestamp&&e.jsxs("span",{children:[e.jsx("strong",{children:"Processado:"})," ",new Date(o.metadados.timestamp).toLocaleString("pt-BR")]})]})})]})})]},n)),t&&e.jsxs(jt,{value:"texto-original",children:[e.jsx(vt,{className:"text-left",children:e.jsx("span",{className:"font-medium",children:"Consulta Original"})}),e.jsx(bt,{children:e.jsx(ie,{className:"p-4 bg-muted/30",children:e.jsx("pre",{className:"text-sm whitespace-pre-wrap font-mono text-muted-foreground",children:t})})})]})]})})}function ys({citations:s}){if(!s.length)return null;const t=r=>{switch(r){case"por_processo":return e.jsx(Le,{className:"h-3 w-3"});case"por_testemunha":return e.jsx(Ss,{className:"h-3 w-3"});default:return e.jsx(Gs,{className:"h-3 w-3"})}},a=r=>{switch(r){case"por_processo":return"default";case"por_testemunha":return"secondary";default:return"outline"}};return e.jsxs("div",{className:"pt-3 border-t",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Gs,{className:"h-3 w-3 text-muted-foreground"}),e.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Citações:"})]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:s.map((r,o)=>e.jsxs(q,{variant:a(r.source),className:"text-xs flex items-center gap-1",children:[t(r.source),r.ref]},o))})]})}function pi({onToggle:s,isAnonymized:t,variant:a="default",className:r=""}){const[o,n]=x.useState(!1),i=async()=>{n(!0);try{await new Promise(d=>setTimeout(d,300)),s(!t)}finally{n(!1)}};return a==="minimal"?e.jsx(A,{variant:t?"default":"outline",size:"sm",onClick:i,disabled:o,className:r,children:t?e.jsxs(e.Fragment,{children:[e.jsx(Ks,{className:"h-4 w-4 mr-2"}),"Dados Anonimizados"]}):e.jsxs(e.Fragment,{children:[e.jsx(He,{className:"h-4 w-4 mr-2"}),"Dados Completos"]})}):e.jsxs(vs,{children:[e.jsx(bs,{asChild:!0,children:e.jsxs(A,{variant:"outline",className:r,children:[e.jsx(Fe,{className:"h-4 w-4 mr-2"}),"Privacidade",e.jsx(ds,{className:"h-4 w-4 ml-2"})]})}),e.jsxs(us,{align:"end",className:"w-56",children:[e.jsx(es,{onClick:i,disabled:o,children:t?e.jsxs(e.Fragment,{children:[e.jsx(He,{className:"h-4 w-4 mr-2"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Mostrar Dados Completos"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Revelar CPFs e nomes reais"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ks,{className:"h-4 w-4 mr-2"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Anonimizar Dados"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Mascarar informações sensíveis"})]})]})}),e.jsxs(es,{disabled:!0,className:"border-t mt-1 pt-2",children:[e.jsx(Fe,{className:"h-4 w-4 mr-2 text-muted-foreground"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Conforme Art. 6º, VII da LGPD"})]})]})]})}function fi({variant:s="compact",showDetails:t=!1,className:a=""}){return s==="badge"?e.jsx(Pa,{children:e.jsxs(xs,{children:[e.jsx(ps,{asChild:!0,children:e.jsxs(q,{variant:"secondary",className:`bg-success/10 text-success border-success/20 ${a}`,children:[e.jsx(Fe,{className:"h-3 w-3 mr-1"}),"LGPD Ready"]})}),e.jsx(ns,{children:e.jsx("p",{children:"Documento em conformidade com a LGPD"})})]})}):s==="compact"?e.jsxs("div",{className:`inline-flex items-center gap-2 px-3 py-2 bg-success/10 border border-success/20 rounded-lg ${a}`,children:[e.jsx(Fe,{className:"h-4 w-4 text-success"}),e.jsx("span",{className:"text-sm font-medium text-success",children:"LGPD Compliant"}),e.jsx($e,{className:"h-3 w-3 text-success"})]}):e.jsxs("div",{className:`border border-success/20 rounded-lg p-4 bg-success/5 ${a}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"flex items-center justify-center w-10 h-10 bg-success/10 rounded-full",children:e.jsx(Fe,{className:"h-5 w-5 text-success"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-success",children:"Documento LGPD-Ready"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Conforme Lei 13.709/2018"})]}),e.jsx($e,{className:"h-5 w-5 text-success ml-auto"})]}),t&&e.jsxs("div",{className:"space-y-2 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(oo,{className:"h-3 w-3"}),e.jsx("span",{children:"Dados criptografados em trânsito e repouso"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(He,{className:"h-3 w-3"}),e.jsx("span",{children:"Informações sensíveis anonimizadas por padrão"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(Le,{className:"h-3 w-3"}),e.jsx("span",{children:"Base legal: Execução regular de direitos (Art. 7º, VI)"})]})]}),e.jsx("div",{className:"mt-3 pt-3 border-t border-success/20",children:e.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.jsx("strong",{children:"Aviso:"})," Este documento contém análise assistida por IA. Validação jurídica humana é obrigatória antes do uso processual."]})})]})}function gi({onExport:s,showPrint:t=!0,disabled:a=!1,showAnonymizeOption:r=!0,isAnonymized:o=!1,onAnonymizeToggle:n,className:i=""}){const{toast:d}=Ae(),u=()=>{window.print(),d({title:"Imprimindo",description:"Preparando documento para impressão..."})},m=v=>{s(v,o);const g=o?" (dados anonimizados)":" (dados completos)";d({title:"Exportando",description:`Gerando arquivo ${v.toUpperCase()}${g}... Será registrado no log de auditoria.`})};return e.jsxs("div",{className:`space-y-3 ${i}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(fi,{variant:"badge"}),r&&n&&e.jsx(pi,{isAnonymized:o,onToggle:n,variant:"minimal"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[t&&e.jsxs(A,{variant:"outline",size:"sm",onClick:u,disabled:a,className:"gap-2",children:[e.jsx(no,{className:"h-4 w-4"}),"Imprimir",o&&e.jsx(Fe,{className:"h-3 w-3 text-success"})]}),e.jsxs(A,{variant:"outline",size:"sm",onClick:()=>m("pdf"),disabled:a,className:"gap-2",children:[e.jsx(Le,{className:"h-4 w-4"}),"PDF",o&&e.jsx(Fe,{className:"h-3 w-3 text-success"})]}),e.jsxs(A,{variant:"outline",size:"sm",onClick:()=>m("csv"),disabled:a,className:"gap-2",children:[e.jsx(tt,{className:"h-4 w-4"}),"CSV",o&&e.jsx(Fe,{className:"h-3 w-3 text-success"})]}),e.jsxs(A,{variant:"outline",size:"sm",onClick:()=>m("docx"),disabled:a,className:"gap-2",children:[e.jsx(Le,{className:"h-4 w-4"}),"DOCX",o&&e.jsx(Fe,{className:"h-3 w-3 text-success"})]}),e.jsxs(A,{variant:"outline",size:"sm",onClick:()=>m("json"),disabled:a,className:"gap-2",children:[e.jsx(fa,{className:"h-4 w-4"}),"JSON",o&&e.jsx(Fe,{className:"h-3 w-3 text-success"})]})]})]})}function ji({blocks:s}){const{toast:t}=Ae(),a=()=>{window.print(),t({title:"PDF",description:"Abrindo diálogo de impressão..."})},r=()=>{const i=["Tipo,Conteudo",...s.map(v=>({Tipo:v.title,Conteudo:JSON.stringify(v.data)})).map(v=>`"${v.Tipo}","${v.Conteudo}"`)].join(`
`),d=new Blob([i],{type:"text/csv;charset=utf-8;"}),u=document.createElement("a"),m=URL.createObjectURL(d);u.setAttribute("href",m),u.setAttribute("download",`analise-${Date.now()}.csv`),document.body.appendChild(u),u.click(),document.body.removeChild(u),t({title:"CSV exportado",description:"Arquivo CSV baixado com sucesso."})},o=()=>{const n={timestamp:new Date().toISOString(),blocks:s},i=new Blob([JSON.stringify(n,null,2)],{type:"application/json"}),d=URL.createObjectURL(i),u=document.createElement("a");u.href=d,u.download=`analise-completa-${Date.now()}.json`,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(d),t({title:"JSON exportado",description:"Arquivo JSON baixado com sucesso."})};return!s||s.length===0?null:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-brand-ink",children:"Resultado da Análise"}),e.jsx(gi,{onExport:n=>{switch(n){case"pdf":a();break;case"csv":r();break;case"json":o();break}},showPrint:!0})]}),e.jsx("div",{className:"space-y-4",children:s.map((n,i)=>{switch(n.type){case"executive":return e.jsx(hi,{cnj:n.data?.cnj||n.data?.processo||(n.context?.type==="testemunha","N/A"),reclamante:n.data?.reclamante||n.context?.data?.nome||n.data?.reclamada||"Não informado",reu:n.data?.reu||n.data?.reclamada||(n.context?.type==="testemunha"?"N/A":"Não informado"),status:n.data?.status||n.meta?.status||n.context?.meta?.status||"Não informado",observacoes:n.data?.observacoes||n.meta?.observacoes||"Análise contextual em progresso",riscoNivel:n.data?.riscoNivel||n.meta?.riscoNivel||n.context?.meta?.riscoNivel||"baixo",confianca:typeof n.data?.confianca=="number"?n.data.confianca:typeof n.meta?.confidence=="number"?Math.round(n.meta.confidence*100):typeof n.context?.meta?.confidence=="number"?Math.round(n.context.meta.confidence*100):typeof n.data?.score=="number"?n.data.score:0,alerta:n.data?.alerta,citacoes:n.citations?.map(d=>({label:d.ref,onClick:()=>{console.log("Citation clicked:",d)}}))||[]},i);case"details":return e.jsxs(ie,{className:"rounded-2xl border-border/50",children:[e.jsx(_e,{children:e.jsxs(ye,{className:"text-base font-semibold flex items-center gap-2",children:[e.jsx(Le,{className:"h-4 w-4 text-primary"}),n.title]})}),e.jsxs(ue,{children:[e.jsx(xi,{secoes:n.data.secoes,textoOriginal:n.data.textoOriginal}),n.citations&&e.jsx(ys,{citations:n.citations})]})]},i);case"alerts":return e.jsxs(ie,{className:"rounded-2xl border-status-critical/30 bg-status-critical/5",children:[e.jsx(_e,{children:e.jsxs(ye,{className:"text-base font-semibold flex items-center gap-2",children:[e.jsx(Ve,{className:"h-4 w-4 text-destructive"}),n.title]})}),e.jsxs(ue,{className:"space-y-3",children:[e.jsxs(ke,{className:"border-destructive/30 bg-destructive/10",children:[e.jsx(Ve,{className:"h-4 w-4 text-destructive"}),e.jsxs(Oe,{className:"text-destructive-foreground",children:[e.jsx("strong",{children:"Triangulação Detectada"})," - Padrões suspeitos identificados entre testemunhas"]})]}),e.jsxs(ke,{className:"border-status-warning/30 bg-status-warning/10",children:[e.jsx(Ve,{className:"h-4 w-4 text-status-warning"}),e.jsxs(Oe,{className:"text-status-warning",children:[e.jsx("strong",{children:"Depoimentos Repetidos"})," - Narrativas similares encontradas"]})]}),n.data.suspiciousPatterns?.map((d,u)=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-destructive/10 rounded-lg",children:[e.jsx(Ve,{className:"h-3 w-3 text-destructive"}),e.jsx("span",{className:"text-sm text-destructive-foreground",children:d})]},u)),e.jsx("div",{className:"mt-4 p-3 bg-muted/50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:["⚠️ ",e.jsx("strong",{children:"Atenção:"})," Possível coordenação entre depoimentos de testemunhas. Recomenda-se investigação detalhada dos vínculos identificados."]})}),n.citations&&e.jsx(ys,{citations:n.citations})]})]},i);case"strategies":return e.jsx(vi,{block:n},i);default:return e.jsxs(ie,{className:"rounded-2xl border-border/50",children:[e.jsx(_e,{children:e.jsx(ye,{className:"text-base font-semibold",children:n.title})}),e.jsxs(ue,{children:[e.jsx("pre",{className:"text-sm text-muted-foreground whitespace-pre-wrap",children:JSON.stringify(n.data,null,2)}),n.citations&&e.jsx(ys,{citations:n.citations})]})]},i)}})}),e.jsxs("div",{className:"text-xs text-muted-foreground text-center pt-4 border-t",children:["Relatório gerado às ",new Date().toLocaleTimeString("pt-BR")," • Dados sujeitos à verificação manual conforme LGPD"]})]})}function vi({block:s}){const{toast:t}=Ae(),a=async o=>{try{await navigator.clipboard.writeText(o),t({title:"Copiado!",description:"Recomendação copiada para a área de transferência."})}catch{t({title:"Erro ao copiar",description:"Não foi possível copiar o conteúdo.",variant:"destructive"})}},r=o=>{switch(o?.toUpperCase()){case"ALTA":return"bg-status-critical/15 text-status-critical border-status-critical/30";case"MÉDIA":return"bg-status-warning/15 text-status-warning border-status-warning/30";case"BAIXA":return"bg-status-success/15 text-status-success border-status-success/30";default:return"bg-muted text-muted-foreground border-border"}};return e.jsxs(ie,{className:"rounded-2xl border-status-success/30 bg-status-success/10",children:[e.jsx(_e,{children:e.jsxs(ye,{className:"text-base font-semibold flex items-center gap-2",children:[e.jsx(pt,{className:"h-4 w-4 text-emerald-600"}),s.title]})}),e.jsxs(ue,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-medium text-emerald-800",children:"Estratégias Ativas"}),e.jsx(q,{variant:"secondary",className:"text-xs",children:"Polo Ativo"})]}),s.data.estrategias?.map((o,n)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white/70 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(q,{className:N("text-xs",r(o.prioridade)),children:o.prioridade}),e.jsx("span",{className:"text-sm",children:o.texto})]}),e.jsx(A,{variant:"ghost",size:"sm",onClick:()=>a(o.texto),className:"h-8 w-8 p-0 shrink-0",children:e.jsx(Ye,{className:"h-3 w-3"})})]},n))]}),s.data.acoesDefensivas&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-emerald-800",children:"Ações Defensivas"}),s.data.acoesDefensivas.map((o,n)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white/70 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(q,{className:N("text-xs",r(o.prioridade)),children:o.prioridade}),e.jsx("span",{className:"text-sm",children:o.texto})]}),e.jsx(A,{variant:"ghost",size:"sm",onClick:()=>a(o.texto),className:"h-8 w-8 p-0 shrink-0",children:e.jsx(Ye,{className:"h-3 w-3"})})]},n))]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pt,{className:"h-4 w-4 text-emerald-600"}),e.jsx("h4",{className:"font-medium text-emerald-800",children:"Próximos Passos"})]}),s.data.proximosPassos?.map((o,n)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white/70 rounded-lg border",children:[e.jsx("span",{className:"text-sm",children:o}),e.jsx(A,{variant:"ghost",size:"sm",onClick:()=>a(o),className:"h-8 w-8 p-0 shrink-0",children:e.jsx(Ye,{className:"h-3 w-3"})})]},n))]}),s.citations&&e.jsx(ys,{citations:s.citations})]})]})}function bi(){const{loadingHints:s,currentHintIndex:t,nextHint:a}=S(),r=x.useRef(null);return x.useEffect(()=>(r.current&&clearInterval(r.current),r.current=setInterval(()=>{a()},800),()=>{r.current&&clearInterval(r.current)}),[a]),e.jsxs("div",{className:"flex gap-4 animate-fade-in",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx(io,{className:"h-4 w-4 text-primary animate-pulse"})}),e.jsx("div",{className:"flex-1 max-w-4xl",children:e.jsx(ie,{className:"bg-card border-primary/20 shadow-sm",children:e.jsxs(ue,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(cs,{className:"h-4 w-4 animate-spin text-primary"}),e.jsx("span",{className:"text-sm text-foreground font-medium transition-opacity duration-200",children:s[t]||"Carregando..."},t)]}),e.jsx("div",{className:"mt-3 flex gap-1",children:Array.from({length:3}).map((o,n)=>e.jsx("div",{className:"h-1 w-8 rounded-full bg-primary/20 animate-pulse",style:{animationDelay:`${n*.2}s`,animationDuration:"1s"}},n))})]})})})]})}const At=({isLoading:s,hasError:t,errorMessage:a,isConnected:r,dataCount:o,dataType:n})=>s?e.jsx(ie,{className:"mb-4 border-blue-200 bg-blue-50/50",children:e.jsx(ue,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(cs,{className:"h-5 w-5 text-blue-600 animate-spin"}),e.jsx("span",{className:"text-sm text-blue-800",children:"Conectando com servidor..."})]})})}):t&&!r?e.jsx(ie,{className:"mb-4 border-orange-200 bg-orange-50/50",children:e.jsx(ue,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(lo,{className:"h-5 w-5 text-orange-600"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm text-orange-800",children:"Servidor indisponível - Exibindo dados simulados"}),a&&e.jsx("p",{className:"text-xs text-orange-700 mt-1",children:a})]}),e.jsx(q,{variant:"outline",className:"text-orange-700 border-orange-300",children:"Mock"})]})})}):t&&r?e.jsx(ie,{className:"mb-4 border-red-200 bg-red-50/50",children:e.jsx(ue,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ve,{className:"h-5 w-5 text-red-600"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm text-red-800",children:"Erro de validação nos filtros"}),a&&e.jsx("p",{className:"text-xs text-red-700 mt-1",children:a})]}),e.jsx(q,{variant:"destructive",className:"text-xs",children:"Erro"})]})})}):r&&o>0?e.jsx(ie,{className:"mb-4 border-green-200 bg-green-50/50",children:e.jsx(ue,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx($e,{className:"h-5 w-5 text-green-600"}),e.jsxs("span",{className:"text-sm text-green-800",children:[o," ",n," carregados do servidor"]}),e.jsx(q,{variant:"outline",className:"text-green-700 border-green-300",children:"Online"})]})})}):null;class Ni extends x.Component{state={hasError:!1,error:null,errorInfo:null,errorCount:0};static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,a){const r=this.state.errorCount+1;Ce.error("🔴 [MapaErrorBoundary] Erro capturado",{error:t.message,stack:t.stack,componentStack:a.componentStack,errorCount:r,timestamp:new Date().toISOString(),userAgent:navigator.userAgent,online:navigator.onLine}),this.setState({error:t,errorInfo:a,errorCount:r}),r>3&&Ce.error("⛔ [MapaErrorBoundary] Loop de erros detectado",{errorCount:r,lastError:t.message})}handleReset=()=>{Ce.info("🔄 [MapaErrorBoundary] Resetando estado de erro"),this.setState({hasError:!1,error:null,errorInfo:null,errorCount:0})};handleGoHome=()=>{Ce.info("🏠 [MapaErrorBoundary] Navegando para home"),typeof window<"u"&&(window.location.href="/")};render(){if(this.state.hasError){const{error:t,errorInfo:a,errorCount:r}=this.state;return e.jsx("div",{className:"flex items-center justify-center min-h-screen p-4 bg-background",children:e.jsxs(ie,{className:"max-w-2xl w-full",children:[e.jsx(_e,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ve,{className:"h-8 w-8 text-destructive"}),e.jsxs("div",{children:[e.jsx(ye,{className:"text-2xl",children:"Erro no Mapa de Testemunhas"}),e.jsx(as,{children:r>1?`Ocorreram ${r} erros consecutivos`:"Ocorreu um erro inesperado"})]})]})}),e.jsxs(ue,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"font-semibold text-sm text-muted-foreground",children:"Mensagem de Erro"}),e.jsx("div",{className:"p-3 bg-destructive/10 border border-destructive/20 rounded-md",children:e.jsx("p",{className:"text-sm text-destructive font-mono",children:t?.message||"Erro desconhecido"})})]}),typeof process<"u"&&!1,e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"font-semibold text-sm text-muted-foreground",children:"Possíveis Causas"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm text-muted-foreground",children:[e.jsx("li",{children:"Problemas de conexão com o servidor"}),e.jsx("li",{children:"Dados inconsistentes ou mal formatados"}),e.jsx("li",{children:"Erro na Edge Function do backend"}),e.jsx("li",{children:"Sessão expirada ou inválida"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[r<=3&&e.jsxs(A,{onClick:this.handleReset,className:"flex-1",children:[e.jsx(Cs,{className:"mr-2 h-4 w-4"}),"Tentar Novamente"]}),e.jsxs(A,{onClick:this.handleGoHome,variant:"outline",className:"flex-1",children:[e.jsx(ja,{className:"mr-2 h-4 w-4"}),"Voltar ao Início"]})]}),r>3&&e.jsx("div",{className:"p-3 bg-yellow-500/10 border border-yellow-500/20 rounded-md",children:e.jsx("p",{className:"text-sm text-yellow-600 dark:text-yellow-400",children:"⚠️ Múltiplas tentativas falharam. Por favor, entre em contato com o suporte."})})]})]})})}return this.props.children}}const _i=()=>{const[s,t]=x.useState($.isEnabled()),{toast:a}=Ae();x.useEffect(()=>{t($.isEnabled())},[]);const r=()=>{const o=$.toggle();t(o),a({title:o?"🐛 Debug Mode Ativado":"Debug Mode Desativado",description:o?"Logs detalhados estão sendo exibidos no console":"Logs de debug foram desativados",duration:2e3})};return e.jsxs("div",{className:"flex items-center space-x-2 bg-muted/50 px-3 py-2 rounded-md border border-border/40",children:[e.jsx(co,{className:"h-4 w-4 text-muted-foreground"}),e.jsx(Ne,{htmlFor:"debug-mode",className:"text-sm cursor-pointer",children:"Debug Mode"}),e.jsx(nt,{id:"debug-mode",checked:s,onCheckedChange:r,className:"data-[state=checked]:bg-primary"})]})};async function yi(s){const t={functionName:s,isReachable:!1,hasAuth:!1};try{const{data:{session:a},error:r}=await Ie.auth.getSession();if(r)return t.authError=r.message,Ce.error(`[EdgeDiagnostics] Erro de sessão para ${s}`,{error:r}),t;if(!a)return t.authError="Nenhuma sessão ativa",Ce.warn(`[EdgeDiagnostics] Nenhuma sessão ativa para ${s}`),t;t.hasAuth=!0,Ce.info(`[EdgeDiagnostics] Testando ${s}...`);const{data:o,error:n}=await Ie.functions.invoke(s,{body:{paginacao:{page:1,limit:1},filtros:{}}});return n?(t.testResult="error",t.errorDetails={message:n.message,context:n.context,status:n.status},Ce.error(`[EdgeDiagnostics] Erro ao testar ${s}`,{error:n,errorDetails:t.errorDetails})):(t.isReachable=!0,t.testResult="success",Ce.info(`[EdgeDiagnostics] ${s} respondeu com sucesso`,{hasData:!!o,dataKeys:o?Object.keys(o):[]})),t}catch(a){return t.testResult="error",t.errorDetails=a,Ce.error(`[EdgeDiagnostics] Exceção ao testar ${s}`,{error:a}),t}}async function wi(){Ce.info("🔍 [EdgeDiagnostics] ===== INICIANDO DIAGNÓSTICO COMPLETO =====");const s=["mapa-testemunhas-processos","mapa-testemunhas-testemunhas"],t={};for(const r of s)Ce.info(`🔍 [EdgeDiagnostics] Testando função: ${r}`),t[r]=await yi(r);Ce.info("✅ [EdgeDiagnostics] ===== DIAGNÓSTICO CONCLUÍDO =====",{results:t});const a=Object.entries(t).map(([r,o])=>({function:r,reachable:o.isReachable,authenticated:o.hasAuth,testResult:o.testResult,error:o.errorDetails?.message||o.authError||"none"}));return console.table(a),t}function Ci(){Ce.info("🔍 [EdgeDiagnostics] ===== CONFIGURAÇÃO SUPABASE =====");const s={hasSupabaseClient:!!Ie,functionsUrl:"<<MANTER>>/functions/v1",hasAuth:!!Ie?.auth};return Ce.info("🔍 [EdgeDiagnostics] Config:",s),console.table(s),s}function Si(){const[s,t]=x.useState(null),[a,r]=x.useState(!1),o=async()=>{r(!0),Ci();const n=await wi();t(n),r(!1)};return e.jsxs(ie,{className:"border-dashed border-yellow-500/50 bg-yellow-50/5",children:[e.jsxs(_e,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(mo,{className:"h-4 w-4 text-yellow-600"}),e.jsx(ye,{className:"text-sm",children:"Diagnóstico de Edge Functions"})]}),e.jsx(q,{variant:"outline",className:"text-yellow-600 border-yellow-600",children:"DEV ONLY"})]}),e.jsx(as,{className:"text-xs",children:"Teste a conectividade e configuração das Edge Functions"})]}),e.jsxs(ue,{className:"space-y-3",children:[e.jsxs(A,{onClick:o,disabled:a,size:"sm",variant:"outline",className:"w-full",children:[a&&e.jsx(Cs,{className:"mr-2 h-3 w-3 animate-spin"}),a?"Executando diagnóstico...":"Executar Diagnóstico"]}),s&&e.jsx("div",{className:"space-y-2",children:Object.entries(s).map(([n,i])=>e.jsx("div",{className:"flex items-start justify-between gap-2 rounded-lg border border-border/50 bg-card/50 p-2 text-xs",children:e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsx("div",{className:"font-mono font-medium",children:n}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[i.hasAuth?e.jsxs(q,{variant:"outline",className:"text-green-600 border-green-600 text-[10px]",children:[e.jsx(ws,{className:"mr-1 h-2 w-2"}),"Autenticado"]}):e.jsxs(q,{variant:"outline",className:"text-red-600 border-red-600 text-[10px]",children:[e.jsx(Js,{className:"mr-1 h-2 w-2"}),"Sem Auth"]}),i.isReachable?e.jsxs(q,{variant:"outline",className:"text-green-600 border-green-600 text-[10px]",children:[e.jsx(ws,{className:"mr-1 h-2 w-2"}),"Alcançável"]}):e.jsxs(q,{variant:"outline",className:"text-red-600 border-red-600 text-[10px]",children:[e.jsx(Js,{className:"mr-1 h-2 w-2"}),"Não Alcançável"]})]}),(i.authError||i.errorDetails)&&e.jsx("div",{className:"text-[10px] text-destructive/80",children:i.authError||i.errorDetails?.message||"Erro desconhecido"})]})},n))})]})]})}function Ti(){const s=S(r=>r.density),t=S(r=>r.setDensity),a=[{value:"compact",label:"Compacto",description:"Espaçamento mínimo"},{value:"comfortable",label:"Confortável",description:"Espaçamento amplo"}];return e.jsxs(vs,{children:[e.jsx(bs,{asChild:!0,children:e.jsxs(A,{variant:"outline",size:"sm",className:"gap-2",children:[e.jsx(uo,{className:"h-4 w-4"}),"Densidade"]})}),e.jsx(us,{align:"end",className:"w-[200px]",children:a.map(r=>e.jsxs(es,{onClick:()=>t(r.value),className:"flex items-center justify-between cursor-pointer",children:[e.jsxs("div",{className:"flex flex-col gap-0.5",children:[e.jsx("span",{className:"text-sm font-medium",children:r.label}),e.jsx("span",{className:"text-xs text-muted-foreground",children:r.description})]}),s===r.value&&e.jsx(st,{className:"h-4 w-4 text-primary"})]},r.value))})]})}function Ei(){const s=rt(),t=S(o=>o.navigationHistory),a=S(o=>o.popNavigation),r=o=>{const n=t[o];n?.path&&(s(n.path),a(o))};return t.length<=1?null:e.jsx(Va,{className:"mb-4",children:e.jsxs(Ba,{children:[e.jsx(Zs,{children:e.jsxs(Xs,{onClick:()=>r(0),className:"flex items-center gap-1 cursor-pointer",children:[e.jsx(ja,{className:"h-3.5 w-3.5"}),e.jsx("span",{children:"Início"})]})}),t.slice(1).map((o,n)=>{const i=n===t.length-2,d=n+1;return e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ja,{}),e.jsx(Zs,{children:i?e.jsx(Ua,{className:"font-medium",children:o.label}):e.jsx(Xs,{onClick:()=>r(d),className:"cursor-pointer hover:text-foreground",children:o.label})})]},d)})]})})}const Pi=()=>{const s=rt(),[t,a]=ho(),{user:r,loading:o}=Co(),{toast:n}=Ae(),i=S(or),d=S(Yo),u=S(en),m=S(sn),v=S(an),g=S(rn),w=S(on),T=S(nn),G=S(ln),f=x.useRef(null),U=x.useRef(null),re=x.useRef(!1),P=x.useRef(!0),J=x.useRef(!1),[he,Y]=x.useState(!1),[H,B]=x.useState(!1),l=S(p=>p.chatResult),c=S(p=>p.chatStatus),h=S(p=>p.setActiveTab),y=S(p=>p.setProcessos),C=S(p=>p.setTestemunhas),z=S(p=>p.setIsLoading),oe=S(p=>p.setLastUpdate),xe=S(p=>p.setError),ge=S(p=>p.setIsImportModalOpen),L=S(p=>p.loadViews),ee=S(p=>p.setProcessoFilters),D=S(p=>p.setTestemunhaFilters),ce=S(p=>p.setSelectedProcesso),M=S(p=>p.setSelectedTestemunha),V=S(p=>p.setHasMoreProcessos),b=S(p=>p.setHasMoreTestemunhas),[R,j]=x.useState(0),[E,Q]=x.useState(0),F=p=>p.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),_=x.useMemo(()=>{const p=Array.isArray(d)?d:[],O=Array.isArray(u)?u:[],Z=p.filter(pe=>pe?.classificacao_final==="Risco Alto"||pe?.classificacao_final==="Alto").length,ae=O.filter(pe=>pe?.foi_testemunha_em_ambos_polos===!0).length,X=(pe,le)=>{if(!isFinite(pe)||!isFinite(le)||le<=0)return 0;const de=Math.round(pe/le*100);return isFinite(de)?de:0},Me=isFinite(R)&&R>0?R:p.length,me=isFinite(E)&&E>0?E:O.length;return{totalProcessos:Me,totalTestemunhas:me,processosAltoRisco:Z,testemunhasAmbosPolos:ae,pctProcAlto:X(Z,Me),pctAmbos:X(ae,me)}},[d,u,R,E]),se=p=>m?"loading":v?navigator.onLine?"error":"offline":p.length?"success":"empty",k=se(d),te=se(u);x.useEffect(()=>{if(!o&&!r){s("/login");return}},[r,o,s]),x.useEffect(()=>{r&&L(r.id)},[r,L]),x.useEffect(()=>{if(J.current)return;const p=t.get("tab"),O=t.get("nome"),Z=t.get("cnj"),ae=t.get("reclamante");if(p&&(p==="processos"||p==="testemunhas")&&p!==i&&h(p),O&&D({search:decodeURIComponent(O)}),Z&&ee({search:decodeURIComponent(Z)}),ae&&ee({search:decodeURIComponent(ae)}),O||Z||ae){J.current=!0;const X=new URLSearchParams(t);X.delete("nome"),X.delete("cnj"),X.delete("reclamante"),a(X,{replace:!0})}},[]),x.useEffect(()=>{if(!(!J.current||re.current)&&!(d.length===0&&u.length===0)){if(G.search&&u.length>0){const p=u.find(O=>O.nome_testemunha?.toLowerCase()===G.search?.toLowerCase());p&&!S.getState().selectedTestemunha&&(M(p),n({title:"Testemunha selecionada",description:p.nome_testemunha}))}if(T.search&&d.length>0){const p=d.find(O=>O.cnj===T.search||O.numero_cnj===T.search);p&&!S.getState().selectedProcesso&&(ce(p),n({title:"Processo selecionado",description:p.cnj||p.numero_cnj}))}}},[d.length,u.length]);const ne=p=>{const O=p;h(O),a({tab:O},{replace:!0}),ce(null),M(null)},W=et(T,300),K=et(G,300),I=x.useCallback(async()=>{if(!r||re.current)return;f.current?.abort(),U.current?.abort();const p=new AbortController,O=new AbortController;f.current=p,U.current=O,re.current=!0,z(!0),xe(!1);try{const Z=S.getState().processoFilters,ae=S.getState().testemunhaFilters,{processosPage:X,testemunhasPage:Me,pageSize:me,processos:pe,testemunhas:le}=S.getState(),[de,we]=await Promise.all([ti({page:X||1,limit:me||50,filters:Z}),si({page:Me||1,limit:me||50,filters:ae})]);if(p.signal.aborted||O.signal.aborted)return;const ss=Array.isArray(de.data)?de.data:[],rs=Array.isArray(we.data)?we.data:[];if(S.getState().processosPage>1){const os=[...pe,...ss],Ms=Array.from(new Map(os.map(hs=>[hs.cnj,hs])).values());y(Ms)}else y(ss);if(S.getState().testemunhasPage>1){const os=[...le,...rs],Ms=Array.from(new Map(os.map(hs=>[hs.nome_testemunha,hs])).values());C(Ms)}else C(rs);const qe=isFinite(de.total)?de.total:ss.length,Te=isFinite(we.total)?we.total:rs.length;j(qe),Q(Te),V(qe>S.getState().processosPage*S.getState().pageSize),b(Te>S.getState().testemunhasPage*S.getState().pageSize);const ze=de.error||we.error;ze?(xe(!0,`Erro ao conectar: ${ze}`),n({title:"Falha ao conectar",description:ze,variant:"destructive"})):P.current&&(oe(new Date),P.current=!1)}catch(Z){if(Z?.name==="AbortError")return;const ae=Z instanceof Error?Z.message:"Erro ao carregar dados";xe(!0,ae),n({title:"Falha na conexão",description:ae,variant:"destructive"})}finally{!p.signal.aborted&&!O.signal.aborted&&(re.current=!1,z(!1))}},[r]);x.useEffect(()=>(r&&I(),()=>{f.current?.abort(),U.current?.abort()}),[r,I]),x.useEffect(()=>{!P.current&&r&&I()},[W,K,I]),x.useEffect(()=>{const p=O=>{(O.ctrlKey||O.metaKey)&&O.key==="f"&&(O.preventDefault(),Y(!0))};return window.addEventListener("keydown",p),()=>window.removeEventListener("keydown",p)},[]);const je=()=>{const O=Object.entries(i==="processos"?T:G);if(O.length===0)return null;const Z=ae=>{if(i==="processos"){const X={...T};delete X[ae],ee(X)}else{const X={...G};delete X[ae],D(X)}};return e.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Filtros ativos:"}),O.map(([ae,X])=>e.jsxs(q,{variant:"secondary",className:"gap-1",children:[e.jsxs("span",{className:"text-xs",children:[ae,": ",String(X)]}),e.jsx("button",{onClick:()=>Z(ae),className:"ml-1 hover:bg-secondary-foreground/10 rounded-full p-0.5","aria-label":`Remover filtro ${ae}`,children:e.jsx(Xe,{className:"h-3 w-3"})})]},ae))]})};return o?e.jsx("div",{className:"min-h-screen flex items-center justify-center","aria-live":"polite",children:e.jsx("div",{className:"animate-pulse text-muted-foreground",children:"Verificando autenticação..."})}):r?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("div",{className:"border-b border-border/50 bg-card",children:e.jsxs("div",{className:"container mx-auto px-6 py-6",children:[e.jsx(Ei,{}),e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold flex items-center gap-3",children:[e.jsx(xo,{className:"h-8 w-8 text-primary","aria-hidden":"true"}),"Mapa de Testemunhas",v&&e.jsx(q,{variant:"destructive",className:"text-xs",children:"Modo Fallback"})]}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Análise estratégica de testemunhas e processos judiciais"}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(po,{className:"h-4 w-4","aria-hidden":"true"}),e.jsxs("span",{children:["Última atualização:"," ",w?F(w):"—"]})]}),e.jsx(Ge,{orientation:"vertical",className:"h-4"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(pa,{className:"h-4 w-4","aria-hidden":"true"}),e.jsx("span",{children:v?"Dados mock":"Dados em tempo real"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ti,{}),e.jsxs(A,{variant:"outline",onClick:()=>ge(!0),className:"gap-2","aria-label":"Importar dados via Excel",children:[e.jsx(Le,{className:"h-4 w-4","aria-hidden":"true"}),"Importar Dados"]}),$.isEnabled()&&e.jsxs(Fa,{open:H,onOpenChange:B,children:[e.jsx(Eo,{asChild:!0,children:e.jsxs(A,{variant:"outline",size:"sm",className:"gap-2",children:[e.jsx(fo,{className:"h-4 w-4"}),"Diagnóstico"]})}),e.jsxs(it,{side:"right",className:"w-[400px]",children:[e.jsxs(lt,{children:[e.jsx(ct,{children:"Diagnóstico do Sistema"}),e.jsx(dt,{children:"Ferramentas de desenvolvimento e diagnóstico"})]}),e.jsx("div",{className:"mt-6",children:e.jsx(Si,{})})]})]}),e.jsx(_i,{}),e.jsx(Fn,{}),e.jsx(Wn,{data:i==="processos"?d:u,fileName:i==="processos"?"por_processo.csv":"por_testemunha.csv"})]})]})]})}),e.jsxs("div",{className:"container mx-auto px-6 py-6",children:[v&&e.jsx(ie,{className:"rounded-2xl border-destructive/50 bg-destructive/5 mb-6",children:e.jsx(ue,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2 text-destructive",children:[e.jsx(Ve,{className:"h-4 w-4","aria-hidden":"true"}),e.jsx("span",{className:"font-medium",children:"Erro:"}),e.jsx("span",{className:"text-sm",children:g})]})})}),e.jsx(Pa,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsxs(xs,{children:[e.jsx(ps,{asChild:!0,children:e.jsxs(ie,{className:"rounded-2xl border-border/50 hover:shadow-md transition-shadow cursor-help",children:[e.jsx(_e,{className:"pb-3",children:e.jsxs(ye,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(ft,{className:"h-4 w-4 text-primary","aria-hidden":"true"}),"Total de Processos"]})}),e.jsxs(ue,{children:[e.jsx("div",{className:"text-3xl font-bold text-primary",children:_.totalProcessos.toLocaleString("pt-BR")}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Processos cadastrados"," ",d.length<_.totalProcessos&&`(exibindo ${d.length})`]})]})]})}),e.jsx(ns,{children:e.jsx("p",{children:"Total de processos jurídicos cadastrados no sistema"})})]}),e.jsxs(xs,{children:[e.jsx(ps,{asChild:!0,children:e.jsxs(ie,{className:"rounded-2xl border-border/50 hover:shadow-md transition-shadow cursor-help",children:[e.jsx(_e,{className:"pb-3",children:e.jsxs(ye,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(gs,{className:"h-4 w-4 text-emerald-600","aria-hidden":"true"}),"Total de Testemunhas"]})}),e.jsxs(ue,{children:[e.jsx("div",{className:"text-3xl font-bold text-emerald-600",children:_.totalTestemunhas.toLocaleString("pt-BR")}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Testemunhas identificadas"," ",u.length<_.totalTestemunhas&&`(exibindo ${u.length})`]})]})]})}),e.jsx(ns,{children:e.jsx("p",{children:"Total de testemunhas únicas identificadas em todos os processos"})})]}),e.jsxs(xs,{children:[e.jsx(ps,{asChild:!0,children:e.jsxs(ie,{className:"rounded-2xl border-border/50 hover:shadow-md transition-shadow cursor-help",children:[e.jsx(_e,{className:"pb-3",children:e.jsxs(ye,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Ve,{className:"h-4 w-4 text-destructive","aria-hidden":"true"}),"Processos de Alto Risco"]})}),e.jsxs(ue,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-3xl font-bold text-destructive",children:_.processosAltoRisco}),e.jsxs(q,{variant:"destructive",className:"text-xs",children:[_.pctProcAlto,"%"]})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Requerem atenção especial"})]})]})}),e.jsx(ns,{children:e.jsx("p",{children:"Processos classificados como alto risco que necessitam atenção imediata"})})]}),e.jsxs(xs,{children:[e.jsx(ps,{asChild:!0,children:e.jsxs(ie,{className:"rounded-2xl border-border/50 hover:shadow-md transition-shadow cursor-help",children:[e.jsx(_e,{className:"pb-3",children:e.jsxs(ye,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(ga,{className:"h-4 w-4 text-orange-500","aria-hidden":"true"}),"Atua nos Dois Polos"]})}),e.jsxs(ue,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-3xl font-bold text-orange-600",children:_.testemunhasAmbosPolos}),e.jsxs(q,{variant:"secondary",className:"text-xs",children:[_.pctAmbos,"%"]})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Testemunhas em ambos os polos"})]})]})}),e.jsx(ns,{children:e.jsx("p",{children:"Testemunhas que participaram tanto como testemunha da reclamante quanto da ré"})})]})]})}),e.jsxs("div",{id:"chat-assistant-section",className:"mb-8 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Assistente de Análise"}),e.jsxs(ke,{className:"inline-flex items-center gap-2 py-2 px-3 w-auto border-violet-200 bg-violet-50",children:[e.jsx(at,{className:"h-4 w-4 text-violet-600"}),e.jsxs(Oe,{className:"text-xs text-violet-900",children:["IA Assistiva LGPD Compliant."," ",e.jsx("a",{href:"/privacidade",className:"underline font-medium hover:text-violet-700",children:"Saiba mais"})]})]})]}),e.jsx(ui,{}),l&&e.jsx("div",{className:"mt-6",children:e.jsx(ji,{blocks:l})}),c==="loading"&&e.jsx("div",{className:"mt-6",children:e.jsx(bi,{})})]}),e.jsx("div",{className:"mt-8",children:e.jsxs(ba,{value:i,onValueChange:ne,children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4 mb-6",children:[e.jsxs(Na,{className:"grid w-full lg:w-auto grid-cols-2",children:[e.jsxs(Es,{value:"processos",className:"flex items-center gap-2",children:[e.jsx(ft,{className:"h-4 w-4","aria-hidden":"true"}),"Por Processo"]}),e.jsxs(Es,{value:"testemunhas",className:"flex items-center gap-2",children:[e.jsx(gs,{className:"h-4 w-4","aria-hidden":"true"}),"Por Testemunha"]})]}),e.jsxs("div",{className:"flex gap-2",children:[r&&e.jsx(_n,{userId:r.id}),e.jsx(Nn,{})]})]}),e.jsxs(Ps,{value:"processos",className:"space-y-6",children:[e.jsx(At,{isLoading:m,hasError:v,errorMessage:g,isConnected:!v||d.length>3,dataCount:d.length,dataType:"processos"}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs(A,{variant:"outline",onClick:()=>Y(!0),className:"w-full sm:w-auto gap-2",children:[e.jsx(gt,{className:"h-4 w-4"}),"Filtros Avançados",e.jsxs("kbd",{className:"ml-auto hidden sm:inline-flex h-5 select-none items-center gap-1 rounded border bg-muted px-1.5 font-mono text-[10px] font-medium opacity-100",children:[e.jsx("span",{className:"text-xs",children:"⌘"}),"F"]})]}),je()]}),k!=="success"?e.jsx(js,{status:k,onRetry:I}):e.jsxs(e.Fragment,{children:[e.jsx(un,{data:d}),e.jsx("div",{className:"flex justify-center mt-4",children:e.jsx(A,{variant:"outline",disabled:!S.getState().hasMoreProcessos||m,onClick:()=>{S.getState().loadMoreProcessos(),I()},children:m?"Carregando...":S.getState().hasMoreProcessos?"Carregar mais":"Fim"})})]})]}),e.jsxs(Ps,{value:"testemunhas",className:"space-y-6",children:[e.jsx(At,{isLoading:m,hasError:v,errorMessage:g,isConnected:!v||u.length>3,dataCount:u.length,dataType:"testemunhas"}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs(A,{variant:"outline",onClick:()=>Y(!0),className:"w-full sm:w-auto gap-2",children:[e.jsx(gt,{className:"h-4 w-4"}),"Filtros Avançados",e.jsxs("kbd",{className:"ml-auto hidden sm:inline-flex h-5 select-none items-center gap-1 rounded border bg-muted px-1.5 font-mono text-[10px] font-medium opacity-100",children:[e.jsx("span",{className:"text-xs",children:"⌘"}),"F"]})]}),je()]}),te!=="success"?e.jsx(js,{status:te,onRetry:I}):e.jsxs(e.Fragment,{children:[e.jsx(xn,{data:u,status:te,onRetry:I}),e.jsx("div",{className:"flex justify-center mt-4",children:e.jsx(A,{variant:"outline",disabled:!S.getState().hasMoreTestemunhas||m,onClick:()=>{S.getState().loadMoreTestemunhas(),I()},children:m?"Carregando...":S.getState().hasMoreTestemunhas?"Carregar mais":"Fim"})})]})]})]})}),e.jsx(Cn,{}),e.jsx(On,{}),e.jsx(bn,{open:he,onOpenChange:Y})]})]}):null},Ri=()=>e.jsx(Ni,{children:e.jsx(Pi,{})}),Li=Object.freeze(Object.defineProperty({__proto__:null,default:Ri},Symbol.toStringTag,{value:"Module"}));export{Fi as $,Lo as A,za as B,Ii as C,Ra as D,vs as E,bs as F,us as G,es as H,Ws as I,$o as J,Ha as K,Va as L,Ba as M,Zs as N,Ua as O,Xs as P,Ja as Q,gi as R,We as S,Pa as T,As as U,js as V,$i as W,$n as X,To as Y,rr as Z,Oa as _,Be as a,Je as a0,ts as a1,Oo as a2,Li as a3,Ze as b,Ue as c,fe as d,nt as e,Mi as f,Qa as g,Wa as h,Xa as i,Ya as j,Za as k,sr as l,er as m,ot as n,Da as o,ka as p,Fa as q,it as r,Ge as s,xs as t,ps as u,ns as v,Fo as w,$a as x,La as y,qa as z};
